<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="mpark/wg21" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="dcterms.date" content="2024-03-21" />
  <title>Quantities and units library</title>
  <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
      div.csl-block{margin-left: 1.5em;}
      ul.task-list{list-style: none;}
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          color: #aaaaaa;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
      div.sourceCode
        {  background-color: #f6f8fa; }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span { } /* Normal */
      code span.al { color: #ff0000; } /* Alert */
      code span.an { } /* Annotation */
      code span.at { } /* Attribute */
      code span.bn { color: #9f6807; } /* BaseN */
      code span.bu { color: #9f6807; } /* BuiltIn */
      code span.cf { color: #00607c; } /* ControlFlow */
      code span.ch { color: #9f6807; } /* Char */
      code span.cn { } /* Constant */
      code span.co { color: #008000; font-style: italic; } /* Comment */
      code span.cv { color: #008000; font-style: italic; } /* CommentVar */
      code span.do { color: #008000; } /* Documentation */
      code span.dt { color: #00607c; } /* DataType */
      code span.dv { color: #9f6807; } /* DecVal */
      code span.er { color: #ff0000; font-weight: bold; } /* Error */
      code span.ex { } /* Extension */
      code span.fl { color: #9f6807; } /* Float */
      code span.fu { } /* Function */
      code span.im { } /* Import */
      code span.in { color: #008000; } /* Information */
      code span.kw { color: #00607c; } /* Keyword */
      code span.op { color: #af1915; } /* Operator */
      code span.ot { } /* Other */
      code span.pp { color: #6f4e37; } /* Preprocessor */
      code span.re { } /* RegionMarker */
      code span.sc { color: #9f6807; } /* SpecialChar */
      code span.ss { color: #9f6807; } /* SpecialString */
      code span.st { color: #9f6807; } /* String */
      code span.va { } /* Variable */
      code span.vs { color: #9f6807; } /* VerbatimString */
      code span.wa { color: #008000; font-weight: bold; } /* Warning */
      code.diff {color: #898887}
      code.diff span.va {color: #006e28}
      code.diff span.st {color: #bf0303}
  </style>
  <style type="text/css">
body {
margin: 5em;
font-family: serif;

hyphens: auto;
line-height: 1.35;
text-align: justify;
}
@media screen and (max-width: 30em) {
body {
margin: 1.5em;
}
}
div.wrapper {
max-width: 60em;
margin: auto;
}
ul {
list-style-type: none;
padding-left: 2em;
margin-top: -0.2em;
margin-bottom: -0.2em;
}
a {
text-decoration: none;
color: #4183C4;
}
a.hidden_link {
text-decoration: none;
color: inherit;
}
li {
margin-top: 0.6em;
margin-bottom: 0.6em;
}
h1, h2, h3, h4 {
position: relative;
line-height: 1;
}
a.self-link {
position: absolute;
top: 0;
left: calc(-1 * (3.5rem - 26px));
width: calc(3.5rem - 26px);
height: 2em;
text-align: center;
border: none;
transition: opacity .2s;
opacity: .5;
font-family: sans-serif;
font-weight: normal;
font-size: 83%;
}
a.self-link:hover { opacity: 1; }
a.self-link::before { content: "§"; }
ul > li:before {
content: "\2014";
position: absolute;
margin-left: -1.5em;
}
:target { background-color: #C9FBC9; }
:target .codeblock { background-color: #C9FBC9; }
:target ul { background-color: #C9FBC9; }
.abbr_ref { float: right; }
.folded_abbr_ref { float: right; }
:target .folded_abbr_ref { display: none; }
:target .unfolded_abbr_ref { float: right; display: inherit; }
.unfolded_abbr_ref { display: none; }
.secnum { display: inline-block; min-width: 35pt; }
.header-section-number { display: inline-block; min-width: 35pt; }
.annexnum { display: block; }
div.sourceLinkParent {
float: right;
}
a.sourceLink {
position: absolute;
opacity: 0;
margin-left: 10pt;
}
a.sourceLink:hover {
opacity: 1;
}
a.itemDeclLink {
position: absolute;
font-size: 75%;
text-align: right;
width: 5em;
opacity: 0;
}
a.itemDeclLink:hover { opacity: 1; }
span.marginalizedparent {
position: relative;
left: -5em;
}
li span.marginalizedparent { left: -7em; }
li ul > li span.marginalizedparent { left: -9em; }
li ul > li ul > li span.marginalizedparent { left: -11em; }
li ul > li ul > li ul > li span.marginalizedparent { left: -13em; }
div.footnoteNumberParent {
position: relative;
left: -4.7em;
}
a.marginalized {
position: absolute;
font-size: 75%;
text-align: right;
width: 5em;
}
a.enumerated_item_num {
position: relative;
left: -3.5em;
display: inline-block;
margin-right: -3em;
text-align: right;
width: 3em;
}
div.para { margin-bottom: 0.6em; margin-top: 0.6em; text-align: justify; }
div.section { text-align: justify; }
div.sentence { display: inline; }
span.indexparent {
display: inline;
position: relative;
float: right;
right: -1em;
}
a.index {
position: absolute;
display: none;
}
a.index:before { content: "⟵"; }

a.index:target {
display: inline;
}
.indexitems {
margin-left: 2em;
text-indent: -2em;
}
div.itemdescr {
margin-left: 3em;
}
.bnf {
font-family: serif;
margin-left: 40pt;
margin-top: 0.5em;
margin-bottom: 0.5em;
}
.ncbnf {
font-family: serif;
margin-top: 0.5em;
margin-bottom: 0.5em;
margin-left: 40pt;
}
.ncsimplebnf {
font-family: serif;
font-style: italic;
margin-top: 0.5em;
margin-bottom: 0.5em;
margin-left: 40pt;
background: inherit; 
}
span.textnormal {
font-style: normal;
font-family: serif;
white-space: normal;
display: inline-block;
}
span.rlap {
display: inline-block;
width: 0px;
}
span.descr { font-style: normal; font-family: serif; }
span.grammarterm { font-style: italic; }
span.term { font-style: italic; }
span.terminal { font-family: monospace; font-style: normal; }
span.nonterminal { font-style: italic; }
span.tcode { font-family: monospace; font-style: normal; }
span.textbf { font-weight: bold; }
span.textsc { font-variant: small-caps; }
a.nontermdef { font-style: italic; font-family: serif; }
span.emph { font-style: italic; }
span.techterm { font-style: italic; }
span.mathit { font-style: italic; }
span.mathsf { font-family: sans-serif; }
span.mathrm { font-family: serif; font-style: normal; }
span.textrm { font-family: serif; }
span.textsl { font-style: italic; }
span.mathtt { font-family: monospace; font-style: normal; }
span.mbox { font-family: serif; font-style: normal; }
span.ungap { display: inline-block; width: 2pt; }
span.textit { font-style: italic; }
span.texttt { font-family: monospace; }
span.tcode_in_codeblock { font-family: monospace; font-style: normal; }
span.phantom { color: white; }

span.math { font-style: normal; }
span.mathblock {
display: block;
margin-left: auto;
margin-right: auto;
margin-top: 1.2em;
margin-bottom: 1.2em;
text-align: center;
}
span.mathalpha {
font-style: italic;
}
span.synopsis {
font-weight: bold;
margin-top: 0.5em;
display: block;
}
span.definition {
font-weight: bold;
display: block;
}
.codeblock {
margin-left: 1.2em;
line-height: 127%;
}
.outputblock {
margin-left: 1.2em;
line-height: 127%;
}
div.itemdecl {
margin-top: 2ex;
}
code.itemdeclcode {
white-space: pre;
display: block;
}
span.textsuperscript {
vertical-align: super;
font-size: smaller;
line-height: 0;
}
.footnotenum { vertical-align: super; font-size: smaller; line-height: 0; }
.footnote {
font-size: small;
margin-left: 2em;
margin-right: 2em;
margin-top: 0.6em;
margin-bottom: 0.6em;
}
div.minipage {
display: inline-block;
margin-right: 3em;
}
div.numberedTable {
text-align: center;
margin: 2em;
}
div.figure {
text-align: center;
margin: 2em;
}
table {
border: 1px solid black;
border-collapse: collapse;
margin-left: auto;
margin-right: auto;
margin-top: 0.8em;
text-align: left;
hyphens: none; 
}
td, th {
padding-left: 1em;
padding-right: 1em;
vertical-align: top;
}
td.empty {
padding: 0px;
padding-left: 1px;
}
td.left {
text-align: left;
}
td.right {
text-align: right;
}
td.center {
text-align: center;
}
td.justify {
text-align: justify;
}
td.border {
border-left: 1px solid black;
}
tr.rowsep, td.cline {
border-top: 1px solid black;
}
tr.even, tr.odd {
border-bottom: 1px solid black;
}
tr.capsep {
border-top: 3px solid black;
border-top-style: double;
}
tr.header {
border-bottom: 3px solid black;
border-bottom-style: double;
}
th {
border-bottom: 1px solid black;
}
span.centry {
font-weight: bold;
}
div.table {
display: block;
margin-left: auto;
margin-right: auto;
text-align: center;
width: 90%;
}
span.indented {
display: block;
margin-left: 2em;
margin-bottom: 1em;
margin-top: 1em;
}
ol.enumeratea { list-style-type: none; background: inherit; }
ol.enumerate { list-style-type: none; background: inherit; }

code.sourceCode > span { display: inline; }
</style>
  <link href="data:image/x-icon;base64,AAABAAIAEBAAAAEAIABoBAAAJgAAACAgAAABACAAqBAAAI4EAAAoAAAAEAAAACAAAAABACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AIJEAACCRAAAgkQAAIJEAACCRAAAgkQAVoJEAN6CRADegkQAWIJEAACCRAAAgkQAAIJEAACCRAAA////AP///wCCRAAAgkQAAIJEAACCRAAsgkQAvoJEAP+CRAD/gkQA/4JEAP+CRADAgkQALoJEAACCRAAAgkQAAP///wD///8AgkQAAIJEABSCRACSgkQA/IJEAP99PQD/dzMA/3czAP99PQD/gkQA/4JEAPyCRACUgkQAFIJEAAD///8A////AHw+AFiBQwDqgkQA/4BBAP9/PxP/uZd6/9rJtf/bybX/upd7/39AFP+AQQD/gkQA/4FDAOqAQgBc////AP///wDKklv4jlEa/3o7AP+PWC//8+3o///////////////////////z7un/kFox/35AAP+GRwD/mVYA+v///wD///8A0Zpk+NmibP+0d0T/8evj///////+/fv/1sKz/9bCs//9/fr//////+/m2/+NRwL/nloA/5xYAPj///8A////ANKaZPjRmGH/5cKh////////////k149/3UwAP91MQD/lmQ//86rhv+USg3/m1YA/5hSAP+bVgD4////AP///wDSmmT4zpJY/+/bx///////8+TV/8mLT/+TVx//gkIA/5lVAP+VTAD/x6B//7aEVv/JpH7/s39J+P///wD///8A0ppk+M6SWP/u2sf///////Pj1f/Nj1T/2KFs/8mOUv+eWhD/lEsA/8aee/+0glT/x6F7/7J8Rvj///8A////ANKaZPjRmGH/48Cf///////+/v7/2qt//82PVP/OkFX/37KJ/86siv+USg7/mVQA/5hRAP+bVgD4////AP///wDSmmT40ppk/9CVXP/69O////////7+/v/x4M//8d/P//7+/f//////9u7n/6tnJf+XUgD/nFgA+P///wD///8A0ppk+NKaZP/RmWL/1qNy//r07///////////////////////+vXw/9akdP/Wnmn/y5FY/6JfFvj///8A////ANKaZFTSmmTo0ppk/9GYYv/Ql1//5cWm//Hg0P/x4ND/5cWm/9GXYP/RmGH/0ppk/9KaZOjVnmpY////AP///wDSmmQA0ppkEtKaZI7SmmT60ppk/9CWX//OkVb/zpFW/9CWX//SmmT/0ppk/NKaZJDSmmQS0ppkAP///wD///8A0ppkANKaZADSmmQA0ppkKtKaZLrSmmT/0ppk/9KaZP/SmmT/0ppkvNKaZCrSmmQA0ppkANKaZAD///8A////ANKaZADSmmQA0ppkANKaZADSmmQA0ppkUtKaZNzSmmTc0ppkVNKaZADSmmQA0ppkANKaZADSmmQA////AP5/AAD4HwAA4AcAAMADAACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAMADAADgBwAA+B8AAP5/AAAoAAAAIAAAAEAAAAABACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AP///wCCRAAAgkQAAIJEAACCRAAAgkQAAIJEAACCRAAAgkQAAIJEAACCRAAAgkQAAIJEAAyCRACMgkQA6oJEAOqCRACQgkQAEIJEAACCRAAAgkQAAIJEAACCRAAAgkQAAIJEAACCRAAAgkQAAIJEAACCRAAA////AP///wD///8A////AIJEAACCRAAAgkQAAIJEAACCRAAAgkQAAIJEAACCRAAAgkQAAIJEAACCRABigkQA5oJEAP+CRAD/gkQA/4JEAP+CRADqgkQAZoJEAACCRAAAgkQAAIJEAACCRAAAgkQAAIJEAACCRAAAgkQAAIJEAAD///8A////AP///wD///8AgkQAAIJEAACCRAAAgkQAAIJEAACCRAAAgkQAAIJEAACCRAA4gkQAwoJEAP+CRAD/gkQA/4JEAP+CRAD/gkQA/4JEAP+CRAD/gkQAxIJEADyCRAAAgkQAAIJEAACCRAAAgkQAAIJEAACCRAAAgkQAAP///wD///8A////AP///wCCRAAAgkQAAIJEAACCRAAAgkQAAIJEAACCRAAWgkQAmIJEAP+CRAD/gkQA/4JEAP+CRAD/gkQA/4JEAP+CRAD/gkQA/4JEAP+CRAD/gkQA/4JEAJyCRAAYgkQAAIJEAACCRAAAgkQAAIJEAACCRAAA////AP///wD///8A////AIJEAACCRAAAgkQAAIJEAACCRAAAgkQAdIJEAPCCRAD/gkQA/4JEAP+CRAD/gkQA/4JEAP+CRAD/gkQA/4JEAP+CRAD/gkQA/4JEAP+CRAD/gkQA/4JEAPSCRAB4gkQAAIJEAACCRAAAgkQAAIJEAAD///8A////AP///wD///8AgkQAAIJEAACCRAAAgkQASoJEANKCRAD/gkQA/4JEAP+CRAD/g0YA/39AAP9zLgD/bSQA/2shAP9rIQD/bSQA/3MuAP9/PwD/g0YA/4JEAP+CRAD/gkQA/4JEAP+CRADUgkQAToJEAACCRAAAgkQAAP///wD///8A////AP///wB+PwAAgkUAIoJEAKiCRAD/gkQA/4JEAP+CRAD/hEcA/4BBAP9sIwD/dTAA/5RfKv+viF7/vp56/76ee/+wiF7/lWAr/3YxAP9sIwD/f0AA/4RHAP+CRAD/gkQA/4JEAP+CRAD/gkQArIJEACaBQwAA////AP///wD///8A////AIBCAEBzNAD6f0EA/4NFAP+CRAD/gkQA/4VIAP92MwD/bSUA/6N1Tv/ezsL/////////////////////////////////38/D/6V3Uv9uJgD/dTEA/4VJAP+CRAD/gkQA/4JEAP+BQwD/fUAA/4FDAEj///8A////AP///wD///8AzJRd5qBlKf91NgD/dDUA/4JEAP+FSQD/cy4A/3YyAP/PuKP//////////////////////////////////////////////////////9K7qP94NQD/ciwA/4VJAP+CRAD/fkEA/35BAP+LSwD/mlYA6v///wD///8A////AP///wDdpnL/4qx3/8KJUv+PUhf/cTMA/3AsAP90LgD/4dK+/////////////////////////////////////////////////////////////////+TYxf91MAD/dTIA/31CAP+GRwD/llQA/6FcAP+gWwD8////AP///wD///8A////ANGZY/LSm2X/4ap3/92mcP+wdT3/byQA/8mwj////////////////////////////////////////////////////////////////////////////+LYxv9zLgP/jUoA/59bAP+hXAD/nFgA/5xYAPL///8A////AP///wD///8A0ppk8tKaZP/RmWL/1p9q/9ubXv/XqXj////////////////////////////7+fD/vZyG/6BxS/+gcUr/vJuE//r37f//////////////////////3MOr/5dQBf+dVQD/nVkA/5xYAP+cWAD/nFgA8v///wD///8A////AP///wDSmmTy0ppk/9KaZP/SmWP/yohJ//jo2P//////////////////////4NTG/4JDFf9lGAD/bSQA/20kAP9kGAD/fz8S/+Xb0f//////5NG9/6txN/+LOgD/m1QA/51aAP+cWAD/m1cA/5xYAP+cWADy////AP///wD///8A////ANKaZPLSmmT/0ppk/8+TWf/Unmv//v37//////////////////////+TWRr/VwsA/35AAP+ERgD/g0UA/4JGAP9lHgD/kFga/8KXX/+TRwD/jT4A/49CAP+VTQD/n10A/5xYAP+OQQD/lk4A/55cAPL///8A////AP///wD///8A0ppk8tKaZP/SmmT/y4tO/92yiP//////////////////////8NnE/8eCQP+rcTT/ez0A/3IyAP98PgD/gEMA/5FSAP+USwD/jj8A/5lUAP+JNwD/yqV2/694Mf+HNQD/jkAA/82rf/+laBj/jT4A8v///wD///8A////AP///wDSmmTy0ppk/9KaZP/LiUr/4byY///////////////////////gupX/0I5P/+Wuev/Lklz/l1sj/308AP+QSwD/ol0A/59aAP+aVQD/k0oA/8yoh///////+fXv/6pwO//Lp3v///////Pr4f+oay7y////AP///wD///8A////ANKaZPLSmmT/0ppk/8uJSv/hvJj//////////////////////+G7l//Jhkb/0ppk/96nc//fqXX/x4xO/6dkFP+QSQD/llEA/5xXAP+USgD/yaOA///////38uv/qG05/8ijdv//////8efb/6ZpLPL///8A////AP///wD///8A0ppk8tKaZP/SmmT/zIxO/9yxh///////////////////////7dbA/8iEQf/Sm2X/0Zlj/9ScZv/eqHf/2KJv/7yAQf+XTgD/iToA/5lSAP+JNgD/yKFv/611LP+HNQD/jT8A/8qmeP+kZRT/jT4A8v///wD///8A////AP///wDSmmTy0ppk/9KaZP/Pk1n/1J5q//78+//////////////////+/fv/1aFv/8iEQv/Tm2b/0ppl/9GZY//Wn2z/1pZc/9eldf/Bl2b/kUcA/4w9AP+OQAD/lUwA/59eAP+cWQD/jT8A/5ZOAP+eXADy////AP///wD///8A////ANKaZPLSmmT/0ppk/9KZY//KiEn/8d/P///////////////////////47+f/05tm/8iCP//KiEj/yohJ/8eCP//RmGH//vfy///////n1sP/rXQ7/4k4AP+TTAD/nVoA/5xYAP+cVwD/nFgA/5xYAPL///8A////AP///wD///8A0ppk8tKaZP/SmmT/0ptl/8uLTf/aq37////////////////////////////+/fz/6c2y/961jv/etY7/6Myx//78+v//////////////////////3MWv/5xXD/+ORAD/mFQA/51ZAP+cWAD/nFgA8v///wD///8A////AP///wDSmmTy0ppk/9KaZP/SmmT/0ppk/8mFRP/s1b//////////////////////////////////////////////////////////////////////////////+PD/0JFU/7NzMv+WUQD/kUsA/5tXAP+dWQDy////AP///wD///8A////ANKaZP/SmmT/0ppk/9KaZP/Sm2X/z5NZ/8yMT//z5NX/////////////////////////////////////////////////////////////////9Ofa/8yNUP/UmGH/36p5/8yTWv+qaSD/kksA/5ROAPz///8A////AP///wD///8A0ppk5NKaZP/SmmT/0ppk/9KaZP/TnGf/zY9T/82OUv/t1sD//////////////////////////////////////////////////////+7Yw//OkFX/zI5R/9OcZ//SmmP/26V0/9ymdf/BhUf/ol8R6P///wD///8A////AP///wDSmmQ80ppk9tKaZP/SmmT/0ppk/9KaZP/TnGj/zpFW/8qJSv/dson/8uHS//////////////////////////////////Lj0//etIv/y4lL/86QVf/TnGj/0ppk/9KaZP/RmWP/05xn/9ymdfjUnWdC////AP///wD///8A////ANKaZADSmmQc0ppkotKaZP/SmmT/0ppk/9KaZP/Tm2b/0Zli/8qJSf/NjlH/16Z3/+G8mP/myKr/5siq/+G8mP/Xp3f/zY5S/8qISf/RmGH/05tm/9KaZP/SmmT/0ppk/9KaZP/SmmSm0pljINWdaQD///8A////AP///wD///8A0ppkANKaZADSmmQA0ppkQtKaZMrSmmT/0ppk/9KaZP/SmmT/0ptl/9GYYf/Nj1P/y4lL/8qISP/KiEj/y4lK/82PU//RmGH/0ptl/9KaZP/SmmT/0ppk/9KaZP/SmmTO0ppkRtKaZADSmmQA0ppkAP///wD///8A////AP///wDSmmQA0ppkANKaZADSmmQA0ppkANKaZGzSmmTu0ppk/9KaZP/SmmT/0ppk/9KaZP/SmmT/0ppk/9KaZP/SmmT/0ppk/9KaZP/SmmT/0ppk/9KaZP/SmmTw0ppkcNKaZADSmmQA0ppkANKaZADSmmQA////AP///wD///8A////ANKaZADSmmQA0ppkANKaZADSmmQA0ppkANKaZBLSmmSQ0ppk/9KaZP/SmmT/0ppk/9KaZP/SmmT/0ppk/9KaZP/SmmT/0ppk/9KaZP/SmmT/0ppklNKaZBTSmmQA0ppkANKaZADSmmQA0ppkANKaZAD///8A////AP///wD///8A0ppkANKaZADSmmQA0ppkANKaZADSmmQA0ppkANKaZADSmmQy0ppkutKaZP/SmmT/0ppk/9KaZP/SmmT/0ppk/9KaZP/SmmT/0ppkvtKaZDbSmmQA0ppkANKaZADSmmQA0ppkANKaZADSmmQA0ppkAP///wD///8A////AP///wDSmmQA0ppkANKaZADSmmQA0ppkANKaZADSmmQA0ppkANKaZADSmmQA0ppkXNKaZODSmmT/0ppk/9KaZP/SmmT/0ppk5NKaZGDSmmQA0ppkANKaZADSmmQA0ppkANKaZADSmmQA0ppkANKaZADSmmQA////AP///wD///8A////ANKaZADSmmQA0ppkANKaZADSmmQA0ppkANKaZADSmmQA0ppkANKaZADSmmQA0ppkBtKaZIbSmmTo0ppk6tKaZIrSmmQK0ppkANKaZADSmmQA0ppkANKaZADSmmQA0ppkANKaZADSmmQA0ppkANKaZAD///8A////AP/8P///+B///+AH//+AAf//AAD//AAAP/AAAA/gAAAHwAAAA8AAAAPAAAADwAAAA8AAAAPAAAADwAAAA8AAAAPAAAADwAAAA8AAAAPAAAADwAAAA8AAAAPAAAADwAAAA+AAAAfwAAAP/AAAP/8AAP//gAH//+AH///4H////D//" rel="icon" />
  
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="wrapper">
<header id="title-block-header">
<h1 class="title" style="text-align:center">Quantities and units
library</h1>
<table style="border:none;float:right">
  <tr>
    <td>Document #:</td>
    <td>P3045R1</td>
  </tr>
  <tr>
    <td>Date:</td>
    <td>2024-03-21</td>
  </tr>
  <tr>
    <td style="vertical-align:top">Project:</td>
    <td>Programming Language C++</td>
  </tr>
  <tr>
    <td style="vertical-align:top">Audience:</td>
    <td>
      SG6 Numerics<br>
      SG16 Unicode<br>
      SG18 Library Evolution Working Group Incubator (LEWGI)<br>
    </td>
  </tr>
  <tr>
    <td style="vertical-align:top">Reply-to:</td>
    <td>
      Mateusz Pusz (<a href="http://www.epam.com">Epam
Systems</a>)<br>&lt;<a href="mailto:mateusz.pusz@gmail.com" class="email">mateusz.pusz@gmail.com</a>&gt;<br>
      Dominik Berner<br>&lt;<a href="mailto:dominik.berner@gmail.com" class="email">dominik.berner@gmail.com</a>&gt;<br>
      Johel Ernesto Guerrero Peña<br>&lt;<a href="mailto:johelegp@gmail.com" class="email">johelegp@gmail.com</a>&gt;<br>
      Chip Hogg (<a href="https://aurora.tech/">Aurora
Innovation</a>)<br>&lt;<a href="mailto:charles.r.hogg@gmail.com" class="email">charles.r.hogg@gmail.com</a>&gt;<br>
      Nicolas Holthaus<br>&lt;<a href="mailto:nholthaus@gmail.com" class="email">nholthaus@gmail.com</a>&gt;<br>
      Roth Michaels (<a href="https://www.native-instruments.com">Native
Instruments</a>)<br>&lt;<a href="mailto:isocxx@rothmichaels.us" class="email">isocxx@rothmichaels.us</a>&gt;<br>
      Vincent Reverdy<br>&lt;<a href="mailto:vince.rev@gmail.com" class="email">vince.rev@gmail.com</a>&gt;<br>
    </td>
  </tr>
</table>
</header>
<div style="clear:both">
<div id="TOC" role="doc-toc">
<h1 id="toctitle">Contents</h1>
<ul>
<li><a href="#revision-history" id="toc-revision-history"><span class="toc-section-number">1</span> Revision history<span></span></a>
<ul>
<li><a href="#changes-since-p3045r0" id="toc-changes-since-p3045r0"><span class="toc-section-number">1.1</span> Changes since <span class="citation" data-cites="P3045R0">[<span>P3045R0</span>]</span><span></span></a></li>
</ul></li>
<li><a href="#introduction" id="toc-introduction"><span class="toc-section-number">2</span> Introduction<span></span></a></li>
<li><a href="#terms-and-definitions" id="toc-terms-and-definitions"><span class="toc-section-number">3</span>
Terms and definitions<span></span></a></li>
<li><a href="#impact-on-the-c-standard" id="toc-impact-on-the-c-standard"><span class="toc-section-number">4</span> Impact on the C++
standard<span></span></a>
<ul>
<li><a href="#interaction-with-stdchrono-types-and-stdratio" id="toc-interaction-with-stdchrono-types-and-stdratio"><span class="toc-section-number">4.1</span> Interaction with
<code class="sourceCode default">std::chrono</code> types and
<code class="sourceCode default">std::ratio</code><span></span></a></li>
<li><a href="#dependencies-on-other-proposals" id="toc-dependencies-on-other-proposals"><span class="toc-section-number">4.2</span> Dependencies on other
proposals<span></span></a></li>
</ul></li>
<li><a href="#about-authors" id="toc-about-authors"><span class="toc-section-number">5</span> About authors<span></span></a>
<ul>
<li><a href="#dominik-berner" id="toc-dominik-berner"><span class="toc-section-number">5.1</span> Dominik
Berner<span></span></a></li>
<li><a href="#johel-ernesto-guerrero-peña" id="toc-johel-ernesto-guerrero-peña"><span class="toc-section-number">5.2</span> Johel Ernesto Guerrero
Peña<span></span></a></li>
<li><a href="#charles-hogg" id="toc-charles-hogg"><span class="toc-section-number">5.3</span> Charles Hogg<span></span></a></li>
<li><a href="#nicolas-holthaus" id="toc-nicolas-holthaus"><span class="toc-section-number">5.4</span> Nicolas
Holthaus<span></span></a></li>
<li><a href="#roth-michaels" id="toc-roth-michaels"><span class="toc-section-number">5.5</span> Roth
Michaels<span></span></a></li>
<li><a href="#mateusz-pusz" id="toc-mateusz-pusz"><span class="toc-section-number">5.6</span> Mateusz Pusz<span></span></a></li>
<li><a href="#vincent-reverdy" id="toc-vincent-reverdy"><span class="toc-section-number">5.7</span> Vincent
Reverdy<span></span></a></li>
</ul></li>
<li><a href="#motivation" id="toc-motivation"><span class="toc-section-number">6</span> Motivation<span></span></a>
<ul>
<li><a href="#safety" id="toc-safety"><span class="toc-section-number">6.1</span> Safety<span></span></a></li>
<li><a href="#vocabulary-types" id="toc-vocabulary-types"><span class="toc-section-number">6.2</span> Vocabulary
types<span></span></a></li>
<li><a href="#certification" id="toc-certification"><span class="toc-section-number">6.3</span>
Certification<span></span></a></li>
<li><a href="#complex-and-complicated" id="toc-complex-and-complicated"><span class="toc-section-number">6.4</span> Complex and
complicated<span></span></a></li>
<li><a href="#extensibility" id="toc-extensibility"><span class="toc-section-number">6.5</span>
Extensibility<span></span></a></li>
<li><a href="#broad-industry-value" id="toc-broad-industry-value"><span class="toc-section-number">6.6</span> Broad industry
value<span></span></a></li>
<li><a href="#standardizing-existing-practice" id="toc-standardizing-existing-practice"><span class="toc-section-number">6.7</span> Standardizing existing
practice<span></span></a></li>
</ul></li>
<li><a href="#common-smells-when-there-is-no-library-for-quantities-and-units" id="toc-common-smells-when-there-is-no-library-for-quantities-and-units"><span class="toc-section-number">7</span> Common smells when there is no
library for quantities and units<span></span></a>
<ul>
<li><a href="#the-proliferation-of-double" id="toc-the-proliferation-of-double"><span class="toc-section-number">7.1</span> The proliferation of
<code class="sourceCode default">double</code><span></span></a></li>
<li><a href="#the-proliferation-of-magic-numbers" id="toc-the-proliferation-of-magic-numbers"><span class="toc-section-number">7.2</span> The proliferation of magic
numbers<span></span></a></li>
<li><a href="#the-proliferation-of-conversion-macros" id="toc-the-proliferation-of-conversion-macros"><span class="toc-section-number">7.3</span> The proliferation of conversion
macros<span></span></a></li>
<li><a href="#lack-of-consistency" id="toc-lack-of-consistency"><span class="toc-section-number">7.4</span> Lack of
consistency<span></span></a></li>
<li><a href="#lack-of-a-conceptual-framework" id="toc-lack-of-a-conceptual-framework"><span class="toc-section-number">7.5</span> Lack of a conceptual
framework<span></span></a></li>
</ul></li>
<li><a href="#design-goals" id="toc-design-goals"><span class="toc-section-number">8</span> Design goals<span></span></a>
<ul>
<li><a href="#compile-time-safety" id="toc-compile-time-safety"><span class="toc-section-number">8.1</span> Compile-time
safety<span></span></a></li>
<li><a href="#performance" id="toc-performance"><span class="toc-section-number">8.2</span> Performance<span></span></a></li>
<li><a href="#great-user-experience" id="toc-great-user-experience"><span class="toc-section-number">8.3</span> Great user
experience<span></span></a></li>
<li><a href="#scope" id="toc-scope"><span class="toc-section-number">8.4</span> Scope<span></span></a></li>
<li><a href="#easy-to-extend" id="toc-easy-to-extend"><span class="toc-section-number">8.5</span> Easy to
extend<span></span></a></li>
<li><a href="#low-standardization-cost" id="toc-low-standardization-cost"><span class="toc-section-number">8.6</span> Low standardization
cost<span></span></a></li>
</ul></li>
<li><a href="#quick-domain-introduction" id="toc-quick-domain-introduction"><span class="toc-section-number">9</span> Quick domain
introduction<span></span></a>
<ul>
<li><a href="#dimension" id="toc-dimension"><span class="toc-section-number">9.1</span> Dimension<span></span></a></li>
<li><a href="#quantity-type" id="toc-quantity-type"><span class="toc-section-number">9.2</span> Quantity
type<span></span></a></li>
<li><a href="#quantity-reference" id="toc-quantity-reference"><span class="toc-section-number">9.3</span> Quantity
reference<span></span></a></li>
<li><a href="#quantity" id="toc-quantity"><span class="toc-section-number">9.4</span> Quantity<span></span></a></li>
</ul></li>
<li><a href="#api-overview" id="toc-api-overview"><span class="toc-section-number">10</span> API overview<span></span></a>
<ul>
<li><a href="#unit-based-quantities-simple-mode" id="toc-unit-based-quantities-simple-mode"><span class="toc-section-number">10.1</span> Unit-based quantities (simple
mode)<span></span></a>
<ul>
<li><a href="#constructing-a-quantity" id="toc-constructing-a-quantity"><span class="toc-section-number">10.1.1</span> Constructing a
quantity<span></span></a></li>
<li><a href="#typical-operations-on-quantities" id="toc-typical-operations-on-quantities"><span class="toc-section-number">10.1.2</span> Typical operations on
quantities<span></span></a>
<ul>
<li><a href="#unit-conversions" id="toc-unit-conversions"><span class="toc-section-number">10.1.2.1</span> Unit
conversions<span></span></a></li>
<li><a href="#obtaining-a-numerical-value-of-a-quantity" id="toc-obtaining-a-numerical-value-of-a-quantity"><span class="toc-section-number">10.1.2.2</span> Obtaining a numerical value
of a quantity<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="#typed-quantities-safer-mode" id="toc-typed-quantities-safer-mode"><span class="toc-section-number">10.2</span> Typed quantities (safer
mode)<span></span></a></li>
<li><a href="#generic-interfaces" id="toc-generic-interfaces"><span class="toc-section-number">10.3</span> Generic
interfaces<span></span></a>
<ul>
<li><a href="#the-issues-with-unit-specific-interfaces" id="toc-the-issues-with-unit-specific-interfaces"><span class="toc-section-number">10.3.1</span> The issues with unit-specific
interfaces<span></span></a></li>
<li><a href="#constraining-function-parameters-with-concepts" id="toc-constraining-function-parameters-with-concepts"><span class="toc-section-number">10.3.2</span> Constraining function
parameters with concepts<span></span></a></li>
<li><a href="#constraining-the-function-return-type" id="toc-constraining-the-function-return-type"><span class="toc-section-number">10.3.3</span> Constraining the function
return type<span></span></a></li>
<li><a href="#constraining-a-variable-on-the-stack" id="toc-constraining-a-variable-on-the-stack"><span class="toc-section-number">10.3.4</span> Constraining a variable on the
stack<span></span></a></li>
</ul></li>
<li><a href="#the-affine-space" id="toc-the-affine-space"><span class="toc-section-number">10.4</span> The affine space<span></span></a>
<ul>
<li><a href="#operations-in-the-affine-space" id="toc-operations-in-the-affine-space"><span class="toc-section-number">10.4.1</span> Operations in the affine
space<span></span></a></li>
<li><a href="#points-are-more-common-than-most-of-us-imagine" id="toc-points-are-more-common-than-most-of-us-imagine"><span class="toc-section-number">10.4.2</span> <em>Points</em> are more common
than most of us imagine<span></span></a></li>
<li><a href="#displacement-vector-is-modeled-by-quantity" id="toc-displacement-vector-is-modeled-by-quantity"><span class="toc-section-number">10.4.3</span> <em>Displacement vector</em> is
modeled by
<code class="sourceCode default">quantity</code><span></span></a></li>
<li><a href="#point-is-modeled-by-quantity_point-and-pointorigin" id="toc-point-is-modeled-by-quantity_point-and-pointorigin"><span class="toc-section-number">10.4.4</span> <em>Point</em> is modeled by
<code class="sourceCode default">quantity_point</code> and
<code class="sourceCode default">PointOrigin</code><span></span></a>
<ul>
<li><a href="#quantity_point" id="toc-quantity_point"><span class="toc-section-number">10.4.4.1</span>
<code class="sourceCode default">quantity_point</code><span></span></a></li>
<li><a href="#zeroth_point_originquantityspec" id="toc-zeroth_point_originquantityspec"><span class="toc-section-number">10.4.4.2</span> <code class="sourceCode default">zeroth_point_origin&lt;QuantitySpec&gt;</code><span></span></a></li>
<li><a href="#absolute-point-origin" id="toc-absolute-point-origin"><span class="toc-section-number">10.4.4.3</span> Absolute <em>point</em>
origin<span></span></a></li>
<li><a href="#relative-point-origin" id="toc-relative-point-origin"><span class="toc-section-number">10.4.4.4</span> Relative <em>point</em>
origin<span></span></a></li>
<li><a href="#converting-between-different-representations-of-the-same-point" id="toc-converting-between-different-representations-of-the-same-point"><span class="toc-section-number">10.4.4.5</span> Converting between different
representations of the same <em>point</em><span></span></a></li>
<li><a href="#temperature-support" id="toc-temperature-support"><span class="toc-section-number">10.4.4.6</span> Temperature
support<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="#user-defined-representation-types" id="toc-user-defined-representation-types"><span class="toc-section-number">10.5</span> User-defined representation
types<span></span></a></li>
<li><a href="#vector-and-tensor-quantities" id="toc-vector-and-tensor-quantities"><span class="toc-section-number">10.6</span> Vector and tensor
quantities<span></span></a></li>
<li><a href="#logarithmic-quantities-and-units" id="toc-logarithmic-quantities-and-units"><span class="toc-section-number">10.7</span> Logarithmic quantities and
units<span></span></a></li>
</ul></li>
<li><a href="#usage-examples" id="toc-usage-examples"><span class="toc-section-number">11</span> Usage examples<span></span></a>
<ul>
<li><a href="#basic-quantity-equations" id="toc-basic-quantity-equations"><span class="toc-section-number">11.1</span> Basic quantity
equations<span></span></a></li>
<li><a href="#hello-units" id="toc-hello-units"><span class="toc-section-number">11.2</span> Hello units<span></span></a></li>
<li><a href="#storage-tank" id="toc-storage-tank"><span class="toc-section-number">11.3</span> Storage
tank<span></span></a></li>
<li><a href="#bridge-across-the-rhine" id="toc-bridge-across-the-rhine"><span class="toc-section-number">11.4</span> Bridge across the
Rhine<span></span></a></li>
<li><a href="#user-defined-quantities-and-units" id="toc-user-defined-quantities-and-units"><span class="toc-section-number">11.5</span> User defined quantities and
units<span></span></a></li>
</ul></li>
<li><a href="#why-do-we-need-typed-quantities" id="toc-why-do-we-need-typed-quantities"><span class="toc-section-number">12</span> Why do we need typed
quantities?<span></span></a>
<ul>
<li><a href="#limitations-of-units-only-solutions" id="toc-limitations-of-units-only-solutions"><span class="toc-section-number">12.1</span> Limitations of units-only
solutions<span></span></a>
<ul>
<li><a href="#no-way-to-specify-a-quantity-type-in-generic-interfaces" id="toc-no-way-to-specify-a-quantity-type-in-generic-interfaces"><span class="toc-section-number">12.1.1</span> No way to specify a quantity
type in generic interfaces<span></span></a></li>
<li><a href="#disjoint-units-of-the-same-quantity-type-do-not-work" id="toc-disjoint-units-of-the-same-quantity-type-do-not-work"><span class="toc-section-number">12.1.2</span> Disjoint units of the same
quantity type do not work<span></span></a></li>
</ul></li>
<li><a href="#limitations-of-dimensions" id="toc-limitations-of-dimensions"><span class="toc-section-number">12.2</span> Limitations of
dimensions<span></span></a>
<ul>
<li><a href="#si-units-of-quantities-of-the-same-dimension-but-different-kinds" id="toc-si-units-of-quantities-of-the-same-dimension-but-different-kinds"><span class="toc-section-number">12.2.1</span> SI units of quantities of the
same dimension but different kinds<span></span></a></li>
<li><a href="#derived-quantities-of-the-same-dimension-but-different-kinds" id="toc-derived-quantities-of-the-same-dimension-but-different-kinds"><span class="toc-section-number">12.2.2</span> Derived quantities of the same
dimension but different kinds<span></span></a></li>
<li><a href="#various-quantities-of-the-same-dimension-and-kinds" id="toc-various-quantities-of-the-same-dimension-and-kinds"><span class="toc-section-number">12.2.3</span> Various quantities of the same
dimension and kinds<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="#systems-of-quantities-and-units" id="toc-systems-of-quantities-and-units"><span class="toc-section-number">13</span> Systems of quantities and
units<span></span></a>
<ul>
<li><a href="#systems-of-quantities" id="toc-systems-of-quantities"><span class="toc-section-number">13.1</span> Systems of
quantities<span></span></a>
<ul>
<li><a href="#quantities-of-the-same-kind" id="toc-quantities-of-the-same-kind"><span class="toc-section-number">13.1.1</span> Quantities of the same
kind<span></span></a></li>
<li><a href="#system-of-quantities-is-not-only-about-kinds" id="toc-system-of-quantities-is-not-only-about-kinds"><span class="toc-section-number">13.1.2</span> System of quantities is not
only about kinds<span></span></a></li>
<li><a href="#converting-between-quantities-of-the-same-kind" id="toc-converting-between-quantities-of-the-same-kind"><span class="toc-section-number">13.1.3</span> Converting between quantities
of the same kind<span></span></a></li>
<li><a href="#comparing-adding-and-subtracting-quantities-of-the-same-kind" id="toc-comparing-adding-and-subtracting-quantities-of-the-same-kind"><span class="toc-section-number">13.1.4</span> Comparing, adding, and
subtracting quantities of the same kind<span></span></a></li>
<li><a href="#hierarchies-of-derived-quantities" id="toc-hierarchies-of-derived-quantities"><span class="toc-section-number">13.1.5</span> Hierarchies of derived
quantities<span></span></a></li>
<li><a href="#modeling-a-quantity-kind" id="toc-modeling-a-quantity-kind"><span class="toc-section-number">13.1.6</span> Modeling a quantity
kind<span></span></a></li>
</ul></li>
<li><a href="#systems-of-units" id="toc-systems-of-units"><span class="toc-section-number">13.2</span> Systems of units<span></span></a>
<ul>
<li><a href="#systems-of-units-are-based-on-systems-of-quantities" id="toc-systems-of-units-are-based-on-systems-of-quantities"><span class="toc-section-number">13.2.1</span> Systems of units are based on
systems of quantities<span></span></a></li>
<li><a href="#units-compose" id="toc-units-compose"><span class="toc-section-number">13.2.2</span> Units
compose<span></span></a></li>
<li><a href="#many-shades-of-the-same-unit" id="toc-many-shades-of-the-same-unit"><span class="toc-section-number">13.2.3</span> Many shades of the same
unit<span></span></a></li>
<li><a href="#constraining-a-derived-unit-to-work-only-with-a-specific-derived-quantity" id="toc-constraining-a-derived-unit-to-work-only-with-a-specific-derived-quantity"><span class="toc-section-number">13.2.4</span> Constraining a derived unit to
work only with a specific derived quantity<span></span></a></li>
<li><a href="#prefixed-units" id="toc-prefixed-units"><span class="toc-section-number">13.2.5</span> Prefixed
units<span></span></a></li>
<li><a href="#scaled-units" id="toc-scaled-units"><span class="toc-section-number">13.2.6</span> Scaled
units<span></span></a></li>
<li><a href="#unit-symbols" id="toc-unit-symbols"><span class="toc-section-number">13.2.7</span> Unit
symbols<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="#safety-1" id="toc-safety-1"><span class="toc-section-number">14</span> Safety<span></span></a>
<ul>
<li><a href="#safety-features" id="toc-safety-features"><span class="toc-section-number">14.1</span> Safety features<span></span></a>
<ul>
<li><a href="#safe-unit-conversions" id="toc-safe-unit-conversions"><span class="toc-section-number">14.1.1</span> Safe unit
conversions<span></span></a></li>
<li><a href="#preventing-truncation-of-data" id="toc-preventing-truncation-of-data"><span class="toc-section-number">14.1.2</span> Preventing truncation of
data<span></span></a></li>
<li><a href="#safety-introduced-by-the-affine-space-abstractions" id="toc-safety-introduced-by-the-affine-space-abstractions"><span class="toc-section-number">14.1.3</span> Safety introduced by the affine
space abstractions<span></span></a></li>
<li><a href="#explicit-is-not-explicit-enough" id="toc-explicit-is-not-explicit-enough"><span class="toc-section-number">14.1.4</span>
<code class="sourceCode default">explicit</code> is not explicit
enough<span></span></a></li>
<li><a href="#safe-quantity-numerical-value-getters" id="toc-safe-quantity-numerical-value-getters"><span class="toc-section-number">14.1.5</span> Safe quantity numerical value
getters<span></span></a></li>
<li><a href="#preventing-dangling-references" id="toc-preventing-dangling-references"><span class="toc-section-number">14.1.6</span> Preventing dangling
references<span></span></a></li>
<li><a href="#quantity-kinds-improve-safety" id="toc-quantity-kinds-improve-safety"><span class="toc-section-number">14.1.7</span> Quantity kinds improve
safety<span></span></a></li>
<li><a href="#additional-safety-introduced-by-modeling-various-quantities-of-the-same-kind" id="toc-additional-safety-introduced-by-modeling-various-quantities-of-the-same-kind"><span class="toc-section-number">14.1.8</span> Additional safety introduced by
modeling various quantities of the same kind<span></span></a></li>
<li><a href="#non-negative-quantities" id="toc-non-negative-quantities"><span class="toc-section-number">14.1.9</span> Non-negative
quantities<span></span></a></li>
<li><a href="#safe-operations-of-vector-and-tensor-quantities" id="toc-safe-operations-of-vector-and-tensor-quantities"><span class="toc-section-number">14.1.10</span> Safe operations of vector and
tensor quantities<span></span></a></li>
</ul></li>
<li><a href="#safety-pitfalls" id="toc-safety-pitfalls"><span class="toc-section-number">14.2</span> Safety pitfalls<span></span></a>
<ul>
<li><a href="#integer-division" id="toc-integer-division"><span class="toc-section-number">14.2.1</span> Integer
division<span></span></a></li>
<li><a href="#lack-of-safe-numeric-types" id="toc-lack-of-safe-numeric-types"><span class="toc-section-number">14.2.2</span> Lack of safe numeric
types<span></span></a></li>
<li><a href="#potential-surprises-during-units-composition" id="toc-potential-surprises-during-units-composition"><span class="toc-section-number">14.2.3</span> Potential surprises during
units composition<span></span></a></li>
<li><a href="#limitations-of-systems-of-quantities" id="toc-limitations-of-systems-of-quantities"><span class="toc-section-number">14.2.4</span> Limitations of systems of
quantities<span></span></a>
<ul>
<li><a href="#allowing-irrational-quantity-combinations" id="toc-allowing-irrational-quantity-combinations"><span class="toc-section-number">14.2.4.1</span> Allowing irrational quantity
combinations<span></span></a></li>
<li><a href="#arithmetic-and-compatibility-of-quantities-of-dimension-one" id="toc-arithmetic-and-compatibility-of-quantities-of-dimension-one"><span class="toc-section-number">14.2.4.2</span> Arithmetic and compatibility
of quantities of dimension one<span></span></a></li>
</ul></li>
<li><a href="#potential-surprises-while-working-with-temperatures" id="toc-potential-surprises-while-working-with-temperatures"><span class="toc-section-number">14.2.5</span> Potential surprises while
working with temperatures<span></span></a></li>
<li><a href="#structural-types" id="toc-structural-types"><span class="toc-section-number">14.2.6</span> Structural
types<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="#text-output" id="toc-text-output"><span class="toc-section-number">15</span> Text output<span></span></a>
<ul>
<li><a href="#symbols" id="toc-symbols"><span class="toc-section-number">15.1</span> Symbols<span></span></a>
<ul>
<li><a href="#symbol-definition-examples" id="toc-symbol-definition-examples"><span class="toc-section-number">15.1.1</span> Symbol definition
examples<span></span></a></li>
<li><a href="#lack-of-unicode-subscript-characters" id="toc-lack-of-unicode-subscript-characters"><span class="toc-section-number">15.1.2</span> Lack of Unicode subscript
characters<span></span></a></li>
<li><a href="#symbols-for-quantity-types" id="toc-symbols-for-quantity-types"><span class="toc-section-number">15.1.3</span> Symbols for quantity
types<span></span></a></li>
<li><a href="#fixed_string" id="toc-fixed_string"><span class="toc-section-number">15.1.4</span>
<code class="sourceCode default">fixed_string</code><span></span></a></li>
<li><a href="#symbol_text" id="toc-symbol_text"><span class="toc-section-number">15.1.5</span>
<code class="sourceCode default">symbol_text</code><span></span></a></li>
<li><a href="#derived-dimensions-symbols-generation" id="toc-derived-dimensions-symbols-generation"><span class="toc-section-number">15.1.6</span> Derived dimensions symbols
generation<span></span></a></li>
<li><a href="#derived-unit-symbols-generation" id="toc-derived-unit-symbols-generation"><span class="toc-section-number">15.1.7</span> Derived unit symbols
generation<span></span></a>
<ul>
<li><a href="#unit_symbol_formatting" id="toc-unit_symbol_formatting"><span class="toc-section-number">15.1.7.1</span>
<code class="sourceCode default">unit_symbol_formatting</code><span></span></a></li>
<li><a href="#unit_symbol" id="toc-unit_symbol"><span class="toc-section-number">15.1.7.2</span>
<code class="sourceCode default">unit_symbol()</code><span></span></a></li>
<li><a href="#unit_symbol_to" id="toc-unit_symbol_to"><span class="toc-section-number">15.1.7.3</span>
<code class="sourceCode default">unit_symbol_to()</code><span></span></a></li>
</ul></li>
</ul></li>
<li><a href="#space_before_unit_symbol-customization-point" id="toc-space_before_unit_symbol-customization-point"><span class="toc-section-number">15.2</span>
<code class="sourceCode default">space_before_unit_symbol</code>
customization point<span></span></a></li>
<li><a href="#output-streams" id="toc-output-streams"><span class="toc-section-number">15.3</span> Output streams<span></span></a>
<ul>
<li><a href="#output-stream-formatting" id="toc-output-stream-formatting"><span class="toc-section-number">15.3.1</span> Output stream
formatting<span></span></a></li>
</ul></li>
<li><a href="#text-formatting" id="toc-text-formatting"><span class="toc-section-number">15.4</span> Text formatting<span></span></a>
<ul>
<li><a href="#controlling-width-fill-and-alignment" id="toc-controlling-width-fill-and-alignment"><span class="toc-section-number">15.4.1</span> Controlling width, fill, and
alignment<span></span></a></li>
<li><a href="#dimension-formatting" id="toc-dimension-formatting"><span class="toc-section-number">15.4.2</span> Dimension
formatting<span></span></a></li>
<li><a href="#unit-formatting" id="toc-unit-formatting"><span class="toc-section-number">15.4.3</span> Unit
formatting<span></span></a></li>
<li><a href="#quantity-formatting" id="toc-quantity-formatting"><span class="toc-section-number">15.4.4</span> Quantity
formatting<span></span></a>
<ul>
<li><a href="#default-formatting" id="toc-default-formatting"><span class="toc-section-number">15.4.4.1</span> Default
formatting<span></span></a></li>
<li><a href="#quantity-numerical-value-unit-symbol-or-both" id="toc-quantity-numerical-value-unit-symbol-or-both"><span class="toc-section-number">15.4.4.2</span> Quantity numerical value,
unit symbol, or both?<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="#quantity-point-text-output" id="toc-quantity-point-text-output"><span class="toc-section-number">15.5</span> Quantity point text
output<span></span></a></li>
<li><a href="#text-output-open-questions" id="toc-text-output-open-questions"><span class="toc-section-number">15.6</span> Text output open
questions<span></span></a></li>
</ul></li>
<li><a href="#design-details-and-rationale" id="toc-design-details-and-rationale"><span class="toc-section-number">16</span> Design details and
rationale<span></span></a>
<ul>
<li><a href="#conventions" id="toc-conventions"><span class="toc-section-number">16.1</span> Conventions<span></span></a>
<ul>
<li><a href="#new-style-of-definitions" id="toc-new-style-of-definitions"><span class="toc-section-number">16.1.1</span> New style of
definitions<span></span></a></li>
<li><a href="#strong-types-instead-of-aliases" id="toc-strong-types-instead-of-aliases"><span class="toc-section-number">16.1.2</span> Strong types instead of
aliases<span></span></a></li>
<li><a href="#entities-composability" id="toc-entities-composability"><span class="toc-section-number">16.1.3</span> Entities
composability<span></span></a></li>
<li><a href="#value-based-equations" id="toc-value-based-equations"><span class="toc-section-number">16.1.4</span> Value-based
equations<span></span></a></li>
</ul></li>
<li><a href="#framework-entities" id="toc-framework-entities"><span class="toc-section-number">16.2</span> Framework
entities<span></span></a>
<ul>
<li><a href="#quantity-character" id="toc-quantity-character"><span class="toc-section-number">16.2.1</span> Quantity
character<span></span></a></li>
<li><a href="#quantity-specification" id="toc-quantity-specification"><span class="toc-section-number">16.2.2</span> Quantity
specification<span></span></a></li>
<li><a href="#unit" id="toc-unit"><span class="toc-section-number">16.2.3</span> Unit<span></span></a></li>
<li><a href="#quantity-representation" id="toc-quantity-representation"><span class="toc-section-number">16.2.4</span> Quantity
representation<span></span></a></li>
<li><a href="#point-origin" id="toc-point-origin"><span class="toc-section-number">16.2.5</span> Point
origin<span></span></a></li>
<li><a href="#quantity-point" id="toc-quantity-point"><span class="toc-section-number">16.2.6</span> Quantity
point<span></span></a></li>
</ul></li>
<li><a href="#concepts" id="toc-concepts"><span class="toc-section-number">16.3</span> Concepts<span></span></a>
<ul>
<li><a href="#Dimension-concept" id="toc-Dimension-concept"><span class="toc-section-number">16.3.1</span>
<code class="sourceCode default">Dimension&lt;T&gt; concept</code><span></span></a>
<ul>
<li><a href="#DimensionOf-concept" id="toc-DimensionOf-concept"><span class="toc-section-number">16.3.1.1</span>
<code class="sourceCode default">DimensionOf&lt;T, V&gt;</code>
concept<span></span></a></li>
</ul></li>
<li><a href="#QuantitySpec-concept" id="toc-QuantitySpec-concept"><span class="toc-section-number">16.3.2</span>
<code class="sourceCode default">QuantitySpec&lt;T&gt; concept</code><span></span></a>
<ul>
<li><a href="#QuantitySpecOf-concept" id="toc-QuantitySpecOf-concept"><span class="toc-section-number">16.3.2.1</span>
<code class="sourceCode default">QuantitySpecOf&lt;T, V&gt;</code>
concept<span></span></a></li>
</ul></li>
<li><a href="#Unit-concept" id="toc-Unit-concept"><span class="toc-section-number">16.3.3</span>
<code class="sourceCode default">Unit&lt;T&gt;</code>
concept<span></span></a>
<ul>
<li><a href="#AssociatedUnit-concept" id="toc-AssociatedUnit-concept"><span class="toc-section-number">16.3.3.1</span>
<code class="sourceCode default">AssociatedUnit&lt;T&gt;</code>
concept<span></span></a></li>
<li><a href="#PrefixableUnit-concept" id="toc-PrefixableUnit-concept"><span class="toc-section-number">16.3.3.2</span>
<code class="sourceCode default">PrefixableUnit&lt;T&gt;</code>
concept<span></span></a></li>
<li><a href="#UnitOf-concept" id="toc-UnitOf-concept"><span class="toc-section-number">16.3.3.3</span>
<code class="sourceCode default">UnitOf&lt;T, V&gt;</code>
concept<span></span></a></li>
<li><a href="#UnitCompatibleWith-concept" id="toc-UnitCompatibleWith-concept"><span class="toc-section-number">16.3.3.4</span> <code class="sourceCode default">UnitCompatibleWith&lt;T, V1, V2&gt;</code>
concept<span></span></a></li>
</ul></li>
<li><a href="#Reference-concept" id="toc-Reference-concept"><span class="toc-section-number">16.3.4</span>
<code class="sourceCode default">Reference&lt;T&gt;</code>
concept<span></span></a>
<ul>
<li><a href="#ReferenceOf-concept" id="toc-ReferenceOf-concept"><span class="toc-section-number">16.3.4.1</span>
<code class="sourceCode default">ReferenceOf&lt;T, V&gt;</code>
concept<span></span></a></li>
</ul></li>
<li><a href="#Representation-concept" id="toc-Representation-concept"><span class="toc-section-number">16.3.5</span>
<code class="sourceCode default">Representation&lt;T&gt;</code>
concept<span></span></a>
<ul>
<li><a href="#RepresentationOf-concept" id="toc-RepresentationOf-concept"><span class="toc-section-number">16.3.5.1</span>
<code class="sourceCode default">RepresentationOf&lt;T, Ch&gt;</code>
concept<span></span></a></li>
</ul></li>
<li><a href="#Quantity-concept" id="toc-Quantity-concept"><span class="toc-section-number">16.3.6</span>
<code class="sourceCode default">Quantity&lt;T&gt;</code>
concept<span></span></a>
<ul>
<li><a href="#QuantityOf-concept" id="toc-QuantityOf-concept"><span class="toc-section-number">16.3.6.1</span>
<code class="sourceCode default">QuantityOf&lt;T, V&gt;</code>
concept<span></span></a></li>
</ul></li>
<li><a href="#PointOrigin-concept" id="toc-PointOrigin-concept"><span class="toc-section-number">16.3.7</span>
<code class="sourceCode default">PointOrigin&lt;T&gt;</code>
concept<span></span></a>
<ul>
<li><a href="#PointOriginFor-concept" id="toc-PointOriginFor-concept"><span class="toc-section-number">16.3.7.1</span>
<code class="sourceCode default">PointOriginFor&lt;T, V&gt;</code>
concept<span></span></a></li>
</ul></li>
<li><a href="#QuantityPoint-concept" id="toc-QuantityPoint-concept"><span class="toc-section-number">16.3.8</span>
<code class="sourceCode default">QuantityPoint&lt;T&gt;</code>
concept<span></span></a>
<ul>
<li><a href="#QuantityPointOf-concept" id="toc-QuantityPointOf-concept"><span class="toc-section-number">16.3.8.1</span>
<code class="sourceCode default">QuantityPointOf&lt;T, V&gt;</code>
concept<span></span></a></li>
</ul></li>
<li><a href="#QuantityLike-concept" id="toc-QuantityLike-concept"><span class="toc-section-number">16.3.9</span>
<code class="sourceCode default">QuantityLike&lt;T&gt;</code>
concept<span></span></a></li>
<li><a href="#QuantityPointLike-concept" id="toc-QuantityPointLike-concept"><span class="toc-section-number">16.3.10</span>
<code class="sourceCode default">QuantityPointLike&lt;T&gt;</code>
concept<span></span></a></li>
</ul></li>
<li><a href="#operations-on-units-dimensions-and-quantity-types" id="toc-operations-on-units-dimensions-and-quantity-types"><span class="toc-section-number">16.4</span> Operations on units, dimensions,
and quantity types<span></span></a></li>
<li><a href="#expression-templates" id="toc-expression-templates"><span class="toc-section-number">16.5</span> Expression
templates<span></span></a>
<ul>
<li><a href="#derived-entities" id="toc-derived-entities"><span class="toc-section-number">16.5.1</span> Derived
entities<span></span></a></li>
<li><a href="#identities" id="toc-identities"><span class="toc-section-number">16.5.2</span>
Identities<span></span></a></li>
<li><a href="#supported-operations-and-their-results" id="toc-supported-operations-and-their-results"><span class="toc-section-number">16.5.3</span> Supported operations and their
results<span></span></a></li>
<li><a href="#simplifying-the-resulting-expression-templates" id="toc-simplifying-the-resulting-expression-templates"><span class="toc-section-number">16.5.4</span> Simplifying the resulting
expression templates<span></span></a></li>
<li><a href="#expression-templates-in-action" id="toc-expression-templates-in-action"><span class="toc-section-number">16.5.5</span> Expression templates in
action<span></span></a></li>
</ul></li>
<li><a href="#physical-constants" id="toc-physical-constants"><span class="toc-section-number">16.6</span> Physical
constants<span></span></a>
<ul>
<li><a href="#simplifying-constants-in-an-equation" id="toc-simplifying-constants-in-an-equation"><span class="toc-section-number">16.6.1</span> Simplifying constants in an
equation<span></span></a></li>
<li><a href="#physical-constants-as-units" id="toc-physical-constants-as-units"><span class="toc-section-number">16.6.2</span> Physical constants as
units<span></span></a></li>
<li><a href="#physical-constants-usage-examples" id="toc-physical-constants-usage-examples"><span class="toc-section-number">16.6.3</span> Physical constants usage
examples<span></span></a></li>
</ul></li>
<li><a href="#quantity-references" id="toc-quantity-references"><span class="toc-section-number">16.7</span> Quantity
references<span></span></a></li>
<li><a href="#quantities" id="toc-quantities"><span class="toc-section-number">16.8</span> Quantities<span></span></a>
<ul>
<li><a href="#why-dont-we-use-udls-to-create-quantities" id="toc-why-dont-we-use-udls-to-create-quantities"><span class="toc-section-number">16.8.1</span> Why don’t we use UDLs to create
quantities?<span></span></a></li>
<li><a href="#quantity-arithmetics" id="toc-quantity-arithmetics"><span class="toc-section-number">16.8.2</span> Quantity
arithmetics<span></span></a>
<ul>
<li><a href="#quantity-is-a-numeric-wrapper" id="toc-quantity-is-a-numeric-wrapper"><span class="toc-section-number">16.8.2.1</span>
<code class="sourceCode default">quantity</code> is a numeric
wrapper<span></span></a></li>
<li><a href="#addition-and-subtraction" id="toc-addition-and-subtraction"><span class="toc-section-number">16.8.2.2</span> Addition and
subtraction<span></span></a></li>
<li><a href="#multiplication-and-division" id="toc-multiplication-and-division"><span class="toc-section-number">16.8.2.3</span> Multiplication and
division<span></span></a></li>
<li><a href="#modulo" id="toc-modulo"><span class="toc-section-number">16.8.2.4</span> Modulo<span></span></a></li>
<li><a href="#comparison-against-zero" id="toc-comparison-against-zero"><span class="toc-section-number">16.8.2.5</span> Comparison against
zero<span></span></a></li>
<li><a href="#other-maths" id="toc-other-maths"><span class="toc-section-number">16.8.2.6</span> Other
maths<span></span></a></li>
</ul></li>
<li><a href="#dimensionless-quantities" id="toc-dimensionless-quantities"><span class="toc-section-number">16.8.3</span> Dimensionless
quantities<span></span></a>
<ul>
<li><a href="#dividing-two-quantities-of-the-same-kind" id="toc-dividing-two-quantities-of-the-same-kind"><span class="toc-section-number">16.8.3.1</span> Dividing two quantities of
the same kind<span></span></a></li>
<li><a href="#counts-of-things" id="toc-counts-of-things"><span class="toc-section-number">16.8.3.2</span> Counts of
things<span></span></a></li>
<li><a href="#lack-of-convertibility-from-fundamental-types" id="toc-lack-of-convertibility-from-fundamental-types"><span class="toc-section-number">16.8.3.3</span> Lack of convertibility from
fundamental types<span></span></a></li>
<li><a href="#predefined-units-of-the-dimensionless-quantity" id="toc-predefined-units-of-the-dimensionless-quantity"><span class="toc-section-number">16.8.3.4</span> Predefined units of the
dimensionless quantity<span></span></a></li>
<li><a href="#angular-quantities" id="toc-angular-quantities"><span class="toc-section-number">16.8.3.5</span> Angular
quantities<span></span></a></li>
<li><a href="#nested-quantity-kinds" id="toc-nested-quantity-kinds"><span class="toc-section-number">16.8.3.6</span> Nested quantity
kinds<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="#interoperability-with-other-libraries" id="toc-interoperability-with-other-libraries"><span class="toc-section-number">16.9</span> Interoperability with other
libraries<span></span></a>
<ul>
<li><a href="#specifying-a-conversion-kind" id="toc-specifying-a-conversion-kind"><span class="toc-section-number">16.9.1</span> Specifying a conversion
kind<span></span></a></li>
<li><a href="#quantities-conversions" id="toc-quantities-conversions"><span class="toc-section-number">16.9.2</span> Quantities
conversions<span></span></a></li>
<li><a href="#quantity-points-conversions" id="toc-quantity-points-conversions"><span class="toc-section-number">16.9.3</span> Quantity points
conversions<span></span></a></li>
<li><a href="#interoperability-with-the-stdchrono-abstractions" id="toc-interoperability-with-the-stdchrono-abstractions"><span class="toc-section-number">16.9.4</span> Interoperability with the
<code class="sourceCode default">std::chrono</code>
abstractions<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="#teachability" id="toc-teachability"><span class="toc-section-number">17</span> Teachability<span></span></a></li>
<li><a href="#acknowledgements" id="toc-acknowledgements"><span class="toc-section-number">18</span>
Acknowledgements<span></span></a></li>
<li><a href="#bibliography" id="toc-bibliography"><span class="toc-section-number">19</span> References<span></span></a></li>
</ul>
</div>
<h1 data-number="1" id="revision-history"><span class="header-section-number">1</span> Revision history<a href="#revision-history" class="self-link"></a></h1>
<h2 data-number="1.1" id="changes-since-p3045r0"><span class="header-section-number">1.1</span> Changes since <span class="citation" data-cites="P3045R0">[<a href="#ref-P3045R0" role="doc-biblioref">P3045R0</a>]</span><a href="#changes-since-p3045r0" class="self-link"></a></h2>
<ul>
<li><a href="#the-affine-space">The affine space</a> chapter rewritten
nearly from scratch.</li>
<li>One more dependency added to the table in the <a href="#dependencies-on-other-proposals">Dependencies on other
proposals</a> chapter.</li>
<li><code class="sourceCode default">basic_symbol_text</code> renamed to
<code class="sourceCode default">symbol_text</code>.</li>
<li><code class="sourceCode default">symbol_text</code> now always
stores <code class="sourceCode default">char8_t</code> and
<code class="sourceCode default">char</code> versions of symbols.</li>
<li>In case UTF-8 symbol is used, now it has to be provided as an UTF-8
(<code class="sourceCode default">u8</code>) literal.</li>
<li>Minor editorial changes and additional clarifications added to the
<a href="#text-output">Text output</a> chapter.</li>
</ul>
<h1 data-number="2" id="introduction"><span class="header-section-number">2</span> Introduction<a href="#introduction" class="self-link"></a></h1>
<p>Several groups in the ISO C++ Committee reviewed the “P1935: A C++
Approach to Physical Units” <span class="citation" data-cites="P1935R2">[<a href="#ref-P1935R2" role="doc-biblioref">P1935R2</a>]</span> proposal in Belfast 2019 and
Prague 2020. All those groups expressed interest in the potential
standardization of such a library and encouraged further work. The
authors also got valuable initial feedback that highly influenced the
design of the V2 version of the <span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span> library.</p>
<p>In the following years, the library’s authors focused on getting more
feedback from the production about the design and developed version 2 of
the <span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span> library
that resolves the issues raised by the users and Committee members. The
features and interfaces of this version are close to being the best we
can get with the current version of the C++ language standard.</p>
<p>This paper is authored by the <span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span> library developers, the
authors of other actively maintained similar libraries on the market,
and other active members of the C++ physical quantities and units
community who have worked on this subject for many years. We join our
forces to say with one voice that we deeply care about standardizing
such features as a part of the C++ Standard Library. Based on our long
and broad experience in the subject, we agree that the interfaces we
will provide in the upcoming proposals are the best we can get today in
the C++ language.</p>
<p>During the Kona 2023 ISO C++ Committee meeting, we got repeating
feedback that there should be one big, unified paper with all the
contents inside. Addressing this requirement, this paper adds a detailed
design description and also includes the most important parts of <span class="citation" data-cites="P2980R1">[<a href="#ref-P2980R1" role="doc-biblioref">P2980R1</a>]</span>, <span class="citation" data-cites="P2981R1">[<a href="#ref-P2981R1" role="doc-biblioref">P2981R1</a>]</span>, and <span class="citation" data-cites="P2982R1">[<a href="#ref-P2982R1" role="doc-biblioref">P2982R1</a>]</span>. With this, we assume that
<span class="citation" data-cites="P2981R1">[<a href="#ref-P2981R1" role="doc-biblioref">P2981R1</a>]</span> and <span class="citation" data-cites="P2982R1">[<a href="#ref-P2982R1" role="doc-biblioref">P2982R1</a>]</span> are superseded by this paper.
The plan and scope described in <span class="citation" data-cites="P2980R1">[<a href="#ref-P2980R1" role="doc-biblioref">P2980R1</a>]</span> might still be updated based on
the current progress and feedback from the upcoming discussions.</p>
<!-- TODO remove this note in the future -->
<p><em>Note: This paper is incomplete and many chapters are still
missing. It is published to gather early feedback and possibly get
acceptance for the major design decisions of the library. More details
will arrive in the next revisions of this paper.</em></p>
<h1 data-number="3" id="terms-and-definitions"><span class="header-section-number">3</span> Terms and definitions<a href="#terms-and-definitions" class="self-link"></a></h1>
<p>This document consistently uses the official metrology vocabulary
defined in the <span class="citation" data-cites="ISO-GUIDE">[<a href="#ref-ISO-GUIDE" role="doc-biblioref">ISO/IEC Guide 99</a>]</span>
and <span class="citation" data-cites="BIPM-VIM">[<a href="#ref-BIPM-VIM" role="doc-biblioref">JCGM 200:2012</a>]</span>.</p>
<h1 data-number="4" id="impact-on-the-c-standard"><span class="header-section-number">4</span> Impact on the C++ standard<a href="#impact-on-the-c-standard" class="self-link"></a></h1>
<p>This change is purely additive. It does not change, fix, or break any
of the existing tools in the C++ standard library.</p>
<h2 data-number="4.1" id="interaction-with-stdchrono-types-and-stdratio"><span class="header-section-number">4.1</span> Interaction with
<code class="sourceCode default">std::chrono</code> types and
<code class="sourceCode default">std::ratio</code><a href="#interaction-with-stdchrono-types-and-stdratio" class="self-link"></a></h2>
<p>The only interaction of this proposal with the C++ standard
facilities is the compatibility mode with
<code class="sourceCode default">std::chrono</code> types
(<code class="sourceCode default">duration</code> and
<code class="sourceCode default">time_point</code>) described in <a href="#interoperability-with-the-stdchrono-abstractions">Interoperability
with the <code class="sourceCode default">std::chrono</code>
abstractions</a>.</p>
<p>We should also mention the potential confusion of users with having
two different ways to deal with time abstractions in the C++ standard
library. If this proposal gets accepted:</p>
<ul>
<li><code class="sourceCode default">std::chrono</code> abstractions
together with <code class="sourceCode default">std::ratio</code> should
be used primarily to deal with calendars and threading facilities,</li>
<li>abstractions introduced in this proposal should be used in all other
use cases (e.g. physical quantities equations).</li>
</ul>
<h2 data-number="4.2" id="dependencies-on-other-proposals"><span class="header-section-number">4.2</span> Dependencies on other
proposals<a href="#dependencies-on-other-proposals" class="self-link"></a></h2>
<p>The features in this chapter are heavily used in the library but are
not domain-specific. Having them standardized (instead of left as
exposition-only) could not only improve this library’s specification,
but also serve as an essential building block for tools in other domains
that we can get in the future from other authors.</p>
<!-- markdownlint-disable MD013 -->
<table>
<colgroup>
<col style="width: 17%" />
<col style="width: 5%" />
<col style="width: 13%" />
<col style="width: 62%" />
</colgroup>
<thead>
<tr class="header">
<th><div style="text-align:center">
<strong>Feature</strong>
</div></th>
<th style="text-align: center;"><div style="text-align:center">
<strong>Priority</strong>
</div></th>
<th style="text-align: center;"><div style="text-align:center">
<strong>Papers</strong>
</div></th>
<th><div style="text-align:center">
<strong>Description</strong>
</div></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code class="sourceCode default">fixed_string</code></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="citation" data-cites="P3094R0">[<a href="#ref-P3094R0" role="doc-biblioref">P3094R0</a>]</span></td>
<td>String-like structural type with inline storage (can be used as an
NTTP).</td>
</tr>
<tr class="even">
<td>Nested entities formatting</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">???</td>
<td>Possibility to override the format string in the parse and format
contexts.</td>
</tr>
<tr class="odd">
<td>Compile-time prime numbers</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span class="citation" data-cites="P3133R0">[<a href="#ref-P3133R0" role="doc-biblioref">P3133R0</a>]</span></td>
<td>Compile-time facilities to break any integral value to a product of
prime numbers and their powers.</td>
</tr>
<tr class="even">
<td>Value-preserving conversions</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span class="citation" data-cites="P0870R5">[<a href="#ref-P0870R5" role="doc-biblioref">P0870R5</a>]</span>, <span class="citation" data-cites="P2509R0">[<a href="#ref-P2509R0" role="doc-biblioref">P2509R0</a>]</span></td>
<td>Type trait stating if the conversion from one type to another is
value preserving or not.</td>
</tr>
<tr class="odd">
<td>Number concepts</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span class="citation" data-cites="P3003R0">[<a href="#ref-P3003R0" role="doc-biblioref">P3003R0</a>]</span></td>
<td>Concepts for vector- and point-space numbers.</td>
</tr>
<tr class="even">
<td>Bounded numeric types</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;"><span class="citation" data-cites="P2993_PRE">[<a href="#ref-P2993_PRE" role="doc-biblioref">P2993</a>]</span></td>
<td>Numerical type wrappers with values bounded to a provided interval
(optionally with wraparound semantics).</td>
</tr>
</tbody>
</table>
<!-- markdownlint-enable MD013 -->
<p>Priorities used above:</p>
<ol type="1">
<li>Mandatory to implement the library or exposed in its public
interfaces.</li>
<li>Functional extension/improvement to the framework design but worse
alternatives are currently available.</li>
<li>Not needed for the library’s implementation but improves its use
cases.</li>
</ol>
<h1 data-number="5" id="about-authors"><span class="header-section-number">5</span> About authors<a href="#about-authors" class="self-link"></a></h1>
<h2 data-number="5.1" id="dominik-berner"><span class="header-section-number">5.1</span> Dominik Berner<a href="#dominik-berner" class="self-link"></a></h2>
<p>Dominik is a strong believer that the C++ language can provide very
high safety guarantees when programming through strong typing; a type
error caught during compilation saves hours of debugging. For the last
15 years, he has mainly coded in C++ and actively follows its evolution
through the new standards.</p>
<p>When working on regulated projects at Med-Tech, there usually were
very tight requirements on which data types were to be used for what,
which turned out to be lists of primitives to be memorized by each
developer. However, throughout his career, Dominik spent way too many
hours debugging and fixing issues caused by these types being incorrect.
In an attempt to bring a closer semantic meaning to these lists, he
eventually wrote <span class="citation" data-cites="SI_LIB">[<a href="#ref-SI_LIB" role="doc-biblioref">SI library</a>]</span> as a side
project.</p>
<p>While <span class="citation" data-cites="SI_LIB">[<a href="#ref-SI_LIB" role="doc-biblioref">SI library</a>]</span> provides
many useful features, such as type-safe conversion between physical
quantities as well as zero-overhead computation for values of the same
units, there are some shortcomings which would require major rework.
Instead of creating yet another library, Dominik decided to join forces
with the other authors of this paper to push for standardizing support
for more type-safety for physical quantities. He hopes that this will
eventually lead to a safer and more robust C++ and open many more
opportunities for the language.</p>
<h2 data-number="5.2" id="johel-ernesto-guerrero-peña"><span class="header-section-number">5.2</span> Johel Ernesto Guerrero Peña<a href="#johel-ernesto-guerrero-peña" class="self-link"></a></h2>
<p>Johel got interested in the units domain while writing his first
hundred lines of game development. He got up to opening the game window,
so this milestone was not reached until years later. Instead, he looked
for the missing piece of abstraction, called “pixel” in the GUI
framework, but modeled as an
<code class="sourceCode default">int</code>. He found out about <span class="citation" data-cites="NHOLTHAUS-UNITS">[<a href="#ref-NHOLTHAUS-UNITS" role="doc-biblioref">nholthaus/units</a>]</span>, and got fascinated
with the idea of a library that succinctly allows expressing his
domain’s units (<a href="https://github.com/nholthaus/units/issues/124#issuecomment-390773279" class="uri">https://github.com/nholthaus/units/issues/124#issuecomment-390773279</a>).</p>
<p>Johel became a contributor to <span class="citation" data-cites="NHOLTHAUS-UNITS">[<a href="#ref-NHOLTHAUS-UNITS" role="doc-biblioref">nholthaus/units</a>]</span> v3 from 2018 to 2020.
He improved the interfaces and implementations by remodeling them after
<code class="sourceCode default">std::chrono::duration</code>. This
included parameterizing the representation type with a template
parameter instead of a macro. He also improved the error messages by
mapping a list of types to an user-defined name.</p>
<p>By 2020, Johel had been aware of <span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span> v0 <code class="sourceCode default">quantity&lt;dim_length, length, int&gt;</code>,
put off by its verbosity. But then, he watched a talk by Mateusz Pusz on
<span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span>. It described how good error
messages was a stake in the ground for the library. Thanks to his
experience in the domain, Johel was convinced that <span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span> was the future.</p>
<p>Since 2020, Johel has been contributing to <span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span>. He added
<code class="sourceCode default">quantity_point</code>, the
generalization of
<code class="sourceCode default">std::chrono::time_point</code>, closing
#1. He also added <code class="sourceCode default">quantity_kind</code>,
which explored the need of representing distinct quantities of the same
dimension. To help guide its evolution, he’s been constantly pointing in
the direction of <span class="citation" data-cites="BIPM-VIM">[<a href="#ref-BIPM-VIM" role="doc-biblioref">JCGM 200:2012</a>]</span> as a
source of truth. And more recently, to <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span>, also helping interpret
it.</p>
<p>Computing systems engineering graduate. (C++) programmer since 2014.
Lives at HEAD with C++Next and good practices. Performs in-depth code
reviews of familiarized code bases. Has an eye for identifying
automation opportunities, and acts on them. Mostly at <a href="https://github.com/JohelEGP/" class="uri">https://github.com/JohelEGP/</a>.</p>
<h2 data-number="5.3" id="charles-hogg"><span class="header-section-number">5.3</span> Charles Hogg<a href="#charles-hogg" class="self-link"></a></h2>
<p>Chip Hogg is a Staff Software Engineer on the Motion Planning Team at
Aurora Innovation, the self-driving vehicle company that is developing
the Aurora Driver. After obtaining his PhD in Physics from Carnegie
Mellon in 2010, he was a postdoctoral researcher and then staff
scientist at the National Institute of Standards and Technology (NIST),
doing Bayesian data analysis. He joined Google in 2012 as a software
engineer, leaving in 2016 to work on autonomous vehicles at Uber’s
Advanced Technologies Group (ATG), where he stayed until their
acquisition by Aurora in 2021.</p>
<p>Chip built his first C++ units library at Uber ATG in 2018, where he
first developed the concept of unit-safe interfaces. At Aurora in 2021,
he ported over only the test cases, writing a new and more powerful
units library from scratch. This included novel features such as vector
space magnitudes, and an adaptive conversion policy which guards against
overflow in integers.</p>
<p>He soon realized that there was a much broader need for Aurora’s
units library. No publicly available units library for C++14 or C++17
could match its ergonomics, developer experience, and performance. This
motivated him to create <span class="citation" data-cites="AU">[<a href="#ref-AU" role="doc-biblioref">Au</a>]</span> in 2022: a new,
zero-dependency units library, which was a drop-in replacement for
Aurora’s original units library, but offered far more composable
interfaces, and was built on simpler, stronger foundations. Once Au
proved its value internally, Chip migrated it to a separate repository
and led the open-sourcing process, culminating in its public release in
2023.</p>
<p>While Au provides excellent ergonomics and robustness for pre-C++20
users, Chip also believes the C++ community would benefit from a
standard units library. For that reason, he has joined forces with the
<span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span> project, contributing code and
design ideas.</p>
<h2 data-number="5.4" id="nicolas-holthaus"><span class="header-section-number">5.4</span> Nicolas Holthaus<a href="#nicolas-holthaus" class="self-link"></a></h2>
<p>Nicolas graduated Summa Cum Laude from Northwestern University with a
B.S. in Computer Engineering. He worked for several years at the United
States Naval Air Warfare Center - Manned Flight Simulator - designing
real-time C++ software for aircraft survivability simulation. He has
subsequently continued in the field at various start-ups, MIT Lincoln
Laboratory, and most recently, STR (Science and Technology
Research).</p>
<p>Nicolas became obsessed with dimensional analysis as a high school
JETS team member after learning that the $125M Mars Climate Orbiter was
destroyed due to a simple feet-to-meters miscalculation. He developed
the widely adopted C++ <span class="citation" data-cites="NHOLTHAUS-UNITS">[<a href="#ref-NHOLTHAUS-UNITS" role="doc-biblioref">nholthaus/units</a>]</span> library based on the
findings of the 2002 white paper “Dimensional Analysis in C++” by Scott
Meyers. Astounded that no one smarter had already written such a
library, he continued with <code class="sourceCode default">units</code>
2.0 and 3.0 based on modern C++. Those libraries have been extensively
adopted in many fields, including modeling &amp; simulation,
agriculture, and geodesy.</p>
<p>In 2023, recognizing the limits of
<code class="sourceCode default">units</code>, he joined forces with
Mateusz Pusz in his effort to standardize his evolutionary dimensional
analysis library, with the goal of providing the highest-quality
dimensional analysis to all C++ users via the C++ standard library.</p>
<h2 data-number="5.5" id="roth-michaels"><span class="header-section-number">5.5</span> Roth Michaels<a href="#roth-michaels" class="self-link"></a></h2>
<p>Roth Michaels is a Principal Software Engineer at <a href="https://www.native-instruments.com">Native Instruments</a>, a
leading manufacturer of audio, and music, software and hardware. Working
in this domain, he has been involved with the creation of ad hoc typed
quantities/units for digital signal processing and GUI library
use-cases. Seeing both the complexity of development and practical uses
where developers need to leave the safety of these simple wrappers
encouraged Roth to explore various quantity/units libraries to see if
they would apply to this domain. He has been doing research into
defining and using digital audio and music domain-specific quantities
and units using first <span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span> as
proposed in <span class="citation" data-cites="P1935R2">[<a href="#ref-P1935R2" role="doc-biblioref">P1935R2</a>]</span> and the new
V2 library described in this paper.</p>
<p>Before working for Native Instruments, Roth worked as a consultant in
multiple industries using a variety of programming languages. He was
involved with the Swift Evolution community in its early days before
focusing primarily on C++ after joining <a href="https://www.izotope.com">iZotope</a> and now Native
Instruments.</p>
<p>Holding a degree in music composition, Roth has over a decade of
experience working with quantities and units of measure related to
music, digital signal processing, analog audio, and acoustics. He has
joined the <span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span> project
as a domain expert in these areas and to provide perspective on
logarithmic and non-linear quantity/unit relationships.</p>
<h2 data-number="5.6" id="mateusz-pusz"><span class="header-section-number">5.6</span> Mateusz Pusz<a href="#mateusz-pusz" class="self-link"></a></h2>
<p>Mateusz got interested in the physical units subject while
contributing to the <span class="citation" data-cites="LK8000">[<a href="#ref-LK8000" role="doc-biblioref">LK8000</a>]</span> Tactical
Flight Computer Open Source project over 10 years ago. The project’s
code was far from being “safe” in the C++ sense, and this is when
Mateusz started to explore alternatives.</p>
<p>Through the following years, he tried to use several existing
solutions, which were always far from being user-friendly, so he also
tried to write a better framework a few times from scratch by
himself.</p>
<p>Finally, with the availability of brand new Concepts TS in the gcc-7,
the <span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span> project
was created. It was designed with safety and user experience in mind.
After many years of working on the project, the <span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span> library is probably the most
modern and complete solution in the C++ market.</p>
<p>Through the last few years, Mateusz has put much effort into building
a community around physical units. He provided many talks and workshops
on this subject at various C++ conferences. He also approached the
authors of other actively maintained libraries to get their feedback and
invited them to work together to find and agree on the best solution for
the C++ language. This paper is the result of those actions.</p>
<h2 data-number="5.7" id="vincent-reverdy"><span class="header-section-number">5.7</span> Vincent Reverdy<a href="#vincent-reverdy" class="self-link"></a></h2>
<p>Vincent is an astrophysicist, computer scientist, and a member of the
French delegation to the ISO C++ Committee, currently working as a full
researcher at the French National Centre for Scientific Research (CNRS).
He has been interested for years in units and quantities for programming
languages to ensure higher levels of both expressivity and safety in
computational physics codes. Back in 2019, he authored <span class="citation" data-cites="P1930R0">[<a href="#ref-P1930R0" role="doc-biblioref">P1930R0</a>]</span> to provide some context of what
could be a quantity and unit library for C++.</p>
<p>After designing and implementing several Domain-Specific Language
(DSL) demonstrators dedicated to units of measurements in C++, he became
more interested in the theoretical side of the problem. Today, one of
his research activities is dedicated to the mathematical formalization
of systems of quantities and systems of units as an interdisciplinary
problem between physics, mathematics, and computer science.</p>
<h1 data-number="6" id="motivation"><span class="header-section-number">6</span> Motivation<a href="#motivation" class="self-link"></a></h1>
<p>This chapter describes why we believe that physical quantities and
units should be part of a C++ Standard Library.</p>
<h2 data-number="6.1" id="safety"><span class="header-section-number">6.1</span> Safety<a href="#safety" class="self-link"></a></h2>
<p>It is no longer only the space industry or experienced pilots that
benefit from the autonomous operations of some machines. We live in a
world where more and more ordinary people trust machines with their
lives daily. In the near future, we will be allowed to sleep while our
car autonomously drives us home from a late party. As a result, many
more C++ engineers are expected to write life-critical software today
than it was a few years ago. However, writing safety-critical code
requires extensive training and experience, both of which are in short
demand. While there exists some standards and guidelines such as MISRA
C++ <span class="citation" data-cites="MISRA_CPP">[<a href="#ref-MISRA_CPP" role="doc-biblioref">MISRA C++</a>]</span> with
the aim of enforcing the creation of safe code in C++, they are
cumbersome to use and tend to shift the burden on the discipline of the
programmers to enforce these. At the time of writing, the C++ language
does not change fast enough to enforce safe-by-construction code.</p>
<p>One of the ways C++ can significantly improve the safety of
applications being written by thousands of developers is by introducing
a type-safe, well-tested, standardized way to handle physical quantities
and their units. The rationale is that people tend to have problems
communicating or using proper units in code and daily life. Numerous
expensive failures and accidents happened due to using an invalid unit
or a quantity type.</p>
<p>The most famous and probably the most expensive example in the
software engineering domain is the Mars Climate Orbiter that in 1999
failed to enter Mars’ orbit and crashed while entering its atmosphere
<span class="citation" data-cites="MARS_ORBITER">[<a href="#ref-MARS_ORBITER" role="doc-biblioref">Mars Orbiter</a>]</span>.
This is one of many examples here. People tend to confuse units quite
often. We see similar errors occurring in various domains over the
years:</p>
<ul>
<li>On October 12, 1492, Christopher Columbus unintentionally discovered
the sea route from Europe to America because, during his travel
preparations, he mixed the Arabic mile with a Roman mile, which led to
the wrong estimation of the equator and his expected travel distance
<span class="citation" data-cites="COLUMBUS">[<a href="#ref-COLUMBUS" role="doc-biblioref">Columbus</a>]</span>.</li>
<li>In 1628, a new warship, Vasa, accidentally had an asymmetrical hull
(being thicker on the port side than the starboard side), which was one
of the reasons for her sinking less than a mile into her maiden voyage,
resulting in the death of 30 people on board. This asymmetry could have
been caused by the use of different systems of measurement, as
archaeologists have found four rulers used by the workers who built the
ship. Two were calibrated in Swedish feet, which had 12 inches, while
the other two measured Amsterdam feet, which had 11 inches <span class="citation" data-cites="VASA">[<a href="#ref-VASA" role="doc-biblioref">Vasa</a>]</span>.</li>
<li>Air Canada Flight 143 ran out of fuel on July 23, 1983, at an
altitude of 41 000 feet (12 000 metres), midway through the flight
because the fuel had been calculated in pounds instead of kilograms by
the ground crew <span class="citation" data-cites="GIMLI_GLIDER">[<a href="#ref-GIMLI_GLIDER" role="doc-biblioref">Gimli
Glider</a>]</span>.</li>
<li>The British rock band Black Sabbath, during its Born Again tour in
1983, ordered a replica of Stonehenge as props for the scene.
Unfortunately, they had to leave them in the storage area because, while
submitting the order, their manager wrote dimensions down in meters when
he meant feet, and so the stones didn’t fit the scene. “It cost a
fortune to make, but there was not a building on Earth that you could
fit it into” <span class="citation" data-cites="STONEHENGE">[<a href="#ref-STONEHENGE" role="doc-biblioref">Stonehenge</a>]</span>.</li>
<li>On April 15, 1999, Korean Air Cargo Flight 6316 crashed due to a
miscommunication between pilots about the desired flight altitude <span class="citation" data-cites="FLIGHT_6316">[<a href="#ref-FLIGHT_6316" role="doc-biblioref">Flight 6316</a>]</span>.</li>
<li>In February 2001, the crew of the Moorpark College Zoo built an
enclosure for Clarence the Tortoise with a weight of 250 pounds instead
of 250 kilograms <span class="citation" data-cites="CLARENCE">[<a href="#ref-CLARENCE" role="doc-biblioref">Clarence</a>]</span>.</li>
<li>In December 2003, one of the roller coaster’s cars at Tokyo
Disneyland’s Space Mountain attraction suddenly derailed due to a broken
axle caused by confusion after upgrading the specification from imperial
to metric units <span class="citation" data-cites="DISNEY">[<a href="#ref-DISNEY" role="doc-biblioref">Disney</a>]</span>.</li>
<li>During the construction of the Hochrheinbrücke bridge to connect the
small German town of Laufenburg with Swiss Laufenburg, the construction
team made a sign error that resulted in a discrepancy of 54 cm between
the two outer ends of the bridge <span class="citation" data-cites="HOCHRHEINBRÜCKE">[<a href="#ref-HOCHRHEINBRÜCKE" role="doc-biblioref">Hochrheinbrücke</a>]</span>.</li>
<li>An American company sold a shipment of wild rice to a Japanese
customer, quoting a price of 39 cents per pound, but the customer
thought the quote was for 39 cents per kilogram <span class="citation" data-cites="WILD_RICE">[<a href="#ref-WILD_RICE" role="doc-biblioref">Wild Rice</a>]</span>.</li>
<li>On October 17, 2023, The Guardian published an article titled
“Record Heat: Malawi swelters with temperatures nearly 68F above
average” with many issues related to the affine space types and
temperature units. Due to incorrect logic, probably during the
translation of the article to the U.S. market,
<code class="sourceCode default">20 °C</code> above the average
temperature was converted to
<code class="sourceCode default">68 °F</code>. The actual temperature
increase was <code class="sourceCode default">32 °F</code>, not
<code class="sourceCode default">68 °F</code> <span class="citation" data-cites="THE_GUARDIAN">[<a href="#ref-THE_GUARDIAN" role="doc-biblioref">The Guardian</a>]</span>.</li>
<li>A whole set of <span class="citation" data-cites="MEDICATION_DOSE_ERRORS">[<a href="#ref-MEDICATION_DOSE_ERRORS" role="doc-biblioref">Medication dose
errors</a>]</span>…</li>
</ul>
<p>The safety subject is so vast and essential by itself that we
dedicated an entire <a href="#safety-features">Safety features</a>
chapter of this paper that discusses all the nuances in detail.</p>
<h2 data-number="6.2" id="vocabulary-types"><span class="header-section-number">6.2</span> Vocabulary types<a href="#vocabulary-types" class="self-link"></a></h2>
<p>We standardized many library features mostly used in the
implementation details (fmt, ranges, random-number generators, etc.).
However, we believe that the most important role of the C++ Standard is
to provide a standardized way of communication between different
vendors.</p>
<p>Let’s imagine a world without
<code class="sourceCode default">std::string</code> or
<code class="sourceCode default">std::vector</code>. Every vendor has
their version of it, and of course, they are highly incompatible with
each other. As a result, when someone needs to integrate software from
different vendors, it turns out to be an unnecessarily arduous task.</p>
<p>Introducing
<code class="sourceCode default">std::chrono::duration</code> and
<code class="sourceCode default">std::chrono::time_point</code> improved
the interfaces a lot, but time is only one of many quantities that we
deal with in our software on a daily basis. We desperately need to be
able to express more quantities and units in a standardized way so
different libraries get means to communicate with each other.</p>
<p>If Lockheed Martin and NASA could have used standardized vocabulary
types in their interfaces, maybe they would not interpret pound-force
seconds as newton seconds, and the <span class="citation" data-cites="MARS_ORBITER">[<a href="#ref-MARS_ORBITER" role="doc-biblioref">Mars Orbiter</a>]</span> would not have crashed
during the Mars orbital insertion maneuver.</p>
<h2 data-number="6.3" id="certification"><span class="header-section-number">6.3</span> Certification<a href="#certification" class="self-link"></a></h2>
<p>Mission and life-critical projects, or those for embedded devices,
often have to obey the safety norms that care about software for
safety-critical systems (e.g., ISO 61508 is a basic functional safety
standard applicable to all industries, and ISO 26262 for automotive). As
a result, their company policy often forbid third-party tooling that
lacks official certification. Such certification requires a
specification to be certified against, and those tools often do not have
one. The risk and cost of self-certifying an Open Source project is too
high for many as well.</p>
<p>Companies often have a policy that the software they use must obey
all the rules MISRA provides. This is a common misconception, as many of
those rules are intended to be deviated from. However, those deviations
require rationale and documentation, which is also considered to be
risky and expensive by many.</p>
<p>All of those reasons often prevent the usage of an Open Source
product in a company, which is a huge issue, as those companies
typically are natural users of physical quantities and units
libraries.</p>
<p>Having the physical quantities and units library standardized would
solve those issues for many customers, and would allow them to produce
safer code for projects on which human life depends every single
day.</p>
<h2 data-number="6.4" id="complex-and-complicated"><span class="header-section-number">6.4</span> Complex and complicated<a href="#complex-and-complicated" class="self-link"></a></h2>
<p>Suppose vendors can’t use an Open Source library in a production
project for the above reasons. They are forced to write their own
abstractions by themselves. Besides being costly and time-consuming, it
also happens that writing a physical quantities and units library by
yourself is far from easy. Doing this is complex and complicated,
especially for engineers who are not experts in the domain. There are
many exceptional corner cases to cover that most developers do not even
realize before falling into a trap in production. On the other hand,
domain experts might find it difficult to put their knowledge into code
and create a correct implementation in C++. As a result, companies
either use really simple and unsafe numeric wrappers, or abandon the
effort entirely and just use built-in types, such as
<code class="sourceCode default">float</code> or
<code class="sourceCode default">int</code>, to express quantity values,
thus losing all semantic categorization. This often leads to safety
issues caused by accidentally using values representing the wrong
quantity or having an incorrect unit.</p>
<h2 data-number="6.5" id="extensibility"><span class="header-section-number">6.5</span> Extensibility<a href="#extensibility" class="self-link"></a></h2>
<p>Many applications of a quantity and units library may need to operate
on a combination of standard (e.g., SI) and domain-specific quantities
and units. The complexity of developing domain-specific solutions
highlights the value in being able to define new quantities and units
that have all the expressivity and safety as those provided by the
library.</p>
<p>Experience with writing ad hoc typed quantities without library
support that can be combined with or converted to
<code class="sourceCode default">std::chrono::duration</code> has shown
the downside of bespoke solutions: If not all operations or conversions
are handled, users will need to leave the safety of typed quantities to
operate on primitive types.</p>
<p>The interfaces of the this library were designed with ease of
extensibility in mind. Each definition of a dimension, quantity type, or
unit typically takes only a single line of code. This is possible thanks
to the extensive usage of C++20 class types as Non-Type Template
Parameters (NTTP). For example, the following code presents how second
(a unit of time in the <span class="citation" data-cites="SI">[<a href="#ref-SI" role="doc-biblioref">SI</a>]</span>) and hertz (a unit of
frequency in the <span class="citation" data-cites="SI">[<a href="#ref-SI" role="doc-biblioref">SI</a>]</span>) can be defined:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> second <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;s&quot;</span>, kind_of<span class="op">&lt;</span>isq<span class="op">::</span>time<span class="op">&gt;&gt;</span> <span class="op">{}</span> second;</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> hertz <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;Hz&quot;</span>, <span class="dv">1</span> <span class="op">/</span> second, kind_of<span class="op">&lt;</span>isq<span class="op">::</span>frequency<span class="op">&gt;&gt;</span> <span class="op">{}</span> hertz;</span></code></pre></div>
<h2 data-number="6.6" id="broad-industry-value"><span class="header-section-number">6.6</span> Broad industry value<a href="#broad-industry-value" class="self-link"></a></h2>
<p>When people think about industries that could use physical quantities
and unit libraries, they think of a few companies related to aerospace,
autonomous cars, or embedded industries. That is all true, but there are
many other potential users for such a library.</p>
<p>Here is a list of some less obvious candidates:</p>
<ul>
<li>Manufacturing,</li>
<li>maritime industry,</li>
<li>freight transport,</li>
<li>military,</li>
<li>astronomy,</li>
<li>3D design,</li>
<li>robotics,</li>
<li>audio,</li>
<li>medical devices,</li>
<li>national laboratories,</li>
<li>scientific institutions and universities,</li>
<li>all kinds of navigation and charting,</li>
<li>GUI frameworks,</li>
<li>finance (including HFT).</li>
</ul>
<p>As we can see, the range of domains for such a library is vast and
not limited to applications involving specifically physical units. Any
software that involves measurements, or operations on counts of some
standard or domain-specific quantities, could benefit from a zero-cost
abstraction for operating on quantity values and their units. The
library also provides affine space abstractions, which may prove useful
in many applications.</p>
<h2 data-number="6.7" id="standardizing-existing-practice"><span class="header-section-number">6.7</span> Standardizing existing
practice<a href="#standardizing-existing-practice" class="self-link"></a></h2>
<p>Plenty of physical units libraries have been available to the public
for many years. In 1998 Walter Brown provided an “Introduction to the SI
Library of Unit-Based Computation” paper for the International
Conference on Computing in High Energy Physics <span class="citation" data-cites="CHEP98">[<a href="#ref-CHEP98" role="doc-biblioref">CHEP’98</a>]</span>. It emphasizes the importance
of strong types and static type-checking. After that, it describes a
library modeling the <span class="citation" data-cites="SI">[<a href="#ref-SI" role="doc-biblioref">SI</a>]</span> to provide “strict
compile-time type-checking without run-time overhead”.</p>
<p>It also states that at this time, “in numeric programming,
programmers make heavy, near-exclusive, use of a language’s native
numeric types (e.g., <code class="sourceCode default">double</code>)”.
Today, twenty-five years later, plenty of “Modern C++” production code
bases still use <code class="sourceCode default">double</code> to
represent various quantities and units. It is high time to change
this.</p>
<p>Throughout the years, we have learned the best practices for handling
specific cases in the domain. Various products may have different scopes
and support different C++ versions. Still, taking that aside, they use
really similar concepts, types, and operations under the hood. We know
how to do those things already.</p>
<p>The authors of this paper developed and delivered multiple successful
C++ libraries for this domain. Libraries developed by them <a href="https://github.com/topics/dimensional-analysis?l=c%2B%2B">have
more than 90% of all the stars on GitHub in the field of physical units
libraries for C++</a>. The <span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span> library, which is the base of
this proposal, has the most number of stars in this list, making it the
most popular project in the C++ industry.</p>
<p>The authors joined forces and are working together to propose the
best quantities and units library we can get with the latest version of
the C++ language. They spend their private time and efforts hoping that
the ISO C++ Committee will be willing to include such a feature in the
C++ standard library.</p>
<h1 data-number="7" id="common-smells-when-there-is-no-library-for-quantities-and-units"><span class="header-section-number">7</span> Common smells when there is no
library for quantities and units<a href="#common-smells-when-there-is-no-library-for-quantities-and-units" class="self-link"></a></h1>
<p>In this chapter, we are going to review typical safety issues related
to physical quantities and units in the C++ code when a proper library
is not used. Even though all the examples come from the Open Source
projects, expensive revenue-generating production source code often is
similar.</p>
<h2 data-number="7.1" id="the-proliferation-of-double"><span class="header-section-number">7.1</span> The proliferation of
<code class="sourceCode default">double</code><a href="#the-proliferation-of-double" class="self-link"></a></h2>
<p>It turns out that in the C++ software, most of our calculations in
the physical quantities and units domain are handled with fundamental
types like <code class="sourceCode default">double</code>. Code like
below is a typical example here:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> GlidePolar<span class="op">::</span>MacCreadyAltitude<span class="op">(</span><span class="dt">double</span> MCREADY,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                                     <span class="dt">double</span> Distance,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                                     <span class="kw">const</span> <span class="dt">double</span> Bearing,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                                     <span class="kw">const</span> <span class="dt">double</span> WindSpeed,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                                     <span class="kw">const</span> <span class="dt">double</span> WindBearing,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                                     <span class="dt">double</span> <span class="op">*</span>BestCruiseTrack,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                                     <span class="dt">double</span> <span class="op">*</span>VMacCready,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                                     <span class="kw">const</span> <span class="dt">bool</span> isFinalGlide,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>                                     <span class="dt">double</span> <span class="op">*</span>TimeToGo,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>                                     <span class="kw">const</span> <span class="dt">double</span> AltitudeAboveTarget<span class="op">=</span><span class="fl">1.0e6</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>                                     <span class="kw">const</span> <span class="dt">double</span> cruise_efficiency<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>                                     <span class="kw">const</span> <span class="dt">double</span> TaskAltDiff<span class="op">=-</span><span class="fl">1.0e6</span><span class="op">)</span>;</span></code></pre></div>
<p><a href="https://github.com/LK8000/LK8000/blob/af404168ff5f92b03ab0c5db336ed8f01a792cda/Common/Header/McReady.h#L7-L21">Original
code here</a>.</p>
<p>There are several problems with such an approach: The abundance of
<code class="sourceCode default">double</code> parameters makes it easy
to accidentally switch values and there is no way of noticing such a
mistake at compile-time. The code is not self-documenting in what units
the parameters are expected. Is
<code class="sourceCode default">Distance</code> in meters or
kilometers? Is <code class="sourceCode default">WindSpeed</code> in
meters per second or knots? Different code bases choose different ways
to encode this information, which may be internally inconsistent. A
strong type system would help answer these questions at the time the
interface is written, and the compiler would verify it at
compile-time.</p>
<h2 data-number="7.2" id="the-proliferation-of-magic-numbers"><span class="header-section-number">7.2</span> The proliferation of magic
numbers<a href="#the-proliferation-of-magic-numbers" class="self-link"></a></h2>
<p>There are a lot of constants and conversion factors involved in the
quantity equations. Source code responsible for such computations is
often trashed with magic numbers:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> AirDensity<span class="op">(</span><span class="dt">double</span> hr, <span class="dt">double</span> temp, <span class="dt">double</span> abs_press<span class="op">)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="op">(</span><span class="dv">1</span><span class="op">/(</span><span class="fl">287.06</span><span class="op">*(</span>temp<span class="op">+</span><span class="fl">273.15</span><span class="op">)))*(</span>abs_press <span class="op">-</span> <span class="fl">230.617</span> <span class="op">*</span> hr <span class="op">*</span> exp<span class="op">((</span><span class="fl">17.5043</span><span class="op">*</span>temp<span class="op">)/(</span><span class="fl">241.2</span><span class="op">+</span>temp<span class="op">)))</span>;</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><a href="https://github.com/LK8000/LK8000/blob/af404168ff5f92b03ab0c5db336ed8f01a792cda/Common/Source/Library/PressureFunctions.cpp#L134-L136">Original
code here</a>.</p>
<p>Apart from the obvious readability issues, such code is hard to
maintain, and it needs a lot of domain knowledge on the developer’s
side. While it would be easy to replace these numbers with named
constants, the question of which unit the constant is in remains. Is
<code class="sourceCode default">287.06</code> in pounds per square inch
(psi) or millibars (mbar)?</p>
<h2 data-number="7.3" id="the-proliferation-of-conversion-macros"><span class="header-section-number">7.3</span> The proliferation of conversion
macros<a href="#the-proliferation-of-conversion-macros" class="self-link"></a></h2>
<p>The lack of automated unit conversions often results in handwritten
conversion functions or macros that are spread everywhere among the code
base:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#ifndef PI</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="kw">static</span> <span class="kw">const</span> <span class="dt">double</span> PI <span class="op">=</span> <span class="op">(</span><span class="dv">4</span><span class="op">*</span>atan<span class="op">(</span><span class="dv">1</span><span class="op">))</span>;</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#endif</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#define EARTH_DIAMETER    </span><span class="fl">12733426.0</span><span class="pp">    </span><span class="co">// Diameter of earth in meters</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#define SQUARED_EARTH_DIAMETER  </span><span class="fl">162140137697476.0</span><span class="pp"> </span><span class="co">// Diameter of earth in meters (EARTH_DIAMETER*EARTH_DIAMETER)</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#ifndef DEG_TO_RAD</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="pp">#define DEG_TO_RAD  </span><span class="op">(</span>PI<span class="pp"> </span><span class="op">/</span><span class="pp"> </span><span class="dv">180</span><span class="op">)</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="pp">#define RAD_TO_DEG  </span><span class="op">(</span><span class="dv">180</span><span class="pp"> </span><span class="op">/</span><span class="pp"> </span>PI<span class="op">)</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="pp">#endif</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="pp">#define NAUTICALMILESTOMETRES </span><span class="op">(</span><span class="dt">double</span><span class="op">)</span><span class="fl">1851.96</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="pp">#define KNOTSTOMETRESSECONDS </span><span class="op">(</span><span class="dt">double</span><span class="op">)</span><span class="fl">0.5144</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="pp">#define TOKNOTS </span><span class="op">(</span><span class="dt">double</span><span class="op">)</span><span class="fl">1.944</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="pp">#define TOFEETPERMINUTE </span><span class="op">(</span><span class="dt">double</span><span class="op">)</span><span class="fl">196.9</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="pp">#define TOMPH   </span><span class="op">(</span><span class="dt">double</span><span class="op">)</span><span class="fl">2.237</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="pp">#define TOKPH   </span><span class="op">(</span><span class="dt">double</span><span class="op">)</span><span class="fl">3.6</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co">// meters to.. conversion</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="pp">#define TONAUTICALMILES </span><span class="op">(</span><span class="fl">1.0</span><span class="pp"> </span><span class="op">/</span><span class="pp"> </span><span class="fl">1852.0</span><span class="op">)</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="pp">#define TOMILES         </span><span class="op">(</span><span class="fl">1.0</span><span class="pp"> </span><span class="op">/</span><span class="pp"> </span><span class="fl">1609.344</span><span class="op">)</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="pp">#define TOKILOMETER     </span><span class="op">(</span><span class="fl">0.001</span><span class="op">)</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="pp">#define TOFEET          </span><span class="op">(</span><span class="fl">1.0</span><span class="pp"> </span><span class="op">/</span><span class="pp"> </span><span class="fl">0.3048</span><span class="op">)</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="pp">#define TOMETER         </span><span class="op">(</span><span class="fl">1.0</span><span class="op">)</span></span></code></pre></div>
<p><a href="https://github.com/LK8000/LK8000/blob/052bbc20a106fda4db41874e788e39020fb86512/Common/Header/Defines.h#L901-L924">Original
code here</a>.</p>
<p>Again, the question of which unit the constant is in remains. Without
looking at the code, it is impossible to tell from which unit
<code class="sourceCode default">TOMETER</code> converts. Also, macros
have the problem that they are not scoped to a namespace and thus can
easily clash with other macros or functions, especially if they have
such common names like <code class="sourceCode default">PI</code> or
<code class="sourceCode default">RAD_TO_DEG</code>. A quick search
through open source C++ code bases reveals that, for example, the
<code class="sourceCode default">RAD_TO_DEG</code> macro is defined in a
multitude of different ways – sometimes even within the same
repository:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#define RAD_TO_DEG </span><span class="op">(</span><span class="dv">180</span><span class="pp"> </span><span class="op">/</span><span class="pp"> </span>PI<span class="op">)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#define RAD_TO_DEG </span><span class="fl">57.2957795131</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#define RAD_TO_DEG </span><span class="op">(</span><span class="pp"> </span>radians<span class="pp"> </span><span class="op">)</span><span class="pp"> </span><span class="op">((</span>radians<span class="pp"> </span><span class="op">)</span><span class="pp"> </span><span class="op">*</span><span class="pp"> </span><span class="fl">180.0</span><span class="pp"> </span><span class="op">/</span><span class="pp"> </span>M_PI<span class="op">)</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#define RAD_TO_DEG </span><span class="fl">57.2957805</span><span class="bu">f</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="op">...</span></span></code></pre></div>
<p><a href="https://github.com/search?q=lang%3AC%2B%2B++%22%23define+RAD_TO_DEG%22&amp;type=code">Example
search across multiple repositories</a></p>
<p><a href="https://github.com/search?q=repo%3ALK8000%2FLK8000%20rad_to_deg&amp;type=code">Multiple
redefinitions in the same repository</a></p>
<p>Another safety issue occurring here is the fact that macro values can
be deliberately tainted by compiler settings at built time and can
acquire values that are not present in the source code. Human reviews
won’t catch such issues.</p>
<p>Also, most of the macros do not follow best practices. Often,
necessary parentheses are missing, processing in a preprocessor ends up
with redundant casts, or some compile-time constants use too many digits
for a value to be exact for a specific type (e.g.,
<code class="sourceCode default">float</code>).</p>
<h2 data-number="7.4" id="lack-of-consistency"><span class="header-section-number">7.4</span> Lack of consistency<a href="#lack-of-consistency" class="self-link"></a></h2>
<p>If we not only lack strong types to isolate the abstractions from
each other, but also lack discipline to keep our code consistent, we end
up in an awful place:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> DistanceBearing<span class="op">(</span><span class="dt">double</span> lat1, <span class="dt">double</span> lon1,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                     <span class="dt">double</span> lat2, <span class="dt">double</span> lon2,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                     <span class="dt">double</span> <span class="op">*</span>Distance, <span class="dt">double</span> <span class="op">*</span>Bearing<span class="op">)</span>;</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> DoubleDistance<span class="op">(</span><span class="dt">double</span> lat1, <span class="dt">double</span> lon1,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>                      <span class="dt">double</span> lat2, <span class="dt">double</span> lon2,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>                      <span class="dt">double</span> lat3, <span class="dt">double</span> lon3<span class="op">)</span>;</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> FindLatitudeLongitude<span class="op">(</span><span class="dt">double</span> Lat, <span class="dt">double</span> Lon,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>                           <span class="dt">double</span> Bearing, <span class="dt">double</span> Distance,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>                           <span class="dt">double</span> <span class="op">*</span>lat_out, <span class="dt">double</span> <span class="op">*</span>lon_out<span class="op">)</span>;</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> CrossTrackError<span class="op">(</span><span class="dt">double</span> lon1, <span class="dt">double</span> lat1,</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>                       <span class="dt">double</span> lon2, <span class="dt">double</span> lat2,</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>                       <span class="dt">double</span> lon3, <span class="dt">double</span> lat3,</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>                       <span class="dt">double</span> <span class="op">*</span>lon4, <span class="dt">double</span> <span class="op">*</span>lat4<span class="op">)</span>;</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> ProjectedDistance<span class="op">(</span><span class="dt">double</span> lon1, <span class="dt">double</span> lat1,</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>                         <span class="dt">double</span> lon2, <span class="dt">double</span> lat2,</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>                         <span class="dt">double</span> lon3, <span class="dt">double</span> lat3,</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>                         <span class="dt">double</span> <span class="op">*</span>xtd, <span class="dt">double</span> <span class="op">*</span>crs<span class="op">)</span>;</span></code></pre></div>
<p><a href="https://github.com/LK8000/LK8000/blob/af404168ff5f92b03ab0c5db336ed8f01a792cda/Common/Header/NavFunctions.h#L7C1-L27">Original
code here</a>.</p>
<p>Users can easily make errors if the interface designers are not
consistent in ordering parameters. It is really hard to remember which
function takes latitude or
<code class="sourceCode default">Bearing</code> first and when a
latitude or <code class="sourceCode default">Distance</code> is in the
front.</p>
<h2 data-number="7.5" id="lack-of-a-conceptual-framework"><span class="header-section-number">7.5</span> Lack of a conceptual
framework<a href="#lack-of-a-conceptual-framework" class="self-link"></a></h2>
<p>The previous points mean that the fundamental types can’t be
leveraged to model the different concepts of quantities and units
frameworks. There is no shared vocabulary between different libraries.
User-facing APIs use ad-hoc conventions. Even internal interfaces are
inconsistent between themselves.</p>
<p>Arithmetic types such as <code class="sourceCode default">int</code>
and <code class="sourceCode default">double</code> are used to model
different concepts. They are used to represent any abstraction (be it a
magnitude, difference, point, or kind) of any quantity type of any unit.
These are weak types that make up weakly-typed interfaces. The resulting
interfaces and implementations built with these types easily allow
mixing up parameters and using operations that are not part of the
represented quantity.</p>
<h1 data-number="8" id="design-goals"><span class="header-section-number">8</span> Design goals<a href="#design-goals" class="self-link"></a></h1>
<p>The library facilities that we plan to propose in the upcoming papers
is designed with the following goals in mind.</p>
<h2 data-number="8.1" id="compile-time-safety"><span class="header-section-number">8.1</span> Compile-time safety<a href="#compile-time-safety" class="self-link"></a></h2>
<p>The most important property of any such a library is the safety it
brings to C++ projects. The correct handling of physical quantities,
units, and numerical values should be verifiable both by the compiler
and by humans with manual inspection of each individual line.</p>
<p>In some cases, we are even eager to prioritize safe interfaces over
the general usability experience (e.g., getters of the underlying raw
numerical value will always require a unit in which the value should be
returned in, which results in more typing and is sometimes
redundant).</p>
<p>More information on this subject can be found in <a href="#safety-features">Safety features</a>.</p>
<h2 data-number="8.2" id="performance"><span class="header-section-number">8.2</span> Performance<a href="#performance" class="self-link"></a></h2>
<p>The library should be as fast or even faster than working with
fundamental types. The should be no runtime overhead, and no space size
overhead should be needed to implement higher-level abstractions.</p>
<h2 data-number="8.3" id="great-user-experience"><span class="header-section-number">8.3</span> Great user experience<a href="#great-user-experience" class="self-link"></a></h2>
<p>The primary purpose of the library is to generate compile-time
errors. If users did not introduce any bugs in the manual handling of
quantities and units, the library would be of little use. This is why
the library is optimized for readable compilation errors and great
debugging experience.</p>
<p>The library is easy to use and flexible. The interfaces are
straight-forward and safe by default. Users should be able to easily
express any quantity and unit, which requires them to compose.</p>
<p>The above constraints imply the usage of special implementation
techniques. The library will not only provide types, but also
compile-time known values that will enable users to write easy to
understand and efficient equations on quantities and units.</p>
<h2 data-number="8.4" id="scope"><span class="header-section-number">8.4</span> Scope<a href="#scope" class="self-link"></a></h2>
<p>There are plenty of expectations from different parties regarding
such a library. It should support at least:</p>
<ul>
<li>Any unit’s magnitude (huge, small, floating-point).</li>
<li>Systems of Quantities.</li>
<li>Systems of Units.</li>
<li>The affine space.</li>
<li>Highly adjustable text-output formatting.</li>
</ul>
<p>Additionally, it would be good to also support the following
features:</p>
<ul>
<li>Scalar, vector, and tensor quantities.</li>
<li>Natural units systems.</li>
</ul>
<h2 data-number="8.5" id="easy-to-extend"><span class="header-section-number">8.5</span> Easy to extend<a href="#easy-to-extend" class="self-link"></a></h2>
<p>The library’s core framework does not assume the usage of any systems
of quantities or units. It is fully generic and allow defining any
system abstraction on top of it.</p>
<p>Most entities in the library can be defined with a single line of
code without preprocessor macros. Users can easily extend provided
systems with custom dimensions, quantities, and units.</p>
<h2 data-number="8.6" id="low-standardization-cost"><span class="header-section-number">8.6</span> Low standardization cost<a href="#low-standardization-cost" class="self-link"></a></h2>
<p>The set of entities required for standardization should be limited to
the bare minimum.</p>
<p>Most of the entities in systems definitions should be possible to
implement with a single line of code.</p>
<p>Derived units do not need separate library types. Instead, they can
be obtained through the composition of predefined named units. Units
should not be associated with User-Defined Literals (UDLs), as it is the
case with <code class="sourceCode default">std::chrono::duration</code>.
UDLs do not compose, have very limited scope and functionality, and are
expensive to standardize.</p>
<p>The user interface should have no preprocessor macros.</p>
<p>It should be possible for most proposed features (besides the text
output) to be freestanding.</p>
<h1 data-number="9" id="quick-domain-introduction"><span class="header-section-number">9</span> Quick domain introduction<a href="#quick-domain-introduction" class="self-link"></a></h1>
<p>This chapter provides a very brief introduction to the quantities and
units domain. Please refer to <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span> and <span class="citation" data-cites="SI">[<a href="#ref-SI" role="doc-biblioref">SI</a>]</span> for more details.</p>
<!-- 
flowchart TD
    dimension --- quantity_type["quantity type"]
    quantity_type --- reference["quantity reference\n(e.g., unit)"]
    reference --- quantity
    number --- quantity
 -->
<p><img src="data:image/svg+xml;base64,PHN2ZyBhcmlhLXJvbGVkZXNjcmlwdGlvbj0iZmxvd2NoYXJ0LXYyIiByb2xlPSJncmFwaGljcy1kb2N1bWVudCBkb2N1bWVudCIgdmlld0JveD0iLTggLTggMjg1LjMxMjUgMzQ2IiBzdHlsZT0ibWF4LXdpZHRoOiAxMDAlOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTAwJSIgaWQ9ImdyYXBoLWRpdiIgaGVpZ2h0PSIxMDAlIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+PHN0eWxlPkBpbXBvcnQgdXJsKCJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9mb250LWF3ZXNvbWUvNi40LjIvY3NzL2FsbC5taW4uY3NzIik7Jzwvc3R5bGU+PHN0eWxlPiNncmFwaC1kaXZ7Zm9udC1mYW1pbHk6InRyZWJ1Y2hldCBtcyIsdmVyZGFuYSxhcmlhbCxzYW5zLXNlcmlmO2ZvbnQtc2l6ZToxNnB4O2ZpbGw6IzMzMzt9I2dyYXBoLWRpdiAuZXJyb3ItaWNvbntmaWxsOiM1NTIyMjI7fSNncmFwaC1kaXYgLmVycm9yLXRleHR7ZmlsbDojNTUyMjIyO3N0cm9rZTojNTUyMjIyO30jZ3JhcGgtZGl2IC5lZGdlLXRoaWNrbmVzcy1ub3JtYWx7c3Ryb2tlLXdpZHRoOjJweDt9I2dyYXBoLWRpdiAuZWRnZS10aGlja25lc3MtdGhpY2t7c3Ryb2tlLXdpZHRoOjMuNXB4O30jZ3JhcGgtZGl2IC5lZGdlLXBhdHRlcm4tc29saWR7c3Ryb2tlLWRhc2hhcnJheTowO30jZ3JhcGgtZGl2IC5lZGdlLXBhdHRlcm4tZGFzaGVke3N0cm9rZS1kYXNoYXJyYXk6Mzt9I2dyYXBoLWRpdiAuZWRnZS1wYXR0ZXJuLWRvdHRlZHtzdHJva2UtZGFzaGFycmF5OjI7fSNncmFwaC1kaXYgLm1hcmtlcntmaWxsOiMzMzMzMzM7c3Ryb2tlOiMzMzMzMzM7fSNncmFwaC1kaXYgLm1hcmtlci5jcm9zc3tzdHJva2U6IzMzMzMzMzt9I2dyYXBoLWRpdiBzdmd7Zm9udC1mYW1pbHk6InRyZWJ1Y2hldCBtcyIsdmVyZGFuYSxhcmlhbCxzYW5zLXNlcmlmO2ZvbnQtc2l6ZToxNnB4O30jZ3JhcGgtZGl2IC5sYWJlbHtmb250LWZhbWlseToidHJlYnVjaGV0IG1zIix2ZXJkYW5hLGFyaWFsLHNhbnMtc2VyaWY7Y29sb3I6IzMzMzt9I2dyYXBoLWRpdiAuY2x1c3Rlci1sYWJlbCB0ZXh0e2ZpbGw6IzMzMzt9I2dyYXBoLWRpdiAuY2x1c3Rlci1sYWJlbCBzcGFuLCNncmFwaC1kaXYgcHtjb2xvcjojMzMzO30jZ3JhcGgtZGl2IC5sYWJlbCB0ZXh0LCNncmFwaC1kaXYgc3BhbiwjZ3JhcGgtZGl2IHB7ZmlsbDojMzMzO2NvbG9yOiMzMzM7fSNncmFwaC1kaXYgLm5vZGUgcmVjdCwjZ3JhcGgtZGl2IC5ub2RlIGNpcmNsZSwjZ3JhcGgtZGl2IC5ub2RlIGVsbGlwc2UsI2dyYXBoLWRpdiAubm9kZSBwb2x5Z29uLCNncmFwaC1kaXYgLm5vZGUgcGF0aHtmaWxsOiNFQ0VDRkY7c3Ryb2tlOiM5MzcwREI7c3Ryb2tlLXdpZHRoOjFweDt9I2dyYXBoLWRpdiAuZmxvd2NoYXJ0LWxhYmVsIHRleHR7dGV4dC1hbmNob3I6bWlkZGxlO30jZ3JhcGgtZGl2IC5ub2RlIC5sYWJlbHt0ZXh0LWFsaWduOmNlbnRlcjt9I2dyYXBoLWRpdiAubm9kZS5jbGlja2FibGV7Y3Vyc29yOnBvaW50ZXI7fSNncmFwaC1kaXYgLmFycm93aGVhZFBhdGh7ZmlsbDojMzMzMzMzO30jZ3JhcGgtZGl2IC5lZGdlUGF0aCAucGF0aHtzdHJva2U6IzMzMzMzMztzdHJva2Utd2lkdGg6Mi4wcHg7fSNncmFwaC1kaXYgLmZsb3djaGFydC1saW5re3N0cm9rZTojMzMzMzMzO2ZpbGw6bm9uZTt9I2dyYXBoLWRpdiAuZWRnZUxhYmVse2JhY2tncm91bmQtY29sb3I6I2U4ZThlODt0ZXh0LWFsaWduOmNlbnRlcjt9I2dyYXBoLWRpdiAuZWRnZUxhYmVsIHJlY3R7b3BhY2l0eTowLjU7YmFja2dyb3VuZC1jb2xvcjojZThlOGU4O2ZpbGw6I2U4ZThlODt9I2dyYXBoLWRpdiAubGFiZWxCa2d7YmFja2dyb3VuZC1jb2xvcjpyZ2JhKDIzMiwgMjMyLCAyMzIsIDAuNSk7fSNncmFwaC1kaXYgLmNsdXN0ZXIgcmVjdHtmaWxsOiNmZmZmZGU7c3Ryb2tlOiNhYWFhMzM7c3Ryb2tlLXdpZHRoOjFweDt9I2dyYXBoLWRpdiAuY2x1c3RlciB0ZXh0e2ZpbGw6IzMzMzt9I2dyYXBoLWRpdiAuY2x1c3RlciBzcGFuLCNncmFwaC1kaXYgcHtjb2xvcjojMzMzO30jZ3JhcGgtZGl2IGRpdi5tZXJtYWlkVG9vbHRpcHtwb3NpdGlvbjphYnNvbHV0ZTt0ZXh0LWFsaWduOmNlbnRlcjttYXgtd2lkdGg6MjAwcHg7cGFkZGluZzoycHg7Zm9udC1mYW1pbHk6InRyZWJ1Y2hldCBtcyIsdmVyZGFuYSxhcmlhbCxzYW5zLXNlcmlmO2ZvbnQtc2l6ZToxMnB4O2JhY2tncm91bmQ6aHNsKDgwLCAxMDAlLCA5Ni4yNzQ1MDk4MDM5JSk7Ym9yZGVyOjFweCBzb2xpZCAjYWFhYTMzO2JvcmRlci1yYWRpdXM6MnB4O3BvaW50ZXItZXZlbnRzOm5vbmU7ei1pbmRleDoxMDA7fSNncmFwaC1kaXYgLmZsb3djaGFydFRpdGxlVGV4dHt0ZXh0LWFuY2hvcjptaWRkbGU7Zm9udC1zaXplOjE4cHg7ZmlsbDojMzMzO30jZ3JhcGgtZGl2IDpyb290ey0tbWVybWFpZC1mb250LWZhbWlseToidHJlYnVjaGV0IG1zIix2ZXJkYW5hLGFyaWFsLHNhbnMtc2VyaWY7fTwvc3R5bGU+PGc+PG1hcmtlciBvcmllbnQ9ImF1dG8iIG1hcmtlckhlaWdodD0iMTIiIG1hcmtlcldpZHRoPSIxMiIgbWFya2VyVW5pdHM9InVzZXJTcGFjZU9uVXNlIiByZWZZPSI1IiByZWZYPSI2IiB2aWV3Qm94PSIwIDAgMTAgMTAiIGNsYXNzPSJtYXJrZXIgZmxvd2NoYXJ0IiBpZD0iZ3JhcGgtZGl2X2Zsb3djaGFydC1wb2ludEVuZCI+PHBhdGggc3R5bGU9InN0cm9rZS13aWR0aDogMTsgc3Ryb2tlLWRhc2hhcnJheTogMSwgMDsiIGNsYXNzPSJhcnJvd01hcmtlclBhdGgiIGQ9Ik0gMCAwIEwgMTAgNSBMIDAgMTAgeiI+PC9wYXRoPjwvbWFya2VyPjxtYXJrZXIgb3JpZW50PSJhdXRvIiBtYXJrZXJIZWlnaHQ9IjEyIiBtYXJrZXJXaWR0aD0iMTIiIG1hcmtlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgcmVmWT0iNSIgcmVmWD0iNC41IiB2aWV3Qm94PSIwIDAgMTAgMTAiIGNsYXNzPSJtYXJrZXIgZmxvd2NoYXJ0IiBpZD0iZ3JhcGgtZGl2X2Zsb3djaGFydC1wb2ludFN0YXJ0Ij48cGF0aCBzdHlsZT0ic3Ryb2tlLXdpZHRoOiAxOyBzdHJva2UtZGFzaGFycmF5OiAxLCAwOyIgY2xhc3M9ImFycm93TWFya2VyUGF0aCIgZD0iTSAwIDUgTCAxMCAxMCBMIDEwIDAgeiI+PC9wYXRoPjwvbWFya2VyPjxtYXJrZXIgb3JpZW50PSJhdXRvIiBtYXJrZXJIZWlnaHQ9IjExIiBtYXJrZXJXaWR0aD0iMTEiIG1hcmtlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgcmVmWT0iNSIgcmVmWD0iMTEiIHZpZXdCb3g9IjAgMCAxMCAxMCIgY2xhc3M9Im1hcmtlciBmbG93Y2hhcnQiIGlkPSJncmFwaC1kaXZfZmxvd2NoYXJ0LWNpcmNsZUVuZCI+PGNpcmNsZSBzdHlsZT0ic3Ryb2tlLXdpZHRoOiAxOyBzdHJva2UtZGFzaGFycmF5OiAxLCAwOyIgY2xhc3M9ImFycm93TWFya2VyUGF0aCIgcj0iNSIgY3k9IjUiIGN4PSI1Ij48L2NpcmNsZT48L21hcmtlcj48bWFya2VyIG9yaWVudD0iYXV0byIgbWFya2VySGVpZ2h0PSIxMSIgbWFya2VyV2lkdGg9IjExIiBtYXJrZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIHJlZlk9IjUiIHJlZlg9Ii0xIiB2aWV3Qm94PSIwIDAgMTAgMTAiIGNsYXNzPSJtYXJrZXIgZmxvd2NoYXJ0IiBpZD0iZ3JhcGgtZGl2X2Zsb3djaGFydC1jaXJjbGVTdGFydCI+PGNpcmNsZSBzdHlsZT0ic3Ryb2tlLXdpZHRoOiAxOyBzdHJva2UtZGFzaGFycmF5OiAxLCAwOyIgY2xhc3M9ImFycm93TWFya2VyUGF0aCIgcj0iNSIgY3k9IjUiIGN4PSI1Ij48L2NpcmNsZT48L21hcmtlcj48bWFya2VyIG9yaWVudD0iYXV0byIgbWFya2VySGVpZ2h0PSIxMSIgbWFya2VyV2lkdGg9IjExIiBtYXJrZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIHJlZlk9IjUuMiIgcmVmWD0iMTIiIHZpZXdCb3g9IjAgMCAxMSAxMSIgY2xhc3M9Im1hcmtlciBjcm9zcyBmbG93Y2hhcnQiIGlkPSJncmFwaC1kaXZfZmxvd2NoYXJ0LWNyb3NzRW5kIj48cGF0aCBzdHlsZT0ic3Ryb2tlLXdpZHRoOiAyOyBzdHJva2UtZGFzaGFycmF5OiAxLCAwOyIgY2xhc3M9ImFycm93TWFya2VyUGF0aCIgZD0iTSAxLDEgbCA5LDkgTSAxMCwxIGwgLTksOSI+PC9wYXRoPjwvbWFya2VyPjxtYXJrZXIgb3JpZW50PSJhdXRvIiBtYXJrZXJIZWlnaHQ9IjExIiBtYXJrZXJXaWR0aD0iMTEiIG1hcmtlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgcmVmWT0iNS4yIiByZWZYPSItMSIgdmlld0JveD0iMCAwIDExIDExIiBjbGFzcz0ibWFya2VyIGNyb3NzIGZsb3djaGFydCIgaWQ9ImdyYXBoLWRpdl9mbG93Y2hhcnQtY3Jvc3NTdGFydCI+PHBhdGggc3R5bGU9InN0cm9rZS13aWR0aDogMjsgc3Ryb2tlLWRhc2hhcnJheTogMSwgMDsiIGNsYXNzPSJhcnJvd01hcmtlclBhdGgiIGQ9Ik0gMSwxIGwgOSw5IE0gMTAsMSBsIC05LDkiPjwvcGF0aD48L21hcmtlcj48ZyBjbGFzcz0icm9vdCI+PGcgY2xhc3M9ImNsdXN0ZXJzIj48L2c+PGcgY2xhc3M9ImVkZ2VQYXRocyI+PHBhdGggc3R5bGU9ImZpbGw6bm9uZTsiIGNsYXNzPSJlZGdlLXRoaWNrbmVzcy1ub3JtYWwgZWRnZS1wYXR0ZXJuLXNvbGlkIGZsb3djaGFydC1saW5rIExTLWRpbWVuc2lvbiBMRS1xdWFudGl0eV90eXBlIiBpZD0iTC1kaW1lbnNpb24tcXVhbnRpdHlfdHlwZS0wIiBkPSJNNzQuODQ0LDM5TDc0Ljg0NCw0My4xNjdDNzQuODQ0LDQ3LjMzMyw3NC44NDQsNTUuNjY3LDc0Ljg0NCw2NEM3NC44NDQsNzIuMzMzLDc0Ljg0NCw4MC42NjcsNzQuODQ0LDg0LjgzM0w3NC44NDQsODkiPjwvcGF0aD48cGF0aCBzdHlsZT0iZmlsbDpub25lOyIgY2xhc3M9ImVkZ2UtdGhpY2tuZXNzLW5vcm1hbCBlZGdlLXBhdHRlcm4tc29saWQgZmxvd2NoYXJ0LWxpbmsgTFMtcXVhbnRpdHlfdHlwZSBMRS1yZWZlcmVuY2UiIGlkPSJMLXF1YW50aXR5X3R5cGUtcmVmZXJlbmNlLTAiIGQ9Ik03NC44NDQsMTI4TDc0Ljg0NCwxMzIuMTY3Qzc0Ljg0NCwxMzYuMzMzLDc0Ljg0NCwxNDQuNjY3LDc0Ljg0NCwxNTNDNzQuODQ0LDE2MS4zMzMsNzQuODQ0LDE2OS42NjcsNzQuODQ0LDE3My44MzNMNzQuODQ0LDE3OCI+PC9wYXRoPjxwYXRoIHN0eWxlPSJmaWxsOm5vbmU7IiBjbGFzcz0iZWRnZS10aGlja25lc3Mtbm9ybWFsIGVkZ2UtcGF0dGVybi1zb2xpZCBmbG93Y2hhcnQtbGluayBMUy1yZWZlcmVuY2UgTEUtcXVhbnRpdHkiIGlkPSJMLXJlZmVyZW5jZS1xdWFudGl0eS0wIiBkPSJNNzQuODQ0LDI0MUw3NC44NDQsMjQ1LjE2N0M3NC44NDQsMjQ5LjMzMyw3NC44NDQsMjU3LjY2Nyw4Mi4zMTgsMjY2Qzg5Ljc5MywyNzQuMzMzLDEwNC43NDIsMjgyLjY2NywxMTIuMjE2LDI4Ni44MzNMMTE5LjY5MSwyOTEiPjwvcGF0aD48cGF0aCBzdHlsZT0iZmlsbDpub25lOyIgY2xhc3M9ImVkZ2UtdGhpY2tuZXNzLW5vcm1hbCBlZGdlLXBhdHRlcm4tc29saWQgZmxvd2NoYXJ0LWxpbmsgTFMtbnVtYmVyIExFLXF1YW50aXR5IiBpZD0iTC1udW1iZXItcXVhbnRpdHktMCIgZD0iTTIzNC41LDIyOUwyMzQuNSwyMzUuMTY3QzIzNC41LDI0MS4zMzMsMjM0LjUsMjUzLjY2NywyMjcuMDI1LDI2NEMyMTkuNTUxLDI3NC4zMzMsMjA0LjYwMiwyODIuNjY3LDE5Ny4xMjcsMjg2LjgzM0wxODkuNjUzLDI5MSI+PC9wYXRoPjwvZz48ZyBjbGFzcz0iZWRnZUxhYmVscyI+PGcgY2xhc3M9ImVkZ2VMYWJlbCI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCwgMCkiIGNsYXNzPSJsYWJlbCI+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSIwIiB3aWR0aD0iMCI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPjxzcGFuIGNsYXNzPSJlZGdlTGFiZWwiPjwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48ZyBjbGFzcz0iZWRnZUxhYmVsIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLCAwKSIgY2xhc3M9ImxhYmVsIj48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjAiIHdpZHRoPSIwIj48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+PHNwYW4gY2xhc3M9ImVkZ2VMYWJlbCI+PC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIGNsYXNzPSJlZGdlTGFiZWwiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAsIDApIiBjbGFzcz0ibGFiZWwiPjxmb3JlaWduT2JqZWN0IGhlaWdodD0iMCIgd2lkdGg9IjAiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0iZWRnZUxhYmVsIj48L3NwYW4+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+PGcgY2xhc3M9ImVkZ2VMYWJlbCI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCwgMCkiIGNsYXNzPSJsYWJlbCI+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSIwIiB3aWR0aD0iMCI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPjxzcGFuIGNsYXNzPSJlZGdlTGFiZWwiPjwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48L2c+PGcgY2xhc3M9Im5vZGVzIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSg3NC44NDM3NSwgMTkuNSkiIGlkPSJmbG93Y2hhcnQtZGltZW5zaW9uLTM5NiIgY2xhc3M9Im5vZGUgZGVmYXVsdCBkZWZhdWx0IGZsb3djaGFydC1sYWJlbCI+PHJlY3QgaGVpZ2h0PSIzOSIgd2lkdGg9Ijg3LjU5Mzc1IiB5PSItMTkuNSIgeD0iLTQzLjc5Njg3NSIgcnk9IjAiIHJ4PSIwIiBzdHlsZT0iIiBjbGFzcz0iYmFzaWMgbGFiZWwtY29udGFpbmVyIj48L3JlY3Q+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTM2LjI5Njg3NSwgLTEyKSIgc3R5bGU9IiIgY2xhc3M9ImxhYmVsIj48cmVjdD48L3JlY3Q+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSIyNCIgd2lkdGg9IjcyLjU5Mzc1Ij48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+PHNwYW4gY2xhc3M9Im5vZGVMYWJlbCI+ZGltZW5zaW9uPC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDc0Ljg0Mzc1LCAxMDguNSkiIGlkPSJmbG93Y2hhcnQtcXVhbnRpdHlfdHlwZS0zOTciIGNsYXNzPSJub2RlIGRlZmF1bHQgZGVmYXVsdCBmbG93Y2hhcnQtbGFiZWwiPjxyZWN0IGhlaWdodD0iMzkiIHdpZHRoPSIxMTEuNjQwNjI1IiB5PSItMTkuNSIgeD0iLTU1LjgyMDMxMjUiIHJ5PSIwIiByeD0iMCIgc3R5bGU9IiIgY2xhc3M9ImJhc2ljIGxhYmVsLWNvbnRhaW5lciI+PC9yZWN0PjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC00OC4zMjAzMTI1LCAtMTIpIiBzdHlsZT0iIiBjbGFzcz0ibGFiZWwiPjxyZWN0PjwvcmVjdD48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjI0IiB3aWR0aD0iOTYuNjQwNjI1Ij48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+PHNwYW4gY2xhc3M9Im5vZGVMYWJlbCI+cXVhbnRpdHkgdHlwZTwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSg3NC44NDM3NSwgMjA5LjUpIiBpZD0iZmxvd2NoYXJ0LXJlZmVyZW5jZS0zOTkiIGNsYXNzPSJub2RlIGRlZmF1bHQgZGVmYXVsdCBmbG93Y2hhcnQtbGFiZWwiPjxyZWN0IGhlaWdodD0iNjMiIHdpZHRoPSIxNDkuNjg3NSIgeT0iLTMxLjUiIHg9Ii03NC44NDM3NSIgcnk9IjAiIHJ4PSIwIiBzdHlsZT0iIiBjbGFzcz0iYmFzaWMgbGFiZWwtY29udGFpbmVyIj48L3JlY3Q+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTY3LjM0Mzc1LCAtMjQpIiBzdHlsZT0iIiBjbGFzcz0ibGFiZWwiPjxyZWN0PjwvcmVjdD48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjQ4IiB3aWR0aD0iMTM0LjY4NzUiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0ibm9kZUxhYmVsIj5xdWFudGl0eSByZWZlcmVuY2U8YnIvPihlLmcuIHVuaXQpPC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE1NC42NzE4NzUsIDMxMC41KSIgaWQ9ImZsb3djaGFydC1xdWFudGl0eS00MDEiIGNsYXNzPSJub2RlIGRlZmF1bHQgZGVmYXVsdCBmbG93Y2hhcnQtbGFiZWwiPjxyZWN0IGhlaWdodD0iMzkiIHdpZHRoPSI3NC45NTMxMjUiIHk9Ii0xOS41IiB4PSItMzcuNDc2NTYyNSIgcnk9IjAiIHJ4PSIwIiBzdHlsZT0iIiBjbGFzcz0iYmFzaWMgbGFiZWwtY29udGFpbmVyIj48L3JlY3Q+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTI5Ljk3NjU2MjUsIC0xMikiIHN0eWxlPSIiIGNsYXNzPSJsYWJlbCI+PHJlY3Q+PC9yZWN0Pjxmb3JlaWduT2JqZWN0IGhlaWdodD0iMjQiIHdpZHRoPSI1OS45NTMxMjUiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0ibm9kZUxhYmVsIj5xdWFudGl0eTwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMzQuNSwgMjA5LjUpIiBpZD0iZmxvd2NoYXJ0LW51bWJlci00MDIiIGNsYXNzPSJub2RlIGRlZmF1bHQgZGVmYXVsdCBmbG93Y2hhcnQtbGFiZWwiPjxyZWN0IGhlaWdodD0iMzkiIHdpZHRoPSI2OS42MjUiIHk9Ii0xOS41IiB4PSItMzQuODEyNSIgcnk9IjAiIHJ4PSIwIiBzdHlsZT0iIiBjbGFzcz0iYmFzaWMgbGFiZWwtY29udGFpbmVyIj48L3JlY3Q+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTI3LjMxMjUsIC0xMikiIHN0eWxlPSIiIGNsYXNzPSJsYWJlbCI+PHJlY3Q+PC9yZWN0Pjxmb3JlaWduT2JqZWN0IGhlaWdodD0iMjQiIHdpZHRoPSI1NC42MjUiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0ibm9kZUxhYmVsIj5udW1iZXI8L3NwYW4+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+PC9nPjwvZz48L2c+PC9zdmc+" style="display: block; margin-left: auto; margin-right: auto; width: 30%;" /></p>
<p><em>Note: A more detailed graph of framework’s entities can be found
in the <a href="#framework-entities">Framework entities</a>
chapter.</em></p>
<h2 data-number="9.1" id="dimension"><span class="header-section-number">9.1</span> Dimension<a href="#dimension" class="self-link"></a></h2>
<p><a href="https://jcgm.bipm.org/vim/en/1.7.html">Dimension</a>
specifies the dependence of a quantity on the base quantities of a
particular system of quantities. It is represented as a product of
powers of factors corresponding to the base quantities, omitting any
numerical factor.</p>
<p>Even though ISO does not officially define those, we find the below
terms useful when discussing the domain and its C++ implementation:</p>
<ul>
<li><strong>base dimension</strong> is the dimension of a <a href="https://jcgm.bipm.org/vim/en/1.4.html">base quantity</a>,</li>
<li><strong>derived dimension</strong> is the dimension of a <a href="https://jcgm.bipm.org/vim/en/1.5.html">derived quantity</a>.</li>
</ul>
<p>As stated above, ISO does not mention a “base dimension” term.
Nevertheless, it treats dimensions of base quantities in a special way
by:</p>
<ul>
<li>assigning unique identifiers/symbols to all of them,</li>
<li>stating that derived quantities have a dimension being a product of
dimensions of base quantities.</li>
</ul>
<p>For example:</p>
<ul>
<li><em>length</em> (<span class="math inline">\(L\)</span>),
<em>mass</em> (<span class="math inline">\(M\)</span>), <em>time</em>
(<span class="math inline">\(T\)</span>), <em>electric current</em>
(<span class="math inline">\(I\)</span>), <em>thermodynamic
temperature</em> (<span class="math inline">\(Θ\)</span>), <em>amount of
substance</em> (<span class="math inline">\(N\)</span>), and
<em>luminous intensity</em> (<span class="math inline">\(J\)</span>) are
the base dimensions of the ISQ.</li>
<li>A derived dimension of <em>force</em> in the ISQ is denoted by <span class="math inline">\(dim\;F = LMT^{–2}\)</span>.</li>
<li><span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span>
(part 13) provides <em>traffic intensity</em> quantity that is measured
in erlangs but not in the unit one, which also implies that it should be
introduced as a base quantity with its own dimension.</li>
</ul>
<h2 data-number="9.2" id="quantity-type"><span class="header-section-number">9.2</span> Quantity type<a href="#quantity-type" class="self-link"></a></h2>
<p>Dimension is not enough to describe a quantity. This is why <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span> provides hundreds of
named quantity types. It turns out that there are many more quantity
types in the ISQ than the named units in the <span class="citation" data-cites="SI">[<a href="#ref-SI" role="doc-biblioref">SI</a>]</span>.</p>
<p><span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span> also defines the term
<strong>kind of quantity</strong> as an aspect common to mutually
comparable quantities. It explicitly says that two or more quantities
cannot be added or subtracted unless they belong to the same category of
mutually comparable quantities.</p>
<p>Quantities might be:</p>
<ul>
<li>of different dimensions (e.g., <em>length</em>, <em>time</em>,
<em>speed</em>, <em>power</em>),</li>
<li>of the same dimension but of a different kind (e.g., <em>work</em>
vs. <em>torque</em>, <em>frequency</em> vs. <em>activity</em>,
<em>area</em> vs. <em>fuel consumption</em>),</li>
<li>of the same dimension and kind but still distinct (e.g.,
<em>radius</em> vs. <em>width</em> vs. <em>height</em> or <em>potential
energy</em> vs. <em>kinetic energy</em> vs. <em>thermodynamic
energy</em>).</li>
</ul>
<p>Additionally, ISO explicitly specifies a quantity of dimension one,
which is commonly known as a dimensionless quantity. It is a quantity
for which all the exponents of the factors corresponding to the base
quantities in its quantity dimension are zero. Typically, they represent
ratios of two quantities of the same dimension or counts of things.</p>
<h2 data-number="9.3" id="quantity-reference"><span class="header-section-number">9.3</span> Quantity reference<a href="#quantity-reference" class="self-link"></a></h2>
<p><span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span> defines a quantity
as:</p>
<blockquote>
<p>property of a phenomenon, body, or substance, where the property has
a magnitude that can be expressed as a number and a reference.</p>
<p>NOTE 2 A reference can be a measurement unit, a measurement
procedure, a reference material, or a combination of such.</p>
</blockquote>
<p>The term “reference” is repeated several times in that ISO
specification. For example:</p>
<ul>
<li><p>quantity value is defined as:</p>
<blockquote>
<p>Number and reference together expressing magnitude of a quantity.</p>
</blockquote></li>
<li><p>numerical quantity value is defined as:</p>
<blockquote>
<p>Number in the expression of a quantity value, other than any number
serving as the reference</p>
</blockquote></li>
</ul>
<p>We realize that the term “reference” might be overloaded in the C++
domain. However, preserving the official metrology terminology here is
still worth trying.</p>
<p>Measurement units are designated by conventionally assigned names and
symbols.</p>
<p>Measurement units of quantities of the same quantity dimension may be
designated by the same name and symbol even when the quantities are not
of the same kind. For example, joule per kelvin and J/K are,
respectively, the name and symbol of both a measurement unit of <em>heat
capacity</em> and a measurement unit of <em>entropy</em>, which are
generally considered to not be quantities of the same kind.</p>
<p>However, in some cases, special measurement unit names are restricted
to be used with quantities of specific kind only. For example, the
measurement unit ‘second to the power minus one’ (1/s) is called hertz
(Hz) when used for <em>frequencies</em> and becquerel (Bq) when used for
<em>activities of radionuclides</em>.</p>
<p>Measurement units of quantities of dimension one are numbers. In some
cases, these measurement units are given special names, e.g., radian,
steradian, and decibel, or are expressed by quotients such as millimole
per mole equal to <span class="math inline">\(10^{−3}\)</span> and
microgram per kilogram equal to <span class="math inline">\(10^{−9}\)</span>.</p>
<h2 data-number="9.4" id="quantity"><span class="header-section-number">9.4</span> Quantity<a href="#quantity" class="self-link"></a></h2>
<p>As stated above, <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span>
defines a quantity as:</p>
<blockquote>
<p>property of a phenomenon, body, or substance, where the property has
a magnitude that can be expressed as a number and a reference.</p>
</blockquote>
<p>The above means that a quantity abstraction should store a runtime
value representing the quantity numerical value and a reference that
might be represented as a unit. It is a common practice to embed a
reference into the C++ type expressing the quantity so it does not
occupy a space/storage at runtime.</p>
<p>It is also worth mentioning here that the distinction between a
quantity and a quantity type is not clearly defined in <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span>. <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span> even explicitly
states:</p>
<blockquote>
<p>It is customary to use the same term, “quantity”, to refer to both
general quantities, such as length, mass, etc., and their instances,
such as given lengths, given masses, etc. Accordingly, we are used to
saying both that length is a quantity and that a given length is a
quantity, by maintaining the specification – “general quantity, <span class="math inline">\(Q\)</span>” or “individual quantity, <span class="math inline">\(Q_a\)</span>” – implicit and exploiting the
linguistic context to remove the ambiguity.</p>
</blockquote>
<p>To prevent such ambiguities in this document, we will consistently
use the term:</p>
<ul>
<li>“quantity type” when we mean a general quantity,</li>
<li>“quantity” when we mean the instance of a quantity that also stores
its numerical value.</li>
</ul>
<p>It is also worth mentioning here that <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span> does not distinguish
between point and vector/interval quantities of <a href="#the-affine-space">The affine space</a>.</p>
<h1 data-number="10" id="api-overview"><span class="header-section-number">10</span> API overview<a href="#api-overview" class="self-link"></a></h1>
<p>This chapter is intended to be a short overview and present the
proposed library’s final look and feel. We start with the most
straightforward use cases and gradually introduce more complex
abstractions. Thanks to that, the readers can assess the <a href="#teachability">Teachability</a> effort of this library by
themselves.</p>
<p>More details about the design, rationale for it, and alternative
syntaxes discussions can be found in the <a href="#design-details-and-rationale">Design details and rationale</a>
chapter.</p>
<h2 data-number="10.1" id="unit-based-quantities-simple-mode"><span class="header-section-number">10.1</span> Unit-based quantities (simple
mode)<a href="#unit-based-quantities-simple-mode" class="self-link"></a></h2>
<p>Consistently with a <a href="#quantity">Quantity</a> definition, a
<code class="sourceCode default">quantity</code> class template takes a
reference and a representation type as parameters:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span>Reference <span class="kw">auto</span> R,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>         RepresentationOf<span class="op">&lt;</span>get_quantity_spec<span class="op">(</span>R<span class="op">).</span>character<span class="op">&gt;</span> Rep <span class="op">=</span> <span class="dt">double</span><span class="op">&gt;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> quantity;</span></code></pre></div>
<h3 data-number="10.1.1" id="constructing-a-quantity"><span class="header-section-number">10.1.1</span> Constructing a quantity<a href="#constructing-a-quantity" class="self-link"></a></h3>
<p>If we want to set a value for a quantity, we always have to provide a
number and a unit:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>si<span class="op">::</span>metre, <span class="dt">int</span><span class="op">&gt;</span> q<span class="op">{</span><span class="dv">42</span>, si<span class="op">::</span>metre<span class="op">}</span>;</span></code></pre></div>
<p>In case a quantity class template should use exactly the same unit
and a representation type as provided in the initializer, it is
recommended to use CTAD:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>quantity q<span class="op">{</span><span class="dv">42</span>, si<span class="op">::</span>metre<span class="op">}</span>;</span></code></pre></div>
<p>Please, note that <code class="sourceCode default">double</code> is
used as a default representation type, so the following does not result
with a quantity of integral representation type:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>si<span class="op">::</span>metre<span class="op">&gt;</span> q2<span class="op">{</span><span class="dv">42</span>, si<span class="op">::</span>metre<span class="op">}</span>;</span></code></pre></div>
<p>This is why CTAD usage is recommended when the user wants to prevent
potential conversion and just deduce the
<code class="sourceCode default">quantity</code> class template
parameters from the initializer. This often prevents unneeded
conversions that can affect runtime performance or memory footprint.</p>
<p>CTAD-based spelling is shorter but is still quite verbose. Consider
having to write:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>quantity q <span class="op">=</span> quantity<span class="op">{</span><span class="dv">1</span>, si<span class="op">::</span>kilo<span class="op">&lt;</span>si<span class="op">::</span>metre<span class="op">&gt;}</span> <span class="op">+</span> quantity<span class="op">{</span><span class="dv">200</span>, si<span class="op">::</span>metre<span class="op">}</span>;</span></code></pre></div>
<p>This is why the library offers an alternative way to construct a
quantity.</p>
<p>The <span class="citation" data-cites="SI">[<a href="#ref-SI" role="doc-biblioref">SI</a>]</span> says:</p>
<blockquote>
<p>The value of the quantity is the product of the number and the unit.
The space between the number and the unit is regarded as a
multiplication sign (just as a space between units implies
multiplication).</p>
</blockquote>
<p>Following the above, the value of a quantity can also be created by
multiplying a number with a predefined unit:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>quantity q <span class="op">=</span> <span class="dv">42</span> <span class="op">*</span> si<span class="op">::</span>metre;</span></code></pre></div>
<p>The above creates an instance of
<code class="sourceCode default">quantity&lt;si::metre(), int&gt;</code>.
It is worth noting here that the syntax with the reversed order of
arguments is invalid and will not compile (e.g., we can’t write
<code class="sourceCode default">si::metre * 42</code>).</p>
<p>The same can be obtained using an optional unit symbol:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> si<span class="op">::</span>unit_symbols;</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>quantity q <span class="op">=</span> <span class="dv">42</span> <span class="op">*</span> m;</span></code></pre></div>
<p>Unit symbols introduce a lot of short identifiers into the current
scope, which is why they are opt-in. A user has to explicitly “import”
them from a dedicated
<code class="sourceCode default">unit_symbols</code> namespace.</p>
<p><span class="citation" data-cites="SI">[<a href="#ref-SI" role="doc-biblioref">SI</a>]</span> specifies 7 base and 22 coherent
derived units with special names. Additionally, it specifies 24
prefixes. There are also non-SI units accepted for use with SI. Some of
them are really popular, for example, minute, hour, day, degree, litre,
hectare, tonne. All of those entities compose to allow the creation of a
vast number of various derived units.</p>
<p>For example, we can create a quantity of speed with either:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>quantity speed1 <span class="op">=</span> <span class="dv">60</span> <span class="op">*</span> si<span class="op">::</span>kilo<span class="op">&lt;</span>si<span class="op">::</span>metre<span class="op">&gt;</span> <span class="op">/</span> non_si<span class="op">::</span>hour;</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>quantity speed2 <span class="op">=</span> <span class="dv">60</span> <span class="op">*</span> km <span class="op">/</span> h;</span></code></pre></div>
<p>In case a complex derived unit is used a lot in the project, for
convenience, a user can quickly provide a nicely named wrapper for it
with:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">constexpr</span> <span class="kw">auto</span> kmph <span class="op">=</span> si<span class="op">::</span>kilo<span class="op">&lt;</span>si<span class="op">::</span>metre<span class="op">&gt;</span> <span class="op">/</span> non_si<span class="op">::</span>hour;</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>quantity speed3 <span class="op">=</span> <span class="dv">60</span> <span class="op">*</span> kmph;</span></code></pre></div>
<p>The library is optimized to generate short and easy-to-understand
types that highly improve the analysis of compile-time errors and
debugging experience. All of the above definitions will create an
instance of the type <code class="sourceCode default">quantity&lt;derived_unit&lt;si::kilo_&lt;si::metre&gt;, per&lt;non_si::hour&gt;&gt;{}, int&gt;&gt;</code>.
As we can see, the type generation is optimized to be easily understood
even by non-experts in the domain. The library tries to keep the type’s
readability as close to English as possible.</p>
<h3 data-number="10.1.2" id="typical-operations-on-quantities"><span class="header-section-number">10.1.2</span> Typical operations on
quantities<a href="#typical-operations-on-quantities" class="self-link"></a></h3>
<p>Various quantities can be multiplied or divided to obtain other
derived quantities. Quantities of the same kind can be added,
subtracted, and compared to each other. Quantities can also be easily
printed with output streams or formatting facilities.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>quantity dist1 <span class="op">=</span> <span class="dv">80</span> <span class="op">*</span> km;</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>quantity dist2 <span class="op">=</span> <span class="dv">105</span> <span class="op">*</span> km;</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>quantity duration <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> h;</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>quantity speed_limit <span class="op">=</span> <span class="dv">100</span> <span class="op">*</span> km <span class="op">/</span> h;</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">((</span>dist1 <span class="op">+</span> dist2<span class="op">)</span> <span class="op">/</span> duration <span class="op">&lt;</span> speed_limit<span class="op">)</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;Thanks for driving within the speed limit of &quot;</span> <span class="op">&lt;&lt;</span> speed_limit <span class="op">&lt;&lt;</span> <span class="st">&quot; :-)</span><span class="sc">\n</span><span class="st">&quot;</span>;</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;Slow down! The speed limit here is {}!&quot;</span>, speed_limit<span class="op">)</span>;</span></code></pre></div>
<p>The above prints:</p>
<pre class="text"><code>Thanks for driving within the speed limit of 100 km/h :-)</code></pre>
<h4 data-number="10.1.2.1" id="unit-conversions"><span class="header-section-number">10.1.2.1</span> Unit conversions<a href="#unit-conversions" class="self-link"></a></h4>
<p>If we want to change the unit of a current quantity, we can use
<code class="sourceCode default">.in(Unit)</code> member function:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;The total distance in meters is &quot;</span> <span class="op">&lt;&lt;</span> <span class="op">(</span>dist1 <span class="op">+</span> dist2<span class="op">).</span>in<span class="op">(</span>m<span class="op">)</span> <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>;</span></code></pre></div>
<p>Trying to do the same for
<code class="sourceCode default">speed_limit</code> is invalid and will
result in a compile time error stating that the member function
<code class="sourceCode default">.in()</code> was not found. This is
caused by the fact that the scaling of an integral type by a rational or
irrational factor is considered not value-preserving. To force such a
conversion, we can use either a
<code class="sourceCode default">.force_in(Unit)</code> member function
or an explicit
<code class="sourceCode default">value_cast&lt;Unit&gt;(Quantity)</code>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;The speed limit in m/s is &quot;</span> <span class="op">&lt;&lt;</span> speed_limit<span class="op">.</span>force_in<span class="op">(</span>m <span class="op">/</span> s<span class="op">)</span> <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>;</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;The speed limit in m/s is &quot;</span> <span class="op">&lt;&lt;</span> value_cast<span class="op">&lt;</span>m <span class="op">/</span> s<span class="op">&gt;(</span>speed_limit<span class="op">)</span> <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>;</span></code></pre></div>
<p>We will get a truncated value of
<code class="sourceCode default">27 m/s</code> in both cases.</p>
<p>To prevent truncation, we must explicitly change the quantity
representation type to a value-preserving one with <code class="sourceCode default">value_cast&lt;Representation&gt;(Quantity)</code>
overload. For example:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;The speed limit in m/s is &quot;</span> <span class="op">&lt;&lt;</span> value_cast<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span>speed_limit<span class="op">).</span>in<span class="op">(</span>m <span class="op">/</span> s<span class="op">)</span> <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>;</span></code></pre></div>
<p>This time, we will see the following in the text output:</p>
<pre class="text"><code>The speed limit in m/s is 27.7778 m/s</code></pre>
<h4 data-number="10.1.2.2" id="obtaining-a-numerical-value-of-a-quantity"><span class="header-section-number">10.1.2.2</span> Obtaining a numerical
value of a quantity<a href="#obtaining-a-numerical-value-of-a-quantity" class="self-link"></a></h4>
<p>Last but not least, if we need to obtain the numerical value of a
quantity and pass it to some the legacy unsafe interface, we can use
either <code class="sourceCode default">.numerical_value_in(Unit)</code>
or
<code class="sourceCode default">.force_numerical_value_in(Unit)</code>
member functions:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> legacy_check_speed_limit<span class="op">(</span><span class="dt">int</span> speed_in_km_per_h<span class="op">)</span>;</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>legacy_check_speed_limit<span class="op">(((</span>dist1 <span class="op">+</span> dist2<span class="op">)</span> <span class="op">/</span> duration<span class="op">).</span>numerical_value_in<span class="op">(</span>km <span class="op">/</span> h<span class="op">))</span>;</span></code></pre></div>
<p>Such a getter will explicitly enforce the usage of a correct unit
required by the underlying interface, which reduces a significant number
of safety-related issues.</p>
<p><code class="sourceCode default">numerical_value_in(Unit)</code>
always returns by value as a quantity value conversion may be required
to adjust to the target unit. In case a user needs a reference to the
underlying storage
<code class="sourceCode default">.numerical_value_ref_in(Unit)</code>
should be used:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> legacy_set_speed_limit<span class="op">(</span><span class="dt">int</span><span class="op">*</span> speed_in_km_per_h<span class="op">)</span> <span class="op">{</span> <span class="op">*</span>speed_in_km_per_h <span class="op">=</span> <span class="dv">100</span>; <span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>km <span class="op">/</span> h, <span class="dt">int</span><span class="op">&gt;</span> speed_limit;</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>legacy_set_speed_limit<span class="op">(&amp;</span>speed_limit<span class="op">.</span>numerical_value_ref_in<span class="op">(</span>km <span class="op">/</span> h<span class="op">))</span>;</span></code></pre></div>
<p>This member function again requires a target unit to enforce safety.
This overload does not participate in overload resolution if the
provided unit has a different scaling factor than the current one.</p>
<h2 data-number="10.2" id="typed-quantities-safer-mode"><span class="header-section-number">10.2</span> Typed quantities (safer
mode)<a href="#typed-quantities-safer-mode" class="self-link"></a></h2>
<p>Simple mode is all about and just about units. In case we care about
a specific quantity type, typed quantities should be preferred. Those
store information not only about a unit but also about a specific
quantity type we want to model.</p>
<p>There a few ways to obtain such a quantity:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>isq<span class="op">::</span>height<span class="op">[</span>m<span class="op">]</span>, <span class="dt">int</span><span class="op">&gt;</span> q1 <span class="op">=</span> <span class="dv">42</span> <span class="op">*</span> m;</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>quantity q2<span class="op">{</span><span class="dv">42</span>, isq<span class="op">::</span>height<span class="op">[</span>m<span class="op">]}</span>;</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>quantity q3 <span class="op">=</span> <span class="dv">42</span> <span class="op">*</span> isq<span class="op">::</span>height<span class="op">[</span>m<span class="op">]</span>;</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>quantity q4 <span class="op">=</span> isq<span class="op">::</span>height<span class="op">(</span><span class="dv">42</span> <span class="op">*</span> m<span class="op">)</span>;</span></code></pre></div>
<p>All of the above cases use a slightly different approach to get the
quantity, but all of them result in exactly the same
<code class="sourceCode default">quantity</code> class template
instantiation.</p>
<p>In the above examples, an expression of
<code class="sourceCode default">isq::height[m]</code> is called a
quantity reference and results in <code class="sourceCode default">reference&lt;isq::height, si::metre&gt;</code>
class template instantiation.</p>
<p><em>Note: The identifier
<code class="sourceCode default">reference</code> is being used in the
<span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span> library but definitely will
need bikeshedding during the standardization process.</em></p>
<p>More about typed quantities can be found in the following
chapters:</p>
<ul>
<li><a href="#why-do-we-need-typed-quantities">Why do we need typed
quantities?</a> provides a detailed rationale.</li>
<li><a href="#systems-of-quantities">Systems of quantities</a> describes
their conversion and arithmetic rules.</li>
<li><a href="#constraining-a-derived-unit-to-work-only-with-a-specific-derived-quantity">Constraining
a derived unit to work only with a specific derived quantity</a>
provides a solution to the problem of units of quantities different
kinds but the same dimension.</li>
</ul>
<h2 data-number="10.3" id="generic-interfaces"><span class="header-section-number">10.3</span> Generic interfaces<a href="#generic-interfaces" class="self-link"></a></h2>
<p>Using a concrete unit in the interface often has a lot of sense. It
is especially useful if we store the data internally in the object. In
such a case, we have to select a specific unit anyway.</p>
<p>For example, let’s consider a simple storage tank:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> StorageTank <span class="op">{</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  quantity<span class="op">&lt;</span>horizontal_area<span class="op">[</span>m2<span class="op">]&gt;</span> base_;</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  quantity<span class="op">&lt;</span>isq<span class="op">::</span>height<span class="op">[</span>m<span class="op">]&gt;</span> height_;</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  quantity<span class="op">&lt;</span>isq<span class="op">::</span>mass_density<span class="op">[</span>kg <span class="op">/</span> m3<span class="op">]&gt;</span> density_ <span class="op">=</span> air_density;</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span><span class="op">:</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">constexpr</span> StorageTank<span class="op">(</span><span class="kw">const</span> quantity<span class="op">&lt;</span>horizontal_area<span class="op">[</span>m2<span class="op">]&gt;&amp;</span> base, <span class="kw">const</span> quantity<span class="op">&lt;</span>isq<span class="op">::</span>height<span class="op">[</span>m<span class="op">]&gt;&amp;</span> height<span class="op">)</span> <span class="op">:</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>      base_<span class="op">(</span>base<span class="op">)</span>, height_<span class="op">(</span>height<span class="op">)</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="op">{</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ...</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>;</span></code></pre></div>
<p>As the quantities provided in the function’s interface are then
stored in the class, there is probably no sense in using generic
interfaces here.</p>
<h3 data-number="10.3.1" id="the-issues-with-unit-specific-interfaces"><span class="header-section-number">10.3.1</span> The issues with
unit-specific interfaces<a href="#the-issues-with-unit-specific-interfaces" class="self-link"></a></h3>
<p>However, in many cases, using a specific unit in the interface is
counterproductive. Let’s consider the following function:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>km <span class="op">/</span> h<span class="op">&gt;</span> avg_speed<span class="op">(</span>quantity<span class="op">&lt;</span>km<span class="op">&gt;</span> distance, quantity<span class="op">&lt;</span>h<span class="op">&gt;</span> duration<span class="op">)</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> distance <span class="op">/</span> duration;</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Everything seems fine for now. It also works great if we call it
with:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>km <span class="op">/</span> h<span class="op">&gt;</span> s1 <span class="op">=</span> avg_speed<span class="op">(</span><span class="dv">220</span> <span class="op">*</span> km, <span class="dv">2</span> <span class="op">*</span> h<span class="op">)</span>;</span></code></pre></div>
<p>However, if the user starts doing the following:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>mi <span class="op">/</span> h<span class="op">&gt;</span> s2 <span class="op">=</span> avg_speed<span class="op">(</span><span class="dv">140</span> <span class="op">*</span> mi, <span class="dv">2</span> <span class="op">*</span> h<span class="op">)</span>;</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>m <span class="op">/</span> s<span class="op">&gt;</span> s3 <span class="op">=</span> avg_speed<span class="op">(</span><span class="dv">20</span> <span class="op">*</span> m, <span class="dv">2</span> <span class="op">*</span> s<span class="op">)</span>;</span></code></pre></div>
<p>some issues start to be clearly visible:</p>
<ol type="1">
<li><p>The arguments must be converted to units mandated by the
function’s parameters at each call. This involves potentially expensive
multiplication/division operations at runtime.</p></li>
<li><p>After the function returns the speed in a unit of
<code class="sourceCode default">km/h</code>, another potentially
expensive multiplication/division operations have to be performed to
convert the resulting quantity into a unit being the derived unit of the
initial function’s arguments.</p></li>
<li><p>Besides the obvious runtime cost, some unit conversions may
result in a data truncation, which means that the result will not be
exactly equal to a direct division of the function’s arguments.</p></li>
<li><p>We have to use a floating-point representation type (the
<code class="sourceCode default">quantity</code> class template by
default uses <code class="sourceCode default">double</code> as a
representation type) which is considered value preserving. Trying to use
an integral type in this scenario will work only for
<code class="sourceCode default">s1</code>, while
<code class="sourceCode default">s2</code> and
<code class="sourceCode default">s3</code> will fail to compile. Failing
to compile is a good thing here as the library tries to prevent the user
from doing a clearly wrong thing. To make the code compile, the user
needs to use dedicated
<code class="sourceCode default">value_cast</code> or
<code class="sourceCode default">force_in</code> like this:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>mi <span class="op">/</span> h<span class="op">&gt;</span> s2 <span class="op">=</span> avg_speed<span class="op">(</span>value_cast<span class="op">&lt;</span>km<span class="op">&gt;(</span><span class="dv">140</span> <span class="op">*</span> mi<span class="op">)</span>, <span class="dv">2</span> <span class="op">*</span> h<span class="op">)</span>;</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>m <span class="op">/</span> s<span class="op">&gt;</span> s3 <span class="op">=</span> avg_speed<span class="op">((</span><span class="dv">20</span> <span class="op">*</span> m<span class="op">).</span>force_in<span class="op">(</span>km<span class="op">)</span>, <span class="op">(</span><span class="dv">2</span> <span class="op">*</span> s<span class="op">).</span>force_in<span class="op">(</span>h<span class="op">))</span>;</span></code></pre></div>
<p>But the above will obviously provide an incorrect behavior (e.g.,
division by <code class="sourceCode default">0</code> in the evaluation
of <code class="sourceCode default">s3</code>).</p></li>
</ol>
<h3 data-number="10.3.2" id="constraining-function-parameters-with-concepts"><span class="header-section-number">10.3.2</span> Constraining function
parameters with concepts<a href="#constraining-function-parameters-with-concepts" class="self-link"></a></h3>
<p>Much better generic code can be implemented using basic concepts
provided with the library:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> avg_speed<span class="op">(</span>QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>length<span class="op">&gt;</span> <span class="kw">auto</span> distance,</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>               QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>time<span class="op">&gt;</span> <span class="kw">auto</span> duration<span class="op">)</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> isq<span class="op">::</span>speed<span class="op">(</span>distance <span class="op">/</span> duration<span class="op">)</span>;</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>This explicitly states that the arguments passed by the user must not
only satisfy a <a href="#Quantity-concept"><code class="sourceCode default">Quantity</code></a>
concept, but also that their quantity specification must be implicitly
convertible to <code class="sourceCode default">isq::length</code> and
<code class="sourceCode default">isq::time</code>, respectively. This no
longer leaves room for error while still allowing the compiler to
generate the most efficient code.</p>
<p>Please, note that now it is safe just to use integral types all the
way, which again improves the runtime performance as the
multiplication/division operations are often faster on integral rather
than floating-point types.</p>
<h3 data-number="10.3.3" id="constraining-the-function-return-type"><span class="header-section-number">10.3.3</span> Constraining the function
return type<a href="#constraining-the-function-return-type" class="self-link"></a></h3>
<p>The above function template resolves all of the issues described
before. However, we can do even better here by additionally constraining
the return type:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>speed<span class="op">&gt;</span> <span class="kw">auto</span> avg_speed<span class="op">(</span>QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>length<span class="op">&gt;</span> <span class="kw">auto</span> distance,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                                      QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>time<span class="op">&gt;</span> <span class="kw">auto</span> duration<span class="op">)</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> isq<span class="op">::</span>speed<span class="op">(</span>distance <span class="op">/</span> duration<span class="op">)</span>;</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Doing so has two important benefits:</p>
<ol type="1">
<li>It informs the users of our interface about what to expect to be the
result of a function invocation. It is superior to just returning
<code class="sourceCode default">auto</code>, which does not provide any
hint about the thing being returned there.</li>
<li>Such a concept constrains the type returned from the function. This
means that it works as a unit test to verify if our function actually
performs what it is supposed to do. If there is an error in the quantity
equation, we will learn about it right away.</li>
</ol>
<h3 data-number="10.3.4" id="constraining-a-variable-on-the-stack"><span class="header-section-number">10.3.4</span> Constraining a variable on
the stack<a href="#constraining-a-variable-on-the-stack" class="self-link"></a></h3>
<p>If we know exactly what the function does in its internals and if we
know the exact argument types passed to such a function, we often know
the exact type that will be returned from its invocation.</p>
<p>However, if we care about performance, we should often use the
generic interfaces described in this chapter. A side effect is that we
sometimes are unsure about the return type. Even if we know it today, it
might change a week from now due to some code refactoring.</p>
<p>In such cases, we can again use
<code class="sourceCode default">auto</code> to denote the type:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> s1 <span class="op">=</span> avg_speed<span class="op">(</span><span class="dv">220</span> <span class="op">*</span> km, <span class="dv">2</span> <span class="op">*</span> h<span class="op">)</span>;</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> s2 <span class="op">=</span> avg_speed<span class="op">(</span><span class="dv">140</span> <span class="op">*</span> mi, <span class="dv">2</span> <span class="op">*</span> h<span class="op">)</span>;</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> s3 <span class="op">=</span> avg_speed<span class="op">(</span><span class="dv">20</span> <span class="op">*</span> m, <span class="dv">2</span> <span class="op">*</span> s<span class="op">)</span>;</span></code></pre></div>
<p>In this case, it is probably OK to do so as the
<code class="sourceCode default">avg_speed</code> function name
explicitly provides the information on what to expect as a result.</p>
<p>In other scenarios where the returned quantity type is not so
obvious, it is again helpful to constrain the type with a concept like
so:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>speed<span class="op">&gt;</span> <span class="kw">auto</span> s1 <span class="op">=</span> avg_speed<span class="op">(</span><span class="dv">220</span> <span class="op">*</span> km, <span class="dv">2</span> <span class="op">*</span> h<span class="op">)</span>;</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>speed<span class="op">&gt;</span> <span class="kw">auto</span> s2 <span class="op">=</span> avg_speed<span class="op">(</span><span class="dv">140</span> <span class="op">*</span> mi, <span class="dv">2</span> <span class="op">*</span> h<span class="op">)</span>;</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>speed<span class="op">&gt;</span> <span class="kw">auto</span> s3 <span class="op">=</span> avg_speed<span class="op">(</span><span class="dv">20</span> <span class="op">*</span> m, <span class="dv">2</span> <span class="op">*</span> s<span class="op">)</span>;</span></code></pre></div>
<p>Again, this explicitly provides additional information about the
quantity we are dealing with in the code, and it serves as a unit test
checking if the “thing” returned from a function is actually what we
expected here.</p>
<h2 data-number="10.4" id="the-affine-space"><span class="header-section-number">10.4</span> The affine space<a href="#the-affine-space" class="self-link"></a></h2>
<p>The affine space has two types of entities:</p>
<ul>
<li><strong><em>point</em></strong> - a position specified with
coordinate values (e.g., location, address, etc.)</li>
<li><strong><em>displacement vectors</em></strong> - the difference
between two points (e.g., shift, offset, displacement, duration,
etc.)</li>
</ul>
<p>The <em>displacement vector</em> described here is specific to the
affine space theory and is not the same thing as the quantity of a
vector character that we discuss later (although, in some cases, those
terms may overlap).</p>
<p>In the following subchapters we will often refer to <em>displacement
vectors</em> simply as <em>vectors</em> for brevity.</p>
<h3 data-number="10.4.1" id="operations-in-the-affine-space"><span class="header-section-number">10.4.1</span> Operations in the affine
space<a href="#operations-in-the-affine-space" class="self-link"></a></h3>
<p>Here are the primary operations one can do in the affine space:</p>
<ul>
<li><em>vector</em> + <em>vector</em> -&gt; <em>vector</em></li>
<li><em>vector</em> - <em>vector</em> -&gt; <em>vector</em></li>
<li>-<em>vector</em> -&gt; <em>vector</em></li>
<li><em>vector</em> * scalar -&gt; <em>vector</em></li>
<li>scalar * <em>vector</em> -&gt; <em>vector</em></li>
<li><em>vector</em> / scalar -&gt; <em>vector</em></li>
<li><em>point</em> - <em>point</em> -&gt; <em>vector</em></li>
<li><em>point</em> + <em>vector</em> -&gt; <em>point</em></li>
<li><em>vector</em> + <em>point</em> -&gt; <em>point</em></li>
<li><em>point</em> - <em>vector</em> -&gt; <em>point</em></li>
</ul>
<p>It is not possible to:</p>
<ul>
<li>add two <em>points</em>,</li>
<li>subtract a <em>point</em> from a <em>vector</em>,</li>
<li>multiply nor divide <em>points</em> with anything else.</li>
</ul>
<h3 data-number="10.4.2" id="points-are-more-common-than-most-of-us-imagine"><span class="header-section-number">10.4.2</span> <em>Points</em> are more
common than most of us imagine<a href="#points-are-more-common-than-most-of-us-imagine" class="self-link"></a></h3>
<p><em>Point</em> abstractions should be used more often in the C++
software. They are not only about <em>temperature</em> or <em>time</em>.
<em>Points</em> are everywhere around us and should become more popular
in the products we implement. They can be used to implement:</p>
<ul>
<li><em>temperature</em> points,</li>
<li>timestamps,</li>
<li>daily <em>mass</em> readouts from the scale,</li>
<li><em>altitudes</em> of mountain peaks on a map,</li>
<li>current <em>speed</em> displayed on a car’s speed-o-meter,</li>
<li>today’s <em>price</em> of instruments on the market,</li>
<li>and many more.</li>
</ul>
<p>Improving the affine space’s <em>Points</em> intuition will allow us
to write better and safer software.</p>
<h3 data-number="10.4.3" id="displacement-vector-is-modeled-by-quantity"><span class="header-section-number">10.4.3</span> <em>Displacement vector</em>
is modeled by <code class="sourceCode default">quantity</code><a href="#displacement-vector-is-modeled-by-quantity" class="self-link"></a></h3>
<p>Up until now, each time when we used a
<code class="sourceCode default">quantity</code> in our code, we were
modeling some kind of a difference between two things:</p>
<ul>
<li>the distance between two points,</li>
<li>duration between two time points,</li>
<li>the difference in speed (even if relative to
<code class="sourceCode default">0</code>).</li>
</ul>
<p>As we already know, a
<code class="sourceCode default">quantity</code> type provides all
operations required for the <em>displacement vector</em> abstraction in
an affine space.</p>
<h3 data-number="10.4.4" id="point-is-modeled-by-quantity_point-and-pointorigin"><span class="header-section-number">10.4.4</span> <em>Point</em> is modeled by
<code class="sourceCode default">quantity_point</code> and
<code class="sourceCode default">PointOrigin</code><a href="#point-is-modeled-by-quantity_point-and-pointorigin" class="self-link"></a></h3>
<p>In the library, the <em>point</em> abstraction is modeled by:</p>
<ul>
<li>the <a href="#PointOrigin-concept"><code class="sourceCode default">PointOrigin</code></a>
concept that specifies a measurement’s origin, and</li>
<li>the <code class="sourceCode default">quantity_point</code> class
template that specifies a <em>point</em> relative to a predefined
origin.</li>
</ul>
<h4 data-number="10.4.4.1" id="quantity_point"><span class="header-section-number">10.4.4.1</span>
<code class="sourceCode default">quantity_point</code><a href="#quantity_point" class="self-link"></a></h4>
<p>The <code class="sourceCode default">quantity_point</code> class
template specifies an absolute quantity measured from a predefined
origin:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span>Reference <span class="kw">auto</span> R,</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>         PointOriginFor<span class="op">&lt;</span>get_quantity_spec<span class="op">(</span>R<span class="op">)&gt;</span> <span class="kw">auto</span> PO <span class="op">=</span> default_point_origin<span class="op">(</span>R<span class="op">)</span>,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>         RepresentationOf<span class="op">&lt;</span>get_quantity_spec<span class="op">(</span>R<span class="op">).</span>character<span class="op">&gt;</span> Rep <span class="op">=</span> <span class="dt">double</span><span class="op">&gt;</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> quantity_point;</span></code></pre></div>
<p>As we can see above, the
<code class="sourceCode default">quantity_point</code> class template
exposes one additional parameter compared to
<code class="sourceCode default">quantity</code>. The
<code class="sourceCode default">PO</code> parameter satisfies a <a href="#PointOriginFor-concept"><code class="sourceCode default">PointOriginFor</code></a>
concept and specifies the origin of our measurement scale.</p>
<p>Each <code class="sourceCode default">quantity_point</code>
internally stores a <code class="sourceCode default">quantity</code>
object which represents a <em>displacement vector</em> from the
predefined origin. Thanks to this, an instantiation of a
<code class="sourceCode default">quantity_point</code> can be considered
as a model of a vector space from such an origin.</p>
<p>Forcing the user to manually predefine an origin for every domain may
be cumbersome and discourage users from using such abstractions at all.
This is why by default, the <code class="sourceCode default">PO</code>
template parameter is initialized with the
<code class="sourceCode default">default_point_origin(R)</code> that
provides the quantity points’ scale zeroth point using the following
rules:</p>
<ul>
<li>if the measurement unit of a quantity specifies its point origin in
its definition (e.g., degree Celsius), then this point is being
used,</li>
<li>otherwise, an instantiation of <code class="sourceCode default">zeroth_point_origin&lt;QuantitySpec&gt;</code>
is being used which provides a well-established zeroth point for a
specific quantity type.</li>
</ul>
<h4 data-number="10.4.4.2" id="zeroth_point_originquantityspec"><span class="header-section-number">10.4.4.2</span> <code class="sourceCode default">zeroth_point_origin&lt;QuantitySpec&gt;</code><a href="#zeroth_point_originquantityspec" class="self-link"></a></h4>
<p><code class="sourceCode default">zeroth_point_origin&lt;QuantitySpec&gt;</code>
is meant to be used in cases where the specific domain has a
well-established non-controversial zeroth point on the measurement
scale. This saves the user from the need of writing a boilerplate code
that would predefine such a type for such domain.</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgoKPHN2ZwogICB3aWR0aD0iOTYuNTE5NDQ3bW0iCiAgIGhlaWdodD0iMTguOTUzNzM1bW0iCiAgIHZpZXdCb3g9IjAgMCA5Ni41MTk0NDcgMTguOTUzNzM1IgogICB2ZXJzaW9uPSIxLjEiCiAgIGlkPSJzdmcxIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnN2Zz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgogIDxkZWZzCiAgICAgaWQ9ImRlZnMxIj4KICAgIDxtYXJrZXIKICAgICAgIHN0eWxlPSJvdmVyZmxvdzp2aXNpYmxlIgogICAgICAgaWQ9IkRhcnRBcnJvdy03IgogICAgICAgcmVmWD0iMCIKICAgICAgIHJlZlk9IjAiCiAgICAgICBvcmllbnQ9ImF1dG8tc3RhcnQtcmV2ZXJzZSIKICAgICAgIG1hcmtlcldpZHRoPSIxIgogICAgICAgbWFya2VySGVpZ2h0PSIxIgogICAgICAgdmlld0JveD0iMCAwIDEgMSIKICAgICAgIHByZXNlcnZlQXNwZWN0UmF0aW89InhNaWRZTWlkIj4KICAgICAgPHBhdGgKICAgICAgICAgc3R5bGU9ImZpbGw6Y29udGV4dC1zdHJva2U7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmUiCiAgICAgICAgIGQ9Ik0gMCwwIDUsLTUgLTEyLjUsMCA1LDUgWiIKICAgICAgICAgdHJhbnNmb3JtPSJzY2FsZSgtMC41KSIKICAgICAgICAgaWQ9InBhdGg2LTQiIC8+CiAgICA8L21hcmtlcj4KICA8L2RlZnM+CiAgPGcKICAgICBpZD0ibGF5ZXIxIgogICAgIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0yNS42ODgwMzEsLTUuMTYxNjU1OCkiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjAuNTtzdHJva2UtZGFzaGFycmF5Om5vbmU7bWFya2VyLWVuZDp1cmwoI0RhcnRBcnJvdy03KSIKICAgICAgIGQ9Ik0gMjUuNjg4MDMxLDIwLjE5MDgwNCBIIDExOC42ODU0OCIKICAgICAgIGlkPSJwYXRoNC0xIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjAuMzgxMjk4O3N0cm9rZS1kYXNoYXJyYXk6bm9uZSIKICAgICAgIGQ9Im0gMzguOTcyNTgyLDE5LjE1MDc0NiB2IDIuMDgwMTE2IgogICAgICAgaWQ9InBhdGg3LTYiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtzdHJva2U6I2E0YTRhNDtzdHJva2Utd2lkdGg6MC4yOTc4MjM7c3Ryb2tlLWRhc2hhcnJheToxLjE5MTI5LCAwLjI5NzgyMztzdHJva2UtZGFzaG9mZnNldDowO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJtIDM4Ljk3MjU4MiwxMC44NzM2MzMgdiA4LjA2Njk2MSIKICAgICAgIGlkPSJwYXRoMi0yLTIiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtzdHJva2U6I2E0YTRhNDtzdHJva2Utd2lkdGg6MC4yOTg7c3Ryb2tlLWRhc2hhcnJheToxLjE5MiwgMC4yOTg7c3Ryb2tlLWRhc2hvZmZzZXQ6MDtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAxMDYuNzAwMjQsNi40NzcwNDkgViAxOC45NDA1OTQiCiAgICAgICBpZD0icGF0aDItMi0xLTAiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtzdHJva2U6I2E0YTRhNDtzdHJva2Utd2lkdGg6MC4yOTg7c3Ryb2tlLWRhc2hhcnJheToxLjE5MiwgMC4yOTg7c3Ryb2tlLWRhc2hvZmZzZXQ6MDtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSA5NC40OTMwMjYsNi40NzcwNDg5IFYgMTguOTQwNTk0IgogICAgICAgaWQ9InBhdGgyLTItMS0wLTAiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MC4zODEyOTg7c3Ryb2tlLWRhc2hhcnJheTpub25lIgogICAgICAgZD0ibSA5NC40OTMwMjYsMTkuMTUwNzQ2IHYgMi4wODAxMTYiCiAgICAgICBpZD0icGF0aDItNS0yIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjAuMzgxMjk4O3N0cm9rZS1kYXNoYXJyYXk6bm9uZSIKICAgICAgIGQ9Im0gMTA2LjcwMDI0LDE5LjE1MDc0NiB2IDIuMDgwMTE2IgogICAgICAgaWQ9InBhdGgyLTUtNy04IiAvPgogICAgPHRleHQKICAgICAgIHhtbDpzcGFjZT0icHJlc2VydmUiCiAgICAgICBzdHlsZT0iZm9udC13ZWlnaHQ6Ym9sZDtmb250LXNpemU6Mi40Njk0NHB4O2ZvbnQtZmFtaWx5OkFyaWFsOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246J0FyaWFsIEJvbGQnO2ZpbGw6IzAwMDAwMDtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MDtzdHJva2UtZGFzaGFycmF5Om5vbmUiCiAgICAgICB4PSIzOC4yOTQ5MzMiCiAgICAgICB5PSIyMy42MDU1MTUiCiAgICAgICBpZD0idGV4dDItMSI+PHRzcGFuCiAgICAgICAgIGlkPSJ0c3BhbjItNCIKICAgICAgICAgc3R5bGU9ImZvbnQtc2l6ZToyLjQ2OTQ0cHg7c3Ryb2tlLXdpZHRoOjA7c3Ryb2tlLWRhc2hhcnJheTpub25lIgogICAgICAgICB4PSIzOC4yOTQ5MzMiCiAgICAgICAgIHk9IjIzLjYwNTUxNSI+MDwvdHNwYW4+PC90ZXh0PgogICAgPHRleHQKICAgICAgIHhtbDpzcGFjZT0icHJlc2VydmUiCiAgICAgICBzdHlsZT0iZm9udC13ZWlnaHQ6Ym9sZDtmb250LXNpemU6Mi40Njk0NHB4O2ZvbnQtZmFtaWx5OkFyaWFsOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246J0FyaWFsIEJvbGQnO2ZpbGw6I2Q0MDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MDtzdHJva2UtZGFzaGFycmF5Om5vbmUiCiAgICAgICB4PSI5Mi40NDM4MDIiCiAgICAgICB5PSIyMy42MjgyNTQiCiAgICAgICBpZD0idGV4dDItMi05Ij48dHNwYW4KICAgICAgICAgaWQ9InRzcGFuMi05LTkiCiAgICAgICAgIHN0eWxlPSJmb250LXNpemU6Mi40Njk0NHB4O2ZpbGw6I2Q0MDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2Utd2lkdGg6MDtzdHJva2UtZGFzaGFycmF5Om5vbmUiCiAgICAgICAgIHg9IjkyLjQ0MzgwMiIKICAgICAgICAgeT0iMjMuNjI4MjU0Ij5xcDE8L3RzcGFuPjwvdGV4dD4KICAgIDx0ZXh0CiAgICAgICB4bWw6c3BhY2U9InByZXNlcnZlIgogICAgICAgc3R5bGU9ImZvbnQtd2VpZ2h0OmJvbGQ7Zm9udC1zaXplOjIuMTE2NjdweDtmb250LWZhbWlseTpBcmlhbDstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOidBcmlhbCBCb2xkJztmaWxsOiNkNDAwMDA7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjA7c3Ryb2tlLWRhc2hhcnJheTpub25lIgogICAgICAgeD0iNjUuNzI0MTI5IgogICAgICAgeT0iMTUuOTAzNzgiCiAgICAgICBpZD0idGV4dDItMi03LTQ5Ij48dHNwYW4KICAgICAgICAgaWQ9InRzcGFuMi05LTAtOTYiCiAgICAgICAgIHN0eWxlPSJmb250LXNpemU6Mi4xMTY2N3B4O2ZpbGw6I2Q0MDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2Utd2lkdGg6MDtzdHJva2UtZGFzaGFycmF5Om5vbmUiCiAgICAgICAgIHg9IjY1LjcyNDEyOSIKICAgICAgICAgeT0iMTUuOTAzNzgiPnExPC90c3Bhbj48L3RleHQ+CiAgICA8dGV4dAogICAgICAgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIKICAgICAgIHN0eWxlPSJmb250LXdlaWdodDpib2xkO2ZvbnQtc2l6ZToyLjQ2OTQ0cHg7Zm9udC1mYW1pbHk6QXJpYWw7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjonQXJpYWwgQm9sZCc7ZmlsbDojMDAwMGRkO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDowO3N0cm9rZS1kYXNoYXJyYXk6bm9uZSIKICAgICAgIHg9IjEwNC41MTIzMyIKICAgICAgIHk9IjIzLjYyODI1NCIKICAgICAgIGlkPSJ0ZXh0Mi0yLTItMzEiPjx0c3BhbgogICAgICAgICBpZD0idHNwYW4yLTktNi00IgogICAgICAgICBzdHlsZT0iZm9udC1zaXplOjIuNDY5NDRweDtmaWxsOiMwMDAwZGQ7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlLXdpZHRoOjA7c3Ryb2tlLWRhc2hhcnJheTpub25lIgogICAgICAgICB4PSIxMDQuNTEyMzMiCiAgICAgICAgIHk9IjIzLjYyODI1NCI+cXAyPC90c3Bhbj48L3RleHQ+CiAgICA8ZwogICAgICAgaWQ9InBhdGg4LTAiPgogICAgICA8cGF0aAogICAgICAgICBzdHlsZT0iY29sb3I6IzAwMDAwMDtmaWxsOiMwMDAwZGQ7LWlua3NjYXBlLXN0cm9rZTpub25lIgogICAgICAgICBkPSJNIDM4Ljg1OTAyNSwxNi45NTg2MjUgSCA5My44ODMyMTMiCiAgICAgICAgIGlkPSJwYXRoMTkiIC8+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJjb2xvcjojMDAwMDAwO2ZpbGw6I2Q0MDAwMDstaW5rc2NhcGUtc3Ryb2tlOm5vbmUiCiAgICAgICAgIGQ9Im0gMzguODU5Mzc1LDE2LjgzMzk4NCB2IDAuMjUgaCA1NS4wMjM0MzcgdiAtMC4yNSB6IgogICAgICAgICBpZD0icGF0aDIwIiAvPgogICAgICA8ZwogICAgICAgICBpZD0iZzE4Ij4KICAgICAgICA8cGF0aAogICAgICAgICAgIHN0eWxlPSJjb2xvcjojMDAwMDAwO2ZpbGw6I2Q0MDAwMDstaW5rc2NhcGUtc3Ryb2tlOm5vbmUiCiAgICAgICAgICAgZD0ibSA5Mi41ODc4OTEsMTYuMDUwNzgxIC0wLjE1ODIwNCwwLjMxNjQwNiAxLjE4MzU5NCwwLjU5MTc5NyAtMS4xODM1OTQsMC41OTE3OTcgMC4xNTgyMDQsMC4zMTY0MDYgMS44MTY0MDYsLTAuOTA4MjAzIHoiCiAgICAgICAgICAgaWQ9InBhdGgxOCIgLz4KICAgICAgPC9nPgogICAgPC9nPgogICAgPHRleHQKICAgICAgIHhtbDpzcGFjZT0icHJlc2VydmUiCiAgICAgICBzdHlsZT0iZm9udC13ZWlnaHQ6Ym9sZDtmb250LXNpemU6Mi4xMTY2N3B4O2ZvbnQtZmFtaWx5OkFyaWFsOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246J0FyaWFsIEJvbGQnO21peC1ibGVuZC1tb2RlOm5vcm1hbDtmaWxsOiNhNGE0YTQ7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjA7c3Ryb2tlLWRhc2hhcnJheTpub25lIgogICAgICAgeD0iOTYuMDMwNTQ4IgogICAgICAgeT0iNi42ODMwMTIiCiAgICAgICBpZD0idGV4dDItMi03LTQ5LTUiPjx0c3BhbgogICAgICAgICBpZD0idHNwYW4yLTktMC05Ni00IgogICAgICAgICBzdHlsZT0iZm9udC1zaXplOjIuMTE2NjdweDtmaWxsOiNhNGE0YTQ7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlLXdpZHRoOjA7c3Ryb2tlLWRhc2hhcnJheTpub25lIgogICAgICAgICB4PSI5Ni4wMzA1NDgiCiAgICAgICAgIHk9IjYuNjgzMDEyIj5xcDIgLSBxcDE8L3RzcGFuPjwvdGV4dD4KICAgIDxnCiAgICAgICBpZD0icGF0aDgtMC05Ij4KICAgICAgPHBhdGgKICAgICAgICAgc3R5bGU9ImNvbG9yOiMwMDAwMDA7ZmlsbDojYTRhNGE0O2ZpbGwtb3BhY2l0eTowLjk2MDc4NDstaW5rc2NhcGUtc3Ryb2tlOm5vbmUiCiAgICAgICAgIGQ9Ik0gOTQuNjY4NjA1LDguMTM0NzI1OSBIIDEwNi4xNTI3IgogICAgICAgICBpZD0icGF0aDEzIiAvPgogICAgICA8cGF0aAogICAgICAgICBzdHlsZT0iY29sb3I6IzAwMDAwMDtmaWxsOiNhNGE0YTQ7ZmlsbC1vcGFjaXR5OjAuOTYwNzg0Oy1pbmtzY2FwZS1zdHJva2U6bm9uZSIKICAgICAgICAgZD0ibSA5NC42Njc5NjksOC4wMDk3NjU2IHYgMC4yNSBoIDExLjQ4NDM3MSB2IC0wLjI1IHoiCiAgICAgICAgIGlkPSJwYXRoMTQiIC8+CiAgICAgIDxnCiAgICAgICAgIGlkPSJnMTIiPgogICAgICAgIDxwYXRoCiAgICAgICAgICAgc3R5bGU9ImNvbG9yOiMwMDAwMDA7ZmlsbDojYTRhNGE0Oy1pbmtzY2FwZS1zdHJva2U6bm9uZSIKICAgICAgICAgICBkPSJtIDEwNC44NTc0Miw3LjIyNjU2MjUgLTAuMTU4MiwwLjMxNjQwNjIgMS4xODM1OSwwLjU5MTc5NjkgLTEuMTgzNTksMC41OTE3OTY5IDAuMTU4MiwwLjMxNjQwNjMgMS44MTY0MSwtMC45MDgyMDMyIHoiCiAgICAgICAgICAgaWQ9InBhdGgxMiIgLz4KICAgICAgPC9nPgogICAgPC9nPgogICAgPGcKICAgICAgIGlkPSJwYXRoMy0yLTYiPgogICAgICA8cGF0aAogICAgICAgICBzdHlsZT0iY29sb3I6IzAwMDAwMDtmaWxsOiMwMDAwZGQ7LWlua3NjYXBlLXN0cm9rZTpub25lIgogICAgICAgICBkPSJNIDM4Ljk0NzM0NywxMi42MzkyMzMgSCAxMDYuMDg1NjIiCiAgICAgICAgIGlkPSJwYXRoMTYiIC8+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJjb2xvcjojMDAwMDAwO2ZpbGw6IzAwMDBkZDstaW5rc2NhcGUtc3Ryb2tlOm5vbmUiCiAgICAgICAgIGQ9Im0gMzguOTQ3MjY2LDEyLjUxMzY3MiB2IDAuMjUgaCA2Ny4xMzg2NzQgdiAtMC4yNSB6IgogICAgICAgICBpZD0icGF0aDE3IiAvPgogICAgICA8ZwogICAgICAgICBpZD0iZzE1Ij4KICAgICAgICA8cGF0aAogICAgICAgICAgIHN0eWxlPSJjb2xvcjojMDAwMDAwO2ZpbGw6IzAwMDBkZDstaW5rc2NhcGUtc3Ryb2tlOm5vbmUiCiAgICAgICAgICAgZD0ibSAxMDQuNzg5MDYsMTEuNzMwNDY5IC0wLjE1ODIsMC4zMTY0MDYgMS4xODM1OSwwLjU5MTc5NyAtMS4xODM1OSwwLjU5MTc5NyAwLjE1ODIsMC4zMTY0MDYgMS44MTY0MSwtMC45MDgyMDMgeiIKICAgICAgICAgICBpZD0icGF0aDE1IiAvPgogICAgICA8L2c+CiAgICA8L2c+CiAgICA8dGV4dAogICAgICAgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIKICAgICAgIHN0eWxlPSJmb250LXdlaWdodDpib2xkO2ZvbnQtc2l6ZToyLjExNjY3cHg7Zm9udC1mYW1pbHk6QXJpYWw7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjonQXJpYWwgQm9sZCc7ZmlsbDojMDAwMGRkO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDowO3N0cm9rZS1kYXNoYXJyYXk6bm9uZSIKICAgICAgIHg9IjcxLjY4NDQ5NCIKICAgICAgIHk9IjExLjY1NTc3IgogICAgICAgaWQ9InRleHQyLTItMi01LTEiPjx0c3BhbgogICAgICAgICBpZD0idHNwYW4yLTktNi0yLTg1IgogICAgICAgICBzdHlsZT0iZm9udC1zaXplOjIuMTE2NjdweDtmaWxsOiMwMDAwZGQ7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlLXdpZHRoOjA7c3Ryb2tlLWRhc2hhcnJheTpub25lIgogICAgICAgICB4PSI3MS42ODQ0OTQiCiAgICAgICAgIHk9IjExLjY1NTc3Ij5xMjwvdHNwYW4+PC90ZXh0PgogICAgPHRleHQKICAgICAgIHhtbDpzcGFjZT0icHJlc2VydmUiCiAgICAgICBzdHlsZT0iZm9udC13ZWlnaHQ6Ym9sZDtmb250LXNpemU6Mi44MjIyMnB4O2ZvbnQtZmFtaWx5OkFyaWFsOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246J0FyaWFsIEJvbGQnO2ZpbGw6IzAwMDAwMDtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MCIKICAgICAgIHg9IjEyMC4wNDk0OCIKICAgICAgIHk9IjIzLjkxMDQwOCIKICAgICAgIGlkPSJ0ZXh0MSI+PHRzcGFuCiAgICAgICAgIGlkPSJ0c3BhbjEiCiAgICAgICAgIHN0eWxlPSJmb250LXNpemU6Mi44MjIyMnB4O3N0cm9rZS13aWR0aDowIgogICAgICAgICB4PSIxMjAuMDQ5NDgiCiAgICAgICAgIHk9IjIzLjkxMDQwOCI+UTwvdHNwYW4+PC90ZXh0PgogIDwvZz4KPC9zdmc+Cg==" style="display: block; margin-left: auto; margin-right: auto; width: 70%;" /></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>quantity_point<span class="op">&lt;</span>isq<span class="op">::</span>distance<span class="op">[</span>si<span class="op">::</span>metre<span class="op">]&gt;</span> qp1<span class="op">{</span><span class="dv">100</span> <span class="op">*</span> m<span class="op">}</span>;</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>quantity_point<span class="op">&lt;</span>isq<span class="op">::</span>distance<span class="op">[</span>si<span class="op">::</span>metre<span class="op">]&gt;</span> qp2<span class="op">{</span><span class="dv">120</span> <span class="op">*</span> m<span class="op">}</span>;</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp1<span class="op">.</span>quantity_from_zero<span class="op">()</span> <span class="op">==</span> <span class="dv">100</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp2<span class="op">.</span>quantity_from_zero<span class="op">()</span> <span class="op">==</span> <span class="dv">120</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp2 <span class="op">-</span> qp1 <span class="op">==</span> <span class="dv">20</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp1 <span class="op">-</span> qp2 <span class="op">==</span> <span class="op">-</span><span class="dv">20</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="co">// auto res = qp1 + qp2;   // Compile-time error</span></span></code></pre></div>
<p>In the above code <code class="sourceCode default">100 * m</code> and
<code class="sourceCode default">120 * m</code> still creates two
quantities which serve as displacement vectors here. Quantity point
objects can be explicitly constructed from such quantities only when its
origin is an instantiation of the <code class="sourceCode default">zeroth_point_origin&lt;QuantitySpec&gt;</code>.</p>
<p>We can use
<code class="sourceCode default">.quantity_from_zero()</code> to obtain
the displacement vector of a point from the origin.</p>
<p>It is important to mention here that simplicity comes with a safety
cost here. For some users it might be surprising that the usage of <code class="sourceCode default">zeroth_point_origin&lt;QuantitySpec&gt;</code>
makes various quantity point objects compatible as long as quantity
types used in the origin and reference are compatible:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>quantity_point<span class="op">&lt;</span>si<span class="op">::</span>metre<span class="op">&gt;</span> qp1<span class="op">{</span>isq<span class="op">::</span>distance<span class="op">(</span><span class="dv">100</span> <span class="op">*</span> m<span class="op">)}</span>;</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>quantity_point<span class="op">&lt;</span>si<span class="op">::</span>metre<span class="op">&gt;</span> qp2<span class="op">{</span>isq<span class="op">::</span>height<span class="op">(</span><span class="dv">120</span> <span class="op">*</span> m<span class="op">)}</span>;</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp2 <span class="op">-</span> qp1 <span class="op">==</span> <span class="dv">20</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp1 <span class="op">-</span> qp2 <span class="op">==</span> <span class="op">-</span><span class="dv">20</span> <span class="op">*</span> m<span class="op">)</span>;</span></code></pre></div>
<h4 data-number="10.4.4.3" id="absolute-point-origin"><span class="header-section-number">10.4.4.3</span> Absolute <em>point</em>
origin<a href="#absolute-point-origin" class="self-link"></a></h4>
<p>In cases where we want to implement an isolated independent space
which points are not compatible with other spaces, even of the same
quantity type, we should manually predefine an absolute point
origin.</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgoKPHN2ZwogICB3aWR0aD0iOTYuNDAzMjM2bW0iCiAgIGhlaWdodD0iMTguODgxMTYzbW0iCiAgIHZpZXdCb3g9IjAgMCA5Ni40MDMyMzYgMTguODgxMTYzIgogICB2ZXJzaW9uPSIxLjEiCiAgIGlkPSJzdmcxIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnN2Zz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgogIDxkZWZzCiAgICAgaWQ9ImRlZnMxIj4KICAgIDxtYXJrZXIKICAgICAgIHN0eWxlPSJvdmVyZmxvdzp2aXNpYmxlIgogICAgICAgaWQ9IkRhcnRBcnJvdyIKICAgICAgIHJlZlg9IjAiCiAgICAgICByZWZZPSIwIgogICAgICAgb3JpZW50PSJhdXRvLXN0YXJ0LXJldmVyc2UiCiAgICAgICBtYXJrZXJXaWR0aD0iMSIKICAgICAgIG1hcmtlckhlaWdodD0iMSIKICAgICAgIHZpZXdCb3g9IjAgMCAxIDEiCiAgICAgICBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJ4TWlkWU1pZCI+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJmaWxsOmNvbnRleHQtc3Ryb2tlO2ZpbGwtcnVsZTpldmVub2RkO3N0cm9rZTpub25lIgogICAgICAgICBkPSJNIDAsMCA1LC01IC0xMi41LDAgNSw1IFoiCiAgICAgICAgIHRyYW5zZm9ybT0ic2NhbGUoLTAuNSkiCiAgICAgICAgIGlkPSJwYXRoNiIgLz4KICAgIDwvbWFya2VyPgogIDwvZGVmcz4KICA8ZwogICAgIGlkPSJsYXllcjEiCiAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTI1LjgwNDIzNiwtMzAuMjE0MzQ5KSI+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MC41O3N0cm9rZS1kYXNoYXJyYXk6bm9uZTttYXJrZXItZW5kOnVybCgjRGFydEFycm93KSIKICAgICAgIGQ9Ik0gMjUuODA0MjM2LDQ1LjE2MTEwNSBIIDExOC44MDE2OCIKICAgICAgIGlkPSJwYXRoMSIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDojMDAwMDAwO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDowLjM4MTI5ODtzdHJva2UtZGFzaGFycmF5Om5vbmUiCiAgICAgICBkPSJtIDM5LjA4ODc4Nyw0NC4xMjEwNDcgdiAyLjA4MDExNiIKICAgICAgIGlkPSJwYXRoMiIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDojMDAwMDAwO3N0cm9rZTojYTRhNGE0O3N0cm9rZS13aWR0aDowLjI5NzgyMztzdHJva2UtZGFzaGFycmF5OjEuMTkxMjksIDAuMjk3ODIzO3N0cm9rZS1kYXNob2Zmc2V0OjA7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Im0gMzkuMDg4Nzg3LDM1Ljg0MzkzNyB2IDguMDY2OTU4IgogICAgICAgaWQ9InBhdGgyLTIiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MC4zODEyOTg7c3Ryb2tlLWRhc2hhcnJheTpub25lIgogICAgICAgZD0ibSA5NC42MDkyMzEsNDQuMTIxMDQ3IHYgMi4wODAxMTYiCiAgICAgICBpZD0icGF0aDItNSIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDojMDAwMDAwO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDowLjM4MTI5ODtzdHJva2UtZGFzaGFycmF5Om5vbmUiCiAgICAgICBkPSJtIDEwNi44MTY0NCw0NC4xMjEwNDcgdiAyLjA4MDExNiIKICAgICAgIGlkPSJwYXRoMi01LTciIC8+CiAgICA8dGV4dAogICAgICAgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIKICAgICAgIHN0eWxlPSJmb250LXdlaWdodDpib2xkO2ZvbnQtc2l6ZToyLjQ2OTQ0cHg7Zm9udC1mYW1pbHk6QXJpYWw7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjonQXJpYWwgQm9sZCc7ZmlsbDojMDAwMDAwO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDowO3N0cm9rZS1kYXNoYXJyYXk6bm9uZSIKICAgICAgIHg9IjM1LjY5MzMwNiIKICAgICAgIHk9IjQ4LjU3NTgxNyIKICAgICAgIGlkPSJ0ZXh0MiI+PHRzcGFuCiAgICAgICAgIGlkPSJ0c3BhbjIiCiAgICAgICAgIHN0eWxlPSJmb250LXNpemU6Mi40Njk0NHB4O3N0cm9rZS13aWR0aDowO3N0cm9rZS1kYXNoYXJyYXk6bm9uZSIKICAgICAgICAgeD0iMzUuNjkzMzA2IgogICAgICAgICB5PSI0OC41NzU4MTciPm9yaWdpbjwvdHNwYW4+PC90ZXh0PgogICAgPHRleHQKICAgICAgIHhtbDpzcGFjZT0icHJlc2VydmUiCiAgICAgICBzdHlsZT0iZm9udC13ZWlnaHQ6Ym9sZDtmb250LXNpemU6Mi40Njk0NHB4O2ZvbnQtZmFtaWx5OkFyaWFsOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246J0FyaWFsIEJvbGQnO2ZpbGw6I2Q0MDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MDtzdHJva2UtZGFzaGFycmF5Om5vbmUiCiAgICAgICB4PSI5Mi41NjAwMDUiCiAgICAgICB5PSI0OC41OTg1NTciCiAgICAgICBpZD0idGV4dDItMiI+PHRzcGFuCiAgICAgICAgIGlkPSJ0c3BhbjItOSIKICAgICAgICAgc3R5bGU9ImZvbnQtc2l6ZToyLjQ2OTQ0cHg7ZmlsbDojZDQwMDAwO2ZpbGwtb3BhY2l0eToxO3N0cm9rZS13aWR0aDowO3N0cm9rZS1kYXNoYXJyYXk6bm9uZSIKICAgICAgICAgeD0iOTIuNTYwMDA1IgogICAgICAgICB5PSI0OC41OTg1NTciPnFwMTwvdHNwYW4+PC90ZXh0PgogICAgPHRleHQKICAgICAgIHhtbDpzcGFjZT0icHJlc2VydmUiCiAgICAgICBzdHlsZT0iZm9udC13ZWlnaHQ6Ym9sZDtmb250LXNpemU6Mi4xMTY2N3B4O2ZvbnQtZmFtaWx5OkFyaWFsOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246J0FyaWFsIEJvbGQnO2ZpbGw6I2Q0MDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MDtzdHJva2UtZGFzaGFycmF5Om5vbmUiCiAgICAgICB4PSI2NS44NDAzMzIiCiAgICAgICB5PSI0MC44NzQwOTIiCiAgICAgICBpZD0idGV4dDItMi03Ij48dHNwYW4KICAgICAgICAgaWQ9InRzcGFuMi05LTAiCiAgICAgICAgIHN0eWxlPSJmb250LXNpemU6Mi4xMTY2N3B4O2ZpbGw6I2Q0MDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2Utd2lkdGg6MDtzdHJva2UtZGFzaGFycmF5Om5vbmUiCiAgICAgICAgIHg9IjY1Ljg0MDMzMiIKICAgICAgICAgeT0iNDAuODc0MDkyIj5xMTwvdHNwYW4+PC90ZXh0PgogICAgPHRleHQKICAgICAgIHhtbDpzcGFjZT0icHJlc2VydmUiCiAgICAgICBzdHlsZT0iZm9udC13ZWlnaHQ6Ym9sZDtmb250LXNpemU6Mi40Njk0NHB4O2ZvbnQtZmFtaWx5OkFyaWFsOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246J0FyaWFsIEJvbGQnO2ZpbGw6IzAwMDBkZDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MDtzdHJva2UtZGFzaGFycmF5Om5vbmUiCiAgICAgICB4PSIxMDQuNjI4NTUiCiAgICAgICB5PSI0OC41OTg1NTciCiAgICAgICBpZD0idGV4dDItMi0yIj48dHNwYW4KICAgICAgICAgaWQ9InRzcGFuMi05LTYiCiAgICAgICAgIHN0eWxlPSJmb250LXNpemU6Mi40Njk0NHB4O2ZpbGw6IzAwMDBkZDtmaWxsLW9wYWNpdHk6MTtzdHJva2Utd2lkdGg6MDtzdHJva2UtZGFzaGFycmF5Om5vbmUiCiAgICAgICAgIHg9IjEwNC42Mjg1NSIKICAgICAgICAgeT0iNDguNTk4NTU3Ij5xcDI8L3RzcGFuPjwvdGV4dD4KICAgIDxnCiAgICAgICBpZD0icGF0aDMiPgogICAgICA8cGF0aAogICAgICAgICBzdHlsZT0iY29sb3I6IzAwMDAwMDtmaWxsOiMwMDAwZGQ7LWlua3NjYXBlLXN0cm9rZTpub25lIgogICAgICAgICBkPSJNIDM5LjEwNzUyMiw0MS45Mjg5MjYgSCA5My45OTk0MTgiCiAgICAgICAgIGlkPSJwYXRoMjgiIC8+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJjb2xvcjojMDAwMDAwO2ZpbGw6I2Q0MDAwMDstaW5rc2NhcGUtc3Ryb2tlOm5vbmUiCiAgICAgICAgIGQ9Im0gMzkuMTA3NDIyLDQxLjgwNDY4NyB2IDAuMjUgSCA5NCB2IC0wLjI1IHoiCiAgICAgICAgIGlkPSJwYXRoMjkiIC8+CiAgICAgIDxnCiAgICAgICAgIGlkPSJnMjciPgogICAgICAgIDxwYXRoCiAgICAgICAgICAgc3R5bGU9ImNvbG9yOiMwMDAwMDA7ZmlsbDojZDQwMDAwOy1pbmtzY2FwZS1zdHJva2U6bm9uZSIKICAgICAgICAgICBkPSJtIDkyLjcwMzEyNSw0MS4wMjE0ODQgLTAuMTU4MjAzLDAuMzE2NDA3IDEuMTgzNTk0LDAuNTkxNzk2IC0xLjE4MzU5NCwwLjU5MTc5NyAwLjE1ODIwMywwLjMxNjQwNyAxLjgxNjQwNiwtMC45MDgyMDQgeiIKICAgICAgICAgICBpZD0icGF0aDI3IiAvPgogICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZwogICAgICAgaWQ9InBhdGgzLTIiPgogICAgICA8cGF0aAogICAgICAgICBzdHlsZT0iY29sb3I6IzAwMDAwMDtmaWxsOiMwMDAwZGQ7LWlua3NjYXBlLXN0cm9rZTpub25lIgogICAgICAgICBkPSJNIDM4Ljk5NzQwNiwzNy42MDk1MzYgSCAxMDYuMjAxODIiCiAgICAgICAgIGlkPSJwYXRoMjIiIC8+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJjb2xvcjojMDAwMDAwO2ZpbGw6IzAwMDBkZDstaW5rc2NhcGUtc3Ryb2tlOm5vbmUiCiAgICAgICAgIGQ9Im0gMzguOTk4MDQ3LDM3LjQ4NDM3NSB2IDAuMjUgaCA2Ny4yMDMxMjMgdiAtMC4yNSB6IgogICAgICAgICBpZD0icGF0aDIzIiAvPgogICAgICA8ZwogICAgICAgICBpZD0iZzIxIj4KICAgICAgICA8cGF0aAogICAgICAgICAgIHN0eWxlPSJjb2xvcjojMDAwMDAwO2ZpbGw6IzAwMDBkZDstaW5rc2NhcGUtc3Ryb2tlOm5vbmUiCiAgICAgICAgICAgZD0ibSAxMDQuOTA2MjUsMzYuNzAxMTcyIC0wLjE1ODIsMC4zMTY0MDYgMS4xODM1OSwwLjU5MTc5NyAtMS4xODM1OSwwLjU5MTc5NyAwLjE1ODIsMC4zMTY0MDYgMS44MTY0MSwtMC45MDgyMDMgeiIKICAgICAgICAgICBpZD0icGF0aDIxIiAvPgogICAgICA8L2c+CiAgICA8L2c+CiAgICA8dGV4dAogICAgICAgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIKICAgICAgIHN0eWxlPSJmb250LXdlaWdodDpib2xkO2ZvbnQtc2l6ZToyLjExNjY3cHg7Zm9udC1mYW1pbHk6QXJpYWw7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjonQXJpYWwgQm9sZCc7ZmlsbDojMDAwMGRkO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDowO3N0cm9rZS1kYXNoYXJyYXk6bm9uZSIKICAgICAgIHg9IjcxLjgwMDY5NyIKICAgICAgIHk9IjM2LjYyNjA3NiIKICAgICAgIGlkPSJ0ZXh0Mi0yLTItNSI+PHRzcGFuCiAgICAgICAgIGlkPSJ0c3BhbjItOS02LTIiCiAgICAgICAgIHN0eWxlPSJmb250LXNpemU6Mi4xMTY2N3B4O2ZpbGw6IzAwMDBkZDtmaWxsLW9wYWNpdHk6MTtzdHJva2Utd2lkdGg6MDtzdHJva2UtZGFzaGFycmF5Om5vbmUiCiAgICAgICAgIHg9IjcxLjgwMDY5NyIKICAgICAgICAgeT0iMzYuNjI2MDc2Ij5xMjwvdHNwYW4+PC90ZXh0PgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7c3Ryb2tlOiNhNGE0YTQ7c3Ryb2tlLXdpZHRoOjAuMjk4O3N0cm9rZS1kYXNoYXJyYXk6MS4xOTIsIDAuMjk4O3N0cm9rZS1kYXNob2Zmc2V0OjA7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMTA2Ljc3NDc5LDMxLjUyOTc0MSBWIDQzLjk5MzI4NSIKICAgICAgIGlkPSJwYXRoMi0yLTEtMC0zIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7c3Ryb2tlOiNhNGE0YTQ7c3Ryb2tlLXdpZHRoOjAuMjk4O3N0cm9rZS1kYXNoYXJyYXk6MS4xOTIsIDAuMjk4O3N0cm9rZS1kYXNob2Zmc2V0OjA7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gOTQuNTY3NTgyLDMxLjUyOTc0MSBWIDQzLjk5MzI4NSIKICAgICAgIGlkPSJwYXRoMi0yLTEtMC0wLTMiIC8+CiAgICA8dGV4dAogICAgICAgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIKICAgICAgIHN0eWxlPSJmb250LXdlaWdodDpib2xkO2ZvbnQtc2l6ZToyLjExNjY3cHg7Zm9udC1mYW1pbHk6QXJpYWw7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjonQXJpYWwgQm9sZCc7bWl4LWJsZW5kLW1vZGU6bm9ybWFsO2ZpbGw6I2E0YTRhNDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MDtzdHJva2UtZGFzaGFycmF5Om5vbmUiCiAgICAgICB4PSI5Ni4xMDUxMDMiCiAgICAgICB5PSIzMS43MzU3MDQiCiAgICAgICBpZD0idGV4dDItMi03LTQ5LTUtMyI+PHRzcGFuCiAgICAgICAgIGlkPSJ0c3BhbjItOS0wLTk2LTQtMSIKICAgICAgICAgc3R5bGU9ImZvbnQtc2l6ZToyLjExNjY3cHg7ZmlsbDojYTRhNGE0O2ZpbGwtb3BhY2l0eToxO3N0cm9rZS13aWR0aDowO3N0cm9rZS1kYXNoYXJyYXk6bm9uZSIKICAgICAgICAgeD0iOTYuMTA1MTAzIgogICAgICAgICB5PSIzMS43MzU3MDQiPnFwMiAtIHFwMTwvdHNwYW4+PC90ZXh0PgogICAgPGcKICAgICAgIGlkPSJwYXRoOC0wLTktOCI+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJjb2xvcjojMDAwMDAwO2ZpbGw6I2E0YTRhNDtmaWxsLW9wYWNpdHk6MC45NjA3ODQ7LWlua3NjYXBlLXN0cm9rZTpub25lIgogICAgICAgICBkPSJNIDk0LjY3NzAxMSwzMy4xODc0MTggSCAxMDYuMjI3MjUiCiAgICAgICAgIGlkPSJwYXRoMjUiIC8+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJjb2xvcjojMDAwMDAwO2ZpbGw6I2E0YTRhNDtmaWxsLW9wYWNpdHk6MC45NjA3ODQ7LWlua3NjYXBlLXN0cm9rZTpub25lIgogICAgICAgICBkPSJtIDk0LjY3NzczNCwzMy4wNjI1IHYgMC4yNSBoIDExLjU0ODgyNiB2IC0wLjI1IHoiCiAgICAgICAgIGlkPSJwYXRoMjYiIC8+CiAgICAgIDxnCiAgICAgICAgIGlkPSJnMjQiPgogICAgICAgIDxwYXRoCiAgICAgICAgICAgc3R5bGU9ImNvbG9yOiMwMDAwMDA7ZmlsbDojYTRhNGE0Oy1pbmtzY2FwZS1zdHJva2U6bm9uZSIKICAgICAgICAgICBkPSJtIDEwNC45MzE2NCwzMi4yNzkyOTcgLTAuMTU4MiwwLjMxNjQwNiAxLjE4MzU5LDAuNTkxNzk3IC0xLjE4MzU5LDAuNTkxNzk3IDAuMTU4MiwwLjMxNjQwNiAxLjgxNjQxLC0wLjkwODIwMyB6IgogICAgICAgICAgIGlkPSJwYXRoMjQiIC8+CiAgICAgIDwvZz4KICAgIDwvZz4KICAgIDx0ZXh0CiAgICAgICB4bWw6c3BhY2U9InByZXNlcnZlIgogICAgICAgc3R5bGU9ImZvbnQtd2VpZ2h0OmJvbGQ7Zm9udC1zaXplOjIuODIyMjJweDtmb250LWZhbWlseTpBcmlhbDstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOidBcmlhbCBCb2xkJztmaWxsOiMwMDAwMDA7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjAiCiAgICAgICB4PSIxMjAuMDQ5NDgiCiAgICAgICB5PSI0OC44ODA3MTEiCiAgICAgICBpZD0idGV4dDEtMSI+PHRzcGFuCiAgICAgICAgIGlkPSJ0c3BhbjEtMCIKICAgICAgICAgc3R5bGU9ImZvbnQtc2l6ZToyLjgyMjIycHg7c3Ryb2tlLXdpZHRoOjAiCiAgICAgICAgIHg9IjEyMC4wNDk0OCIKICAgICAgICAgeT0iNDguODgwNzExIj5RPC90c3Bhbj48L3RleHQ+CiAgPC9nPgo8L3N2Zz4K" style="display: block; margin-left: auto; margin-right: auto; width: 70%;" /></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> origin <span class="op">:</span> absolute_point_origin<span class="op">&lt;</span>origin, isq<span class="op">::</span>distance<span class="op">&gt;</span> <span class="op">{}</span> origin;</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co">// quantity_point&lt;si::metre, origin&gt; qp1{100 * m};  // Compile-time error</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co">// quantity_point&lt;si::metre, origin&gt; qp2{120 * m};  // Compile-time error</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>quantity_point<span class="op">&lt;</span>si<span class="op">::</span>metre, origin<span class="op">&gt;</span> qp1 <span class="op">=</span> origin <span class="op">+</span> <span class="dv">100</span> <span class="op">*</span> m;</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>quantity_point<span class="op">&lt;</span>si<span class="op">::</span>metre, origin<span class="op">&gt;</span> qp2 <span class="op">=</span> <span class="dv">120</span> <span class="op">*</span> m <span class="op">+</span> origin;</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp1<span class="op">.</span>quantity_from_zero<span class="op">()</span> <span class="op">==</span> <span class="dv">100</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp2<span class="op">.</span>quantity_from_zero<span class="op">()</span> <span class="op">==</span> <span class="dv">120</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp1 <span class="op">-</span> origin <span class="op">==</span> <span class="dv">100</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp2 <span class="op">-</span> origin <span class="op">==</span> <span class="dv">120</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>origin <span class="op">-</span> qp1 <span class="op">==</span> <span class="op">-</span><span class="dv">100</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>origin <span class="op">-</span> qp2 <span class="op">==</span> <span class="op">-</span><span class="dv">120</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp2 <span class="op">-</span> qp1 <span class="op">==</span> <span class="dv">20</span> <span class="op">*</span> m<span class="op">)</span>;</span></code></pre></div>
<p>This time we can’t construct quantity point from any quantity. In
order to prevent potential safety issues, when a custom point origin is
being used, we always need to provide its object in the expression that
results with a quantity point instantiation.</p>
<p>Similarly to quantities, if someone does not like the arithmetic way
to construct a quantity point a two-parameter constructor can be
used:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>quantity_point qp1<span class="op">{</span><span class="dv">100</span> <span class="op">*</span> m, origin<span class="op">}</span>;</span></code></pre></div>
<p>Again, CTAD helps to always use exactly the type that we need in a
current case.</p>
<p>Finally, please note that it is not allowed to subtract two point
origins defined in terms of
<code class="sourceCode default">absolute_point_origin</code> (e.g.,
<code class="sourceCode default">origin - origin</code>) as those do not
contain information about the unit, so we are not able to determine a
resulting <code class="sourceCode default">quantity</code> type.</p>
<p>Absolute point origins are also perfect to establish independent
spaces even if the same quantity type and unit is being used:</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgoKPHN2ZwogICB3aWR0aD0iOTYuOTk5Mzc0bW0iCiAgIGhlaWdodD0iMjUuNjYyOTk2bW0iCiAgIHZpZXdCb3g9IjAgMCA5Ni45OTkzNzQgMjUuNjYyOTk2IgogICB2ZXJzaW9uPSIxLjEiCiAgIGlkPSJzdmcxIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnN2Zz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgogIDxkZWZzCiAgICAgaWQ9ImRlZnMxIj4KICAgIDxtYXJrZXIKICAgICAgIHN0eWxlPSJvdmVyZmxvdzp2aXNpYmxlIgogICAgICAgaWQ9IkRhcnRBcnJvdy00IgogICAgICAgcmVmWD0iMCIKICAgICAgIHJlZlk9IjAiCiAgICAgICBvcmllbnQ9ImF1dG8tc3RhcnQtcmV2ZXJzZSIKICAgICAgIG1hcmtlcldpZHRoPSIxIgogICAgICAgbWFya2VySGVpZ2h0PSIxIgogICAgICAgdmlld0JveD0iMCAwIDEgMSIKICAgICAgIHByZXNlcnZlQXNwZWN0UmF0aW89InhNaWRZTWlkIj4KICAgICAgPHBhdGgKICAgICAgICAgc3R5bGU9ImZpbGw6Y29udGV4dC1zdHJva2U7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmUiCiAgICAgICAgIGQ9Ik0gMCwwIDUsLTUgLTEyLjUsMCA1LDUgWiIKICAgICAgICAgdHJhbnNmb3JtPSJzY2FsZSgtMC41KSIKICAgICAgICAgaWQ9InBhdGg2LTAiIC8+CiAgICA8L21hcmtlcj4KICAgIDxtYXJrZXIKICAgICAgIHN0eWxlPSJvdmVyZmxvdzp2aXNpYmxlIgogICAgICAgaWQ9IkRhcnRBcnJvdy00LTYzIgogICAgICAgcmVmWD0iMCIKICAgICAgIHJlZlk9IjAiCiAgICAgICBvcmllbnQ9ImF1dG8tc3RhcnQtcmV2ZXJzZSIKICAgICAgIG1hcmtlcldpZHRoPSIxIgogICAgICAgbWFya2VySGVpZ2h0PSIxIgogICAgICAgdmlld0JveD0iMCAwIDEgMSIKICAgICAgIHByZXNlcnZlQXNwZWN0UmF0aW89InhNaWRZTWlkIj4KICAgICAgPHBhdGgKICAgICAgICAgc3R5bGU9ImZpbGw6Y29udGV4dC1zdHJva2U7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmUiCiAgICAgICAgIGQ9Ik0gMCwwIDUsLTUgLTEyLjUsMCA1LDUgWiIKICAgICAgICAgdHJhbnNmb3JtPSJzY2FsZSgtMC41KSIKICAgICAgICAgaWQ9InBhdGg2LTAtMSIgLz4KICAgIDwvbWFya2VyPgogIDwvZGVmcz4KICA8ZwogICAgIGlkPSJsYXllcjEiCiAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTI1LjIwODA5OCwtNTkuMDk1NjU2KSI+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MC41O3N0cm9rZS1kYXNoYXJyYXk6bm9uZTttYXJrZXItZW5kOnVybCgjRGFydEFycm93LTQpIgogICAgICAgZD0iTSAyNS44MzYwOTUsNjkuMTUyMDIyIEggMTE4LjgzMzUzIgogICAgICAgaWQ9InBhdGg0IiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjAuNTtzdHJva2UtZGFzaGFycmF5Om5vbmU7bWFya2VyLWVuZDp1cmwoI0RhcnRBcnJvdy00LTYzKSIKICAgICAgIGQ9Im0gMjUuODM2MSw3NS4wMzE2MTQgaCA5Mi45OTc0MyIKICAgICAgIGlkPSJwYXRoNC0xOSIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDojMDAwMDAwO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDowLjM4MTI5ODtzdHJva2UtZGFzaGFycmF5Om5vbmUiCiAgICAgICBkPSJNIDM5LjEyMDY0Niw2OC4xMTE5NjQgViA3MC4xOTIwOCIKICAgICAgIGlkPSJwYXRoNyIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDojMDAwMDAwO3N0cm9rZTojYTRhNGE0O3N0cm9rZS13aWR0aDowLjI5NzgyMztzdHJva2UtZGFzaGFycmF5OjEuMTkxMjksIDAuMjk3ODIzO3N0cm9rZS1kYXNob2Zmc2V0OjA7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Im0gMzkuMTIwNjQ2LDU5LjgzNDg1OCB2IDguMDY2OTU0IgogICAgICAgaWQ9InBhdGgyLTItNyIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDojMDAwMDAwO3N0cm9rZTojYTRhNGE0O3N0cm9rZS13aWR0aDowLjI5NzgyMztzdHJva2UtZGFzaGFycmF5OjEuMTkxMjksIDAuMjk3ODIzO3N0cm9rZS1kYXNob2Zmc2V0OjA7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Im0gMTA2Ljg0ODMsNTkuODM0ODU4IHYgOC4wNjY5NTQiCiAgICAgICBpZD0icGF0aDItMi0xLTUiIC8+CiAgICA8ZwogICAgICAgaWQ9ImcyIgogICAgICAgdHJhbnNmb3JtPSJtYXRyaXgoMSwwLDAsLTEsMCwxNDQuMTUxMSkiPgogICAgICA8cGF0aAogICAgICAgICBzdHlsZT0iZmlsbDojMDAwMDAwO3N0cm9rZTojYTRhNGE0O3N0cm9rZS13aWR0aDowLjI5ODtzdHJva2UtZGFzaGFycmF5OjEuMTkyLCAwLjI5ODtzdHJva2UtZGFzaG9mZnNldDowO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICAgIGQ9Im0gOTQuNjQxMDksNjQuMTAxMjU5IHYgMy44MDA1NDciCiAgICAgICAgIGlkPSJwYXRoMi0yLTQtNC0wIiAvPgogICAgICA8cGF0aAogICAgICAgICBzdHlsZT0iZmlsbDojMDAwMDAwO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDowLjM4MTI5ODtzdHJva2UtZGFzaGFycmF5Om5vbmUiCiAgICAgICAgIGQ9Im0gOTQuNjQxMDksNjguMTExOTU4IHYgMi4wODAxMTYiCiAgICAgICAgIGlkPSJwYXRoMi01LTQtMSIgLz4KICAgIDwvZz4KICAgIDxnCiAgICAgICBpZD0iZzItMCIKICAgICAgIHRyYW5zZm9ybT0ibWF0cml4KDEsMCwwLC0xLC00MC44NTE1MDYsMTQ0LjE1MTEpIj4KICAgICAgPHBhdGgKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtzdHJva2U6I2E0YTRhNDtzdHJva2Utd2lkdGg6MC4yOTg7c3Ryb2tlLWRhc2hhcnJheToxLjE5MiwgMC4yOTg7c3Ryb2tlLWRhc2hvZmZzZXQ6MDtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICBkPSJtIDk0LjY0MTA5LDY0LjEwMTI1OSB2IDMuODAwNTQ3IgogICAgICAgICBpZD0icGF0aDItMi00LTQtMC05IiAvPgogICAgICA8cGF0aAogICAgICAgICBzdHlsZT0iZmlsbDojMDAwMDAwO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDowLjM4MTI5ODtzdHJva2UtZGFzaGFycmF5Om5vbmUiCiAgICAgICAgIGQ9Im0gOTQuNjQxMDksNjguMTExOTU4IHYgMi4wODAxMTYiCiAgICAgICAgIGlkPSJwYXRoMi01LTQtMS0xIiAvPgogICAgPC9nPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjAuMzgxMjk4O3N0cm9rZS1kYXNoYXJyYXk6bm9uZSIKICAgICAgIGQ9Ik0gMTA2Ljg0ODMsNjguMTExOTY0IFYgNzAuMTkyMDgiCiAgICAgICBpZD0icGF0aDItNS03LTUiIC8+CiAgICA8dGV4dAogICAgICAgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIKICAgICAgIHN0eWxlPSJmb250LXdlaWdodDpib2xkO2ZvbnQtc2l6ZToyLjQ2OTQ0cHg7Zm9udC1mYW1pbHk6QXJpYWw7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjonQXJpYWwgQm9sZCc7ZmlsbDojMDAwMGRmO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDowO3N0cm9rZS1kYXNoYXJyYXk6bm9uZTtzdHJva2Utb3BhY2l0eTowIgogICAgICAgeD0iMzUuMDE3MzcyIgogICAgICAgeT0iNzIuNTY2NzM0IgogICAgICAgaWQ9InRleHQyLTgiPjx0c3BhbgogICAgICAgICBpZD0idHNwYW4yLTYiCiAgICAgICAgIHN0eWxlPSJmb250LXNpemU6Mi40Njk0NHB4O2ZpbGw6IzAwMDBkZjtmaWxsLW9wYWNpdHk6MTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLW9wYWNpdHk6MCIKICAgICAgICAgeD0iMzUuMDE3MzcyIgogICAgICAgICB5PSI3Mi41NjY3MzQiPm9yaWdpbjI8L3RzcGFuPjwvdGV4dD4KICAgIDx0ZXh0CiAgICAgICB4bWw6c3BhY2U9InByZXNlcnZlIgogICAgICAgc3R5bGU9ImZvbnQtd2VpZ2h0OmJvbGQ7Zm9udC1zaXplOjIuNDY5NDRweDtmb250LWZhbWlseTpBcmlhbDstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOidBcmlhbCBCb2xkJztmaWxsOiNkNDAwMDA7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjA7c3Ryb2tlLWRhc2hhcnJheTpub25lIgogICAgICAgeD0iNDkuODI0OTc0IgogICAgICAgeT0iNzIuNDY5MTA5IgogICAgICAgaWQ9InRleHQyLTgtNyI+PHRzcGFuCiAgICAgICAgIGlkPSJ0c3BhbjItNi00IgogICAgICAgICBzdHlsZT0iZm9udC1zaXplOjIuNDY5NDRweDtmaWxsOiNkNDAwMDA7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlLXdpZHRoOjA7c3Ryb2tlLWRhc2hhcnJheTpub25lIgogICAgICAgICB4PSI0OS44MjQ5NzQiCiAgICAgICAgIHk9IjcyLjQ2OTEwOSI+b3JpZ2luMTwvdHNwYW4+PC90ZXh0PgogICAgPHRleHQKICAgICAgIHhtbDpzcGFjZT0icHJlc2VydmUiCiAgICAgICBzdHlsZT0iZm9udC13ZWlnaHQ6Ym9sZDtmb250LXNpemU6Mi40Njk0NHB4O2ZvbnQtZmFtaWx5OkFyaWFsOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246J0FyaWFsIEJvbGQnO2ZpbGw6I2Q0MDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MDtzdHJva2UtZGFzaGFycmF5Om5vbmUiCiAgICAgICB4PSI5Mi41OTE4NjYiCiAgICAgICB5PSI3Mi41ODk0NyIKICAgICAgIGlkPSJ0ZXh0Mi0yLTgiPjx0c3BhbgogICAgICAgICBpZD0idHNwYW4yLTktMyIKICAgICAgICAgc3R5bGU9ImZvbnQtc2l6ZToyLjQ2OTQ0cHg7ZmlsbDojZDQwMDAwO2ZpbGwtb3BhY2l0eToxO3N0cm9rZS13aWR0aDowO3N0cm9rZS1kYXNoYXJyYXk6bm9uZSIKICAgICAgICAgeD0iOTIuNTkxODY2IgogICAgICAgICB5PSI3Mi41ODk0NyI+cXAxPC90c3Bhbj48L3RleHQ+CiAgICA8dGV4dAogICAgICAgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIKICAgICAgIHN0eWxlPSJmb250LXdlaWdodDpib2xkO2ZvbnQtc2l6ZToyLjExNjY3cHg7Zm9udC1mYW1pbHk6QXJpYWw7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjonQXJpYWwgQm9sZCc7ZmlsbDojZDQwMDAwO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDowO3N0cm9rZS1kYXNoYXJyYXk6bm9uZSIKICAgICAgIHg9IjczLjIxNTQyNCIKICAgICAgIHk9Ijc3LjYyMDEyNSIKICAgICAgIGlkPSJ0ZXh0Mi0yLTctNCI+PHRzcGFuCiAgICAgICAgIGlkPSJ0c3BhbjItOS0wLTkiCiAgICAgICAgIHN0eWxlPSJmb250LXNpemU6Mi4xMTY2N3B4O2ZpbGw6I2Q0MDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2Utd2lkdGg6MDtzdHJva2UtZGFzaGFycmF5Om5vbmUiCiAgICAgICAgIHg9IjczLjIxNTQyNCIKICAgICAgICAgeT0iNzcuNjIwMTI1Ij5xMTwvdHNwYW4+PC90ZXh0PgogICAgPHRleHQKICAgICAgIHhtbDpzcGFjZT0icHJlc2VydmUiCiAgICAgICBzdHlsZT0iZm9udC13ZWlnaHQ6Ym9sZDtmb250LXNpemU6Mi40Njk0NHB4O2ZvbnQtZmFtaWx5OkFyaWFsOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246J0FyaWFsIEJvbGQnO2ZpbGw6IzAwMDBkZDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MDtzdHJva2UtZGFzaGFycmF5Om5vbmUiCiAgICAgICB4PSIxMDQuNjYwNDEiCiAgICAgICB5PSI3Mi41ODk0NyIKICAgICAgIGlkPSJ0ZXh0Mi0yLTItMyI+PHRzcGFuCiAgICAgICAgIGlkPSJ0c3BhbjItOS02LTI4IgogICAgICAgICBzdHlsZT0iZm9udC1zaXplOjIuNDY5NDRweDtmaWxsOiMwMDAwZGQ7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlLXdpZHRoOjA7c3Ryb2tlLWRhc2hhcnJheTpub25lIgogICAgICAgICB4PSIxMDQuNjYwNDEiCiAgICAgICAgIHk9IjcyLjU4OTQ3Ij5xcDI8L3RzcGFuPjwvdGV4dD4KICAgIDxnCiAgICAgICBpZD0icGF0aDgiPgogICAgICA8cGF0aAogICAgICAgICBzdHlsZT0iY29sb3I6IzAwMDAwMDtmaWxsOiMwMDAwZGQ7LWlua3NjYXBlLXN0cm9rZTpub25lIgogICAgICAgICBkPSJNIDUzLjc0MjE2Myw3OC42NzQ5NDUgSCA5NC4yNDcyNDgiCiAgICAgICAgIGlkPSJwYXRoMzQiIC8+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJjb2xvcjojMDAwMDAwO2ZpbGw6I2Q0MDAwMDstaW5rc2NhcGUtc3Ryb2tlOm5vbmUiCiAgICAgICAgIGQ9Im0gNTMuNzQyMTg3LDc4LjU1MDc4MSB2IDAuMjUgaCA0MC41MDU4NiB2IC0wLjI1IHoiCiAgICAgICAgIGlkPSJwYXRoMzUiIC8+CiAgICAgIDxnCiAgICAgICAgIGlkPSJnMzMiPgogICAgICAgIDxwYXRoCiAgICAgICAgICAgc3R5bGU9ImNvbG9yOiMwMDAwMDA7ZmlsbDojZDQwMDAwOy1pbmtzY2FwZS1zdHJva2U6bm9uZSIKICAgICAgICAgICBkPSJtIDkyLjk1MTE3Miw3Ny43Njc1NzggLTAuMTU4MjAzLDAuMzE2NDA2IDEuMTgzNTkzLDAuNTkxNzk3IC0xLjE4MzU5MywwLjU5MTc5NyAwLjE1ODIwMywwLjMxNjQwNiAxLjgxNjQwNiwtMC45MDgyMDMgeiIKICAgICAgICAgICBpZD0icGF0aDMzIiAvPgogICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZwogICAgICAgaWQ9InBhdGgzLTItOSI+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJjb2xvcjojMDAwMDAwO2ZpbGw6IzAwMDBkZDstaW5rc2NhcGUtc3Ryb2tlOm5vbmUiCiAgICAgICAgIGQ9Ik0gMzguODk3NjMzLDYxLjYwMDQ1NSBIIDEwNi4zMjY1NiIKICAgICAgICAgaWQ9InBhdGgzMSIgLz4KICAgICAgPHBhdGgKICAgICAgICAgc3R5bGU9ImNvbG9yOiMwMDAwMDA7ZmlsbDojMDAwMGRkOy1pbmtzY2FwZS1zdHJva2U6bm9uZSIKICAgICAgICAgZD0ibSAzOC44OTg0MzcsNjEuNDc0NjA5IHYgMC4yNSBoIDY3LjQyNzczMyB2IC0wLjI1IHoiCiAgICAgICAgIGlkPSJwYXRoMzIiIC8+CiAgICAgIDxnCiAgICAgICAgIGlkPSJnMzAiPgogICAgICAgIDxwYXRoCiAgICAgICAgICAgc3R5bGU9ImNvbG9yOiMwMDAwMDA7ZmlsbDojMDAwMGRkOy1pbmtzY2FwZS1zdHJva2U6bm9uZSIKICAgICAgICAgICBkPSJtIDEwNS4wMzEyNSw2MC42OTE0MDYgLTAuMTU4MiwwLjMxNjQwNiAxLjE4MzU5LDAuNTkxNzk3IC0xLjE4MzU5LDAuNTkxNzk3IDAuMTU4MiwwLjMxNjQwNiAxLjgxNjQxLC0wLjkwODIwMyB6IgogICAgICAgICAgIGlkPSJwYXRoMzAiIC8+CiAgICAgIDwvZz4KICAgIDwvZz4KICAgIDx0ZXh0CiAgICAgICB4bWw6c3BhY2U9InByZXNlcnZlIgogICAgICAgc3R5bGU9ImZvbnQtd2VpZ2h0OmJvbGQ7Zm9udC1zaXplOjIuMTE2NjdweDtmb250LWZhbWlseTpBcmlhbDstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOidBcmlhbCBCb2xkJztmaWxsOiMwMDAwZGQ7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjA7c3Ryb2tlLWRhc2hhcnJheTpub25lIgogICAgICAgeD0iNzEuODc5MzI2IgogICAgICAgeT0iNjAuNjE3MDEyIgogICAgICAgaWQ9InRleHQyLTItMi01LTYiPjx0c3BhbgogICAgICAgICBpZD0idHNwYW4yLTktNi0yLTgiCiAgICAgICAgIHN0eWxlPSJmb250LXNpemU6Mi4xMTY2N3B4O2ZpbGw6IzAwMDBkZDtmaWxsLW9wYWNpdHk6MTtzdHJva2Utd2lkdGg6MDtzdHJva2UtZGFzaGFycmF5Om5vbmUiCiAgICAgICAgIHg9IjcxLjg3OTMyNiIKICAgICAgICAgeT0iNjAuNjE3MDEyIj5xMjwvdHNwYW4+PC90ZXh0PgogICAgPHRleHQKICAgICAgIHhtbDpzcGFjZT0icHJlc2VydmUiCiAgICAgICBzdHlsZT0iZm9udC13ZWlnaHQ6Ym9sZDtmb250LXNpemU6Mi4xMTY2N3B4O2ZvbnQtZmFtaWx5OkFyaWFsOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246J0FyaWFsIEJvbGQnO3RleHQtYWxpZ246Y2VudGVyO3RleHQtYW5jaG9yOm1pZGRsZTtmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjAuMjk4O3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheToxLjE5MiwgMC4yOTg7c3Ryb2tlLWRhc2hvZmZzZXQ6MDtzdHJva2Utb3BhY2l0eTowIgogICAgICAgeD0iMzYuNTkzNjM5IgogICAgICAgeT0iODEuNTE4MzY0IgogICAgICAgaWQ9InRleHQ1Ij48dHNwYW4KICAgICAgICAgaWQ9InRzcGFuNSIKICAgICAgICAgc3R5bGU9ImZvbnQtc2l6ZToyLjExNjY3cHg7dGV4dC1hbGlnbjpjZW50ZXI7dGV4dC1hbmNob3I6bWlkZGxlO2ZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2Utd2lkdGg6MC4yOTgiCiAgICAgICAgIHg9IjM2LjU5MzYzOSIKICAgICAgICAgeT0iODEuNTE4MzY0Ij51bnJlbGF0ZWQ8L3RzcGFuPjx0c3BhbgogICAgICAgICBzdHlsZT0iZm9udC1zaXplOjIuMTE2NjdweDt0ZXh0LWFsaWduOmNlbnRlcjt0ZXh0LWFuY2hvcjptaWRkbGU7ZmlsbDojMDAwMDAwO2ZpbGwtb3BhY2l0eToxO3N0cm9rZS13aWR0aDowLjI5OCIKICAgICAgICAgeD0iMzYuNTkzNjM5IgogICAgICAgICB5PSI4NC4xNjQyIgogICAgICAgICBpZD0idHNwYW42Ij4obm8ga25vd24gdHJhbnNsYXRpb24pPC90c3Bhbj48L3RleHQ+CiAgICA8ZwogICAgICAgaWQ9InBhdGg5Ij4KICAgICAgPHBhdGgKICAgICAgICAgc3R5bGU9ImNvbG9yOiMwMDAwMDA7ZmlsbDojMDAwMDAwOy1pbmtzY2FwZS1zdHJva2U6bm9uZSIKICAgICAgICAgZD0ibSAyOS4xODE2NDEsNjkuNzgxMjUgLTAuMTc3NzM1LDAuMDg3ODkgNC45NTcwMzEsOS44MjIyNjUgMC4xNzc3MzUsLTAuMDg3ODkgeiIKICAgICAgICAgaWQ9InBhdGgzOSIgLz4KICAgICAgPGcKICAgICAgICAgaWQ9ImczOCI+CiAgICAgICAgPHBhdGgKICAgICAgICAgICBzdHlsZT0iY29sb3I6IzAwMDAwMDtmaWxsOiMwMDAwMDA7LWlua3NjYXBlLXN0cm9rZTpub25lIgogICAgICAgICAgIGQ9Im0gMjguOTA2MjUsNjkuNDU3MDMxIDAuMDA1OSwxLjYwOTM3NSAwLjI4MTI1LC0wLjAwMiAtMC4wMDM5LC0xLjA0ODgyOCAwLjgzOTg0NCwwLjYyNjk1MyAwLjE2Nzk2OSwtMC4yMjQ2MDkgeiIKICAgICAgICAgICBpZD0icGF0aDM4IiAvPgogICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZwogICAgICAgaWQ9InBhdGg5LTAiPgogICAgICA8cGF0aAogICAgICAgICBzdHlsZT0iY29sb3I6IzAwMDAwMDtmaWxsOiMwMDAwMDA7LWlua3NjYXBlLXN0cm9rZTpub25lIgogICAgICAgICBkPSJtIDQzLjgzNzg5MSw3NS44Mzc4OTEgLTMuNDYyODkxLDMuNjQ4NDM3IDAuMTQ0NTMxLDAuMTM0NzY2IDMuNDYwOTM4LC0zLjY0NjQ4NSB6IgogICAgICAgICBpZD0icGF0aDM3IiAvPgogICAgICA8ZwogICAgICAgICBpZD0iZzM2Ij4KICAgICAgICA8cGF0aAogICAgICAgICAgIHN0eWxlPSJjb2xvcjojMDAwMDAwO2ZpbGw6IzAwMDAwMDstaW5rc2NhcGUtc3Ryb2tlOm5vbmUiCiAgICAgICAgICAgZD0ibSA0NC4xOTMzNTksNzUuNjA3NDIyIC0xLjUxMTcxOCwwLjU0ODgyOCAwLjA5Mzc1LDAuMjYxNzE5IDAuOTg2MzI4LC0wLjM1NzQyMiAtMC4zMDQ2ODgsMS4wMDM5MDYgMC4yNjc1NzgsMC4wODAwOCB6IgogICAgICAgICAgIGlkPSJwYXRoMzYiIC8+CiAgICAgIDwvZz4KICAgIDwvZz4KICAgIDx0ZXh0CiAgICAgICB4bWw6c3BhY2U9InByZXNlcnZlIgogICAgICAgc3R5bGU9ImZvbnQtd2VpZ2h0OmJvbGQ7Zm9udC1zaXplOjIuODIyMjJweDtmb250LWZhbWlseTpBcmlhbDstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOidBcmlhbCBCb2xkJztmaWxsOiMwMDAwMDA7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjAiCiAgICAgICB4PSIxMjAuMDQ5NDgiCiAgICAgICB5PSI3Mi44NzE2MiIKICAgICAgIGlkPSJ0ZXh0MS0wIj48dHNwYW4KICAgICAgICAgaWQ9InRzcGFuMS0xIgogICAgICAgICBzdHlsZT0iZm9udC1zaXplOjIuODIyMjJweDtzdHJva2Utd2lkdGg6MCIKICAgICAgICAgeD0iMTIwLjA0OTQ4IgogICAgICAgICB5PSI3Mi44NzE2MiI+UTwvdHNwYW4+PC90ZXh0PgogIDwvZz4KPC9zdmc+Cg==" style="display: block; margin-left: auto; margin-right: auto; width: 70%;" /></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> origin1 <span class="op">:</span> absolute_point_origin<span class="op">&lt;</span>origin1, isq<span class="op">::</span>distance<span class="op">&gt;</span> <span class="op">{}</span> origin1;</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> origin2 <span class="op">:</span> absolute_point_origin<span class="op">&lt;</span>origin2, isq<span class="op">::</span>distance<span class="op">&gt;</span> <span class="op">{}</span> origin2;</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>quantity_point qp1 <span class="op">=</span> origin1 <span class="op">+</span> <span class="dv">100</span> <span class="op">*</span> m;</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>quantity_point qp2 <span class="op">=</span> origin2 <span class="op">+</span> <span class="dv">120</span> <span class="op">*</span> m;</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp1<span class="op">.</span>quantity_from_zero<span class="op">()</span> <span class="op">==</span> <span class="dv">100</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp2<span class="op">.</span>quantity_from_zero<span class="op">()</span> <span class="op">==</span> <span class="dv">120</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp1 <span class="op">-</span> origin1 <span class="op">==</span> <span class="dv">100</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp2 <span class="op">-</span> origin2 <span class="op">==</span> <span class="dv">120</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>origin1 <span class="op">-</span> qp1 <span class="op">==</span> <span class="op">-</span><span class="dv">100</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>origin2 <span class="op">-</span> qp2 <span class="op">==</span> <span class="op">-</span><span class="dv">120</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="co">// assert(qp2 - qp1 == 20 * m);       // Compile-time error</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="co">// assert(qp1 - origin2 == 100 * m);  // Compile-time error</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="co">// assert(qp2 - origin1 == 120 * m);  // Compile-time error</span></span></code></pre></div>
<h4 data-number="10.4.4.4" id="relative-point-origin"><span class="header-section-number">10.4.4.4</span> Relative <em>point</em>
origin<a href="#relative-point-origin" class="self-link"></a></h4>
<p>We often do not have only one ultimate “zero” point when we measure
things. Often we have one common scale but we measure various quantities
relative to different points and still expect those points to be
compatible. There are many examples here but probably the most common
are temperatures, timestamps, and altitudes.</p>
<p>For such cases relative point origins should be used:</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgoKPHN2ZwogICB3aWR0aD0iOTYuMzI2OTM1bW0iCiAgIGhlaWdodD0iMzAuMjYzMjIybW0iCiAgIHZpZXdCb3g9IjAgMCA5Ni4zMjY5MzUgMzAuMjYzMjIyIgogICB2ZXJzaW9uPSIxLjEiCiAgIGlkPSJzdmcxIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIxLjMuMiAoMDkxZTIwZSwgMjAyMy0xMS0yNSwgY3VzdG9tKSIKICAgc29kaXBvZGk6ZG9jbmFtZT0iYWZmaW5lIHNwYWNlLnN2ZyIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8c29kaXBvZGk6bmFtZWR2aWV3CiAgICAgaWQ9Im5hbWVkdmlldzEiCiAgICAgcGFnZWNvbG9yPSIjZmZmZmZmIgogICAgIGJvcmRlcmNvbG9yPSIjMDAwMDAwIgogICAgIGJvcmRlcm9wYWNpdHk9IjAuMjUiCiAgICAgaW5rc2NhcGU6c2hvd3BhZ2VzaGFkb3c9IjIiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlY2hlY2tlcmJvYXJkPSIwIgogICAgIGlua3NjYXBlOmRlc2tjb2xvcj0iI2QxZDFkMSIKICAgICBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0ibW0iCiAgICAgaW5rc2NhcGU6em9vbT0iMi44Mjg0MjcxIgogICAgIGlua3NjYXBlOmN4PSIyODIuMzEyMzgiCiAgICAgaW5rc2NhcGU6Y3k9IjIyNy42ODgzOCIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjE5MjAiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iMTAxOCIKICAgICBpbmtzY2FwZTp3aW5kb3cteD0iLTYiCiAgICAgaW5rc2NhcGU6d2luZG93LXk9Ii02IgogICAgIGlua3NjYXBlOndpbmRvdy1tYXhpbWl6ZWQ9IjEiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ibGF5ZXIxIiAvPgogIDxkZWZzCiAgICAgaWQ9ImRlZnMxIj4KICAgIDxtYXJrZXIKICAgICAgIHN0eWxlPSJvdmVyZmxvdzp2aXNpYmxlIgogICAgICAgaWQ9IkRhcnRBcnJvdy00LTYiCiAgICAgICByZWZYPSIwIgogICAgICAgcmVmWT0iMCIKICAgICAgIG9yaWVudD0iYXV0by1zdGFydC1yZXZlcnNlIgogICAgICAgaW5rc2NhcGU6c3RvY2tpZD0iRGFydCBhcnJvdyIKICAgICAgIG1hcmtlcldpZHRoPSIxIgogICAgICAgbWFya2VySGVpZ2h0PSIxIgogICAgICAgdmlld0JveD0iMCAwIDEgMSIKICAgICAgIGlua3NjYXBlOmlzc3RvY2s9InRydWUiCiAgICAgICBpbmtzY2FwZTpjb2xsZWN0PSJhbHdheXMiCiAgICAgICBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJ4TWlkWU1pZCI+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJmaWxsOmNvbnRleHQtc3Ryb2tlO2ZpbGwtcnVsZTpldmVub2RkO3N0cm9rZTpub25lIgogICAgICAgICBkPSJNIDAsMCA1LC01IC0xMi41LDAgNSw1IFoiCiAgICAgICAgIHRyYW5zZm9ybT0ic2NhbGUoLTAuNSkiCiAgICAgICAgIGlkPSJwYXRoNi0wLTIiIC8+CiAgICA8L21hcmtlcj4KICA8L2RlZnM+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiCiAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTI1Ljg4MDU0NSwtOTYuMDc1MTE2KSI+CiAgICA8dGV4dAogICAgICAgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIKICAgICAgIHN0eWxlPSJmb250LXdlaWdodDpib2xkO2ZvbnQtc2l6ZToyLjExNjY3cHg7Zm9udC1mYW1pbHk6QXJpYWw7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjonQXJpYWwgQm9sZCc7dGV4dC1hbGlnbjpjZW50ZXI7dGV4dC1hbmNob3I6bWlkZGxlO2ZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MC4yOTg7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5OjEuMTkyLCAwLjI5ODtzdHJva2UtZGFzaG9mZnNldDowO3N0cm9rZS1vcGFjaXR5OjAiCiAgICAgICB4PSIzOC45NjgzNDkiCiAgICAgICB5PSIxMjMuMDk4MDUiCiAgICAgICBpZD0idGV4dDUtNyI+PHRzcGFuCiAgICAgICAgIHNvZGlwb2RpOnJvbGU9ImxpbmUiCiAgICAgICAgIHN0eWxlPSJmb250LXNpemU6Mi4xMTY2N3B4O3RleHQtYWxpZ246Y2VudGVyO3RleHQtYW5jaG9yOm1pZGRsZTtmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlLXdpZHRoOjAuMjk4IgogICAgICAgICB4PSIzOC45NjgzNDkiCiAgICAgICAgIHk9IjEyMy4wOTgwNSIKICAgICAgICAgaWQ9InRzcGFuNCI+YWJzb2x1dGU8L3RzcGFuPjx0c3BhbgogICAgICAgICBzb2RpcG9kaTpyb2xlPSJsaW5lIgogICAgICAgICBzdHlsZT0iZm9udC1zaXplOjIuMTE2NjdweDt0ZXh0LWFsaWduOmNlbnRlcjt0ZXh0LWFuY2hvcjptaWRkbGU7ZmlsbDojMDAwMDAwO2ZpbGwtb3BhY2l0eToxO3N0cm9rZS13aWR0aDowLjI5OCIKICAgICAgICAgeD0iMzguOTY4MzQ5IgogICAgICAgICB5PSIxMjUuNzQzODkiCiAgICAgICAgIGlkPSJ0c3BhbjciPnBvaW50IG9yaWdpbjwvdHNwYW4+PC90ZXh0PgogICAgPGcKICAgICAgIGlkPSJwYXRoOS0wLTYiPgogICAgICA8cGF0aAogICAgICAgICBzdHlsZT0iY29sb3I6IzAwMDAwMDtmaWxsOiMwMDAwMDA7LWlua3NjYXBlLXN0cm9rZTpub25lIgogICAgICAgICBkPSJtIDM4Ljk3NDYwOSwxMTYuNjg5NDUgLTAuMDg3ODksNC40NDE0MSAwLjE5OTIxOCwwLjAwNCAwLjA4NTk0LC00LjQ0MTQxIHoiCiAgICAgICAgIGlkPSJwYXRoNjIiIC8+CiAgICAgIDxnCiAgICAgICAgIGlkPSJnNjEiPgogICAgICAgIDxwYXRoCiAgICAgICAgICAgc3R5bGU9ImNvbG9yOiMwMDAwMDA7ZmlsbDojMDAwMDAwOy1pbmtzY2FwZS1zdHJva2U6bm9uZSIKICAgICAgICAgICBkPSJtIDM5LjA4MjAzMSwxMTYuMjc5MyAtMC43NDgwNDcsMS40MjM4MyAwLjI0ODA0NywwLjEzMDg1IDAuNDg4MjgxLC0wLjkyNzczIDAuNDQ5MjE5LDAuOTQ1MzEgMC4yNTM5MDYsLTAuMTE5MTQgeiIKICAgICAgICAgICBpZD0icGF0aDYxIiAvPgogICAgICA8L2c+CiAgICA8L2c+CiAgICA8dGV4dAogICAgICAgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIKICAgICAgIHN0eWxlPSJmb250LXdlaWdodDpib2xkO2ZvbnQtc2l6ZToyLjExNjY3cHg7Zm9udC1mYW1pbHk6QXJpYWw7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjonQXJpYWwgQm9sZCc7bWl4LWJsZW5kLW1vZGU6bm9ybWFsO2ZpbGw6I2E0YTRhNDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MDtzdHJva2UtZGFzaGFycmF5Om5vbmUiCiAgICAgICB4PSI5Ni4yMDIxOTQiCiAgICAgICB5PSI5Ny42MjAyNDciCiAgICAgICBpZD0idGV4dDItMi03LTQ5LTUtMy0yIj48dHNwYW4KICAgICAgICAgc29kaXBvZGk6cm9sZT0ibGluZSIKICAgICAgICAgaWQ9InRzcGFuMi05LTAtOTYtNC0xLTgiCiAgICAgICAgIHN0eWxlPSJmb250LXNpemU6Mi4xMTY2N3B4O2ZpbGw6I2E0YTRhNDtmaWxsLW9wYWNpdHk6MTtzdHJva2Utd2lkdGg6MDtzdHJva2UtZGFzaGFycmF5Om5vbmUiCiAgICAgICAgIHg9Ijk2LjIwMjE5NCIKICAgICAgICAgeT0iOTcuNjIwMjQ3Ij5xcDIgLSBxcDE8L3RzcGFuPjwvdGV4dD4KICAgIDx0ZXh0CiAgICAgICB4bWw6c3BhY2U9InByZXNlcnZlIgogICAgICAgc3R5bGU9ImZvbnQtd2VpZ2h0OmJvbGQ7Zm9udC1zaXplOjIuMTE2NjdweDtmb250LWZhbWlseTpBcmlhbDstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOidBcmlhbCBCb2xkJzttaXgtYmxlbmQtbW9kZTpub3JtYWw7ZmlsbDojYTRhNGE0O2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDowO3N0cm9rZS1kYXNoYXJyYXk6bm9uZSIKICAgICAgIHg9IjU0LjI0OTE3MiIKICAgICAgIHk9Ijk3LjYxNjExMiIKICAgICAgIGlkPSJ0ZXh0Mi0yLTctNDktNS0zLTItNiI+PHRzcGFuCiAgICAgICAgIHNvZGlwb2RpOnJvbGU9ImxpbmUiCiAgICAgICAgIGlkPSJ0c3BhbjItOS0wLTk2LTQtMS04LTgiCiAgICAgICAgIHN0eWxlPSJmb250LXNpemU6Mi4xMTY2N3B4O2ZpbGw6I2E0YTRhNDtmaWxsLW9wYWNpdHk6MTtzdHJva2Utd2lkdGg6MDtzdHJva2UtZGFzaGFycmF5Om5vbmUiCiAgICAgICAgIHg9IjU0LjI0OTE3MiIKICAgICAgICAgeT0iOTcuNjE2MTEyIj5xcDEucXVhbnRpdHlfZnJvbV96ZXJvKCk8L3RzcGFuPjwvdGV4dD4KICAgIDxnCiAgICAgICBpZD0icGF0aDgtMC05LTgtMCI+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJjb2xvcjojMDAwMDAwO2ZpbGw6I2E0YTRhNDtmaWxsLW9wYWNpdHk6MC45NjA3ODQ7LWlua3NjYXBlLXN0cm9rZTpub25lIgogICAgICAgICBkPSJNIDk0LjcwNzk1NCw5OS4wNzE4MjYgSCAxMDYuMzI0MzQiCiAgICAgICAgIGlkPSJwYXRoNTkiIC8+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJjb2xvcjojMDAwMDAwO2ZpbGw6I2E0YTRhNDtmaWxsLW9wYWNpdHk6MC45NjA3ODQ7LWlua3NjYXBlLXN0cm9rZTpub25lIgogICAgICAgICBkPSJtIDk0LjcwNzAzMSw5OC45NDcyNjYgdiAwLjI1IGggMTEuNjE3MTg5IHYgLTAuMjUgeiIKICAgICAgICAgaWQ9InBhdGg2MCIgLz4KICAgICAgPGcKICAgICAgICAgaWQ9Imc1OCI+CiAgICAgICAgPHBhdGgKICAgICAgICAgICBzdHlsZT0iY29sb3I6IzAwMDAwMDtmaWxsOiNhNGE0YTQ7LWlua3NjYXBlLXN0cm9rZTpub25lIgogICAgICAgICAgIGQ9Im0gMTA1LjAyOTMsOTguMTY0MDYyIC0wLjE1ODIxLDAuMzE2NDA3IDEuMTgzNiwwLjU5MTc5NyAtMS4xODM2LDAuNTkxNzk2IDAuMTU4MjEsMC4zMTY0MDcgMS44MTQ0NSwtMC45MDgyMDMgeiIKICAgICAgICAgICBpZD0icGF0aDU4IiAvPgogICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZwogICAgICAgaWQ9InBhdGg4LTAtOS04LTAtMCI+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJjb2xvcjojMDAwMDAwO2ZpbGw6I2E0YTRhNDtmaWxsLW9wYWNpdHk6MC45NjA3ODQ7LWlua3NjYXBlLXN0cm9rZTpub25lIgogICAgICAgICBkPSJNIDM5LjEwNzcxOSw5OS4wNzE4MjYgSCA5NC4xMTU3NzIiCiAgICAgICAgIGlkPSJwYXRoNTYiIC8+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJjb2xvcjojMDAwMDAwO2ZpbGw6I2E0YTRhNDtmaWxsLW9wYWNpdHk6MC45NjA3ODQ7LWlua3NjYXBlLXN0cm9rZTpub25lIgogICAgICAgICBkPSJtIDM5LjEwNzQyMiw5OC45NDcyNjYgdiAwLjI1IGggNTUuMDA3ODEyIHYgLTAuMjUgeiIKICAgICAgICAgaWQ9InBhdGg1NyIgLz4KICAgICAgPGcKICAgICAgICAgaWQ9Imc1NSI+CiAgICAgICAgPHBhdGgKICAgICAgICAgICBzdHlsZT0iY29sb3I6IzAwMDAwMDtmaWxsOiNhNGE0YTQ7LWlua3NjYXBlLXN0cm9rZTpub25lIgogICAgICAgICAgIGQ9Im0gOTIuODIwMzEyLDk4LjE2NDA2MiAtMC4xNTgyMDMsMC4zMTY0MDcgMS4xODM1OTQsMC41OTE3OTcgLTEuMTgzNTk0LDAuNTkxNzk2IDAuMTU4MjAzLDAuMzE2NDA3IDEuODE2NDA3LC0wLjkwODIwMyB6IgogICAgICAgICAgIGlkPSJwYXRoNTUiIC8+CiAgICAgIDwvZz4KICAgIDwvZz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDojMDAwMDAwO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDowLjU7c3Ryb2tlLWRhc2hhcnJheTpub25lO21hcmtlci1lbmQ6dXJsKCNEYXJ0QXJyb3ctNC02KSIKICAgICAgIGQ9Ik0gMjUuODgwNTQ1LDExMS44MzcwOCBIIDExOC44Nzc5OCIKICAgICAgIGlkPSJwYXRoNC01IiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjAuMzgxMjk4O3N0cm9rZS1kYXNoYXJyYXk6bm9uZSIKICAgICAgIGQ9Im0gMzkuMTY1MDk2LDExMC43OTcwMSB2IDIuMDgwMTMiCiAgICAgICBpZD0icGF0aDctNjgiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtzdHJva2U6I2E0YTRhNDtzdHJva2Utd2lkdGg6MC4yOTc4MjM7c3Ryb2tlLWRhc2hhcnJheToxLjE5MTI5LCAwLjI5NzgyMztzdHJva2UtZGFzaG9mZnNldDowO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDM5LjE2NTA5Niw5Ny4zNzQ5MjIgViAxMTAuNTg2ODYiCiAgICAgICBpZD0icGF0aDItMi03LTQiCiAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjIiAvPgogICAgPGcKICAgICAgIGlkPSJnMyI+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7c3Ryb2tlOiNhNGE0YTQ7c3Ryb2tlLXdpZHRoOjAuMjk3ODIzO3N0cm9rZS1kYXNoYXJyYXk6MS4xOTEyOSwgMC4yOTc4MjM7c3Ryb2tlLWRhc2hvZmZzZXQ6MDtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICBkPSJNIDEwNi44OTI3NSw5Ny40MjE2OTMgViAxMTAuNTg2ODYiCiAgICAgICAgIGlkPSJwYXRoMi0yLTEtNS02IgogICAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjIiAvPgogICAgICA8ZwogICAgICAgICBpZD0iZzUtOCIKICAgICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTQuMTY5NjQ1LDcyLjg0NzUwMikiPgogICAgICAgIDxwYXRoCiAgICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtzdHJva2U6I2E0YTRhNDtzdHJva2Utd2lkdGg6MC4yOTg7c3Ryb2tlLWRhc2hhcnJheToxLjE5MiwgMC4yOTg7c3Ryb2tlLWRhc2hvZmZzZXQ6MDtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICAgIGQ9Im0gODAuNTE1ODk1LDI0LjU4NDMxMyB2IDEzLjE1NDk4IgogICAgICAgICAgIGlkPSJwYXRoMi0yLTQtNC01IgogICAgICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICAgICAgPHBhdGgKICAgICAgICAgICBzdHlsZT0iZmlsbDojMDAwMDAwO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDowLjM4MTI5ODtzdHJva2UtZGFzaGFycmF5Om5vbmUiCiAgICAgICAgICAgZD0ibSA4MC41MTU4OTUsMzcuOTQ5NDQ1IHYgMi4wODAxMTYiCiAgICAgICAgICAgaWQ9InBhdGgyLTUtNC04IiAvPgogICAgICA8L2c+CiAgICA8L2c+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtzdHJva2U6I2E0YTRhNDtzdHJva2Utd2lkdGg6MC4yOTg7c3Ryb2tlLWRhc2hhcnJheToxLjE5MiwgMC4yOTg7c3Ryb2tlLWRhc2hvZmZzZXQ6MDtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0ibSA1MS4wMjc3MDQsMTA2Ljc4NjI4IHYgMy44MDA1NyIKICAgICAgIGlkPSJwYXRoMi0yLTQtNC05LTgiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MC4zODEyOTg7c3Ryb2tlLWRhc2hhcnJheTpub25lIgogICAgICAgZD0ibSA1MS4wMjc3MDQsMTEwLjc5NyB2IDIuMDgwMTIiCiAgICAgICBpZD0icGF0aDItNS00LTctNSIgLz4KICAgIDxnCiAgICAgICBpZD0iZzUtNy01LTAiCiAgICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTguOTg3MzA3LDcyLjg0NzUwMikiPgogICAgICA8cGF0aAogICAgICAgICBzdHlsZT0iZmlsbDojMDAwMDAwO3N0cm9rZTojYTRhNGE0O3N0cm9rZS13aWR0aDowLjI5ODtzdHJva2UtZGFzaGFycmF5OjEuMTkyLCAwLjI5ODtzdHJva2UtZGFzaG9mZnNldDowO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICAgIGQ9Im0gODAuNTE1ODk1LDMzLjkzODc0NiB2IDMuODAwNTQ3IgogICAgICAgICBpZD0icGF0aDItMi00LTQtOS04LTMiIC8+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjAuMzgxMjk4O3N0cm9rZS1kYXNoYXJyYXk6bm9uZSIKICAgICAgICAgZD0ibSA4MC41MTU4OTUsMzcuOTQ5NDQ1IHYgMi4wODAxMTYiCiAgICAgICAgIGlkPSJwYXRoMi01LTQtNy01LTgiIC8+CiAgICA8L2c+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MC4zODEyOTg7c3Ryb2tlLWRhc2hhcnJheTpub25lIgogICAgICAgZD0ibSAxMDYuODkyNzUsMTEwLjc5NzAxIHYgMi4wODAxMyIKICAgICAgIGlkPSJwYXRoMi01LTctNS0yIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7c3Ryb2tlOiNhNGE0YTQ7c3Ryb2tlLXdpZHRoOjAuMjk3ODIzO3N0cm9rZS1kYXNoYXJyYXk6MS4xOTEyOSwgMC4yOTc4MjM7c3Ryb2tlLWRhc2hvZmZzZXQ6MDtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0ibSA2OC45NDQ0MTcsMTAyLjUxOTg2IHYgOC4wNjciCiAgICAgICBpZD0icGF0aDItMi0xLTUtNi02IiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjAuMzgxMjk4O3N0cm9rZS1kYXNoYXJyYXk6bm9uZSIKICAgICAgIGQ9Im0gNjguOTQ0NDE3LDExMC43OTY5OSB2IDIuMDgwMTMiCiAgICAgICBpZD0icGF0aDItNS03LTUtMi0xIiAvPgogICAgPHRleHQKICAgICAgIHhtbDpzcGFjZT0icHJlc2VydmUiCiAgICAgICBzdHlsZT0iZm9udC13ZWlnaHQ6Ym9sZDtmb250LXNpemU6Mi40Njk0NHB4O2ZvbnQtZmFtaWx5OkFyaWFsOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246J0FyaWFsIEJvbGQnO2ZpbGw6IzAwMDBkZjtmaWxsLW9wYWNpdHk6MTtzdHJva2U6IzAwMDBlMDtzdHJva2Utd2lkdGg6MDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLW9wYWNpdHk6MC42MDc4NDMiCiAgICAgICB4PSI1MC4xMjI0NjMiCiAgICAgICB5PSIxMTUuNTE0MzciCiAgICAgICBpZD0idGV4dDItOC01Ij48dHNwYW4KICAgICAgICAgc29kaXBvZGk6cm9sZT0ibGluZSIKICAgICAgICAgaWQ9InRzcGFuMi02LTciCiAgICAgICAgIHN0eWxlPSJmb250LXNpemU6Mi40Njk0NHB4O2ZpbGw6IzAwMDBkZjtmaWxsLW9wYWNpdHk6MTtzdHJva2U6IzAwMDBlMDtzdHJva2Utd2lkdGg6MDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLW9wYWNpdHk6MC42MDc4NDMiCiAgICAgICAgIHg9IjUwLjEyMjQ2MyIKICAgICAgICAgeT0iMTE1LjUxNDM3Ij5CPC90c3Bhbj48L3RleHQ+CiAgICA8dGV4dAogICAgICAgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIKICAgICAgIHN0eWxlPSJmb250LXdlaWdodDpib2xkO2ZvbnQtc2l6ZToyLjQ2OTQ0cHg7Zm9udC1mYW1pbHk6QXJpYWw7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjonQXJpYWwgQm9sZCc7ZmlsbDojMDAwMDAwO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMjc5YjE0O3N0cm9rZS13aWR0aDowO3N0cm9rZS1kYXNoYXJyYXk6bm9uZTtzdHJva2Utb3BhY2l0eTowLjgxODE4MiIKICAgICAgIHg9IjM4LjI5MTk1NCIKICAgICAgIHk9IjExNS41MTQzNyIKICAgICAgIGlkPSJ0ZXh0Mi04LTctNCI+PHRzcGFuCiAgICAgICAgIHNvZGlwb2RpOnJvbGU9ImxpbmUiCiAgICAgICAgIGlkPSJ0c3BhbjItNi00LTQiCiAgICAgICAgIHN0eWxlPSJmb250LXNpemU6Mi40Njk0NHB4O2ZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6IzI3OWIxNDtzdHJva2Utd2lkdGg6MDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLW9wYWNpdHk6MC44MTgxODIiCiAgICAgICAgIHg9IjM4LjI5MTk1NCIKICAgICAgICAgeT0iMTE1LjUxNDM3Ij5BPC90c3Bhbj48L3RleHQ+CiAgICA8dGV4dAogICAgICAgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIKICAgICAgIHN0eWxlPSJmb250LXdlaWdodDpib2xkO2ZvbnQtc2l6ZToyLjQ2OTQ0cHg7Zm9udC1mYW1pbHk6QXJpYWw7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjonQXJpYWwgQm9sZCc7ZmlsbDojMDAwMGRmO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMGUwO3N0cm9rZS13aWR0aDowO3N0cm9rZS1kYXNoYXJyYXk6bm9uZTtzdHJva2Utb3BhY2l0eTowLjYwNzg0MyIKICAgICAgIHg9IjkyLjYzNjMyMiIKICAgICAgIHk9IjExNS4yNzQzOCIKICAgICAgIGlkPSJ0ZXh0Mi0yLTgtOSI+PHRzcGFuCiAgICAgICAgIHNvZGlwb2RpOnJvbGU9ImxpbmUiCiAgICAgICAgIGlkPSJ0c3BhbjItOS0zLTgiCiAgICAgICAgIHN0eWxlPSJmb250LXNpemU6Mi40Njk0NHB4O2ZpbGw6IzAwMDBkZjtmaWxsLW9wYWNpdHk6MTtzdHJva2U6IzAwMDBlMDtzdHJva2Utd2lkdGg6MDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLW9wYWNpdHk6MC42MDc4NDMiCiAgICAgICAgIHg9IjkyLjYzNjMyMiIKICAgICAgICAgeT0iMTE1LjI3NDM4Ij5xcDE8L3RzcGFuPjwvdGV4dD4KICAgIDx0ZXh0CiAgICAgICB4bWw6c3BhY2U9InByZXNlcnZlIgogICAgICAgc3R5bGU9ImZvbnQtd2VpZ2h0OmJvbGQ7Zm9udC1zaXplOjIuMTE2NjdweDtmb250LWZhbWlseTpBcmlhbDstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOidBcmlhbCBCb2xkJztmaWxsOiMwMDAwZGY7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOiMwMDAwZTA7c3Ryb2tlLXdpZHRoOjA7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1vcGFjaXR5OjAuNjA3ODQzIgogICAgICAgeD0iNzcuMDc1ODEzIgogICAgICAgeT0iMTA3LjU0OTk5IgogICAgICAgaWQ9InRleHQyLTItNy00LTYiPjx0c3BhbgogICAgICAgICBzb2RpcG9kaTpyb2xlPSJsaW5lIgogICAgICAgICBpZD0idHNwYW4yLTktMC05LTQiCiAgICAgICAgIHN0eWxlPSJmb250LXNpemU6Mi4xMTY2N3B4O2ZpbGw6IzAwMDBkZjtmaWxsLW9wYWNpdHk6MTtzdHJva2U6IzAwMDBlMDtzdHJva2Utd2lkdGg6MDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLW9wYWNpdHk6MC42MDc4NDMiCiAgICAgICAgIHg9Ijc3LjA3NTgxMyIKICAgICAgICAgeT0iMTA3LjU0OTk5Ij5xMTwvdHNwYW4+PC90ZXh0PgogICAgPHRleHQKICAgICAgIHhtbDpzcGFjZT0icHJlc2VydmUiCiAgICAgICBzdHlsZT0iZm9udC13ZWlnaHQ6Ym9sZDtmb250LXNpemU6Mi4xMTY2N3B4O2ZvbnQtZmFtaWx5OkFyaWFsOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246J0FyaWFsIEJvbGQnO2ZpbGw6IzAwMDBkZjtmaWxsLW9wYWNpdHk6MTtzdHJva2U6IzAwMDBlMDtzdHJva2Utd2lkdGg6MDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLW9wYWNpdHk6MC42MDc4NDMiCiAgICAgICB4PSI0Mi43NTAzODEiCiAgICAgICB5PSIxMDcuNTQ2ODkiCiAgICAgICBpZD0idGV4dDItMi03LTQtNi00NSI+PHRzcGFuCiAgICAgICAgIHNvZGlwb2RpOnJvbGU9ImxpbmUiCiAgICAgICAgIGlkPSJ0c3BhbjItOS0wLTktNC01IgogICAgICAgICBzdHlsZT0iZm9udC1zaXplOjIuMTE2NjdweDtmaWxsOiMwMDAwZGY7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOiMwMDAwZTA7c3Ryb2tlLXdpZHRoOjA7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1vcGFjaXR5OjAuNjA3ODQzIgogICAgICAgICB4PSI0Mi43NTAzODEiCiAgICAgICAgIHk9IjEwNy41NDY4OSI+cUFCPC90c3Bhbj48L3RleHQ+CiAgICA8dGV4dAogICAgICAgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIKICAgICAgIHN0eWxlPSJmb250LXdlaWdodDpib2xkO2ZvbnQtc2l6ZToyLjExNjY3cHg7Zm9udC1mYW1pbHk6QXJpYWw7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjonQXJpYWwgQm9sZCc7ZmlsbDojMDAwMGRmO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMGUwO3N0cm9rZS13aWR0aDowO3N0cm9rZS1kYXNoYXJyYXk6bm9uZTtzdHJva2Utb3BhY2l0eTowLjYwNzg0MyIKICAgICAgIHg9IjU0LjA0MjA2NSIKICAgICAgIHk9IjEwNy41NTk4MSIKICAgICAgIGlkPSJ0ZXh0Mi0yLTctNC02LTQ1LTMiPjx0c3BhbgogICAgICAgICBzb2RpcG9kaTpyb2xlPSJsaW5lIgogICAgICAgICBpZD0idHNwYW4yLTktMC05LTQtNS0zIgogICAgICAgICBzdHlsZT0iZm9udC1zaXplOjIuMTE2NjdweDtmaWxsOiMwMDAwZGY7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOiMwMDAwZTA7c3Ryb2tlLXdpZHRoOjA7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1vcGFjaXR5OjAuNjA3ODQzIgogICAgICAgICB4PSI1NC4wNDIwNjUiCiAgICAgICAgIHk9IjEwNy41NTk4MSI+cUJDPC90c3Bhbj48L3RleHQ+CiAgICA8dGV4dAogICAgICAgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIKICAgICAgIHN0eWxlPSJmb250LXdlaWdodDpib2xkO2ZvbnQtc2l6ZToyLjQ2OTQ0cHg7Zm9udC1mYW1pbHk6QXJpYWw7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjonQXJpYWwgQm9sZCc7ZmlsbDojZDQwMDAwO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojZDQwMDAwO3N0cm9rZS13aWR0aDowO3N0cm9rZS1kYXNoYXJyYXk6bm9uZTtzdHJva2Utb3BhY2l0eToxIgogICAgICAgeD0iMTA0LjcwNDg2IgogICAgICAgeT0iMTE1LjI3NDM4IgogICAgICAgaWQ9InRleHQyLTItMi0zLTAiPjx0c3BhbgogICAgICAgICBzb2RpcG9kaTpyb2xlPSJsaW5lIgogICAgICAgICBpZD0idHNwYW4yLTktNi0yOC0yIgogICAgICAgICBzdHlsZT0iZm9udC1zaXplOjIuNDY5NDRweDtmaWxsOiNkNDAwMDA7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOiNkNDAwMDA7c3Ryb2tlLXdpZHRoOjA7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICAgIHg9IjEwNC43MDQ4NiIKICAgICAgICAgeT0iMTE1LjI3NDM4Ij5xcDI8L3RzcGFuPjwvdGV4dD4KICAgIDxnCiAgICAgICBpZD0icGF0aDgtMiI+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJjb2xvcjojMDAwMDAwO2ZpbGw6IzAwMDBkZjstaW5rc2NhcGUtc3Ryb2tlOm5vbmUiCiAgICAgICAgIGQ9Ik0gNjEuNDg2NjUzLDEwOC42MDQ4OCBIIDk0LjI4OTY4NiIKICAgICAgICAgaWQ9InBhdGg1MCIgLz4KICAgICAgPHBhdGgKICAgICAgICAgc3R5bGU9ImNvbG9yOiMwMDAwMDA7ZmlsbDojMDAwMGUwO2ZpbGwtb3BhY2l0eTowLjYwNzg0MzstaW5rc2NhcGUtc3Ryb2tlOm5vbmUiCiAgICAgICAgIGQ9Im0gNjEuNDg2MzI4LDEwOC40OTIxOSB2IDAuMjI0NjEgaCAzMi44MDI3MzQgdiAtMC4yMjQ2MSB6IgogICAgICAgICBpZD0icGF0aDUxIiAvPgogICAgICA8ZwogICAgICAgICBpZD0iZzQ5Ij4KICAgICAgICA8cGF0aAogICAgICAgICAgIHN0eWxlPSJjb2xvcjojMDAwMDAwO2ZpbGw6IzAwMDBlMDstaW5rc2NhcGUtc3Ryb2tlOm5vbmUiCiAgICAgICAgICAgZD0ibSA5My4xMjY5NTMsMTA3Ljc5MTAyIC0wLjE0MjU3OCwwLjI4MzIgMS4wNjI1LDAuNTMxMjUgLTEuMDYyNSwwLjUzMTI1IDAuMTQyNTc4LDAuMjgzMiAxLjYyODkwNiwtMC44MTQ0NSB6IgogICAgICAgICAgIGlkPSJwYXRoNDkiIC8+CiAgICAgIDwvZz4KICAgIDwvZz4KICAgIDx0ZXh0CiAgICAgICB4bWw6c3BhY2U9InByZXNlcnZlIgogICAgICAgc3R5bGU9ImZvbnQtd2VpZ2h0OmJvbGQ7Zm9udC1zaXplOjIuMTE2NjdweDtmb250LWZhbWlseTpBcmlhbDstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOidBcmlhbCBCb2xkJztmaWxsOiNkNDAwMDA7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOiNkNDAwMDA7c3Ryb2tlLXdpZHRoOjA7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICB4PSI4Ni43Mjg5MzUiCiAgICAgICB5PSIxMDIuOTgyNDQiCiAgICAgICBpZD0idGV4dDItMi03LTQtNi00Ij48dHNwYW4KICAgICAgICAgc29kaXBvZGk6cm9sZT0ibGluZSIKICAgICAgICAgaWQ9InRzcGFuMi05LTAtOS00LTQiCiAgICAgICAgIHN0eWxlPSJmb250LXNpemU6Mi4xMTY2N3B4O2ZpbGw6I2Q0MDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6I2Q0MDAwMDtzdHJva2Utd2lkdGg6MDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgeD0iODYuNzI4OTM1IgogICAgICAgICB5PSIxMDIuOTgyNDQiPnEyPC90c3Bhbj48L3RleHQ+CiAgICA8ZwogICAgICAgaWQ9InBhdGg4LTItNSI+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJjb2xvcjojMDAwMDAwO2ZpbGw6I2Q0MDAwMDstaW5rc2NhcGUtc3Ryb2tlOm5vbmUiCiAgICAgICAgIGQ9Ik0gNjguOTA4MTczLDEwNC4wMzcyNyBIIDEwNi4zNDU5OCIKICAgICAgICAgaWQ9InBhdGg1MyIgLz4KICAgICAgPHBhdGgKICAgICAgICAgc3R5bGU9ImNvbG9yOiMwMDAwMDA7ZmlsbDojZDQwMDAwOy1pbmtzY2FwZS1zdHJva2U6bm9uZSIKICAgICAgICAgZD0ibSA2OC45MDgyMDMsMTAzLjkyMTg4IHYgMC4yMzA0NiBIIDEwNi4zNDU3IHYgLTAuMjMwNDYgeiIKICAgICAgICAgaWQ9InBhdGg1NCIgLz4KICAgICAgPGcKICAgICAgICAgaWQ9Imc1MiI+CiAgICAgICAgPHBhdGgKICAgICAgICAgICBzdHlsZT0iY29sb3I6IzAwMDAwMDtmaWxsOiNkNDAwMDA7LWlua3NjYXBlLXN0cm9rZTpub25lIgogICAgICAgICAgIGQ9Im0gMTA1LjE0ODQ0LDEwMy4xOTkyMiAtMC4xNDY0OSwwLjI5MTAxIDEuMDkzNzUsMC41NDY4OCAtMS4wOTM3NSwwLjU0Njg3IDAuMTQ2NDksMC4yOTI5NyAxLjY3NzczLC0wLjgzOTg0IHoiCiAgICAgICAgICAgaWQ9InBhdGg1MiIgLz4KICAgICAgPC9nPgogICAgPC9nPgogICAgPHRleHQKICAgICAgIHhtbDpzcGFjZT0icHJlc2VydmUiCiAgICAgICBzdHlsZT0iZm9udC13ZWlnaHQ6Ym9sZDtmb250LXNpemU6Mi40Njk0NHB4O2ZvbnQtZmFtaWx5OkFyaWFsOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246J0FyaWFsIEJvbGQnO2ZpbGw6IzAwMDBkZjtmaWxsLW9wYWNpdHk6MTtzdHJva2U6IzAwMDBlMDtzdHJva2Utd2lkdGg6MDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLW9wYWNpdHk6MC42MDc4NDMiCiAgICAgICB4PSI2MC44MDE2OTciCiAgICAgICB5PSIxMTUuNTE0MzciCiAgICAgICBpZD0idGV4dDItOC01LTgiPjx0c3BhbgogICAgICAgICBzb2RpcG9kaTpyb2xlPSJsaW5lIgogICAgICAgICBpZD0idHNwYW4yLTYtNy00IgogICAgICAgICBzdHlsZT0iZm9udC1zaXplOjIuNDY5NDRweDtmaWxsOiMwMDAwZGY7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOiMwMDAwZTA7c3Ryb2tlLXdpZHRoOjA7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1vcGFjaXR5OjAuNjA3ODQzIgogICAgICAgICB4PSI2MC44MDE2OTciCiAgICAgICAgIHk9IjExNS41MTQzNyI+QzwvdHNwYW4+PC90ZXh0PgogICAgPHRleHQKICAgICAgIHhtbDpzcGFjZT0icHJlc2VydmUiCiAgICAgICBzdHlsZT0iZm9udC13ZWlnaHQ6Ym9sZDtmb250LXNpemU6Mi40Njk0NHB4O2ZvbnQtZmFtaWx5OkFyaWFsOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246J0FyaWFsIEJvbGQnO2ZpbGw6I2Q0MDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6I2Q0MDAwMDtzdHJva2Utd2lkdGg6MDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIHg9IjY4LjAyNTAwOSIKICAgICAgIHk9IjExNS40ODQyMyIKICAgICAgIGlkPSJ0ZXh0Mi04LTUtOC0zIj48dHNwYW4KICAgICAgICAgc29kaXBvZGk6cm9sZT0ibGluZSIKICAgICAgICAgaWQ9InRzcGFuMi02LTctNC0wIgogICAgICAgICBzdHlsZT0iZm9udC1zaXplOjIuNDY5NDRweDtmaWxsOiNkNDAwMDA7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOiNkNDAwMDA7c3Ryb2tlLXdpZHRoOjA7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICAgIHg9IjY4LjAyNTAwOSIKICAgICAgICAgeT0iMTE1LjQ4NDIzIj5EPC90c3Bhbj48L3RleHQ+CiAgICA8ZwogICAgICAgaWQ9InBhdGg4LTItMyI+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJjb2xvcjojMDAwMDAwO2ZpbGw6IzAwMDBkZjtzdHJva2UtZGFzaGFycmF5OjAuNDQ4NjQyLCAwLjIyNDMyMTstaW5rc2NhcGUtc3Ryb2tlOm5vbmUiCiAgICAgICAgIGQ9Ik0gMzkuMzE3MDczLDEwOC42MDQ4OCBIIDUwLjUyMzQ4NiIKICAgICAgICAgaWQ9InBhdGg0NCIgLz4KICAgICAgPHBhdGgKICAgICAgICAgc3R5bGU9ImNvbG9yOiMwMDAwMDA7ZmlsbDojMDAwMGUwO2ZpbGwtb3BhY2l0eTowLjYwNzg0MztzdHJva2UtZGFzaGFycmF5OjAuNDQ4NjQyLCAwLjIyNDMyMTstaW5rc2NhcGUtc3Ryb2tlOm5vbmUiCiAgICAgICAgIGQ9Im0gMzkuMzE2NDA2LDEwOC40OTIxOSB2IDAuMjI0NjEgaCAwLjQ0OTIxOSB2IC0wLjIyNDYxIHogbSAwLjY3MzgyOCwwIHYgMC4yMjQ2MSBoIDAuNDQ5MjE5IHYgLTAuMjI0NjEgeiBtIDAuNjcxODc1LDAgdiAwLjIyNDYxIGggMC40NDkyMTkgdiAtMC4yMjQ2MSB6IG0gMC42NzM4MjgsMCB2IDAuMjI0NjEgaCAwLjQ0OTIxOSB2IC0wLjIyNDYxIHogbSAwLjY3MzgyOSwwIHYgMC4yMjQ2MSBoIDAuNDQ3MjY1IHYgLTAuMjI0NjEgeiBtIDAuNjcxODc1LDAgdiAwLjIyNDYxIGggMC40NDkyMTggdiAtMC4yMjQ2MSB6IG0gMC42NzM4MjgsMCB2IDAuMjI0NjEgaCAwLjQ0NzI2NSB2IC0wLjIyNDYxIHogbSAwLjY3MTg3NSwwIHYgMC4yMjQ2MSBoIDAuNDQ5MjE4IHYgLTAuMjI0NjEgeiBtIDAuNjczODI4LDAgdiAwLjIyNDYxIGggMC40NDkyMTkgdiAtMC4yMjQ2MSB6IG0gMC42NzE4NzUsMCB2IDAuMjI0NjEgaCAwLjQ0OTIxOSB2IC0wLjIyNDYxIHogbSAwLjY3MzgyOCwwIHYgMC4yMjQ2MSBoIDAuNDQ5MjE5IHYgLTAuMjI0NjEgeiBtIDAuNjcxODc1LDAgdiAwLjIyNDYxIGggMC40NDkyMTkgdiAtMC4yMjQ2MSB6IG0gMC42NzM4MjgsMCB2IDAuMjI0NjEgaCAwLjQ0OTIxOSB2IC0wLjIyNDYxIHogbSAwLjY3MzgyOCwwIHYgMC4yMjQ2MSBoIDAuNDQ3MjY2IHYgLTAuMjI0NjEgeiBtIDAuNjcxODc1LDAgdiAwLjIyNDYxIEggNDkuMTg3NSB2IC0wLjIyNDYxIHogbSAwLjY3MzgyOCwwIHYgMC4yMjQ2MSBoIDAuNDQ3MjY2IHYgLTAuMjI0NjEgeiBtIDAuNjcxODc1LDAgdiAwLjIyNDYxIGggMC40Mzk0NTMgdiAtMC4yMjQ2MSB6IgogICAgICAgICBpZD0icGF0aDQ1IiAvPgogICAgICA8ZwogICAgICAgICBpZD0iZzQzIj4KICAgICAgICA8cGF0aAogICAgICAgICAgIHN0eWxlPSJjb2xvcjojMDAwMDAwO2ZpbGw6IzAwMDBlMDstaW5rc2NhcGUtc3Ryb2tlOm5vbmUiCiAgICAgICAgICAgZD0ibSA0OS4zNjEzMjgsMTA3Ljc5MTAyIC0wLjE0MjU3OCwwLjI4MzIgMS4wNjI1LDAuNTMxMjUgLTEuMDYyNSwwLjUzMTI1IDAuMTQyNTc4LDAuMjgzMiAxLjYyODkwNiwtMC44MTQ0NSB6IgogICAgICAgICAgIGlkPSJwYXRoNDMiIC8+CiAgICAgIDwvZz4KICAgIDwvZz4KICAgIDx0ZXh0CiAgICAgICB4bWw6c3BhY2U9InByZXNlcnZlIgogICAgICAgc3R5bGU9ImZvbnQtd2VpZ2h0OmJvbGQ7Zm9udC1zaXplOjIuMTE2NjdweDtmb250LWZhbWlseTpBcmlhbDstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOidBcmlhbCBCb2xkJztmaWxsOiNkNDAwMDA7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOiNkNDAwMDA7c3Ryb2tlLXdpZHRoOjA7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICB4PSI1MS44NjE1IgogICAgICAgeT0iMTAyLjk3OTM0IgogICAgICAgaWQ9InRleHQyLTItNy00LTYtNDUtOCI+PHRzcGFuCiAgICAgICAgIHNvZGlwb2RpOnJvbGU9ImxpbmUiCiAgICAgICAgIGlkPSJ0c3BhbjItOS0wLTktNC01LTMyIgogICAgICAgICBzdHlsZT0iZm9udC1zaXplOjIuMTE2NjdweDtmaWxsOiNkNDAwMDA7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOiNkNDAwMDA7c3Ryb2tlLXdpZHRoOjA7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICAgIHg9IjUxLjg2MTUiCiAgICAgICAgIHk9IjEwMi45NzkzNCI+cUFEPC90c3Bhbj48L3RleHQ+CiAgICA8ZwogICAgICAgaWQ9InBhdGg4LTItMy0xIj4KICAgICAgPHBhdGgKICAgICAgICAgc3R5bGU9ImNvbG9yOiMwMDAwMDA7ZmlsbDojZDQwMDAwO3N0cm9rZS1kYXNoYXJyYXk6MC40NDg2NDIsIDAuMjI0MzIxOy1pbmtzY2FwZS1zdHJva2U6bm9uZSIKICAgICAgICAgZD0iTSAzOS4yMTcwNzcsMTA0LjAzNzI3IEggNjguMzgxNjU4IgogICAgICAgICBpZD0icGF0aDQxIiAvPgogICAgICA8cGF0aAogICAgICAgICBzdHlsZT0iY29sb3I6IzAwMDAwMDtmaWxsOiNkNDAwMDA7c3Ryb2tlLWRhc2hhcnJheTowLjQ0ODY0MiwgMC4yMjQzMjE7LWlua3NjYXBlLXN0cm9rZTpub25lIgogICAgICAgICBkPSJtIDM5LjIxNjc5NywxMDMuOTI1NzggdiAwLjIyNDYxIGggMC40NDkyMTkgdiAtMC4yMjQ2MSB6IG0gMC42NzM4MjgsMCB2IDAuMjI0NjEgaCAwLjQ0NzI2NiB2IC0wLjIyNDYxIHogbSAwLjY3MTg3NSwwIHYgMC4yMjQ2MSBoIDAuNDQ5MjE5IHYgLTAuMjI0NjEgeiBtIDAuNjczODI4LDAgdiAwLjIyNDYxIGggMC40NDkyMTkgdiAtMC4yMjQ2MSB6IG0gMC42NzE4NzUsMCB2IDAuMjI0NjEgaCAwLjQ0OTIxOSB2IC0wLjIyNDYxIHogbSAwLjY3MzgyOCwwIHYgMC4yMjQ2MSBoIDAuNDQ5MjE5IHYgLTAuMjI0NjEgeiBtIDAuNjcxODc1LDAgdiAwLjIyNDYxIGggMC40NDkyMTkgdiAtMC4yMjQ2MSB6IG0gMC42NzM4MjgsMCB2IDAuMjI0NjEgaCAwLjQ0OTIxOSB2IC0wLjIyNDYxIHogbSAwLjY3MzgyOCwwIHYgMC4yMjQ2MSBoIDAuNDQ3MjY2IHYgLTAuMjI0NjEgeiBtIDAuNjcxODc1LDAgdiAwLjIyNDYxIGggMC40NDkyMTkgdiAtMC4yMjQ2MSB6IG0gMC42NzM4MjksMCB2IDAuMjI0NjEgaCAwLjQ0NzI2NSB2IC0wLjIyNDYxIHogbSAwLjY3MTg3NSwwIHYgMC4yMjQ2MSBoIDAuNDQ5MjE4IHYgLTAuMjI0NjEgeiBtIDAuNjczODI4LDAgdiAwLjIyNDYxIGggMC40NDkyMTggdiAtMC4yMjQ2MSB6IG0gMC42NzE4NzUsMCB2IDAuMjI0NjEgaCAwLjQ0OTIxOCB2IC0wLjIyNDYxIHogbSAwLjY3MzgyOCwwIHYgMC4yMjQ2MSBoIDAuNDQ5MjE5IHYgLTAuMjI0NjEgeiBtIDAuNjcxODc1LDAgdiAwLjIyNDYxIGggMC40NDkyMTkgdiAtMC4yMjQ2MSB6IG0gMC42NzM4MjgsMCB2IDAuMjI0NjEgaCAwLjQ0OTIxOSB2IC0wLjIyNDYxIHogbSAwLjY3MzgyOCwwIHYgMC4yMjQ2MSBoIDAuNDQ3MjY2IHYgLTAuMjI0NjEgeiBtIDAuNjcxODc1LDAgdiAwLjIyNDYxIGggMC40NDkyMTkgdiAtMC4yMjQ2MSB6IG0gMC42NzM4MjgsMCB2IDAuMjI0NjEgaCAwLjQ0NzI2NiB2IC0wLjIyNDYxIHogbSAwLjY3MTg3NSwwIHYgMC4yMjQ2MSBIIDUzLjEyNSB2IC0wLjIyNDYxIHogbSAwLjY3MzgyOCwwIHYgMC4yMjQ2MSBoIDAuNDQ5MjE5IHYgLTAuMjI0NjEgeiBtIDAuNjcxODc1LDAgdiAwLjIyNDYxIGggMC40NDkyMTkgdiAtMC4yMjQ2MSB6IG0gMC42NzM4MjgsMCB2IDAuMjI0NjEgaCAwLjQ0OTIxOSB2IC0wLjIyNDYxIHogbSAwLjY3MzgyOSwwIHYgMC4yMjQ2MSBoIDAuNDQ3MjY1IHYgLTAuMjI0NjEgeiBtIDAuNjcxODc1LDAgdiAwLjIyNDYxIGggMC40NDkyMTggdiAtMC4yMjQ2MSB6IG0gMC42NzM4MjgsMCB2IDAuMjI0NjEgaCAwLjQ0NzI2NSB2IC0wLjIyNDYxIHogbSAwLjY3MTg3NSwwIHYgMC4yMjQ2MSBoIDAuNDQ5MjE4IHYgLTAuMjI0NjEgeiBtIDAuNjczODI4LDAgdiAwLjIyNDYxIGggMC40NDcyNjUgdiAtMC4yMjQ2MSB6IG0gMC42NzE4NzUsMCB2IDAuMjI0NjEgaCAwLjQ0OTIxOSB2IC0wLjIyNDYxIHogbSAwLjY3MzgyOCwwIHYgMC4yMjQ2MSBoIDAuNDQ5MjE5IHYgLTAuMjI0NjEgeiBtIDAuNjcxODc1LDAgdiAwLjIyNDYxIGggMC40NDkyMTkgdiAtMC4yMjQ2MSB6IG0gMC42NzM4MjgsMCB2IDAuMjI0NjEgaCAwLjQ0OTIxOSB2IC0wLjIyNDYxIHogbSAwLjY3MzgyOCwwIHYgMC4yMjQ2MSBoIDAuNDQ3MjY2IHYgLTAuMjI0NjEgeiBtIDAuNjcxODc1LDAgdiAwLjIyNDYxIGggMC40NDkyMTkgdiAtMC4yMjQ2MSB6IG0gMC42NzM4MjgsMCB2IDAuMjI0NjEgaCAwLjQ0NzI2NiB2IC0wLjIyNDYxIHogbSAwLjY3MTg3NSwwIHYgMC4yMjQ2MSBoIDAuNDQ5MjE5IHYgLTAuMjI0NjEgeiBtIDAuNjczODI4LDAgdiAwLjIyNDYxIGggMC40NDcyNjYgdiAtMC4yMjQ2MSB6IG0gMC42NzE4NzUsMCB2IDAuMjI0NjEgaCAwLjQ0OTIxOSB2IC0wLjIyNDYxIHogbSAwLjY3MzgyOSwwIHYgMC4yMjQ2MSBoIDAuNDQ5MjE4IHYgLTAuMjI0NjEgeiBtIDAuNjcxODc1LDAgdiAwLjIyNDYxIGggMC40NDkyMTggdiAtMC4yMjQ2MSB6IG0gMC42NzM4MjgsMCB2IDAuMjI0NjEgaCAwLjQ0OTIxOCB2IC0wLjIyNDYxIHogbSAwLjY3MzgyOCwwIHYgMC4yMjQ2MSBoIDAuNDQ3MjY1IHYgLTAuMjI0NjEgeiBtIDAuNjcxODc1LDAgdiAwLjIyNDYxIGggMC4yMjY1NjIgdiAtMC4yMjQ2MSB6IgogICAgICAgICBpZD0icGF0aDQyIiAvPgogICAgICA8ZwogICAgICAgICBpZD0iZzQwIj4KICAgICAgICA8cGF0aAogICAgICAgICAgIHN0eWxlPSJjb2xvcjojMDAwMDAwO2ZpbGw6I2Q0MDAwMDstaW5rc2NhcGUtc3Ryb2tlOm5vbmUiCiAgICAgICAgICAgZD0ibSA2Ny4yMTg3NSwxMDMuMjIyNjYgLTAuMTQyNTc4LDAuMjgzMiAxLjA2MjUsMC41MzEyNSAtMS4wNjI1LDAuNTMxMjUgMC4xNDI1NzgsMC4yODMyIDEuNjI4OTA2LC0wLjgxNDQ1IHoiCiAgICAgICAgICAgaWQ9InBhdGg0MCIgLz4KICAgICAgPC9nPgogICAgPC9nPgogICAgPGcKICAgICAgIGlkPSJwYXRoOC0yLTMtOCI+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJjb2xvcjojMDAwMDAwO2ZpbGw6IzAwMDBkZjtzdHJva2UtZGFzaGFycmF5OjAuNDQ4NjQyLCAwLjIyNDMyMTstaW5rc2NhcGUtc3Ryb2tlOm5vbmUiCiAgICAgICAgIGQ9Im0gNTEuMzAxNzczLDEwOC42MDQ4OCBoIDkuODE2MjM5IgogICAgICAgICBpZD0icGF0aDQ3IiAvPgogICAgICA8cGF0aAogICAgICAgICBzdHlsZT0iY29sb3I6IzAwMDAwMDtmaWxsOiMwMDAwZTA7ZmlsbC1vcGFjaXR5OjAuNjA3ODQzO3N0cm9rZS1kYXNoYXJyYXk6MC40NDg2NDIsIDAuMjI0MzIxOy1pbmtzY2FwZS1zdHJva2U6bm9uZSIKICAgICAgICAgZD0ibSA1MS4zMDI3MzQsMTA4LjQ5MjE5IHYgMC4yMjQ2MSBIIDUxLjc1IHYgLTAuMjI0NjEgeiBtIDAuNjcxODc1LDAgdiAwLjIyNDYxIGggMC40NDkyMTkgdiAtMC4yMjQ2MSB6IG0gMC42NzM4MjgsMCB2IDAuMjI0NjEgaCAwLjQ0NzI2NiB2IC0wLjIyNDYxIHogbSAwLjY3MTg3NSwwIHYgMC4yMjQ2MSBoIDAuNDQ5MjE5IHYgLTAuMjI0NjEgeiBtIDAuNjczODI5LDAgdiAwLjIyNDYxIGggMC40NDcyNjUgdiAtMC4yMjQ2MSB6IG0gMC42NzE4NzUsMCB2IDAuMjI0NjEgaCAwLjQ0OTIxOCB2IC0wLjIyNDYxIHogbSAwLjY3MzgyOCwwIHYgMC4yMjQ2MSBoIDAuNDQ5MjE4IHYgLTAuMjI0NjEgeiBtIDAuNjcxODc1LDAgdiAwLjIyNDYxIGggMC40NDkyMTggdiAtMC4yMjQ2MSB6IG0gMC42NzM4MjgsMCB2IDAuMjI0NjEgaCAwLjQ0OTIxOSB2IC0wLjIyNDYxIHogbSAwLjY3MzgyOCwwIHYgMC4yMjQ2MSBoIDAuNDQ3MjY2IHYgLTAuMjI0NjEgeiBtIDAuNjcxODc1LDAgdiAwLjIyNDYxIGggMC40NDkyMTkgdiAtMC4yMjQ2MSB6IG0gMC42NzM4MjgsMCB2IDAuMjI0NjEgaCAwLjQ0NzI2NiB2IC0wLjIyNDYxIHogbSAwLjY3MTg3NSwwIHYgMC4yMjQ2MSBoIDAuNDQ5MjE5IHYgLTAuMjI0NjEgeiBtIDAuNjczODI4LDAgdiAwLjIyNDYxIGggMC40NDcyNjYgdiAtMC4yMjQ2MSB6IG0gMC42NzE4NzUsMCB2IDAuMjI0NjEgaCAwLjM5NDUzMSB2IC0wLjIyNDYxIHoiCiAgICAgICAgIGlkPSJwYXRoNDgiIC8+CiAgICAgIDxnCiAgICAgICAgIGlkPSJnNDYiPgogICAgICAgIDxwYXRoCiAgICAgICAgICAgc3R5bGU9ImNvbG9yOiMwMDAwMDA7ZmlsbDojMDAwMGUwOy1pbmtzY2FwZS1zdHJva2U6bm9uZSIKICAgICAgICAgICBkPSJtIDU5Ljk1NTA3OCwxMDcuNzkxMDIgLTAuMTQyNTc4LDAuMjgzMiAxLjA2NDQ1MywwLjUzMTI1IC0xLjA2NDQ1MywwLjUzMTI1IDAuMTQyNTc4LDAuMjgzMiAxLjYyODkwNiwtMC44MTQ0NSB6IgogICAgICAgICAgIGlkPSJwYXRoNDYiIC8+CiAgICAgIDwvZz4KICAgIDwvZz4KICAgIDx0ZXh0CiAgICAgICB4bWw6c3BhY2U9InByZXNlcnZlIgogICAgICAgc3R5bGU9ImZvbnQtd2VpZ2h0OmJvbGQ7Zm9udC1zaXplOjIuODIyMjJweDtmb250LWZhbWlseTpBcmlhbDstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOidBcmlhbCBCb2xkJztmaWxsOiMwMDAwMDA7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjAiCiAgICAgICB4PSIxMjAuMDQ5NDgiCiAgICAgICB5PSIxMTUuNTU2NTMiCiAgICAgICBpZD0idGV4dDEtOSI+PHRzcGFuCiAgICAgICAgIHNvZGlwb2RpOnJvbGU9ImxpbmUiCiAgICAgICAgIGlkPSJ0c3BhbjEtMiIKICAgICAgICAgc3R5bGU9ImZvbnQtc2l6ZToyLjgyMjIycHg7c3Ryb2tlLXdpZHRoOjAiCiAgICAgICAgIHg9IjEyMC4wNDk0OCIKICAgICAgICAgeT0iMTE1LjU1NjUzIj5RPC90c3Bhbj48L3RleHQ+CiAgICA8dGV4dAogICAgICAgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIKICAgICAgIHN0eWxlPSJmb250LXdlaWdodDpib2xkO2ZvbnQtc2l6ZToyLjExNjY3cHg7Zm9udC1mYW1pbHk6QXJpYWw7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjonQXJpYWwgQm9sZCc7dGV4dC1hbGlnbjpjZW50ZXI7dGV4dC1hbmNob3I6bWlkZGxlO2ZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MC4yOTg7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5OjEuMTkyLCAwLjI5ODtzdHJva2UtZGFzaG9mZnNldDowO3N0cm9rZS1vcGFjaXR5OjAiCiAgICAgICB4PSI2MC43MjU2NzQiCiAgICAgICB5PSIxMjMuMDk4MDUiCiAgICAgICBpZD0idGV4dDUtNy0zIj48dHNwYW4KICAgICAgICAgc29kaXBvZGk6cm9sZT0ibGluZSIKICAgICAgICAgc3R5bGU9ImZvbnQtc2l6ZToyLjExNjY3cHg7dGV4dC1hbGlnbjpjZW50ZXI7dGV4dC1hbmNob3I6bWlkZGxlO2ZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2Utd2lkdGg6MC4yOTgiCiAgICAgICAgIHg9IjYwLjcyNTY3NCIKICAgICAgICAgeT0iMTIzLjA5ODA1IgogICAgICAgICBpZD0idHNwYW43LTIiPnJlbGF0aXZlPC90c3Bhbj48dHNwYW4KICAgICAgICAgc29kaXBvZGk6cm9sZT0ibGluZSIKICAgICAgICAgc3R5bGU9ImZvbnQtc2l6ZToyLjExNjY3cHg7dGV4dC1hbGlnbjpjZW50ZXI7dGV4dC1hbmNob3I6bWlkZGxlO2ZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2Utd2lkdGg6MC4yOTgiCiAgICAgICAgIHg9IjYwLjcyNTY3NCIKICAgICAgICAgeT0iMTI1Ljc0Mzg5IgogICAgICAgICBpZD0idHNwYW44Ij5wb2ludCBvcmlnaW5zPC90c3Bhbj48L3RleHQ+CiAgICA8ZwogICAgICAgaWQ9InBhdGg5LTAtNi0wIj4KICAgICAgPHBhdGgKICAgICAgICAgc3R5bGU9ImNvbG9yOiMwMDAwMDA7ZmlsbDojMDAwMDAwOy1pbmtzY2FwZS1zdHJva2U6bm9uZSIKICAgICAgICAgZD0ibSA1Mi40NzQ2MDksMTE2LjI4MzIgLTAuMTIxMDkzLDAuMTU2MjUgNS40Njg3NSw0LjI0NDE0IDAuMTIxMDkzLC0wLjE1ODIgeiIKICAgICAgICAgaWQ9InBhdGg2NCIgLz4KICAgICAgPGcKICAgICAgICAgaWQ9Imc2MyI+CiAgICAgICAgPHBhdGgKICAgICAgICAgICBzdHlsZT0iY29sb3I6IzAwMDAwMDtmaWxsOiMwMDAwMDA7LWlua3NjYXBlLXN0cm9rZTpub25lIgogICAgICAgICAgIGQ9Im0gNTIuMDg5ODQ0LDExNi4xMDc0MiAwLjY5NTMxMiwxLjQ1MTE3IDAuMjUxOTUzLC0wLjEyMTA5IC0wLjQ1MzEyNSwtMC45NDUzMSAxLjAyNzM0NCwwLjIwNTA4IDAuMDU0NjksLTAuMjc1MzkgeiIKICAgICAgICAgICBpZD0icGF0aDYzIiAvPgogICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZwogICAgICAgaWQ9InBhdGg5LTAtNi0yIj4KICAgICAgPHBhdGgKICAgICAgICAgc3R5bGU9ImNvbG9yOiMwMDAwMDA7ZmlsbDojMDAwMDAwOy1pbmtzY2FwZS1zdHJva2U6bm9uZSIKICAgICAgICAgZD0ibSA2MS4zODA4NTksMTE2LjQwMjM0IC0xLjA4MDA3OCw0LjI0NDE0IDAuMTkxNDA2LDAuMDQ4OCAxLjA4MDA3OSwtNC4yNDQxNCB6IgogICAgICAgICBpZD0icGF0aDY2IiAvPgogICAgICA8ZwogICAgICAgICBpZD0iZzY1Ij4KICAgICAgICA8cGF0aAogICAgICAgICAgIHN0eWxlPSJjb2xvcjojMDAwMDAwO2ZpbGw6IzAwMDAwMDstaW5rc2NhcGUtc3Ryb2tlOm5vbmUiCiAgICAgICAgICAgZD0ibSA2MS41NzgxMjUsMTE2LjAyNzM0IC0xLjA1MDc4MSwxLjIxNjggMC4yMTA5MzcsMC4xODM1OSAwLjY4NTU0NywtMC43OTQ5MiAwLjIyMjY1NiwxLjAyNTM5IDAuMjczNDM4LC0wLjA1ODYgeiIKICAgICAgICAgICBpZD0icGF0aDY1IiAvPgogICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZwogICAgICAgaWQ9InBhdGg5LTAtNi04Ij4KICAgICAgPHBhdGgKICAgICAgICAgc3R5bGU9ImNvbG9yOiMwMDAwMDA7ZmlsbDojMDAwMDAwOy1pbmtzY2FwZS1zdHJva2U6bm9uZSIKICAgICAgICAgZD0ibSA2Ny40Mjk2ODcsMTE2LjQ4NjMzIC00LjQ1NTA3OCw0LjExMTMzIDAuMTM0NzY2LDAuMTQ2NDggNC40NTMxMjUsLTQuMTExMzMgeiIKICAgICAgICAgaWQ9InBhdGg2OCIgLz4KICAgICAgPGcKICAgICAgICAgaWQ9Imc2NyI+CiAgICAgICAgPHBhdGgKICAgICAgICAgICBzdHlsZT0iY29sb3I6IzAwMDAwMDtmaWxsOiMwMDAwMDA7LWlua3NjYXBlLXN0cm9rZTpub25lIgogICAgICAgICAgIGQ9Im0gNjcuNzk4ODI4LDExNi4yNzkzIC0xLjU0NDkyMiwwLjQ0NzI2IDAuMDc4MTMsMC4yNjk1MyAxLjAwNzgxMywtMC4yOTEwMSAtMC4zNzEwOTQsMC45ODA0NyAwLjI2MTcxOSwwLjA5NzYgeiIKICAgICAgICAgICBpZD0icGF0aDY3IiAvPgogICAgICA8L2c+CiAgICA8L2c+CiAgPC9nPgo8L3N2Zz4K" style="display: block; margin-left: auto; margin-right: auto; width: 70%;" /></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> A <span class="op">:</span> absolute_point_origin<span class="op">&lt;</span>A, isq<span class="op">::</span>distance<span class="op">&gt;</span> <span class="op">{}</span> A;</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> B <span class="op">:</span> relative_point_origin<span class="op">&lt;</span>A <span class="op">+</span> <span class="dv">10</span> <span class="op">*</span> m<span class="op">&gt;</span> <span class="op">{}</span> B;</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> C <span class="op">:</span> relative_point_origin<span class="op">&lt;</span>B <span class="op">+</span> <span class="dv">10</span> <span class="op">*</span> m<span class="op">&gt;</span> <span class="op">{}</span> C;</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> D <span class="op">:</span> relative_point_origin<span class="op">&lt;</span>A <span class="op">+</span> <span class="dv">30</span> <span class="op">*</span> m<span class="op">&gt;</span> <span class="op">{}</span> D;</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>quantity_point qp1 <span class="op">=</span> C <span class="op">+</span> <span class="dv">100</span> <span class="op">*</span> m;</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>quantity_point qp2 <span class="op">=</span> D <span class="op">+</span> <span class="dv">120</span> <span class="op">*</span> m;</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp1<span class="op">.</span>quantity_ref_from<span class="op">(</span>qp1<span class="op">.</span>point_origin<span class="op">())</span> <span class="op">==</span> <span class="dv">100</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp2<span class="op">.</span>quantity_ref_from<span class="op">(</span>qp2<span class="op">.</span>point_origin<span class="op">())</span> <span class="op">==</span> <span class="dv">120</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp1<span class="op">.</span>quantity_from_zero<span class="op">()</span> <span class="op">==</span> <span class="dv">120</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp2<span class="op">.</span>quantity_from_zero<span class="op">()</span> <span class="op">==</span> <span class="dv">150</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp1 <span class="op">-</span> A <span class="op">==</span> <span class="dv">120</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp1 <span class="op">-</span> B <span class="op">==</span> <span class="dv">110</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp1 <span class="op">-</span> C <span class="op">==</span> <span class="dv">100</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp1 <span class="op">-</span> D <span class="op">==</span> <span class="dv">90</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp1<span class="op">.</span>quantity_from<span class="op">(</span>A<span class="op">)</span> <span class="op">==</span> <span class="dv">120</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp1<span class="op">.</span>quantity_from<span class="op">(</span>B<span class="op">)</span> <span class="op">==</span> <span class="dv">110</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp1<span class="op">.</span>quantity_from<span class="op">(</span>C<span class="op">)</span> <span class="op">==</span> <span class="dv">100</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp1<span class="op">.</span>quantity_from<span class="op">(</span>D<span class="op">)</span> <span class="op">==</span> <span class="dv">90</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp2 <span class="op">-</span> A <span class="op">==</span> <span class="dv">150</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp2 <span class="op">-</span> B <span class="op">==</span> <span class="dv">140</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp2 <span class="op">-</span> C <span class="op">==</span> <span class="dv">130</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp2 <span class="op">-</span> D <span class="op">==</span> <span class="dv">120</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp2<span class="op">.</span>quantity_from<span class="op">(</span>A<span class="op">)</span> <span class="op">==</span> <span class="dv">150</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp2<span class="op">.</span>quantity_from<span class="op">(</span>B<span class="op">)</span> <span class="op">==</span> <span class="dv">140</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp2<span class="op">.</span>quantity_from<span class="op">(</span>C<span class="op">)</span> <span class="op">==</span> <span class="dv">130</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp2<span class="op">.</span>quantity_from<span class="op">(</span>D<span class="op">)</span> <span class="op">==</span> <span class="dv">120</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp2 <span class="op">-</span> qp1 <span class="op">==</span> <span class="dv">30</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>B <span class="op">-</span> A <span class="op">==</span> <span class="dv">10</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>C <span class="op">-</span> A <span class="op">==</span> <span class="dv">20</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>D <span class="op">-</span> A <span class="op">==</span> <span class="dv">30</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>D <span class="op">-</span> C <span class="op">==</span> <span class="dv">10</span> <span class="op">*</span> m<span class="op">)</span>;</span></code></pre></div>
<p>As we can see above, the
<code class="sourceCode default">quantity_from()</code> member function
returns a relative distance from the provided point origin while the
<code class="sourceCode default">quantity_from_zero()</code> always
returns the distance from the absolute point origin.</p>
<p>Also, please note that as long as we can’t subtract two absolute
point origins from each other, it is possible to subtract relative ones
or a relative and absolute one.</p>
<h4 data-number="10.4.4.5" id="converting-between-different-representations-of-the-same-point"><span class="header-section-number">10.4.4.5</span> Converting between
different representations of the same <em>point</em><a href="#converting-between-different-representations-of-the-same-point" class="self-link"></a></h4>
<p>As we might represent the same <em>point</em> with <em>displacement
vectors</em> from various origins, the library provides facilities to
convert the same <em>point</em> to the
<code class="sourceCode default">quantity_point</code> class templates
expressed in terms of different origins.</p>
<p>For this purpose, we can either use:</p>
<ul>
<li><p>A converting constructor:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>quantity_point<span class="op">&lt;</span>si<span class="op">::</span>metre, B<span class="op">&gt;</span> qp3 <span class="op">=</span> qp1;</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp3<span class="op">.</span>quantity_ref_from<span class="op">(</span>qp3<span class="op">.</span>point_origin<span class="op">())</span> <span class="op">==</span> <span class="dv">130</span> <span class="op">*</span> m<span class="op">)</span>;</span></code></pre></div></li>
<li><p>A dedicated conversion interface:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>quantity_point qp4 <span class="op">=</span> qp1<span class="op">.</span>point_for<span class="op">(</span>B<span class="op">)</span>;</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>qp4<span class="op">.</span>quantity_ref_from<span class="op">(</span>qp4<span class="op">.</span>point_origin<span class="op">())</span> <span class="op">==</span> <span class="dv">130</span> <span class="op">*</span> m<span class="op">)</span>;</span></code></pre></div></li>
</ul>
<p>It is only allowed to convert between various origins defined in
terms of the same
<code class="sourceCode default">absolute_point_origin</code>. Even if
it is possible to express the same <em>point</em> as a <em>displacement
vector</em> from another
<code class="sourceCode default">absolute_point_origin</code>, the
library will not provide such a conversion. A custom user-defined
conversion function will be needed to add this functionality.</p>
<p>Said another way, in the library, there is no way to spell how two
distinct <code class="sourceCode default">absolute_point_origin</code>
types relate to each other.</p>
<h4 data-number="10.4.4.6" id="temperature-support"><span class="header-section-number">10.4.4.6</span> Temperature support<a href="#temperature-support" class="self-link"></a></h4>
<p>Support for temperature quantity points is probably one of the most
common examples of relative point origins in action that we use in daily
life.</p>
<p>The <span class="citation" data-cites="SI">[<a href="#ref-SI" role="doc-biblioref">SI</a>]</span> definition in the library provides a
few predefined point origins for this purpose:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> si <span class="op">{</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> absolute_zero <span class="op">:</span> absolute_point_origin<span class="op">&lt;</span>absolute_zero, isq<span class="op">::</span>thermodynamic_temperature<span class="op">&gt;</span> <span class="op">{}</span> absolute_zero;</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> zeroth_kelvin <span class="op">:</span> <span class="kw">decltype</span><span class="op">(</span>absolute_zero<span class="op">)</span> <span class="op">{}</span> zeroth_kelvin;</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> ice_point <span class="op">:</span> relative_point_origin<span class="op">&lt;</span>quantity_point<span class="op">{</span><span class="dv">273&#39;150</span> <span class="op">*</span> milli<span class="op">&lt;</span>kelvin<span class="op">&gt;}&gt;</span> <span class="op">{}</span> ice_point;</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> zeroth_degree_Celsius <span class="op">:</span> <span class="kw">decltype</span><span class="op">(</span>ice_point<span class="op">)</span> <span class="op">{}</span> zeroth_degree_Celsius;</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> usc <span class="op">{</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> zeroth_degree_Fahrenheit <span class="op">:</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  relative_point_origin<span class="op">&lt;</span>si<span class="op">::</span>zeroth_degree_Celsius <span class="op">-</span> <span class="dv">32</span> <span class="op">*</span> <span class="op">(</span>mag<span class="op">&lt;</span>ratio<span class="op">{</span><span class="dv">5</span>, <span class="dv">9</span><span class="op">}&gt;</span> <span class="op">*</span> si<span class="op">::</span>degree_Celsius<span class="op">)&gt;</span> <span class="op">{}</span> zeroth_degree_Fahrenheit;</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>The above is a great example of how point origins can be stacked on
top of each other:</p>
<ul>
<li><code class="sourceCode default">usc::zeroth_degree_Fahrenheit</code>
is defined relative to
<code class="sourceCode default">si::zeroth_degree_Celsius</code></li>
<li><code class="sourceCode default">si::zeroth_degree_Celsius</code> is
defined relative to
<code class="sourceCode default">si::zeroth_kelvin</code>.</li>
</ul>
<p><em>Note: Notice that while stacking point origins, we can use not
only different representation types but also different units for origins
and a <em>point</em>. In the above example, the relative point origin
for degree Celsius is defined in terms of
<code class="sourceCode default">si::kelvin</code>, while the quantity
point for it will use
<code class="sourceCode default">si::degree_Celsius</code> as a
unit.</em></p>
<p>The temperature point origins defined above are provided explicitly
in the respective units’ definitions:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> si <span class="op">{</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> kelvin <span class="op">:</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    named_unit<span class="op">&lt;</span><span class="st">&quot;K&quot;</span>, kind_of<span class="op">&lt;</span>isq<span class="op">::</span>thermodynamic_temperature<span class="op">&gt;</span>, zeroth_kelvin<span class="op">&gt;</span> <span class="op">{}</span> kelvin;</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> degree_Celsius <span class="op">:</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    named_unit<span class="op">&lt;{</span><span class="st">u8&quot;°C&quot;</span>, <span class="st">&quot;`C&quot;</span><span class="op">}</span>, kelvin, zeroth_degree_Celsius<span class="op">&gt;</span> <span class="op">{}</span> degree_Celsius;</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> usc <span class="op">{</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> degree_Fahrenheit <span class="op">:</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>    named_unit<span class="op">&lt;{</span><span class="st">u8&quot;°F&quot;</span>, <span class="st">&quot;`F&quot;</span><span class="op">}</span>, mag<span class="op">&lt;</span>ratio<span class="op">{</span><span class="dv">5</span>, <span class="dv">9</span><span class="op">}&gt;</span> <span class="op">*</span> si<span class="op">::</span>degree_Celsius,</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>               zeroth_degree_Fahrenheit<span class="op">&gt;</span> <span class="op">{}</span> degree_Fahrenheit;</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Now let’s see how we can benefit from the above definitions. We have
quite a few alternatives to choose from here. Depending on our needs or
taste we can:</p>
<ul>
<li><p>be explicit about the unit and origin:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>quantity_point<span class="op">&lt;</span>si<span class="op">::</span>degree_Celsius, si<span class="op">::</span>zeroth_degree_Celsius<span class="op">&gt;</span> q1 <span class="op">=</span> si<span class="op">::</span>zeroth_degree_Celsius <span class="op">+</span> <span class="fl">20.5</span> <span class="op">*</span> deg_C;</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>quantity_point<span class="op">&lt;</span>si<span class="op">::</span>degree_Celsius, si<span class="op">::</span>zeroth_degree_Celsius<span class="op">&gt;</span> q2 <span class="op">=</span> <span class="op">{</span><span class="fl">20.5</span> <span class="op">*</span> deg_C, si<span class="op">::</span>zeroth_degree_Celsius<span class="op">}</span>;</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>quantity_point<span class="op">&lt;</span>si<span class="op">::</span>degree_Celsius, si<span class="op">::</span>zeroth_degree_Celsius<span class="op">&gt;</span> q3<span class="op">{</span><span class="fl">20.5</span> <span class="op">*</span> deg_C<span class="op">}</span>;</span></code></pre></div></li>
<li><p>specify a unit and use its zeroth point origin implicitly:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>quantity_point<span class="op">&lt;</span>si<span class="op">::</span>degree_Celsius<span class="op">&gt;</span> q4 <span class="op">=</span> si<span class="op">::</span>zeroth_degree_Celsius <span class="op">+</span> <span class="fl">20.5</span> <span class="op">*</span> deg_C;</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>quantity_point<span class="op">&lt;</span>si<span class="op">::</span>degree_Celsius<span class="op">&gt;</span> q5 <span class="op">=</span> <span class="op">{</span><span class="fl">20.5</span> <span class="op">*</span> deg_C, si<span class="op">::</span>zeroth_degree_Celsius<span class="op">}</span>;</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>quantity_point<span class="op">&lt;</span>si<span class="op">::</span>degree_Celsius<span class="op">&gt;</span> q6<span class="op">{</span><span class="fl">20.5</span> <span class="op">*</span> deg_C<span class="op">}</span>;</span></code></pre></div></li>
<li><p>benefit from CTAD:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>quantity_point q7 <span class="op">=</span> si<span class="op">::</span>zeroth_degree_Celsius <span class="op">+</span> <span class="fl">20.5</span> <span class="op">*</span> deg_C;</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>quantity_point q8 <span class="op">=</span> <span class="op">{</span><span class="fl">20.5</span> <span class="op">*</span> deg_C, si<span class="op">::</span>zeroth_degree_Celsius<span class="op">}</span>;</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>quantity_point q9<span class="op">{</span><span class="fl">20.5</span> <span class="op">*</span> deg_C<span class="op">}</span>;</span></code></pre></div></li>
</ul>
<p>In all of the above cases, we end up with the
<code class="sourceCode default">quantity_point</code> of the same type
and value.</p>
<p>To play a bit more with temperatures, we can implement a simple room
AC temperature controller in the following way:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="kw">constexpr</span> <span class="kw">struct</span> room_reference_temp <span class="op">:</span> relative_point_origin<span class="op">&lt;</span>quantity_point<span class="op">{</span><span class="dv">21</span> <span class="op">*</span> deg_C<span class="op">}&gt;</span> <span class="op">{}</span> room_reference_temp;</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> room_temp <span class="op">=</span> quantity_point<span class="op">&lt;</span>isq<span class="op">::</span>Celsius_temperature<span class="op">[</span>deg_C<span class="op">]</span>, room_reference_temp<span class="op">&gt;</span>;</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="kw">constexpr</span> <span class="kw">auto</span> step_delta <span class="op">=</span> isq<span class="op">::</span>Celsius_temperature<span class="op">(</span><span class="fl">0.5</span> <span class="op">*</span> deg_C<span class="op">)</span>;</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="kw">constexpr</span> <span class="dt">int</span> number_of_steps <span class="op">=</span> <span class="dv">6</span>;</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>room_temp room_ref<span class="op">{}</span>;</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>room_temp room_low <span class="op">=</span> room_ref <span class="op">-</span> number_of_steps <span class="op">*</span> step_delta;</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>room_temp room_high <span class="op">=</span> room_ref <span class="op">+</span> number_of_steps <span class="op">*</span> step_delta;</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;Room reference temperature: {} ({}, {})</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>             room_ref<span class="op">.</span>quantity_from_zero<span class="op">()</span>,</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>             room_ref<span class="op">.</span>in<span class="op">(</span>usc<span class="op">::</span>degree_Fahrenheit<span class="op">).</span>quantity_from_zero<span class="op">()</span>,</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>             room_ref<span class="op">.</span>in<span class="op">(</span>si<span class="op">::</span>kelvin<span class="op">).</span>quantity_from_zero<span class="op">())</span>;</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;| {:&lt;14} | {:^18} | {:^18} | {:^18} |&quot;</span>,</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;Temperature&quot;</span>, <span class="st">&quot;Room reference&quot;</span>, <span class="st">&quot;Ice point&quot;</span>, <span class="st">&quot;Absolute zero&quot;</span><span class="op">)</span>;</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;|{0:=^16}|{0:=^20}|{0:=^20}|{0:=^20}|&quot;</span>, <span class="st">&quot;&quot;</span><span class="op">)</span>;</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> print <span class="op">=</span> <span class="op">[&amp;](</span>std<span class="op">::</span>string_view label, <span class="kw">auto</span> v<span class="op">)</span> <span class="op">{</span></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;| {:&lt;14} | {:^18} | {:^18} | {:^18:N[.2f]} |&quot;</span>, label,</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>               v <span class="op">-</span> room_reference_temp, <span class="op">(</span>v <span class="op">-</span> si<span class="op">::</span>ice_point<span class="op">).</span>in<span class="op">(</span>deg_C<span class="op">)</span>, <span class="op">(</span>v <span class="op">-</span> si<span class="op">::</span>absolute_zero<span class="op">).</span>in<span class="op">(</span>deg_C<span class="op">))</span>;</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>;</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>print<span class="op">(</span><span class="st">&quot;Lowest&quot;</span>, room_low<span class="op">)</span>;</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>print<span class="op">(</span><span class="st">&quot;Default&quot;</span>, room_ref<span class="op">)</span>;</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>print<span class="op">(</span><span class="st">&quot;Highest&quot;</span>, room_high<span class="op">)</span>;</span></code></pre></div>
<p>The above prints:</p>
<pre class="text"><code>Room reference temperature: 21 °C (69.8 °F, 294.15 K)

| Temperature    |   Room reference   |     Ice point      |   Absolute zero    |
|================|====================|====================|====================|
| Lowest         |       -3 °C        |       18 °C        |     291.15 °C      |
| Default        |        0 °C        |       21 °C        |     294.15 °C      |
| Highest        |        3 °C        |       24 °C        |     297.15 °C      |</code></pre>
<p>More about temperatures can be found in the <a href="#potential-surprises-while-working-with-temperatures">Potential
surprises while working with temperatures</a> chapter.</p>
<h2 data-number="10.5" id="user-defined-representation-types"><span class="header-section-number">10.5</span> User-defined representation
types<a href="#user-defined-representation-types" class="self-link"></a></h2>
<p>The library of physical quantities and units library should work with
any custom representation type. Those can be used to:</p>
<ul>
<li>Improve safety (e.g., prevent overflows, restrict the range of
accepted values, etc.),</li>
<li>provide additional information (e.g., not only a quantity value but
also the uncertainty of the measurement), and</li>
<li>enable linear algebra usage.</li>
</ul>
<p>As of right now, we have two other concurrent proposals to SG6 in
this subject on the fly (<span class="citation" data-cites="P2993_PRE">[<a href="#ref-P2993_PRE" role="doc-biblioref">P2993</a>]</span> and <span class="citation" data-cites="P3003R0">[<a href="#ref-P3003R0" role="doc-biblioref">P3003R0</a>]</span>), so we do not provide any
concrete requirements or recommendations here so far.</p>
<p>Based on the results of discussions on the mentioned proposals, we
will provide correct guidelines in the next revisions of this paper.</p>
<p>By default all floating-point and integral (besides
<code class="sourceCode default">bool</code>) types are treated as
scalars.</p>
<h2 data-number="10.6" id="vector-and-tensor-quantities"><span class="header-section-number">10.6</span> Vector and tensor quantities<a href="#vector-and-tensor-quantities" class="self-link"></a></h2>
<p>TBD</p>
<h2 data-number="10.7" id="logarithmic-quantities-and-units"><span class="header-section-number">10.7</span> Logarithmic quantities and
units<a href="#logarithmic-quantities-and-units" class="self-link"></a></h2>
<p>TBD</p>
<h1 data-number="11" id="usage-examples"><span class="header-section-number">11</span> Usage examples<a href="#usage-examples" class="self-link"></a></h1>
<h2 data-number="11.1" id="basic-quantity-equations"><span class="header-section-number">11.1</span> Basic quantity equations<a href="#basic-quantity-equations" class="self-link"></a></h2>
<p>Let’s start with a really simple example presenting basic operations
that every physical quantities and units library should provide:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> mp_units;</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> mp_units;</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> mp_units<span class="op">::</span>si<span class="op">::</span>unit_symbols;</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="co">// simple numeric operations</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span><span class="dv">10</span> <span class="op">*</span> km <span class="op">/</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">5</span> <span class="op">*</span> km<span class="op">)</span>;</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="co">// conversions to common units</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span><span class="dv">1</span> <span class="op">*</span> h <span class="op">==</span> <span class="dv">3600</span> <span class="op">*</span> s<span class="op">)</span>;</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span><span class="dv">1</span> <span class="op">*</span> km <span class="op">+</span> <span class="dv">1</span> <span class="op">*</span> m <span class="op">==</span> <span class="dv">1001</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="co">// derived quantities</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span><span class="dv">1</span> <span class="op">*</span> km <span class="op">/</span> <span class="op">(</span><span class="dv">1</span> <span class="op">*</span> s<span class="op">)</span> <span class="op">==</span> <span class="dv">1000</span> <span class="op">*</span> m <span class="op">/</span> s<span class="op">)</span>;</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span><span class="dv">2</span> <span class="op">*</span> km <span class="op">/</span> h <span class="op">*</span> <span class="op">(</span><span class="dv">2</span> <span class="op">*</span> h<span class="op">)</span> <span class="op">==</span> <span class="dv">4</span> <span class="op">*</span> km<span class="op">)</span>;</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span><span class="dv">2</span> <span class="op">*</span> km <span class="op">/</span> <span class="op">(</span><span class="dv">2</span> <span class="op">*</span> km <span class="op">/</span> h<span class="op">)</span> <span class="op">==</span> <span class="dv">1</span> <span class="op">*</span> h<span class="op">)</span>;</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span><span class="dv">2</span> <span class="op">*</span> m <span class="op">*</span> <span class="op">(</span><span class="dv">3</span> <span class="op">*</span> m<span class="op">)</span> <span class="op">==</span> <span class="dv">6</span> <span class="op">*</span> m2<span class="op">)</span>;</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span><span class="dv">10</span> <span class="op">*</span> km <span class="op">/</span> <span class="op">(</span><span class="dv">5</span> <span class="op">*</span> km<span class="op">)</span> <span class="op">==</span> <span class="dv">2</span> <span class="op">*</span> one<span class="op">)</span>;</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span><span class="dv">1000</span> <span class="op">/</span> <span class="op">(</span><span class="dv">1</span> <span class="op">*</span> s<span class="op">)</span> <span class="op">==</span> <span class="dv">1</span> <span class="op">*</span> kHz<span class="op">)</span>;</span></code></pre></div>
<p>Try it in <a href="https://godbolt.org/z/sYfoPzTvT">the Compiler
Explorer</a>.</p>
<h2 data-number="11.2" id="hello-units"><span class="header-section-number">11.2</span> Hello units<a href="#hello-units" class="self-link"></a></h2>
<p>The next example serves as a showcase of various features available
in the <span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span>
library.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> mp_units;</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> std;</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> mp_units;</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="kw">constexpr</span> QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>speed<span class="op">&gt;</span> <span class="kw">auto</span> avg_speed<span class="op">(</span>QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>length<span class="op">&gt;</span> <span class="kw">auto</span> d,</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>                                                QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>time<span class="op">&gt;</span> <span class="kw">auto</span> t<span class="op">)</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> d <span class="op">/</span> t;</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">using</span> <span class="kw">namespace</span> mp_units<span class="op">::</span>si<span class="op">::</span>unit_symbols;</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>  <span class="kw">using</span> <span class="kw">namespace</span> mp_units<span class="op">::</span>international<span class="op">::</span>unit_symbols;</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>  <span class="kw">constexpr</span> quantity v1 <span class="op">=</span> <span class="dv">110</span> <span class="op">*</span> km <span class="op">/</span> h;</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>  <span class="kw">constexpr</span> quantity v2 <span class="op">=</span> <span class="dv">70</span> <span class="op">*</span> mph;</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>  <span class="kw">constexpr</span> quantity v3 <span class="op">=</span> avg_speed<span class="op">(</span><span class="fl">220.</span> <span class="op">*</span> isq<span class="op">::</span>distance<span class="op">[</span>km<span class="op">]</span>, <span class="dv">2</span> <span class="op">*</span> h<span class="op">)</span>;</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>  <span class="kw">constexpr</span> quantity v4 <span class="op">=</span> avg_speed<span class="op">(</span>isq<span class="op">::</span>distance<span class="op">(</span><span class="fl">140.</span> <span class="op">*</span> mi<span class="op">)</span>, <span class="dv">2</span> <span class="op">*</span> h<span class="op">)</span>;</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>  <span class="kw">constexpr</span> quantity v5 <span class="op">=</span> v3<span class="op">.</span>in<span class="op">(</span>m <span class="op">/</span> s<span class="op">)</span>;</span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>  <span class="kw">constexpr</span> quantity v6 <span class="op">=</span> value_cast<span class="op">&lt;</span>m <span class="op">/</span> s<span class="op">&gt;(</span>v4<span class="op">)</span>;</span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>  <span class="kw">constexpr</span> quantity v7 <span class="op">=</span> value_cast<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span>v6<span class="op">)</span>;</span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> v1 <span class="op">&lt;&lt;</span> <span class="ch">&#39;</span><span class="sc">\n</span><span class="ch">&#39;</span>;                                        <span class="co">// 110 km/h</span></span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> std<span class="op">::</span>setw<span class="op">(</span><span class="dv">10</span><span class="op">)</span> <span class="op">&lt;&lt;</span> std<span class="op">::</span>setfill<span class="op">(</span><span class="ch">&#39;*&#39;</span><span class="op">)</span> <span class="op">&lt;&lt;</span> v2 <span class="op">&lt;&lt;</span> <span class="ch">&#39;</span><span class="sc">\n</span><span class="ch">&#39;</span>;  <span class="co">// ***70 mi/h</span></span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> std<span class="op">::</span>format<span class="op">(</span><span class="st">&quot;{:*^10}</span><span class="sc">\n</span><span class="st">&quot;</span>, v3<span class="op">)</span>;                      <span class="co">// *110 km/h*</span></span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;{:%N in %U}&quot;</span>, v4<span class="op">)</span>;                                <span class="co">// 70 in mi/h</span></span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;{:{%N:.2f}%?%U}&quot;</span>, v5<span class="op">)</span>;                            <span class="co">// 30.56 m/s</span></span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;{:{%N:.2f}%?{%U:n}}&quot;</span>, v6<span class="op">)</span>;                        <span class="co">// 31.29 m s⁻¹</span></span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;{:%N}&quot;</span>, v7<span class="op">)</span>;                                      <span class="co">// 31</span></span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Try it in <a href="https://godbolt.org/z/aPe7naKrE">the Compiler
Explorer</a>.</p>
<h2 data-number="11.3" id="storage-tank"><span class="header-section-number">11.3</span> Storage tank<a href="#storage-tank" class="self-link"></a></h2>
<p>This example estimates the process of filling a storage tank with
some contents. It presents:</p>
<ul>
<li><a href="https://mpusz.github.io/mp-units/2.0/users_guide/framework_basics/systems_of_quantities/#system-of-quantities-is-not-only-about-kinds">The
importance of supporting more than one distinct quantity of the same
kind</a>,</li>
<li><a href="https://mpusz.github.io/mp-units/2.0/users_guide/framework_basics/faster_than_lightspeed_constants/">faster-than-lightspeed
constants</a>,</li>
<li>how easy it is to <a href="https://mpusz.github.io/mp-units/2.0/users_guide/framework_basics/systems_of_quantities/#defining-quantities">add
custom quantity types</a> when needed, and</li>
<li><a href="https://mpusz.github.io/mp-units/2.1/users_guide/framework_basics/concepts/#QuantityLike">interoperability
with
<code class="sourceCode default">std::chrono::duration</code></a>.</li>
</ul>
<div class="sourceCode" id="cb51"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> mp_units;</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> std;</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co">// allows standard gravity (acceleration) and weight (force) to be expressed with scalar representation</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co">// types instead of requiring the usage of Linear Algebra library for this simple example</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span><span class="kw">class</span> T<span class="op">&gt;</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">requires</span> mp_units<span class="op">::</span>is_scalar<span class="op">&lt;</span>T<span class="op">&gt;</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="dt">bool</span> mp_units<span class="op">::</span>is_vector<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="op">=</span> <span class="kw">true</span>;</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> <span class="op">{</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> mp_units;</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> mp_units<span class="op">::</span>si<span class="op">::</span>unit_symbols;</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="co">// add a custom quantity type of kind isq::length</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> horizontal_length <span class="op">:</span> quantity_spec<span class="op">&lt;</span>isq<span class="op">::</span>length<span class="op">&gt;</span> <span class="op">{}</span> horizontal_length;</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a><span class="co">// add a custom derived quantity type of kind isq::area</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a><span class="co">// with a constrained quantity equation</span></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> horizontal_area <span class="op">:</span> quantity_spec<span class="op">&lt;</span>horizontal_length <span class="op">*</span> isq<span class="op">::</span>width<span class="op">&gt;</span> <span class="op">{}</span> horizontal_area;</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">auto</span> g <span class="op">=</span> <span class="dv">1</span> <span class="op">*</span> si<span class="op">::</span>standard_gravity;</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">auto</span> air_density <span class="op">=</span> isq<span class="op">::</span>mass_density<span class="op">(</span><span class="fl">1.225</span> <span class="op">*</span> kg <span class="op">/</span> m3<span class="op">)</span>;</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> StorageTank <span class="op">{</span></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>  quantity<span class="op">&lt;</span>horizontal_area<span class="op">[</span>m2<span class="op">]&gt;</span> base_;</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>  quantity<span class="op">&lt;</span>isq<span class="op">::</span>height<span class="op">[</span>m<span class="op">]&gt;</span> height_;</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>  quantity<span class="op">&lt;</span>isq<span class="op">::</span>mass_density<span class="op">[</span>kg <span class="op">/</span> m3<span class="op">]&gt;</span> density_ <span class="op">=</span> air_density;</span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span><span class="op">:</span></span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>  <span class="kw">constexpr</span> StorageTank<span class="op">(</span><span class="kw">const</span> quantity<span class="op">&lt;</span>horizontal_area<span class="op">[</span>m2<span class="op">]&gt;&amp;</span> base, <span class="kw">const</span> quantity<span class="op">&lt;</span>isq<span class="op">::</span>height<span class="op">[</span>m<span class="op">]&gt;&amp;</span> height<span class="op">)</span> <span class="op">:</span></span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>      base_<span class="op">(</span>base<span class="op">)</span>, height_<span class="op">(</span>height<span class="op">)</span></span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>  <span class="op">{</span></span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>  <span class="kw">constexpr</span> <span class="dt">void</span> set_contents_density<span class="op">(</span><span class="kw">const</span> quantity<span class="op">&lt;</span>isq<span class="op">::</span>mass_density<span class="op">[</span>kg <span class="op">/</span> m3<span class="op">]&gt;&amp;</span> density<span class="op">)</span></span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a>  <span class="op">{</span></span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a>    <span class="ot">assert</span><span class="op">(</span>density <span class="op">&gt;</span> air_density<span class="op">)</span>;</span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a>    density_ <span class="op">=</span> density;</span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a>  <span class="op">[[</span><span class="at">nodiscard</span><span class="op">]]</span> <span class="kw">constexpr</span> QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>weight<span class="op">&gt;</span> <span class="kw">auto</span> filled_weight<span class="op">()</span> <span class="kw">const</span></span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a>  <span class="op">{</span></span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> <span class="kw">auto</span> volume <span class="op">=</span> isq<span class="op">::</span>volume<span class="op">(</span>base_ <span class="op">*</span> height_<span class="op">)</span>;</span>
<span id="cb51-44"><a href="#cb51-44" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>mass<span class="op">&gt;</span> <span class="kw">auto</span> mass <span class="op">=</span> density_ <span class="op">*</span> volume;</span>
<span id="cb51-45"><a href="#cb51-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> isq<span class="op">::</span>weight<span class="op">(</span>mass <span class="op">*</span> g<span class="op">)</span>;</span>
<span id="cb51-46"><a href="#cb51-46" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb51-47"><a href="#cb51-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-48"><a href="#cb51-48" aria-hidden="true" tabindex="-1"></a>  <span class="op">[[</span><span class="at">nodiscard</span><span class="op">]]</span> <span class="kw">constexpr</span> quantity<span class="op">&lt;</span>isq<span class="op">::</span>height<span class="op">[</span>m<span class="op">]&gt;</span> fill_level<span class="op">(</span><span class="kw">const</span> quantity<span class="op">&lt;</span>isq<span class="op">::</span>mass<span class="op">[</span>kg<span class="op">]&gt;&amp;</span> measured_mass<span class="op">)</span> <span class="kw">const</span></span>
<span id="cb51-49"><a href="#cb51-49" aria-hidden="true" tabindex="-1"></a>  <span class="op">{</span></span>
<span id="cb51-50"><a href="#cb51-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> height_ <span class="op">*</span> measured_mass <span class="op">*</span> g <span class="op">/</span> filled_weight<span class="op">()</span>;</span>
<span id="cb51-51"><a href="#cb51-51" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb51-52"><a href="#cb51-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-53"><a href="#cb51-53" aria-hidden="true" tabindex="-1"></a>  <span class="op">[[</span><span class="at">nodiscard</span><span class="op">]]</span> <span class="kw">constexpr</span> quantity<span class="op">&lt;</span>isq<span class="op">::</span>volume<span class="op">[</span>m3<span class="op">]&gt;</span> spare_capacity<span class="op">(</span><span class="kw">const</span> quantity<span class="op">&lt;</span>isq<span class="op">::</span>mass<span class="op">[</span>kg<span class="op">]&gt;&amp;</span> measured_mass<span class="op">)</span> <span class="kw">const</span></span>
<span id="cb51-54"><a href="#cb51-54" aria-hidden="true" tabindex="-1"></a>  <span class="op">{</span></span>
<span id="cb51-55"><a href="#cb51-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">(</span>height_ <span class="op">-</span> fill_level<span class="op">(</span>measured_mass<span class="op">))</span> <span class="op">*</span> base_;</span>
<span id="cb51-56"><a href="#cb51-56" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb51-57"><a href="#cb51-57" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>;</span>
<span id="cb51-58"><a href="#cb51-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-59"><a href="#cb51-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-60"><a href="#cb51-60" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CylindricalStorageTank <span class="op">:</span> <span class="kw">public</span> StorageTank <span class="op">{</span></span>
<span id="cb51-61"><a href="#cb51-61" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span><span class="op">:</span></span>
<span id="cb51-62"><a href="#cb51-62" aria-hidden="true" tabindex="-1"></a>  <span class="kw">constexpr</span> CylindricalStorageTank<span class="op">(</span><span class="kw">const</span> quantity<span class="op">&lt;</span>isq<span class="op">::</span>radius<span class="op">[</span>m<span class="op">]&gt;&amp;</span> radius, <span class="kw">const</span> quantity<span class="op">&lt;</span>isq<span class="op">::</span>height<span class="op">[</span>m<span class="op">]&gt;&amp;</span> height<span class="op">)</span> <span class="op">:</span></span>
<span id="cb51-63"><a href="#cb51-63" aria-hidden="true" tabindex="-1"></a>      StorageTank<span class="op">(</span>quantity_cast<span class="op">&lt;</span>horizontal_area<span class="op">&gt;(</span>std<span class="op">::</span>numbers<span class="op">::</span>pi <span class="op">*</span> pow<span class="op">&lt;</span><span class="dv">2</span><span class="op">&gt;(</span>radius<span class="op">))</span>, height<span class="op">)</span></span>
<span id="cb51-64"><a href="#cb51-64" aria-hidden="true" tabindex="-1"></a>  <span class="op">{</span></span>
<span id="cb51-65"><a href="#cb51-65" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb51-66"><a href="#cb51-66" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>;</span>
<span id="cb51-67"><a href="#cb51-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-68"><a href="#cb51-68" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> RectangularStorageTank <span class="op">:</span> <span class="kw">public</span> StorageTank <span class="op">{</span></span>
<span id="cb51-69"><a href="#cb51-69" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span><span class="op">:</span></span>
<span id="cb51-70"><a href="#cb51-70" aria-hidden="true" tabindex="-1"></a>  <span class="kw">constexpr</span> RectangularStorageTank<span class="op">(</span><span class="kw">const</span> quantity<span class="op">&lt;</span>horizontal_length<span class="op">[</span>m<span class="op">]&gt;&amp;</span> length, <span class="kw">const</span> quantity<span class="op">&lt;</span>isq<span class="op">::</span>width<span class="op">[</span>m<span class="op">]&gt;&amp;</span> width,</span>
<span id="cb51-71"><a href="#cb51-71" aria-hidden="true" tabindex="-1"></a>                                   <span class="kw">const</span> quantity<span class="op">&lt;</span>isq<span class="op">::</span>height<span class="op">[</span>m<span class="op">]&gt;&amp;</span> height<span class="op">)</span> <span class="op">:</span></span>
<span id="cb51-72"><a href="#cb51-72" aria-hidden="true" tabindex="-1"></a>      StorageTank<span class="op">(</span>length <span class="op">*</span> width, height<span class="op">)</span></span>
<span id="cb51-73"><a href="#cb51-73" aria-hidden="true" tabindex="-1"></a>  <span class="op">{</span></span>
<span id="cb51-74"><a href="#cb51-74" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb51-75"><a href="#cb51-75" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>;</span>
<span id="cb51-76"><a href="#cb51-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-77"><a href="#cb51-77" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>  <span class="co">// namespace</span></span>
<span id="cb51-78"><a href="#cb51-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-79"><a href="#cb51-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-80"><a href="#cb51-80" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span></span>
<span id="cb51-81"><a href="#cb51-81" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb51-82"><a href="#cb51-82" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> quantity height <span class="op">=</span> isq<span class="op">::</span>height<span class="op">(</span><span class="dv">200</span> <span class="op">*</span> mm<span class="op">)</span>;</span>
<span id="cb51-83"><a href="#cb51-83" aria-hidden="true" tabindex="-1"></a>  <span class="kw">auto</span> tank <span class="op">=</span> RectangularStorageTank<span class="op">(</span>horizontal_length<span class="op">(</span><span class="dv">1&#39;000</span> <span class="op">*</span> mm<span class="op">)</span>, isq<span class="op">::</span>width<span class="op">(</span><span class="dv">500</span> <span class="op">*</span> mm<span class="op">)</span>, height<span class="op">)</span>;</span>
<span id="cb51-84"><a href="#cb51-84" aria-hidden="true" tabindex="-1"></a>  tank<span class="op">.</span>set_contents_density<span class="op">(</span><span class="dv">1&#39;000</span> <span class="op">*</span> kg <span class="op">/</span> m3<span class="op">)</span>;</span>
<span id="cb51-85"><a href="#cb51-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-86"><a href="#cb51-86" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> <span class="kw">auto</span> duration <span class="op">=</span> std<span class="op">::</span>chrono<span class="op">::</span>seconds<span class="op">{</span><span class="dv">200</span><span class="op">}</span>;</span>
<span id="cb51-87"><a href="#cb51-87" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> quantity fill_time <span class="op">=</span> value_cast<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span>quantity<span class="op">{</span>duration<span class="op">})</span>;  <span class="co">// time since starting fill</span></span>
<span id="cb51-88"><a href="#cb51-88" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> quantity measured_mass <span class="op">=</span> <span class="fl">20.</span> <span class="op">*</span> kg;                         <span class="co">// measured mass at fill_time</span></span>
<span id="cb51-89"><a href="#cb51-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-90"><a href="#cb51-90" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> quantity fill_level <span class="op">=</span> tank<span class="op">.</span>fill_level<span class="op">(</span>measured_mass<span class="op">)</span>;</span>
<span id="cb51-91"><a href="#cb51-91" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> quantity spare_capacity <span class="op">=</span> tank<span class="op">.</span>spare_capacity<span class="op">(</span>measured_mass<span class="op">)</span>;</span>
<span id="cb51-92"><a href="#cb51-92" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> quantity filled_weight <span class="op">=</span> tank<span class="op">.</span>filled_weight<span class="op">()</span>;</span>
<span id="cb51-93"><a href="#cb51-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-94"><a href="#cb51-94" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>mass_change_rate<span class="op">&gt;</span> <span class="kw">auto</span> input_flow_rate <span class="op">=</span> measured_mass <span class="op">/</span> fill_time;</span>
<span id="cb51-95"><a href="#cb51-95" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>speed<span class="op">&gt;</span> <span class="kw">auto</span> float_rise_rate <span class="op">=</span> fill_level <span class="op">/</span> fill_time;</span>
<span id="cb51-96"><a href="#cb51-96" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>time<span class="op">&gt;</span> <span class="kw">auto</span> fill_time_left <span class="op">=</span> <span class="op">(</span>height <span class="op">/</span> fill_level <span class="op">-</span> <span class="dv">1</span> <span class="op">*</span> one<span class="op">)</span> <span class="op">*</span> fill_time;</span>
<span id="cb51-97"><a href="#cb51-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-98"><a href="#cb51-98" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> quantity fill_ratio <span class="op">=</span> fill_level <span class="op">/</span> height;</span>
<span id="cb51-99"><a href="#cb51-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-100"><a href="#cb51-100" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;fill height at {} = {} ({} full)&quot;</span>, fill_time, fill_level, fill_ratio<span class="op">.</span>in<span class="op">(</span>percent<span class="op">))</span>;</span>
<span id="cb51-101"><a href="#cb51-101" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;fill weight at {} = {} ({})&quot;</span>, fill_time, filled_weight, filled_weight<span class="op">.</span>in<span class="op">(</span>N<span class="op">))</span>;</span>
<span id="cb51-102"><a href="#cb51-102" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;spare capacity at {} = {}&quot;</span>, fill_time, spare_capacity<span class="op">)</span>;</span>
<span id="cb51-103"><a href="#cb51-103" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;input flow rate = {}&quot;</span>, input_flow_rate<span class="op">)</span>;</span>
<span id="cb51-104"><a href="#cb51-104" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;float rise rate = {}&quot;</span>, float_rise_rate<span class="op">)</span>;</span>
<span id="cb51-105"><a href="#cb51-105" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;tank full E.T.A. at current flow rate = {}&quot;</span>, fill_time_left<span class="op">.</span>in<span class="op">(</span>s<span class="op">))</span>;</span>
<span id="cb51-106"><a href="#cb51-106" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>The above code outputs:</p>
<pre class="text"><code>fill height at 200 s = 0.04 m (20% full)
fill weight at 200 s = 100 g₀ kg (980.665 N)
spare capacity at 200 s = 0.08 m³
input flow rate = 0.1 kg/s
float rise rate = 2e-04 m/s
tank full E.T.A. at current flow rate = 800 s</code></pre>
<p>Try it in <a href="https://godbolt.org/z/cW19WYr3M">the Compiler
Explorer</a>.</p>
<h2 data-number="11.4" id="bridge-across-the-rhine"><span class="header-section-number">11.4</span> Bridge across the Rhine<a href="#bridge-across-the-rhine" class="self-link"></a></h2>
<p>The following example codifies the history of a famous issue during
the construction of a bridge across the Rhine River between the German
and Swiss parts of the town Laufenburg <span class="citation" data-cites="HOCHRHEINBRÜCKE">[<a href="#ref-HOCHRHEINBRÜCKE" role="doc-biblioref">Hochrheinbrücke</a>]</span>. It also nicely
presents how <a href="https://mpusz.github.io/mp-units/latest/users_guide/framework_basics/the_affine_space/">the
Affine Space is being modeled in the library</a>.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> mp_units;</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> std;</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> mp_units;</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> mp_units<span class="op">::</span>si<span class="op">::</span>unit_symbols;</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="kw">constexpr</span> <span class="kw">struct</span> amsterdam_sea_level <span class="op">:</span> absolute_point_origin<span class="op">&lt;</span>amsterdam_sea_level, isq<span class="op">::</span>altitude<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> amsterdam_sea_level;</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="kw">constexpr</span> <span class="kw">struct</span> mediterranean_sea_level <span class="op">:</span> relative_point_origin<span class="op">&lt;</span>amsterdam_sea_level <span class="op">-</span> <span class="dv">27</span> <span class="op">*</span> cm<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> mediterranean_sea_level;</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> altitude_DE <span class="op">=</span> quantity_point<span class="op">&lt;</span>isq<span class="op">::</span>altitude<span class="op">[</span>m<span class="op">]</span>, amsterdam_sea_level<span class="op">&gt;</span>;</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> altitude_CH <span class="op">=</span> quantity_point<span class="op">&lt;</span>isq<span class="op">::</span>altitude<span class="op">[</span>m<span class="op">]</span>, mediterranean_sea_level<span class="op">&gt;</span>;</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span><span class="kw">auto</span> R, <span class="kw">typename</span> Rep<span class="op">&gt;</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>ostream<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">&lt;&lt;(</span>std<span class="op">::</span>ostream<span class="op">&amp;</span> os, quantity_point<span class="op">&lt;</span>R, altitude_DE<span class="op">::</span>point_origin, Rep<span class="op">&gt;</span> alt<span class="op">)</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> os <span class="op">&lt;&lt;</span> alt<span class="op">.</span>quantity_ref_from<span class="op">(</span>altitude_DE<span class="op">::</span>point_origin<span class="op">)</span> <span class="op">&lt;&lt;</span> <span class="st">&quot; AMSL(DE)&quot;</span>;</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span><span class="kw">auto</span> R, <span class="kw">typename</span> Rep<span class="op">&gt;</span></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>ostream<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">&lt;&lt;(</span>std<span class="op">::</span>ostream<span class="op">&amp;</span> os, quantity_point<span class="op">&lt;</span>R, altitude_CH<span class="op">::</span>point_origin, Rep<span class="op">&gt;</span> alt<span class="op">)</span></span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> os <span class="op">&lt;&lt;</span> alt<span class="op">.</span>quantity_ref_from<span class="op">(</span>altitude_CH<span class="op">::</span>point_origin<span class="op">)</span> <span class="op">&lt;&lt;</span> <span class="st">&quot; AMSL(CH)&quot;</span>;</span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span><span class="kw">auto</span> R, <span class="kw">typename</span> Rep<span class="op">&gt;</span></span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> std<span class="op">::</span>formatter<span class="op">&lt;</span>quantity_point<span class="op">&lt;</span>R, altitude_DE<span class="op">::</span>point_origin, Rep<span class="op">&gt;&gt;</span> <span class="op">:</span> formatter<span class="op">&lt;</span>quantity<span class="op">&lt;</span>R, Rep<span class="op">&gt;&gt;</span> <span class="op">{</span></span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a>  <span class="kw">template</span><span class="op">&lt;</span><span class="kw">typename</span> FormatContext<span class="op">&gt;</span></span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a>  <span class="kw">auto</span> format<span class="op">(</span><span class="kw">const</span> quantity_point<span class="op">&lt;</span>R, altitude_DE<span class="op">::</span>point_origin, Rep<span class="op">&gt;&amp;</span> alt, FormatContext<span class="op">&amp;</span> ctx<span class="op">)</span> <span class="kw">const</span></span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a>  <span class="op">{</span></span>
<span id="cb52-33"><a href="#cb52-33" aria-hidden="true" tabindex="-1"></a>    formatter<span class="op">&lt;</span>quantity<span class="op">&lt;</span>R, Rep<span class="op">&gt;&gt;::</span>format<span class="op">(</span>alt<span class="op">.</span>quantity_ref_from<span class="op">(</span>altitude_DE<span class="op">::</span>point_origin<span class="op">)</span>, ctx<span class="op">)</span>;</span>
<span id="cb52-34"><a href="#cb52-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> std<span class="op">::</span>format_to<span class="op">(</span>ctx<span class="op">.</span>out<span class="op">()</span>, <span class="st">&quot; AMSL(DE)&quot;</span><span class="op">)</span>;</span>
<span id="cb52-35"><a href="#cb52-35" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb52-36"><a href="#cb52-36" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>;</span>
<span id="cb52-37"><a href="#cb52-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-38"><a href="#cb52-38" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span><span class="kw">auto</span> R, <span class="kw">typename</span> Rep<span class="op">&gt;</span></span>
<span id="cb52-39"><a href="#cb52-39" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> std<span class="op">::</span>formatter<span class="op">&lt;</span>quantity_point<span class="op">&lt;</span>R, altitude_CH<span class="op">::</span>point_origin, Rep<span class="op">&gt;&gt;</span> <span class="op">:</span> formatter<span class="op">&lt;</span>quantity<span class="op">&lt;</span>R, Rep<span class="op">&gt;&gt;</span> <span class="op">{</span></span>
<span id="cb52-40"><a href="#cb52-40" aria-hidden="true" tabindex="-1"></a>  <span class="kw">template</span><span class="op">&lt;</span><span class="kw">typename</span> FormatContext<span class="op">&gt;</span></span>
<span id="cb52-41"><a href="#cb52-41" aria-hidden="true" tabindex="-1"></a>  <span class="kw">auto</span> format<span class="op">(</span><span class="kw">const</span> quantity_point<span class="op">&lt;</span>R, altitude_CH<span class="op">::</span>point_origin, Rep<span class="op">&gt;&amp;</span> alt, FormatContext<span class="op">&amp;</span> ctx<span class="op">)</span> <span class="kw">const</span></span>
<span id="cb52-42"><a href="#cb52-42" aria-hidden="true" tabindex="-1"></a>  <span class="op">{</span></span>
<span id="cb52-43"><a href="#cb52-43" aria-hidden="true" tabindex="-1"></a>    formatter<span class="op">&lt;</span>quantity<span class="op">&lt;</span>R, Rep<span class="op">&gt;&gt;::</span>format<span class="op">(</span>alt<span class="op">.</span>quantity_ref_from<span class="op">(</span>altitude_CH<span class="op">::</span>point_origin<span class="op">)</span>, ctx<span class="op">)</span>;</span>
<span id="cb52-44"><a href="#cb52-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> std<span class="op">::</span>format_to<span class="op">(</span>ctx<span class="op">.</span>out<span class="op">()</span>, <span class="st">&quot; AMSL(CH)&quot;</span><span class="op">)</span>;</span>
<span id="cb52-45"><a href="#cb52-45" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb52-46"><a href="#cb52-46" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>;</span>
<span id="cb52-47"><a href="#cb52-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-48"><a href="#cb52-48" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span></span>
<span id="cb52-49"><a href="#cb52-49" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb52-50"><a href="#cb52-50" aria-hidden="true" tabindex="-1"></a>  <span class="co">// expected bridge altitude in a specific reference system</span></span>
<span id="cb52-51"><a href="#cb52-51" aria-hidden="true" tabindex="-1"></a>  quantity_point expected_bridge_alt <span class="op">=</span> amsterdam_sea_level <span class="op">+</span> <span class="dv">330</span> <span class="op">*</span> m;</span>
<span id="cb52-52"><a href="#cb52-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-53"><a href="#cb52-53" aria-hidden="true" tabindex="-1"></a>  <span class="co">// some nearest landmark altitudes on both sides of the river</span></span>
<span id="cb52-54"><a href="#cb52-54" aria-hidden="true" tabindex="-1"></a>  <span class="co">// equal but not equal ;-)</span></span>
<span id="cb52-55"><a href="#cb52-55" aria-hidden="true" tabindex="-1"></a>  altitude_DE landmark_alt_DE <span class="op">=</span> altitude_DE<span class="op">::</span>point_origin <span class="op">+</span> <span class="dv">300</span> <span class="op">*</span> m;</span>
<span id="cb52-56"><a href="#cb52-56" aria-hidden="true" tabindex="-1"></a>  altitude_CH landmark_alt_CH <span class="op">=</span> altitude_CH<span class="op">::</span>point_origin <span class="op">+</span> <span class="dv">300</span> <span class="op">*</span> m;</span>
<span id="cb52-57"><a href="#cb52-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-58"><a href="#cb52-58" aria-hidden="true" tabindex="-1"></a>  <span class="co">// artifical deltas from landmarks of the bridge base on both sides of the river</span></span>
<span id="cb52-59"><a href="#cb52-59" aria-hidden="true" tabindex="-1"></a>  quantity delta_DE <span class="op">=</span> isq<span class="op">::</span>height<span class="op">(</span><span class="dv">3</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb52-60"><a href="#cb52-60" aria-hidden="true" tabindex="-1"></a>  quantity delta_CH <span class="op">=</span> isq<span class="op">::</span>height<span class="op">(-</span><span class="dv">2</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb52-61"><a href="#cb52-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-62"><a href="#cb52-62" aria-hidden="true" tabindex="-1"></a>  <span class="co">// artificial altitude of the bridge base on both sides of the river</span></span>
<span id="cb52-63"><a href="#cb52-63" aria-hidden="true" tabindex="-1"></a>  quantity_point bridge_base_alt_DE <span class="op">=</span> landmark_alt_DE <span class="op">+</span> delta_DE;</span>
<span id="cb52-64"><a href="#cb52-64" aria-hidden="true" tabindex="-1"></a>  quantity_point bridge_base_alt_CH <span class="op">=</span> landmark_alt_CH <span class="op">+</span> delta_CH;</span>
<span id="cb52-65"><a href="#cb52-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-66"><a href="#cb52-66" aria-hidden="true" tabindex="-1"></a>  <span class="co">// artificial height of the required bridge pilar height on both sides of the river</span></span>
<span id="cb52-67"><a href="#cb52-67" aria-hidden="true" tabindex="-1"></a>  quantity bridge_pilar_height_DE <span class="op">=</span> expected_bridge_alt <span class="op">-</span> bridge_base_alt_DE;</span>
<span id="cb52-68"><a href="#cb52-68" aria-hidden="true" tabindex="-1"></a>  quantity bridge_pilar_height_CH <span class="op">=</span> expected_bridge_alt <span class="op">-</span> bridge_base_alt_CH;</span>
<span id="cb52-69"><a href="#cb52-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-70"><a href="#cb52-70" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;Bridge pillars height:&quot;</span><span class="op">)</span>;</span>
<span id="cb52-71"><a href="#cb52-71" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;- Germany:     {}&quot;</span>, bridge_pilar_height_DE<span class="op">)</span>;</span>
<span id="cb52-72"><a href="#cb52-72" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;- Switzerland: {}&quot;</span>, bridge_pilar_height_CH<span class="op">)</span>;</span>
<span id="cb52-73"><a href="#cb52-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-74"><a href="#cb52-74" aria-hidden="true" tabindex="-1"></a>  <span class="co">// artificial bridge altitude on both sides of the river in both systems</span></span>
<span id="cb52-75"><a href="#cb52-75" aria-hidden="true" tabindex="-1"></a>  quantity_point bridge_road_alt_DE <span class="op">=</span> bridge_base_alt_DE <span class="op">+</span> bridge_pilar_height_DE;</span>
<span id="cb52-76"><a href="#cb52-76" aria-hidden="true" tabindex="-1"></a>  quantity_point bridge_road_alt_CH <span class="op">=</span> bridge_base_alt_CH <span class="op">+</span> bridge_pilar_height_CH;</span>
<span id="cb52-77"><a href="#cb52-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-78"><a href="#cb52-78" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;Bridge road altitude:&quot;</span><span class="op">)</span>;</span>
<span id="cb52-79"><a href="#cb52-79" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;- Germany:     {}&quot;</span>, bridge_road_alt_DE<span class="op">)</span>;</span>
<span id="cb52-80"><a href="#cb52-80" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;- Switzerland: {}&quot;</span>, bridge_road_alt_CH<span class="op">)</span>;</span>
<span id="cb52-81"><a href="#cb52-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-82"><a href="#cb52-82" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;Bridge road altitude relative to the Amsterdam Sea Level:&quot;</span><span class="op">)</span>;</span>
<span id="cb52-83"><a href="#cb52-83" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;- Germany:     {}&quot;</span>, bridge_road_alt_DE<span class="op">.</span>quantity_from<span class="op">(</span>amsterdam_sea_level<span class="op">))</span>;</span>
<span id="cb52-84"><a href="#cb52-84" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;- Switzerland: {}&quot;</span>, bridge_road_alt_CH<span class="op">.</span>quantity_from<span class="op">(</span>amsterdam_sea_level<span class="op">))</span>;</span>
<span id="cb52-85"><a href="#cb52-85" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>The above provides the following text output:</p>
<pre class="text"><code>Bridge pillars height:
- Germany:     27 m
- Switzerland: 3227 cm
Bridge road altitude:
- Germany:     330 m AMSL(DE)
- Switzerland: 33027 cm AMSL(CH)
Bridge road altitude relative to the Amsterdam Sea Level:
- Germany:     330 m
- Switzerland: 33000 cm</code></pre>
<p>Try it in <a href="https://godbolt.org/z/oEW1vfeMG">the Compiler
Explorer</a>.</p>
<h2 data-number="11.5" id="user-defined-quantities-and-units"><span class="header-section-number">11.5</span> User defined quantities and
units<a href="#user-defined-quantities-and-units" class="self-link"></a></h2>
<p>Users can easily define new quantities and units for domain-specific
use-cases. This example from digital signal processing domain will show
how to define custom strongly typed dimensionless quantities, units for
them, and how they can be converted to time measured in
milliseconds:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> mp_units;</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> std;</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> mp_units;</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> ni <span class="op">{</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="co">// quantities</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> SampleCount <span class="op">:</span> quantity_spec<span class="op">&lt;</span>dimensionless, is_kind<span class="op">&gt;</span> <span class="op">{}</span> SampleCount;</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> SampleDuration <span class="op">:</span> quantity_spec<span class="op">&lt;</span>isq<span class="op">::</span>time<span class="op">&gt;</span> <span class="op">{}</span> SampleDuration;</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> SamplingRate <span class="op">:</span> quantity_spec<span class="op">&lt;</span>isq<span class="op">::</span>frequency, SampleCount <span class="op">/</span> isq<span class="op">::</span>time<span class="op">&gt;</span> <span class="op">{}</span> SamplingRate;</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> UnitSampleAmount <span class="op">:</span> quantity_spec<span class="op">&lt;</span>dimensionless, is_kind<span class="op">&gt;</span> <span class="op">{}</span> UnitSampleAmount;</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">auto</span> Amplitude <span class="op">=</span> UnitSampleAmount;</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">auto</span> Level <span class="op">=</span> UnitSampleAmount;</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> Power <span class="op">:</span> quantity_spec<span class="op">&lt;</span>Level <span class="op">*</span> Level<span class="op">&gt;</span> <span class="op">{}</span> Power;</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> MIDIClock <span class="op">:</span> quantity_spec<span class="op">&lt;</span>dimensionless, is_kind<span class="op">&gt;</span> <span class="op">{}</span> MIDIClock;</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> BeatCount <span class="op">:</span> quantity_spec<span class="op">&lt;</span>dimensionless, is_kind<span class="op">&gt;</span> <span class="op">{}</span> BeatCount;</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> BeatDuration <span class="op">:</span> quantity_spec<span class="op">&lt;</span>isq<span class="op">::</span>time<span class="op">&gt;</span> <span class="op">{}</span> BeatDuration;</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> Tempo <span class="op">:</span> quantity_spec<span class="op">&lt;</span>isq<span class="op">::</span>frequency, BeatCount <span class="op">/</span> isq<span class="op">::</span>time<span class="op">&gt;</span> <span class="op">{}</span> Tempo;</span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a><span class="co">// units</span></span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> Sample <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;Smpl&quot;</span>, one, kind_of<span class="op">&lt;</span>SampleCount<span class="op">&gt;&gt;</span> <span class="op">{}</span> Sample;</span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> SampleValue <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;PCM&quot;</span>, one, kind_of<span class="op">&lt;</span>UnitSampleAmount<span class="op">&gt;&gt;</span> <span class="op">{}</span> SampleValue;</span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> MIDIPulse <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;p&quot;</span>, one, kind_of<span class="op">&lt;</span>MIDIClock<span class="op">&gt;&gt;</span> <span class="op">{}</span> MIDIPulse;</span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> QuarterNote <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;q&quot;</span>, one, kind_of<span class="op">&lt;</span>BeatCount<span class="op">&gt;&gt;</span> <span class="op">{}</span> QuarterNote;</span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> HalfNote <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;h&quot;</span>, mag<span class="op">&lt;</span><span class="dv">2</span><span class="op">&gt;</span> <span class="op">*</span> QuarterNote<span class="op">&gt;</span> <span class="op">{}</span> HalfNote;</span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> DottedHalfNote <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;h.&quot;</span>, mag<span class="op">&lt;</span><span class="dv">3</span><span class="op">&gt;</span> <span class="op">*</span> QuarterNote<span class="op">&gt;</span> <span class="op">{}</span> DottedHalfNote;</span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> WholeNote <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;w&quot;</span>, mag<span class="op">&lt;</span><span class="dv">4</span><span class="op">&gt;</span> <span class="op">*</span> QuarterNote<span class="op">&gt;</span> <span class="op">{}</span> WholeNote;</span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> EightNote <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;8th&quot;</span>, mag<span class="op">&lt;</span>ratio<span class="op">{</span><span class="dv">1</span>, <span class="dv">2</span><span class="op">}&gt;</span> <span class="op">*</span> QuarterNote<span class="op">&gt;</span> <span class="op">{}</span> EightNote;</span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> DottedQuarterNote <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;q.&quot;</span>, mag<span class="op">&lt;</span><span class="dv">3</span><span class="op">&gt;</span> <span class="op">*</span> EightNote<span class="op">&gt;</span> <span class="op">{}</span> DottedQuarterNote;</span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> QuarterNoteTriplet <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;qt&quot;</span>, mag<span class="op">&lt;</span>ratio<span class="op">{</span><span class="dv">1</span>, <span class="dv">3</span><span class="op">}&gt;</span> <span class="op">*</span> HalfNote<span class="op">&gt;</span> <span class="op">{}</span> QuarterNoteTriplet;</span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> SixteenthNote <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;16th&quot;</span>, mag<span class="op">&lt;</span>ratio<span class="op">{</span><span class="dv">1</span>, <span class="dv">2</span><span class="op">}&gt;</span> <span class="op">*</span> EightNote<span class="op">&gt;</span> <span class="op">{}</span> SixteenthNote;</span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> DottedEightNote <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;q.&quot;</span>, mag<span class="op">&lt;</span><span class="dv">3</span><span class="op">&gt;</span> <span class="op">*</span> SixteenthNote<span class="op">&gt;</span> <span class="op">{}</span> DottedEightNote;</span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-39"><a href="#cb53-39" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">auto</span> Beat <span class="op">=</span> QuarterNote;</span>
<span id="cb53-40"><a href="#cb53-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-41"><a href="#cb53-41" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> BeatsPerMinute <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;bpm&quot;</span>, Beat <span class="op">/</span> si<span class="op">::</span>minute<span class="op">&gt;</span> <span class="op">{}</span> BeatsPerMinute;</span>
<span id="cb53-42"><a href="#cb53-42" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> MIDIPulsePerQuarter <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;ppqn&quot;</span>, MIDIPulse <span class="op">/</span> QuarterNote<span class="op">&gt;</span> <span class="op">{}</span> MIDIPulsePerQuarter;</span>
<span id="cb53-43"><a href="#cb53-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-44"><a href="#cb53-44" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> unit_symbols <span class="op">{</span></span>
<span id="cb53-45"><a href="#cb53-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-46"><a href="#cb53-46" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">auto</span> Smpl <span class="op">=</span> Sample;</span>
<span id="cb53-47"><a href="#cb53-47" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">auto</span> pcm <span class="op">=</span> SampleValue;</span>
<span id="cb53-48"><a href="#cb53-48" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">auto</span> p <span class="op">=</span> MIDIPulse;</span>
<span id="cb53-49"><a href="#cb53-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-50"><a href="#cb53-50" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">auto</span> n_wd <span class="op">=</span> <span class="dv">3</span> <span class="op">*</span> HalfNote;</span>
<span id="cb53-51"><a href="#cb53-51" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">auto</span> n_w <span class="op">=</span> WholeNote;</span>
<span id="cb53-52"><a href="#cb53-52" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">auto</span> n_hd <span class="op">=</span> DottedHalfNote;</span>
<span id="cb53-53"><a href="#cb53-53" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">auto</span> n_h <span class="op">=</span> HalfNote;</span>
<span id="cb53-54"><a href="#cb53-54" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">auto</span> n_qd <span class="op">=</span> DottedQuarterNote;</span>
<span id="cb53-55"><a href="#cb53-55" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">auto</span> n_q <span class="op">=</span> QuarterNote;</span>
<span id="cb53-56"><a href="#cb53-56" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">auto</span> n_qt <span class="op">=</span> QuarterNoteTriplet;</span>
<span id="cb53-57"><a href="#cb53-57" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">auto</span> n_8thd <span class="op">=</span> DottedEightNote;</span>
<span id="cb53-58"><a href="#cb53-58" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">auto</span> n_8th <span class="op">=</span> EightNote;</span>
<span id="cb53-59"><a href="#cb53-59" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">auto</span> n_16th <span class="op">=</span> SixteenthNote;</span>
<span id="cb53-60"><a href="#cb53-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-61"><a href="#cb53-61" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb53-62"><a href="#cb53-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-63"><a href="#cb53-63" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>BeatsPerMinute, <span class="dt">float</span><span class="op">&gt;</span> GetTempo<span class="op">()</span></span>
<span id="cb53-64"><a href="#cb53-64" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb53-65"><a href="#cb53-65" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="dv">110</span> <span class="op">*</span> BeatsPerMinute;</span>
<span id="cb53-66"><a href="#cb53-66" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb53-67"><a href="#cb53-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-68"><a href="#cb53-68" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>MIDIPulsePerQuarter, <span class="dt">unsigned</span><span class="op">&gt;</span> GetPPQN<span class="op">()</span></span>
<span id="cb53-69"><a href="#cb53-69" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb53-70"><a href="#cb53-70" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="dv">960</span> <span class="op">*</span> MIDIPulse <span class="op">/</span> QuarterNote;</span>
<span id="cb53-71"><a href="#cb53-71" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb53-72"><a href="#cb53-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-73"><a href="#cb53-73" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>MIDIPulse, <span class="dt">unsigned</span><span class="op">&gt;</span> GetTransportPos<span class="op">()</span></span>
<span id="cb53-74"><a href="#cb53-74" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb53-75"><a href="#cb53-75" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="dv">15836</span> <span class="op">*</span> MIDIPulse;</span>
<span id="cb53-76"><a href="#cb53-76" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb53-77"><a href="#cb53-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-78"><a href="#cb53-78" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>SamplingRate<span class="op">[</span>si<span class="op">::</span>hertz<span class="op">]</span>, <span class="dt">float</span><span class="op">&gt;</span> GetSampleRate<span class="op">()</span></span>
<span id="cb53-79"><a href="#cb53-79" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb53-80"><a href="#cb53-80" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fl">44100.</span><span class="bu">f</span> <span class="op">*</span> si<span class="op">::</span>hertz;</span>
<span id="cb53-81"><a href="#cb53-81" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb53-82"><a href="#cb53-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-83"><a href="#cb53-83" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb53-84"><a href="#cb53-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-85"><a href="#cb53-85" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span></span>
<span id="cb53-86"><a href="#cb53-86" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb53-87"><a href="#cb53-87" aria-hidden="true" tabindex="-1"></a>  <span class="kw">using</span> <span class="kw">namespace</span> ni<span class="op">::</span>unit_symbols;</span>
<span id="cb53-88"><a href="#cb53-88" aria-hidden="true" tabindex="-1"></a>  <span class="kw">using</span> <span class="kw">namespace</span> mp_units<span class="op">::</span>si<span class="op">::</span>unit_symbols;</span>
<span id="cb53-89"><a href="#cb53-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-90"><a href="#cb53-90" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> <span class="kw">auto</span> sr1 <span class="op">=</span> ni<span class="op">::</span>GetSampleRate<span class="op">()</span>;</span>
<span id="cb53-91"><a href="#cb53-91" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> <span class="kw">auto</span> sr2 <span class="op">=</span> <span class="fl">48000.</span><span class="bu">f</span> <span class="op">*</span> Smpl <span class="op">/</span> s;</span>
<span id="cb53-92"><a href="#cb53-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-93"><a href="#cb53-93" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> <span class="kw">auto</span> samples <span class="op">=</span> <span class="dv">512</span> <span class="op">*</span> Smpl;</span>
<span id="cb53-94"><a href="#cb53-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-95"><a href="#cb53-95" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> <span class="kw">auto</span> sampleTime1 <span class="op">=</span> <span class="op">(</span>samples <span class="op">/</span> sr1<span class="op">).</span>in<span class="op">(</span>s<span class="op">)</span>;</span>
<span id="cb53-96"><a href="#cb53-96" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> <span class="kw">auto</span> sampleTime2 <span class="op">=</span> <span class="op">(</span>samples <span class="op">/</span> sr2<span class="op">).</span>in<span class="op">(</span>ms<span class="op">)</span>;</span>
<span id="cb53-97"><a href="#cb53-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-98"><a href="#cb53-98" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> <span class="kw">auto</span> sampleDuration1 <span class="op">=</span> <span class="op">(</span><span class="dv">1</span> <span class="op">/</span> sr1<span class="op">).</span>in<span class="op">(</span>ms<span class="op">)</span>;</span>
<span id="cb53-99"><a href="#cb53-99" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> <span class="kw">auto</span> sampleDuration2 <span class="op">=</span> <span class="op">(</span><span class="dv">1</span> <span class="op">/</span> sr2<span class="op">).</span>in<span class="op">(</span>ms<span class="op">)</span>;</span>
<span id="cb53-100"><a href="#cb53-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-101"><a href="#cb53-101" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> <span class="kw">auto</span> rampTime <span class="op">=</span> <span class="fl">35.</span><span class="bu">f</span> <span class="op">*</span> ms;</span>
<span id="cb53-102"><a href="#cb53-102" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> <span class="kw">auto</span> rampSamples1 <span class="op">=</span> value_cast<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;((</span>rampTime <span class="op">*</span> sr1<span class="op">).</span>in<span class="op">(</span>Smpl<span class="op">))</span>;</span>
<span id="cb53-103"><a href="#cb53-103" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> <span class="kw">auto</span> rampSamples2 <span class="op">=</span> value_cast<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;((</span>rampTime <span class="op">*</span> sr2<span class="op">).</span>in<span class="op">(</span>Smpl<span class="op">))</span>;</span>
<span id="cb53-104"><a href="#cb53-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-105"><a href="#cb53-105" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;Sample rate 1 is: {}&quot;</span>, sr1<span class="op">)</span>;</span>
<span id="cb53-106"><a href="#cb53-106" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;Sample rate 2 is: {}&quot;</span>, sr2<span class="op">)</span>;</span>
<span id="cb53-107"><a href="#cb53-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-108"><a href="#cb53-108" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;{} @ {} is {:{%N:.5f} %U}&quot;</span>, samples, sr1, sampleTime1<span class="op">)</span>;</span>
<span id="cb53-109"><a href="#cb53-109" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;{} @ {} is {:{%N:.5f} %U}&quot;</span>, samples, sr2, sampleTime2<span class="op">)</span>;</span>
<span id="cb53-110"><a href="#cb53-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-111"><a href="#cb53-111" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;One sample @ {} is {:{%N:.5f} %U}&quot;</span>, sr1, sampleDuration1<span class="op">)</span>;</span>
<span id="cb53-112"><a href="#cb53-112" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;One sample @ {} is {:{%N:.5f} %U}&quot;</span>, sr2, sampleDuration2<span class="op">)</span>;</span>
<span id="cb53-113"><a href="#cb53-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-114"><a href="#cb53-114" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;{} is {} @ {}&quot;</span>, rampTime, rampSamples1, sr1<span class="op">)</span>;</span>
<span id="cb53-115"><a href="#cb53-115" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;{} is {} @ {}&quot;</span>, rampTime, rampSamples2, sr2<span class="op">)</span>;</span>
<span id="cb53-116"><a href="#cb53-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-117"><a href="#cb53-117" aria-hidden="true" tabindex="-1"></a>  <span class="kw">auto</span> sampleValue <span class="op">=</span> <span class="op">-</span><span class="fl">0.4</span><span class="bu">f</span> <span class="op">*</span> pcm;</span>
<span id="cb53-118"><a href="#cb53-118" aria-hidden="true" tabindex="-1"></a>  <span class="kw">auto</span> power1 <span class="op">=</span> sampleValue <span class="op">*</span> sampleValue;</span>
<span id="cb53-119"><a href="#cb53-119" aria-hidden="true" tabindex="-1"></a>  <span class="kw">auto</span> power2 <span class="op">=</span> <span class="op">-</span><span class="fl">0.2</span> <span class="op">*</span> pow<span class="op">&lt;</span><span class="dv">2</span><span class="op">&gt;(</span>pcm<span class="op">)</span>;</span>
<span id="cb53-120"><a href="#cb53-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-121"><a href="#cb53-121" aria-hidden="true" tabindex="-1"></a>  <span class="kw">auto</span> tempo <span class="op">=</span> ni<span class="op">::</span>GetTempo<span class="op">()</span>;</span>
<span id="cb53-122"><a href="#cb53-122" aria-hidden="true" tabindex="-1"></a>  <span class="kw">auto</span> reverbBeats <span class="op">=</span> <span class="dv">1</span> <span class="op">*</span> n_qd;</span>
<span id="cb53-123"><a href="#cb53-123" aria-hidden="true" tabindex="-1"></a>  <span class="kw">auto</span> reverbTime <span class="op">=</span> reverbBeats <span class="op">/</span> tempo;</span>
<span id="cb53-124"><a href="#cb53-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-125"><a href="#cb53-125" aria-hidden="true" tabindex="-1"></a>  <span class="kw">auto</span> pulsePerQuarter <span class="op">=</span> value_cast<span class="op">&lt;</span><span class="dt">float</span><span class="op">&gt;(</span>ni<span class="op">::</span>GetPPQN<span class="op">())</span>;</span>
<span id="cb53-126"><a href="#cb53-126" aria-hidden="true" tabindex="-1"></a>  <span class="kw">auto</span> transportPosition <span class="op">=</span> ni<span class="op">::</span>GetTransportPos<span class="op">()</span>;</span>
<span id="cb53-127"><a href="#cb53-127" aria-hidden="true" tabindex="-1"></a>  <span class="kw">auto</span> transportBeats <span class="op">=</span> <span class="op">(</span>transportPosition <span class="op">/</span> pulsePerQuarter<span class="op">).</span>in<span class="op">(</span>n_q<span class="op">)</span>;</span>
<span id="cb53-128"><a href="#cb53-128" aria-hidden="true" tabindex="-1"></a>  <span class="kw">auto</span> transportTime <span class="op">=</span> <span class="op">(</span>transportBeats <span class="op">/</span> tempo<span class="op">).</span>in<span class="op">(</span>s<span class="op">)</span>;</span>
<span id="cb53-129"><a href="#cb53-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-130"><a href="#cb53-130" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;SampleValue is: {}&quot;</span>, sampleValue<span class="op">)</span>;</span>
<span id="cb53-131"><a href="#cb53-131" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;Power 1 is: {}&quot;</span>, power1<span class="op">)</span>;</span>
<span id="cb53-132"><a href="#cb53-132" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;Power 2 is: {}&quot;</span>, power2<span class="op">)</span>;</span>
<span id="cb53-133"><a href="#cb53-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-134"><a href="#cb53-134" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;Tempo is: {}&quot;</span>, tempo<span class="op">)</span>;</span>
<span id="cb53-135"><a href="#cb53-135" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;Reverb Beats is: {}&quot;</span>, reverbBeats<span class="op">)</span>;</span>
<span id="cb53-136"><a href="#cb53-136" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;Reverb Time is: {}&quot;</span>, reverbTime<span class="op">.</span>in<span class="op">(</span>s<span class="op">))</span>;</span>
<span id="cb53-137"><a href="#cb53-137" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;Pulse Per Quarter is: {}&quot;</span>, pulsePerQuarter<span class="op">)</span>;</span>
<span id="cb53-138"><a href="#cb53-138" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;Transport Position is: {}&quot;</span>, transportPosition<span class="op">)</span>;</span>
<span id="cb53-139"><a href="#cb53-139" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;Transport Beats is: {}&quot;</span>, transportBeats<span class="op">)</span>;</span>
<span id="cb53-140"><a href="#cb53-140" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;Transport Time is: {}&quot;</span>, transportTime<span class="op">)</span>;</span>
<span id="cb53-141"><a href="#cb53-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-142"><a href="#cb53-142" aria-hidden="true" tabindex="-1"></a>  <span class="co">// auto error = 1 * Smpl + 1 * pcm + 1 * p + 1 * Beat;  // Compile-time error</span></span>
<span id="cb53-143"><a href="#cb53-143" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>The above code outputs:</p>
<pre class="text"><code>Sample rate 1 is: 44100 Hz
Sample rate 2 is: 48000 Smpl/s
512 Smpl @ 44100 Hz is 0.01161 s
512 Smpl @ 48000 Smpl/s is 10.66667 ms
One sample @ 44100 Hz is 0.02268 ms
One sample @ 48000 Smpl/s is 0.02083 ms
35 ms is 1543 Smpl @ 44100 Hz
35 ms is 1680 Smpl @ 48000 Smpl/s
SampleValue is: -0.4 PCM
Power 1 is: 0.16000001 PCM²
Power 2 is: -0.2 PCM²
Tempo is: 110 bpm
Reverb Beats is: 1 q.
Reverb Time is: 0.8181818 s
Pulse Per Quarter is: 960 ppqn
Transport Position is: 15836 p
Transport Beats is: 16.495832 q
Transport Time is: 8.997726 s</code></pre>
<p>Try it in <a href="https://godbolt.org/z/MvGTc5Eva">the Compiler
Explorer</a>.</p>
<p><em>Note: More about this example can be found in <a href="https://www.youtube.com/watch?v=oxnCdIfC4Z4">“Exploration of
Strongly-typed Units in C++: A Case Study from Digital Audio”</a> CppCon
2023 talk by Roth Michaels.</em></p>
<h1 data-number="12" id="why-do-we-need-typed-quantities"><span class="header-section-number">12</span> Why do we need typed
quantities?<a href="#why-do-we-need-typed-quantities" class="self-link"></a></h1>
<h2 data-number="12.1" id="limitations-of-units-only-solutions"><span class="header-section-number">12.1</span> Limitations of units-only
solutions<a href="#limitations-of-units-only-solutions" class="self-link"></a></h2>
<p>Units-only is not a good design for a quantities and units library.
It works to some extent, but plenty of use cases can’t be addressed, and
for those that somehow work, we miss important safety improvements
provided by additional abstractions in this chapter. But before we talk
about those extensions, let’s first discuss some limitations of the
units-only solution.</p>
<p><em>Note: The issues described below do not apply to the proposed
library, because with the proposed interfaces, even if we decide to only
use the simple mode, units are still backed up by quantity kinds under
the framework’s hood.</em></p>
<h3 data-number="12.1.1" id="no-way-to-specify-a-quantity-type-in-generic-interfaces"><span class="header-section-number">12.1.1</span> No way to specify a quantity
type in generic interfaces<a href="#no-way-to-specify-a-quantity-type-in-generic-interfaces" class="self-link"></a></h3>
<p>A common requirement in the domain is to write unit-agnostic generic
interfaces. For example, let’s try to implement a generic
<code class="sourceCode default">avg_speed</code> function template that
takes a quantity of any unit and produces the result. So if we call it
with <em>distance</em> in <code class="sourceCode default">km</code> and
<em>time</em> in <code class="sourceCode default">h</code>, we will get
<code class="sourceCode default">km / h</code> as a result, but if we
call it with <code class="sourceCode default">mi</code> and
<code class="sourceCode default">h</code>, we expect
<code class="sourceCode default">mi / h</code> to be returned.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span>Unit <span class="kw">auto</span> U1, <span class="kw">typename</span> Rep1, Unit <span class="kw">auto</span> U2, <span class="kw">typename</span> Rep2<span class="op">&gt;</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> avg_speed<span class="op">(</span>quantity<span class="op">&lt;</span>U1, Rep1<span class="op">&gt;</span> distance, quantity<span class="op">&lt;</span>U2, Rep2<span class="op">&gt;</span> time<span class="op">)</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> distance <span class="op">/</span> time;</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>quantity speed <span class="op">=</span> avg_speed<span class="op">(</span><span class="dv">120</span> <span class="op">*</span> km, <span class="dv">2</span> <span class="op">*</span> h<span class="op">)</span>;</span></code></pre></div>
<p>This function works but does not provide any type safety to the
users. The function arguments can be easily reordered on the call site.
Also, we do not get any information about the return type of the
function and any safety to ensure that the function logic actually
returns a quantity of <em>speed</em>.</p>
<p>With a units-only library, we have to write the function in the
following way:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>si<span class="op">::</span>metre <span class="op">/</span> si<span class="op">::</span>second<span class="op">&gt;</span> avg_speed<span class="op">(</span>quantity<span class="op">&lt;</span>si<span class="op">::</span>metre<span class="op">&gt;</span> distance, quantity<span class="op">&lt;</span>si<span class="op">::</span>second<span class="op">&gt;</span> time<span class="op">)</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> distance <span class="op">/</span> time;</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>avg_speed<span class="op">(</span><span class="dv">120</span> <span class="op">*</span> km, <span class="dv">2</span> <span class="op">*</span> h<span class="op">).</span>in<span class="op">(</span>km <span class="op">/</span> h<span class="op">)</span>;</span></code></pre></div>
<p>The above code decreased the performance because we always pay for
the conversion at the function’s input and output. Moreover, we had to
force <code class="sourceCode default">double</code> as a representation
type to prevent narrowing, which can affect not only the performance,
but also precision and memory footprint.</p>
<p>We could try to provide concepts like
<code class="sourceCode default">ScaledUnitOf&lt;si::metre&gt;</code>
that will try to constrain somehow the arguments, but it leads to even
more problems with the unit definitions. For example, are Hz and Bq
scaled versions of 1 / s? What about radian and steradian or a litre and
a cubic meter?</p>
<h3 data-number="12.1.2" id="disjoint-units-of-the-same-quantity-type-do-not-work"><span class="header-section-number">12.1.2</span> Disjoint units of the same
quantity type do not work<a href="#disjoint-units-of-the-same-quantity-type-do-not-work" class="self-link"></a></h3>
<p>Sometimes, we need to define several units describing the same
quantity but which do not convert to each other. A typical example can
be a currency use case. A user may want to define EURO and USD as units
of currency, but do not provide any predefined conversion factor and
handle such a conversion at runtime with custom logic. In such a case,
how we can specify that EURO and USD are quantities of the same
type/dimension?</p>
<h2 data-number="12.2" id="limitations-of-dimensions"><span class="header-section-number">12.2</span> Limitations of dimensions<a href="#limitations-of-dimensions" class="self-link"></a></h2>
<p>To prevent the above issues, most of the libraries on the market
introduce dimension abstraction. Thanks to that, we could solve the
first issue of the previous chapter with:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>QuantityOf<span class="op">&lt;</span>dim_speed<span class="op">&gt;</span> <span class="kw">auto</span> avg_speed<span class="op">(</span>QuantityOf<span class="op">&lt;</span>dim_length<span class="op">&gt;</span> <span class="kw">auto</span> distance, </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>                                     QuantityOf<span class="op">&lt;</span>dim_time<span class="op">&gt;</span> <span class="kw">auto</span> time<span class="op">)</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> distance <span class="op">/</span> time;</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>and the second one by specifying that both EURO and USD are units of
<code class="sourceCode default">dim_currency</code>. This is a
significant improvement but still has some issues.</p>
<p>Let’s first look again at the above solution. A domain expert seeing
this code will immediately say there is no such thing as a speed
dimension. The ISQ specifies only 7 dimensions with unique symbols
assigned, and the dimensions of all the ISQ quantities are created as a
vector product of those. For example, a quantity of <em>speed</em> has a
dimension of <span class="math inline">\(L^1T^{-1}\)</span>. So, to be
physically correct, the above code should be rewritten as:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>QuantityOf<span class="op">&lt;</span>dim_length <span class="op">/</span> dim_time<span class="op">&gt;</span> <span class="kw">auto</span> avg_speed<span class="op">(</span>QuantityOf<span class="op">&lt;</span>dim_length<span class="op">&gt;</span> <span class="kw">auto</span> distance, </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>                                                 QuantityOf<span class="op">&lt;</span>dim_time<span class="op">&gt;</span> <span class="kw">auto</span> time<span class="op">)</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> distance <span class="op">/</span> time;</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Most of the libraries on the market ignore this fact and try to model
distinct quantities through their dimensions, giving a false sense of
safety. A dimension is not enough to describe a quantity. This has been
known for a long time now. The <span class="citation" data-cites="MSRMT_DATA">[<a href="#ref-MSRMT_DATA" role="doc-biblioref">Measurement Data</a>]</span> report from 1996 says
explicitly, “Dimensional analysis does not adequately model the
semantics of measurement data”.</p>
<p>In the following chapters, we will see a few use cases that can’t be
solved with an approach that only relies on units or dimensions.</p>
<h3 data-number="12.2.1" id="si-units-of-quantities-of-the-same-dimension-but-different-kinds"><span class="header-section-number">12.2.1</span> SI units of quantities of
the same dimension but different kinds<a href="#si-units-of-quantities-of-the-same-dimension-but-different-kinds" class="self-link"></a></h3>
<p>The <span class="citation" data-cites="SI">[<a href="#ref-SI" role="doc-biblioref">SI</a>]</span> provides several units for distinct
quantities of the same dimension but different kinds. For example:</p>
<ul>
<li>hertz (Hz) is a unit of <em>frequency</em> and becquerel (Bq) is a
unit of <em>activity</em>. Both are defined as <span class="math inline">\(s^{-1}\)</span>, and have the same dimension of
<span class="math inline">\(T^{-1}\)</span>.</li>
<li>gray (Gy) is a unit of <em>absorbed dose</em> and sievert (Sv) is a
unit of <em>dose equivalent</em>. Both are defined as <span class="math inline">\(m^2 s^{-2}\)</span>, and have the same dimension
of <span class="math inline">\(L^2T^{-2}\)</span></li>
<li>radian (rad) is a unit of <em>plane angle</em> defined as <span class="math inline">\(m/m\)</span>, and steradian (sr) is a unit of
<em>solid angle</em> defined as <span class="math inline">\(m^2/m^2\)</span>. Both are quantities of dimension
one, which also has its own units like one (1) and percent (%).</li>
</ul>
<p>There are many more similar examples in <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span>. For example, <em>storage
capacity</em> quantity can be measured in units of one, bit, octet, and
byte.</p>
<p>The above conflicts can’t be solved with dimensions, and they yield
many safety issues. For example, we can ask ourselves what should be the
result of the following:</p>
<ol type="1">
<li><code class="sourceCode default">quantity q = 1 * Hz + 1 * Bq;</code></li>
<li><code class="sourceCode default">quantity&lt;Gy&gt; q = 42 * Sv;</code></li>
<li><code class="sourceCode default">bool b = (1 * rad + 1 * bit) == 2 * sr;</code></li>
</ol>
<p>None of the above code should compile, but most of the libraries on
the market happily accept it and provide meaningless results. Some of
them decide not to define one or more of the above units at all to avoid
potential safety issues. For example, <a href="https://github.com/aurora-opensource/au/pull/157">the Au library
does not define <code class="sourceCode default">Sv</code> to avoid
mixing it up with Gy</a>.</p>
<h3 data-number="12.2.2" id="derived-quantities-of-the-same-dimension-but-different-kinds"><span class="header-section-number">12.2.2</span> Derived quantities of the
same dimension but different kinds<a href="#derived-quantities-of-the-same-dimension-but-different-kinds" class="self-link"></a></h3>
<p>Even if some quantities do not have a specially assigned unit, they
may still have a totally different physical meaning even if they share
the same dimension:</p>
<ul>
<li><em>work</em> vs. <em>moment of force</em> both of the same
dimension <span class="math inline">\(L^2MT^{-2}\)</span></li>
<li><em>fuel consumption</em> expressed in <span class="math inline">\(\frac{l}{100\;km}\)</span> vs. <em>area</em>
expressed in <span class="math inline">\(m^2\)</span> both of the same
dimension <span class="math inline">\(L^2\)</span></li>
</ul>
<p>Again, we don’t want to accidentally mix those.</p>
<h3 data-number="12.2.3" id="various-quantities-of-the-same-dimension-and-kinds"><span class="header-section-number">12.2.3</span> Various quantities of the
same dimension and kinds<a href="#various-quantities-of-the-same-dimension-and-kinds" class="self-link"></a></h3>
<p>Even if we somehow address all the above, there are still plenty of
use cases that still can’t be safely implemented with such
abstractions.</p>
<p>Let’s consider that we want to implement a freight transport
application to position cargo in the container. In such a scenario, we
need to be able to discriminate between <em>length</em>, <em>width</em>,
and <em>height</em> of the package. Also, often, we can find a “This
side up” arrow on the box.</p>
<p>A similar but also really important use case is in aviation. The
current <em>altitude</em> is a totally different quantity than the
<em>distance</em> to the destination. The same is true for <em>forward
speed</em> and <em>sink rate</em>. We do not want to accidentally mix
those.</p>
<p>When we deal with <em>energy</em>, we should be able to implicitly
construct it from a proper product of any <em>mass</em>,
<em>length</em>, and <em>time</em>. However, when we want to calculate
<em>gravitational potential energy</em>, we may not want it to be
implicitly initialized from any expression of matching dimensions. Such
an implicit construction should be allowed only if we multiply a
<em>mass</em> with <em>acceleration of free fall</em> and
<em>height</em>. All other conversions should happen explicitly.</p>
<p>Yet another example comes from the audio industry. In the audio
software, we want to treat specific counts (e.g., <em>beats</em>,
<em>samples</em>) as separate quantities, but if we divide them, we
should obtain a quantity convertible to <em>frequency</em>. The latter
has the dimension of <span class="math inline">\(T^{-1}\)</span>, which
prevents us from assigning dedicated dimensions to such counts.</p>
<p>The last example that we want to mention here comes from finance.
This time, we need to model <em>volume</em> as a special quantity of
<em>currency</em>. <em>volume</em> can be obtained by multiplying
<em>currency</em> by the dimensionless <em>market quantity</em>. Of
course, both <em>currency</em> and <em>volume</em> should be expressed
in the same units (e.g., USD).</p>
<p>None of the above scenarios can be addressed with just units and
dimensions. We need a better abstraction to safely implement them.</p>
<h1 data-number="13" id="systems-of-quantities-and-units"><span class="header-section-number">13</span> Systems of quantities and
units<a href="#systems-of-quantities-and-units" class="self-link"></a></h1>
<!-- 
flowchart TD
    system_of_quantities["System of Quantities"] --- system_of_units1[System of Units #1]
    system_of_quantities["System of Quantities"] --- system_of_units2[System of Units #2]
    system_of_quantities["System of Quantities"] --- system_of_units3[System of Units #3]
 -->
<p><img src="data:image/svg+xml;base64,PHN2ZyBhcmlhLXJvbGVkZXNjcmlwdGlvbj0iZmxvd2NoYXJ0LXYyIiByb2xlPSJncmFwaGljcy1kb2N1bWVudCBkb2N1bWVudCIgdmlld0JveD0iLTggLTggNTU4Ljk2ODc1IDE0NCIgc3R5bGU9Im1heC13aWR0aDogMTAwJTsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGlkPSJncmFwaC1kaXYiIGhlaWdodD0iMTAwJSIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxzdHlsZT5AaW1wb3J0IHVybCgiaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvZm9udC1hd2Vzb21lLzYuNC4yL2Nzcy9hbGwubWluLmNzcyIpOyc8L3N0eWxlPjxzdHlsZT4jZ3JhcGgtZGl2e2ZvbnQtZmFtaWx5OiJ0cmVidWNoZXQgbXMiLHZlcmRhbmEsYXJpYWwsc2Fucy1zZXJpZjtmb250LXNpemU6MTZweDtmaWxsOiMzMzM7fSNncmFwaC1kaXYgLmVycm9yLWljb257ZmlsbDojNTUyMjIyO30jZ3JhcGgtZGl2IC5lcnJvci10ZXh0e2ZpbGw6IzU1MjIyMjtzdHJva2U6IzU1MjIyMjt9I2dyYXBoLWRpdiAuZWRnZS10aGlja25lc3Mtbm9ybWFse3N0cm9rZS13aWR0aDoycHg7fSNncmFwaC1kaXYgLmVkZ2UtdGhpY2tuZXNzLXRoaWNre3N0cm9rZS13aWR0aDozLjVweDt9I2dyYXBoLWRpdiAuZWRnZS1wYXR0ZXJuLXNvbGlke3N0cm9rZS1kYXNoYXJyYXk6MDt9I2dyYXBoLWRpdiAuZWRnZS1wYXR0ZXJuLWRhc2hlZHtzdHJva2UtZGFzaGFycmF5OjM7fSNncmFwaC1kaXYgLmVkZ2UtcGF0dGVybi1kb3R0ZWR7c3Ryb2tlLWRhc2hhcnJheToyO30jZ3JhcGgtZGl2IC5tYXJrZXJ7ZmlsbDojMzMzMzMzO3N0cm9rZTojMzMzMzMzO30jZ3JhcGgtZGl2IC5tYXJrZXIuY3Jvc3N7c3Ryb2tlOiMzMzMzMzM7fSNncmFwaC1kaXYgc3Zne2ZvbnQtZmFtaWx5OiJ0cmVidWNoZXQgbXMiLHZlcmRhbmEsYXJpYWwsc2Fucy1zZXJpZjtmb250LXNpemU6MTZweDt9I2dyYXBoLWRpdiAubGFiZWx7Zm9udC1mYW1pbHk6InRyZWJ1Y2hldCBtcyIsdmVyZGFuYSxhcmlhbCxzYW5zLXNlcmlmO2NvbG9yOiMzMzM7fSNncmFwaC1kaXYgLmNsdXN0ZXItbGFiZWwgdGV4dHtmaWxsOiMzMzM7fSNncmFwaC1kaXYgLmNsdXN0ZXItbGFiZWwgc3BhbiwjZ3JhcGgtZGl2IHB7Y29sb3I6IzMzMzt9I2dyYXBoLWRpdiAubGFiZWwgdGV4dCwjZ3JhcGgtZGl2IHNwYW4sI2dyYXBoLWRpdiBwe2ZpbGw6IzMzMztjb2xvcjojMzMzO30jZ3JhcGgtZGl2IC5ub2RlIHJlY3QsI2dyYXBoLWRpdiAubm9kZSBjaXJjbGUsI2dyYXBoLWRpdiAubm9kZSBlbGxpcHNlLCNncmFwaC1kaXYgLm5vZGUgcG9seWdvbiwjZ3JhcGgtZGl2IC5ub2RlIHBhdGh7ZmlsbDojRUNFQ0ZGO3N0cm9rZTojOTM3MERCO3N0cm9rZS13aWR0aDoxcHg7fSNncmFwaC1kaXYgLmZsb3djaGFydC1sYWJlbCB0ZXh0e3RleHQtYW5jaG9yOm1pZGRsZTt9I2dyYXBoLWRpdiAubm9kZSAubGFiZWx7dGV4dC1hbGlnbjpjZW50ZXI7fSNncmFwaC1kaXYgLm5vZGUuY2xpY2thYmxle2N1cnNvcjpwb2ludGVyO30jZ3JhcGgtZGl2IC5hcnJvd2hlYWRQYXRoe2ZpbGw6IzMzMzMzMzt9I2dyYXBoLWRpdiAuZWRnZVBhdGggLnBhdGh7c3Ryb2tlOiMzMzMzMzM7c3Ryb2tlLXdpZHRoOjIuMHB4O30jZ3JhcGgtZGl2IC5mbG93Y2hhcnQtbGlua3tzdHJva2U6IzMzMzMzMztmaWxsOm5vbmU7fSNncmFwaC1kaXYgLmVkZ2VMYWJlbHtiYWNrZ3JvdW5kLWNvbG9yOiNlOGU4ZTg7dGV4dC1hbGlnbjpjZW50ZXI7fSNncmFwaC1kaXYgLmVkZ2VMYWJlbCByZWN0e29wYWNpdHk6MC41O2JhY2tncm91bmQtY29sb3I6I2U4ZThlODtmaWxsOiNlOGU4ZTg7fSNncmFwaC1kaXYgLmxhYmVsQmtne2JhY2tncm91bmQtY29sb3I6cmdiYSgyMzIsIDIzMiwgMjMyLCAwLjUpO30jZ3JhcGgtZGl2IC5jbHVzdGVyIHJlY3R7ZmlsbDojZmZmZmRlO3N0cm9rZTojYWFhYTMzO3N0cm9rZS13aWR0aDoxcHg7fSNncmFwaC1kaXYgLmNsdXN0ZXIgdGV4dHtmaWxsOiMzMzM7fSNncmFwaC1kaXYgLmNsdXN0ZXIgc3BhbiwjZ3JhcGgtZGl2IHB7Y29sb3I6IzMzMzt9I2dyYXBoLWRpdiBkaXYubWVybWFpZFRvb2x0aXB7cG9zaXRpb246YWJzb2x1dGU7dGV4dC1hbGlnbjpjZW50ZXI7bWF4LXdpZHRoOjIwMHB4O3BhZGRpbmc6MnB4O2ZvbnQtZmFtaWx5OiJ0cmVidWNoZXQgbXMiLHZlcmRhbmEsYXJpYWwsc2Fucy1zZXJpZjtmb250LXNpemU6MTJweDtiYWNrZ3JvdW5kOmhzbCg4MCwgMTAwJSwgOTYuMjc0NTA5ODAzOSUpO2JvcmRlcjoxcHggc29saWQgI2FhYWEzMztib3JkZXItcmFkaXVzOjJweDtwb2ludGVyLWV2ZW50czpub25lO3otaW5kZXg6MTAwO30jZ3JhcGgtZGl2IC5mbG93Y2hhcnRUaXRsZVRleHR7dGV4dC1hbmNob3I6bWlkZGxlO2ZvbnQtc2l6ZToxOHB4O2ZpbGw6IzMzMzt9I2dyYXBoLWRpdiA6cm9vdHstLW1lcm1haWQtZm9udC1mYW1pbHk6InRyZWJ1Y2hldCBtcyIsdmVyZGFuYSxhcmlhbCxzYW5zLXNlcmlmO308L3N0eWxlPjxnPjxtYXJrZXIgb3JpZW50PSJhdXRvIiBtYXJrZXJIZWlnaHQ9IjEyIiBtYXJrZXJXaWR0aD0iMTIiIG1hcmtlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgcmVmWT0iNSIgcmVmWD0iNiIgdmlld0JveD0iMCAwIDEwIDEwIiBjbGFzcz0ibWFya2VyIGZsb3djaGFydCIgaWQ9ImdyYXBoLWRpdl9mbG93Y2hhcnQtcG9pbnRFbmQiPjxwYXRoIHN0eWxlPSJzdHJva2Utd2lkdGg6IDE7IHN0cm9rZS1kYXNoYXJyYXk6IDEsIDA7IiBjbGFzcz0iYXJyb3dNYXJrZXJQYXRoIiBkPSJNIDAgMCBMIDEwIDUgTCAwIDEwIHoiPjwvcGF0aD48L21hcmtlcj48bWFya2VyIG9yaWVudD0iYXV0byIgbWFya2VySGVpZ2h0PSIxMiIgbWFya2VyV2lkdGg9IjEyIiBtYXJrZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIHJlZlk9IjUiIHJlZlg9IjQuNSIgdmlld0JveD0iMCAwIDEwIDEwIiBjbGFzcz0ibWFya2VyIGZsb3djaGFydCIgaWQ9ImdyYXBoLWRpdl9mbG93Y2hhcnQtcG9pbnRTdGFydCI+PHBhdGggc3R5bGU9InN0cm9rZS13aWR0aDogMTsgc3Ryb2tlLWRhc2hhcnJheTogMSwgMDsiIGNsYXNzPSJhcnJvd01hcmtlclBhdGgiIGQ9Ik0gMCA1IEwgMTAgMTAgTCAxMCAwIHoiPjwvcGF0aD48L21hcmtlcj48bWFya2VyIG9yaWVudD0iYXV0byIgbWFya2VySGVpZ2h0PSIxMSIgbWFya2VyV2lkdGg9IjExIiBtYXJrZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIHJlZlk9IjUiIHJlZlg9IjExIiB2aWV3Qm94PSIwIDAgMTAgMTAiIGNsYXNzPSJtYXJrZXIgZmxvd2NoYXJ0IiBpZD0iZ3JhcGgtZGl2X2Zsb3djaGFydC1jaXJjbGVFbmQiPjxjaXJjbGUgc3R5bGU9InN0cm9rZS13aWR0aDogMTsgc3Ryb2tlLWRhc2hhcnJheTogMSwgMDsiIGNsYXNzPSJhcnJvd01hcmtlclBhdGgiIHI9IjUiIGN5PSI1IiBjeD0iNSI+PC9jaXJjbGU+PC9tYXJrZXI+PG1hcmtlciBvcmllbnQ9ImF1dG8iIG1hcmtlckhlaWdodD0iMTEiIG1hcmtlcldpZHRoPSIxMSIgbWFya2VyVW5pdHM9InVzZXJTcGFjZU9uVXNlIiByZWZZPSI1IiByZWZYPSItMSIgdmlld0JveD0iMCAwIDEwIDEwIiBjbGFzcz0ibWFya2VyIGZsb3djaGFydCIgaWQ9ImdyYXBoLWRpdl9mbG93Y2hhcnQtY2lyY2xlU3RhcnQiPjxjaXJjbGUgc3R5bGU9InN0cm9rZS13aWR0aDogMTsgc3Ryb2tlLWRhc2hhcnJheTogMSwgMDsiIGNsYXNzPSJhcnJvd01hcmtlclBhdGgiIHI9IjUiIGN5PSI1IiBjeD0iNSI+PC9jaXJjbGU+PC9tYXJrZXI+PG1hcmtlciBvcmllbnQ9ImF1dG8iIG1hcmtlckhlaWdodD0iMTEiIG1hcmtlcldpZHRoPSIxMSIgbWFya2VyVW5pdHM9InVzZXJTcGFjZU9uVXNlIiByZWZZPSI1LjIiIHJlZlg9IjEyIiB2aWV3Qm94PSIwIDAgMTEgMTEiIGNsYXNzPSJtYXJrZXIgY3Jvc3MgZmxvd2NoYXJ0IiBpZD0iZ3JhcGgtZGl2X2Zsb3djaGFydC1jcm9zc0VuZCI+PHBhdGggc3R5bGU9InN0cm9rZS13aWR0aDogMjsgc3Ryb2tlLWRhc2hhcnJheTogMSwgMDsiIGNsYXNzPSJhcnJvd01hcmtlclBhdGgiIGQ9Ik0gMSwxIGwgOSw5IE0gMTAsMSBsIC05LDkiPjwvcGF0aD48L21hcmtlcj48bWFya2VyIG9yaWVudD0iYXV0byIgbWFya2VySGVpZ2h0PSIxMSIgbWFya2VyV2lkdGg9IjExIiBtYXJrZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIHJlZlk9IjUuMiIgcmVmWD0iLTEiIHZpZXdCb3g9IjAgMCAxMSAxMSIgY2xhc3M9Im1hcmtlciBjcm9zcyBmbG93Y2hhcnQiIGlkPSJncmFwaC1kaXZfZmxvd2NoYXJ0LWNyb3NzU3RhcnQiPjxwYXRoIHN0eWxlPSJzdHJva2Utd2lkdGg6IDI7IHN0cm9rZS1kYXNoYXJyYXk6IDEsIDA7IiBjbGFzcz0iYXJyb3dNYXJrZXJQYXRoIiBkPSJNIDEsMSBsIDksOSBNIDEwLDEgbCAtOSw5Ij48L3BhdGg+PC9tYXJrZXI+PGcgY2xhc3M9InJvb3QiPjxnIGNsYXNzPSJjbHVzdGVycyI+PC9nPjxnIGNsYXNzPSJlZGdlUGF0aHMiPjxwYXRoIHN0eWxlPSJmaWxsOm5vbmU7IiBjbGFzcz0iZWRnZS10aGlja25lc3Mtbm9ybWFsIGVkZ2UtcGF0dGVybi1zb2xpZCBmbG93Y2hhcnQtbGluayBMUy1zeXN0ZW1fb2ZfcXVhbnRpdGllcyBMRS1zeXN0ZW1fb2ZfdW5pdHMxIiBpZD0iTC1zeXN0ZW1fb2ZfcXVhbnRpdGllcy1zeXN0ZW1fb2ZfdW5pdHMxLTAiIGQ9Ik0xODkuODQ4LDM3Ljg4TDE3MC41MTEsNDIuMjMzQzE1MS4xNzQsNDYuNTg2LDExMi41MDEsNTUuMjkzLDkzLjE2NSw2My44MTNDNzMuODI4LDcyLjMzMyw3My44MjgsODAuNjY3LDczLjgyOCw4NC44MzNMNzMuODI4LDg5Ij48L3BhdGg+PHBhdGggc3R5bGU9ImZpbGw6bm9uZTsiIGNsYXNzPSJlZGdlLXRoaWNrbmVzcy1ub3JtYWwgZWRnZS1wYXR0ZXJuLXNvbGlkIGZsb3djaGFydC1saW5rIExTLXN5c3RlbV9vZl9xdWFudGl0aWVzIExFLXN5c3RlbV9vZl91bml0czIiIGlkPSJMLXN5c3RlbV9vZl9xdWFudGl0aWVzLXN5c3RlbV9vZl91bml0czItMCIgZD0iTTI3MS40ODQsMzlMMjcxLjQ4NCw0My4xNjdDMjcxLjQ4NCw0Ny4zMzMsMjcxLjQ4NCw1NS42NjcsMjcxLjQ4NCw2NEMyNzEuNDg0LDcyLjMzMywyNzEuNDg0LDgwLjY2NywyNzEuNDg0LDg0LjgzM0wyNzEuNDg0LDg5Ij48L3BhdGg+PHBhdGggc3R5bGU9ImZpbGw6bm9uZTsiIGNsYXNzPSJlZGdlLXRoaWNrbmVzcy1ub3JtYWwgZWRnZS1wYXR0ZXJuLXNvbGlkIGZsb3djaGFydC1saW5rIExTLXN5c3RlbV9vZl9xdWFudGl0aWVzIExFLXN5c3RlbV9vZl91bml0czMiIGlkPSJMLXN5c3RlbV9vZl9xdWFudGl0aWVzLXN5c3RlbV9vZl91bml0czMtMCIgZD0iTTM1My4xMjEsMzcuODhMMzcyLjQ1OCw0Mi4yMzNDMzkxLjc5NCw0Ni41ODYsNDMwLjQ2Nyw1NS4yOTMsNDQ5LjgwNCw2My44MTNDNDY5LjE0MSw3Mi4zMzMsNDY5LjE0MSw4MC42NjcsNDY5LjE0MSw4NC44MzNMNDY5LjE0MSw4OSI+PC9wYXRoPjwvZz48ZyBjbGFzcz0iZWRnZUxhYmVscyI+PGcgY2xhc3M9ImVkZ2VMYWJlbCI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCwgMCkiIGNsYXNzPSJsYWJlbCI+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSIwIiB3aWR0aD0iMCI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPjxzcGFuIGNsYXNzPSJlZGdlTGFiZWwiPjwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48ZyBjbGFzcz0iZWRnZUxhYmVsIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLCAwKSIgY2xhc3M9ImxhYmVsIj48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjAiIHdpZHRoPSIwIj48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+PHNwYW4gY2xhc3M9ImVkZ2VMYWJlbCI+PC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIGNsYXNzPSJlZGdlTGFiZWwiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAsIDApIiBjbGFzcz0ibGFiZWwiPjxmb3JlaWduT2JqZWN0IGhlaWdodD0iMCIgd2lkdGg9IjAiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0iZWRnZUxhYmVsIj48L3NwYW4+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+PC9nPjxnIGNsYXNzPSJub2RlcyI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjcxLjQ4NDM3NSwgMTkuNSkiIGlkPSJmbG93Y2hhcnQtc3lzdGVtX29mX3F1YW50aXRpZXMtNDYxIiBjbGFzcz0ibm9kZSBkZWZhdWx0IGRlZmF1bHQgZmxvd2NoYXJ0LWxhYmVsIj48cmVjdCBoZWlnaHQ9IjM5IiB3aWR0aD0iMTYzLjI3MzQzNzUiIHk9Ii0xOS41IiB4PSItODEuNjM2NzE4NzUiIHJ5PSIwIiByeD0iMCIgc3R5bGU9IiIgY2xhc3M9ImJhc2ljIGxhYmVsLWNvbnRhaW5lciI+PC9yZWN0PjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC03NC4xMzY3MTg3NSwgLTEyKSIgc3R5bGU9IiIgY2xhc3M9ImxhYmVsIj48cmVjdD48L3JlY3Q+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSIyNCIgd2lkdGg9IjE0OC4yNzM0Mzc1Ij48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+PHNwYW4gY2xhc3M9Im5vZGVMYWJlbCI+U3lzdGVtIG9mIFF1YW50aXRpZXM8L3NwYW4+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNzMuODI4MTI1LCAxMDguNSkiIGlkPSJmbG93Y2hhcnQtc3lzdGVtX29mX3VuaXRzMS00NjIiIGNsYXNzPSJub2RlIGRlZmF1bHQgZGVmYXVsdCBmbG93Y2hhcnQtbGFiZWwiPjxyZWN0IGhlaWdodD0iMzkiIHdpZHRoPSIxNDcuNjU2MjUiIHk9Ii0xOS41IiB4PSItNzMuODI4MTI1IiByeT0iMCIgcng9IjAiIHN0eWxlPSIiIGNsYXNzPSJiYXNpYyBsYWJlbC1jb250YWluZXIiPjwvcmVjdD48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNjYuMzI4MTI1LCAtMTIpIiBzdHlsZT0iIiBjbGFzcz0ibGFiZWwiPjxyZWN0PjwvcmVjdD48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjI0IiB3aWR0aD0iMTMyLjY1NjI1Ij48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+PHNwYW4gY2xhc3M9Im5vZGVMYWJlbCI+U3lzdGVtIG9mIFVuaXRzICMxPC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI3MS40ODQzNzUsIDEwOC41KSIgaWQ9ImZsb3djaGFydC1zeXN0ZW1fb2ZfdW5pdHMyLTQ2NCIgY2xhc3M9Im5vZGUgZGVmYXVsdCBkZWZhdWx0IGZsb3djaGFydC1sYWJlbCI+PHJlY3QgaGVpZ2h0PSIzOSIgd2lkdGg9IjE0Ny42NTYyNSIgeT0iLTE5LjUiIHg9Ii03My44MjgxMjUiIHJ5PSIwIiByeD0iMCIgc3R5bGU9IiIgY2xhc3M9ImJhc2ljIGxhYmVsLWNvbnRhaW5lciI+PC9yZWN0PjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC02Ni4zMjgxMjUsIC0xMikiIHN0eWxlPSIiIGNsYXNzPSJsYWJlbCI+PHJlY3Q+PC9yZWN0Pjxmb3JlaWduT2JqZWN0IGhlaWdodD0iMjQiIHdpZHRoPSIxMzIuNjU2MjUiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0ibm9kZUxhYmVsIj5TeXN0ZW0gb2YgVW5pdHMgIzI8L3NwYW4+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNDY5LjE0MDYyNSwgMTA4LjUpIiBpZD0iZmxvd2NoYXJ0LXN5c3RlbV9vZl91bml0czMtNDY2IiBjbGFzcz0ibm9kZSBkZWZhdWx0IGRlZmF1bHQgZmxvd2NoYXJ0LWxhYmVsIj48cmVjdCBoZWlnaHQ9IjM5IiB3aWR0aD0iMTQ3LjY1NjI1IiB5PSItMTkuNSIgeD0iLTczLjgyODEyNSIgcnk9IjAiIHJ4PSIwIiBzdHlsZT0iIiBjbGFzcz0iYmFzaWMgbGFiZWwtY29udGFpbmVyIj48L3JlY3Q+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTY2LjMyODEyNSwgLTEyKSIgc3R5bGU9IiIgY2xhc3M9ImxhYmVsIj48cmVjdD48L3JlY3Q+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSIyNCIgd2lkdGg9IjEzMi42NTYyNSI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPjxzcGFuIGNsYXNzPSJub2RlTGFiZWwiPlN5c3RlbSBvZiBVbml0cyAjMzwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48L2c+PC9nPjwvZz48L3N2Zz4=" style="display: block; margin-left: auto; margin-right: auto; width: 70%;" /></p>
<p>A <a href="https://jcgm.bipm.org/vim/en/1.3.html">system of
quantities</a> is a set of quantities together with a set of
noncontradictory equations relating those quantities.</p>
<p>The <a href="https://jcgm.bipm.org/vim/en/1.6.html">International
System of Quantities (ISQ)</a> is a system of quantities based on the
seven base quantities: <em>length</em>, <em>mass</em>, <em>time</em>,
<em>electric current</em>, <em>thermodynamic temperature</em>,
<em>amount of substance</em>, and <em>luminous intensity</em>. This
system of quantities is published in <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span>, “Quantities and
units”.</p>
<p>A <a href="https://jcgm.bipm.org/vim/en/1.13.html">system of
units</a> is a set of base units and derived units, together with their
multiples and submultiples, defined in accordance with given rules, for
a given system of quantities.</p>
<p>The <a href="https://jcgm.bipm.org/vim/en/1.16.html">International
System of Units (SI)</a> is a system of units, based on the
International System of Quantities, their names and symbols, including a
series of prefixes and their names and symbols, together with rules for
their use, adopted by the General Conference on Weights and Measures
(CGPM).</p>
<h2 data-number="13.1" id="systems-of-quantities"><span class="header-section-number">13.1</span> Systems of quantities<a href="#systems-of-quantities" class="self-link"></a></h2>
<p>The physical units libraries on the market typically only focus on
modeling one or more systems of units. However, this is not the only
system kind to model. Another, and maybe even more important, is a
system of quantities. The most important example here is the
International System of Quantities (ISQ) defined by <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span>.</p>
<h3 data-number="13.1.1" id="quantities-of-the-same-kind"><span class="header-section-number">13.1.1</span> Quantities of the same
kind<a href="#quantities-of-the-same-kind" class="self-link"></a></h3>
<p>As it was described in <a href="#limitations-of-dimensions">Limitations of dimensions</a>,
dimension is not enough to describe a quantity. We need a better
abstraction to provide safety to our calculations.</p>
<p>The <span class="citation" data-cites="ISO-GUIDE">[<a href="#ref-ISO-GUIDE" role="doc-biblioref">ISO/IEC Guide 99</a>]</span>
says:</p>
<ul>
<li>Quantities may be grouped together into categories of quantities
that are <strong>mutually comparable</strong></li>
<li>Mutually comparable quantities are called <strong>quantities of the
same kind</strong></li>
<li>Two or more quantities <strong>cannot be added or subtracted unless
they belong to the same category of mutually comparable
quantities</strong></li>
<li>Quantities of the <strong>same kind</strong> within a given system
of quantities <strong>have the same quantity dimension</strong></li>
<li>Quantities of the <strong>same dimension are not necessarily of the
same kind</strong></li>
</ul>
<p><span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span> also explicitly
notes:</p>
<blockquote>
<p><strong>Measurement units of quantities of the same quantity
dimension may be designated by the same name and symbol even when the
quantities are not of the same kind</strong>. For example, joule per
kelvin and J/K are respectively the name and symbol of both a
measurement unit of heat capacity and a measurement unit of entropy,
which are generally not considered to be quantities of the same kind.
<strong>However, in some cases special measurement unit names are
restricted to be used with quantities of specific kind only</strong>.
For example, the measurement unit ‘second to the power minus one’ (1/s)
is called hertz (Hz) when used for frequencies and becquerel (Bq) when
used for activities of radionuclides. As another example, the joule (J)
is used as a unit of energy, but never as a unit of moment of force,
i.e. the newton metre (N · m).</p>
</blockquote>
<p>Those provide answers to all the issues mentioned above. More than
one quantity may be defined for the same dimension:</p>
<ul>
<li>quantities of different kinds (e.g., <em>frequency</em>,
<em>modulation rate</em>, <em>activity</em>)</li>
<li>quantities of the same kind (e.g., <em>length</em>, <em>width</em>,
<em>altitude</em>, <em>distance</em>, <em>radius</em>,
<em>wavelength</em>, <em>position vector</em>)</li>
</ul>
<p>Two quantities can’t be added, subtracted, or compared unless they
belong to the same quantity kind.</p>
<h3 data-number="13.1.2" id="system-of-quantities-is-not-only-about-kinds"><span class="header-section-number">13.1.2</span> System of quantities is not
only about kinds<a href="#system-of-quantities-is-not-only-about-kinds" class="self-link"></a></h3>
<p><span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span> specifies hundreds of
different quantities. Plenty of various kinds are provided, and often,
each kind contains more than one quantity. It turns out that such
quantities form a hierarchy of quantities of the same kind.</p>
<p>For example, here are all quantities of the kind <em>length</em>
provided in <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span>
(part 1):</p>
<p><img src="data:image/svg+xml;base64,PHN2ZyBhcmlhLXJvbGVkZXNjcmlwdGlvbj0iZmxvd2NoYXJ0LXYyIiByb2xlPSJncmFwaGljcy1kb2N1bWVudCBkb2N1bWVudCIgdmlld0JveD0iLTggLTggMTA3Mi43NTc4MTI1IDM0NiIgc3R5bGU9Im1heC13aWR0aDogMTAwJTsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGlkPSJncmFwaC1kaXYiIGhlaWdodD0iMTAwJSIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxzdHlsZT5AaW1wb3J0IHVybCgiaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvZm9udC1hd2Vzb21lLzYuNC4yL2Nzcy9hbGwubWluLmNzcyIpOyc8L3N0eWxlPjxzdHlsZT4jZ3JhcGgtZGl2e2ZvbnQtZmFtaWx5OiJ0cmVidWNoZXQgbXMiLHZlcmRhbmEsYXJpYWwsc2Fucy1zZXJpZjtmb250LXNpemU6MTZweDtmaWxsOiMzMzM7fSNncmFwaC1kaXYgLmVycm9yLWljb257ZmlsbDojNTUyMjIyO30jZ3JhcGgtZGl2IC5lcnJvci10ZXh0e2ZpbGw6IzU1MjIyMjtzdHJva2U6IzU1MjIyMjt9I2dyYXBoLWRpdiAuZWRnZS10aGlja25lc3Mtbm9ybWFse3N0cm9rZS13aWR0aDoycHg7fSNncmFwaC1kaXYgLmVkZ2UtdGhpY2tuZXNzLXRoaWNre3N0cm9rZS13aWR0aDozLjVweDt9I2dyYXBoLWRpdiAuZWRnZS1wYXR0ZXJuLXNvbGlke3N0cm9rZS1kYXNoYXJyYXk6MDt9I2dyYXBoLWRpdiAuZWRnZS1wYXR0ZXJuLWRhc2hlZHtzdHJva2UtZGFzaGFycmF5OjM7fSNncmFwaC1kaXYgLmVkZ2UtcGF0dGVybi1kb3R0ZWR7c3Ryb2tlLWRhc2hhcnJheToyO30jZ3JhcGgtZGl2IC5tYXJrZXJ7ZmlsbDojMzMzMzMzO3N0cm9rZTojMzMzMzMzO30jZ3JhcGgtZGl2IC5tYXJrZXIuY3Jvc3N7c3Ryb2tlOiMzMzMzMzM7fSNncmFwaC1kaXYgc3Zne2ZvbnQtZmFtaWx5OiJ0cmVidWNoZXQgbXMiLHZlcmRhbmEsYXJpYWwsc2Fucy1zZXJpZjtmb250LXNpemU6MTZweDt9I2dyYXBoLWRpdiAubGFiZWx7Zm9udC1mYW1pbHk6InRyZWJ1Y2hldCBtcyIsdmVyZGFuYSxhcmlhbCxzYW5zLXNlcmlmO2NvbG9yOiMzMzM7fSNncmFwaC1kaXYgLmNsdXN0ZXItbGFiZWwgdGV4dHtmaWxsOiMzMzM7fSNncmFwaC1kaXYgLmNsdXN0ZXItbGFiZWwgc3BhbiwjZ3JhcGgtZGl2IHB7Y29sb3I6IzMzMzt9I2dyYXBoLWRpdiAubGFiZWwgdGV4dCwjZ3JhcGgtZGl2IHNwYW4sI2dyYXBoLWRpdiBwe2ZpbGw6IzMzMztjb2xvcjojMzMzO30jZ3JhcGgtZGl2IC5ub2RlIHJlY3QsI2dyYXBoLWRpdiAubm9kZSBjaXJjbGUsI2dyYXBoLWRpdiAubm9kZSBlbGxpcHNlLCNncmFwaC1kaXYgLm5vZGUgcG9seWdvbiwjZ3JhcGgtZGl2IC5ub2RlIHBhdGh7ZmlsbDojRUNFQ0ZGO3N0cm9rZTojOTM3MERCO3N0cm9rZS13aWR0aDoxcHg7fSNncmFwaC1kaXYgLmZsb3djaGFydC1sYWJlbCB0ZXh0e3RleHQtYW5jaG9yOm1pZGRsZTt9I2dyYXBoLWRpdiAubm9kZSAubGFiZWx7dGV4dC1hbGlnbjpjZW50ZXI7fSNncmFwaC1kaXYgLm5vZGUuY2xpY2thYmxle2N1cnNvcjpwb2ludGVyO30jZ3JhcGgtZGl2IC5hcnJvd2hlYWRQYXRoe2ZpbGw6IzMzMzMzMzt9I2dyYXBoLWRpdiAuZWRnZVBhdGggLnBhdGh7c3Ryb2tlOiMzMzMzMzM7c3Ryb2tlLXdpZHRoOjIuMHB4O30jZ3JhcGgtZGl2IC5mbG93Y2hhcnQtbGlua3tzdHJva2U6IzMzMzMzMztmaWxsOm5vbmU7fSNncmFwaC1kaXYgLmVkZ2VMYWJlbHtiYWNrZ3JvdW5kLWNvbG9yOiNlOGU4ZTg7dGV4dC1hbGlnbjpjZW50ZXI7fSNncmFwaC1kaXYgLmVkZ2VMYWJlbCByZWN0e29wYWNpdHk6MC41O2JhY2tncm91bmQtY29sb3I6I2U4ZThlODtmaWxsOiNlOGU4ZTg7fSNncmFwaC1kaXYgLmxhYmVsQmtne2JhY2tncm91bmQtY29sb3I6cmdiYSgyMzIsIDIzMiwgMjMyLCAwLjUpO30jZ3JhcGgtZGl2IC5jbHVzdGVyIHJlY3R7ZmlsbDojZmZmZmRlO3N0cm9rZTojYWFhYTMzO3N0cm9rZS13aWR0aDoxcHg7fSNncmFwaC1kaXYgLmNsdXN0ZXIgdGV4dHtmaWxsOiMzMzM7fSNncmFwaC1kaXYgLmNsdXN0ZXIgc3BhbiwjZ3JhcGgtZGl2IHB7Y29sb3I6IzMzMzt9I2dyYXBoLWRpdiBkaXYubWVybWFpZFRvb2x0aXB7cG9zaXRpb246YWJzb2x1dGU7dGV4dC1hbGlnbjpjZW50ZXI7bWF4LXdpZHRoOjIwMHB4O3BhZGRpbmc6MnB4O2ZvbnQtZmFtaWx5OiJ0cmVidWNoZXQgbXMiLHZlcmRhbmEsYXJpYWwsc2Fucy1zZXJpZjtmb250LXNpemU6MTJweDtiYWNrZ3JvdW5kOmhzbCg4MCwgMTAwJSwgOTYuMjc0NTA5ODAzOSUpO2JvcmRlcjoxcHggc29saWQgI2FhYWEzMztib3JkZXItcmFkaXVzOjJweDtwb2ludGVyLWV2ZW50czpub25lO3otaW5kZXg6MTAwO30jZ3JhcGgtZGl2IC5mbG93Y2hhcnRUaXRsZVRleHR7dGV4dC1hbmNob3I6bWlkZGxlO2ZvbnQtc2l6ZToxOHB4O2ZpbGw6IzMzMzt9I2dyYXBoLWRpdiA6cm9vdHstLW1lcm1haWQtZm9udC1mYW1pbHk6InRyZWJ1Y2hldCBtcyIsdmVyZGFuYSxhcmlhbCxzYW5zLXNlcmlmO308L3N0eWxlPjxnPjxtYXJrZXIgb3JpZW50PSJhdXRvIiBtYXJrZXJIZWlnaHQ9IjEyIiBtYXJrZXJXaWR0aD0iMTIiIG1hcmtlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgcmVmWT0iNSIgcmVmWD0iNiIgdmlld0JveD0iMCAwIDEwIDEwIiBjbGFzcz0ibWFya2VyIGZsb3djaGFydCIgaWQ9ImdyYXBoLWRpdl9mbG93Y2hhcnQtcG9pbnRFbmQiPjxwYXRoIHN0eWxlPSJzdHJva2Utd2lkdGg6IDE7IHN0cm9rZS1kYXNoYXJyYXk6IDEsIDA7IiBjbGFzcz0iYXJyb3dNYXJrZXJQYXRoIiBkPSJNIDAgMCBMIDEwIDUgTCAwIDEwIHoiPjwvcGF0aD48L21hcmtlcj48bWFya2VyIG9yaWVudD0iYXV0byIgbWFya2VySGVpZ2h0PSIxMiIgbWFya2VyV2lkdGg9IjEyIiBtYXJrZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIHJlZlk9IjUiIHJlZlg9IjQuNSIgdmlld0JveD0iMCAwIDEwIDEwIiBjbGFzcz0ibWFya2VyIGZsb3djaGFydCIgaWQ9ImdyYXBoLWRpdl9mbG93Y2hhcnQtcG9pbnRTdGFydCI+PHBhdGggc3R5bGU9InN0cm9rZS13aWR0aDogMTsgc3Ryb2tlLWRhc2hhcnJheTogMSwgMDsiIGNsYXNzPSJhcnJvd01hcmtlclBhdGgiIGQ9Ik0gMCA1IEwgMTAgMTAgTCAxMCAwIHoiPjwvcGF0aD48L21hcmtlcj48bWFya2VyIG9yaWVudD0iYXV0byIgbWFya2VySGVpZ2h0PSIxMSIgbWFya2VyV2lkdGg9IjExIiBtYXJrZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIHJlZlk9IjUiIHJlZlg9IjExIiB2aWV3Qm94PSIwIDAgMTAgMTAiIGNsYXNzPSJtYXJrZXIgZmxvd2NoYXJ0IiBpZD0iZ3JhcGgtZGl2X2Zsb3djaGFydC1jaXJjbGVFbmQiPjxjaXJjbGUgc3R5bGU9InN0cm9rZS13aWR0aDogMTsgc3Ryb2tlLWRhc2hhcnJheTogMSwgMDsiIGNsYXNzPSJhcnJvd01hcmtlclBhdGgiIHI9IjUiIGN5PSI1IiBjeD0iNSI+PC9jaXJjbGU+PC9tYXJrZXI+PG1hcmtlciBvcmllbnQ9ImF1dG8iIG1hcmtlckhlaWdodD0iMTEiIG1hcmtlcldpZHRoPSIxMSIgbWFya2VyVW5pdHM9InVzZXJTcGFjZU9uVXNlIiByZWZZPSI1IiByZWZYPSItMSIgdmlld0JveD0iMCAwIDEwIDEwIiBjbGFzcz0ibWFya2VyIGZsb3djaGFydCIgaWQ9ImdyYXBoLWRpdl9mbG93Y2hhcnQtY2lyY2xlU3RhcnQiPjxjaXJjbGUgc3R5bGU9InN0cm9rZS13aWR0aDogMTsgc3Ryb2tlLWRhc2hhcnJheTogMSwgMDsiIGNsYXNzPSJhcnJvd01hcmtlclBhdGgiIHI9IjUiIGN5PSI1IiBjeD0iNSI+PC9jaXJjbGU+PC9tYXJrZXI+PG1hcmtlciBvcmllbnQ9ImF1dG8iIG1hcmtlckhlaWdodD0iMTEiIG1hcmtlcldpZHRoPSIxMSIgbWFya2VyVW5pdHM9InVzZXJTcGFjZU9uVXNlIiByZWZZPSI1LjIiIHJlZlg9IjEyIiB2aWV3Qm94PSIwIDAgMTEgMTEiIGNsYXNzPSJtYXJrZXIgY3Jvc3MgZmxvd2NoYXJ0IiBpZD0iZ3JhcGgtZGl2X2Zsb3djaGFydC1jcm9zc0VuZCI+PHBhdGggc3R5bGU9InN0cm9rZS13aWR0aDogMjsgc3Ryb2tlLWRhc2hhcnJheTogMSwgMDsiIGNsYXNzPSJhcnJvd01hcmtlclBhdGgiIGQ9Ik0gMSwxIGwgOSw5IE0gMTAsMSBsIC05LDkiPjwvcGF0aD48L21hcmtlcj48bWFya2VyIG9yaWVudD0iYXV0byIgbWFya2VySGVpZ2h0PSIxMSIgbWFya2VyV2lkdGg9IjExIiBtYXJrZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIHJlZlk9IjUuMiIgcmVmWD0iLTEiIHZpZXdCb3g9IjAgMCAxMSAxMSIgY2xhc3M9Im1hcmtlciBjcm9zcyBmbG93Y2hhcnQiIGlkPSJncmFwaC1kaXZfZmxvd2NoYXJ0LWNyb3NzU3RhcnQiPjxwYXRoIHN0eWxlPSJzdHJva2Utd2lkdGg6IDI7IHN0cm9rZS1kYXNoYXJyYXk6IDEsIDA7IiBjbGFzcz0iYXJyb3dNYXJrZXJQYXRoIiBkPSJNIDEsMSBsIDksOSBNIDEwLDEgbCAtOSw5Ij48L3BhdGg+PC9tYXJrZXI+PGcgY2xhc3M9InJvb3QiPjxnIGNsYXNzPSJjbHVzdGVycyI+PC9nPjxnIGNsYXNzPSJlZGdlUGF0aHMiPjxwYXRoIHN0eWxlPSJmaWxsOm5vbmU7IiBjbGFzcz0iZWRnZS10aGlja25lc3Mtbm9ybWFsIGVkZ2UtcGF0dGVybi1zb2xpZCBmbG93Y2hhcnQtbGluayBMUy1sZW5ndGggTEUtd2lkdGgiIGlkPSJMLWxlbmd0aC13aWR0aC0wIiBkPSJNNjA3LjI3MywyMi4xNDhMNTI3Ljg2LDI5LjEyNEM0NDguNDQ3LDM2LjA5OSwyODkuNjIsNTAuMDQ5LDIxMC4yMDYsNjMuMTkxQzEzMC43OTMsNzYuMzMzLDEzMC43OTMsODguNjY3LDEzMC43OTMsOTQuODMzTDEzMC43OTMsMTAxIj48L3BhdGg+PHBhdGggc3R5bGU9ImZpbGw6bm9uZTsiIGNsYXNzPSJlZGdlLXRoaWNrbmVzcy1ub3JtYWwgZWRnZS1wYXR0ZXJuLXNvbGlkIGZsb3djaGFydC1saW5rIExTLWxlbmd0aCBMRS1oZWlnaHQiIGlkPSJMLWxlbmd0aC1oZWlnaHQtMCIgZD0iTTYwNy4yNzMsMjMuODkzTDU2MS4zOTEsMzAuNTc3QzUxNS41MDgsMzcuMjYyLDQyMy43NDIsNTAuNjMxLDM3Ny44NTksNjMuNDgyQzMzMS45NzcsNzYuMzMzLDMzMS45NzcsODguNjY3LDMzMS45NzcsOTQuODMzTDMzMS45NzcsMTAxIj48L3BhdGg+PHBhdGggc3R5bGU9ImZpbGw6bm9uZTsiIGNsYXNzPSJlZGdlLXRoaWNrbmVzcy1ub3JtYWwgZWRnZS1wYXR0ZXJuLXNvbGlkIGZsb3djaGFydC1saW5rIExTLXdpZHRoIExFLXRoaWNrbmVzcyIgaWQ9Ikwtd2lkdGgtdGhpY2tuZXNzLTAiIGQ9Ik05OS42NDEsMTQwTDg5Ljc4OSwxNDYuMTY3Qzc5LjkzOCwxNTIuMzMzLDYwLjIzNCwxNjQuNjY3LDUwLjM4MywxNzVDNDAuNTMxLDE4NS4zMzMsNDAuNTMxLDE5My42NjcsNDAuNTMxLDE5Ny44MzNMNDAuNTMxLDIwMiI+PC9wYXRoPjxwYXRoIHN0eWxlPSJmaWxsOm5vbmU7IiBjbGFzcz0iZWRnZS10aGlja25lc3Mtbm9ybWFsIGVkZ2UtcGF0dGVybi1zb2xpZCBmbG93Y2hhcnQtbGluayBMUy13aWR0aCBMRS1kaWFtZXRlciIgaWQ9Ikwtd2lkdGgtZGlhbWV0ZXItMCIgZD0iTTE0NC43MjIsMTQwTDE0OS4xMjcsMTQ2LjE2N0MxNTMuNTMyLDE1Mi4zMzMsMTYyLjM0MiwxNjQuNjY3LDE2Ni43NDcsMTc1QzE3MS4xNTIsMTg1LjMzMywxNzEuMTUyLDE5My42NjcsMTcxLjE1MiwxOTcuODMzTDE3MS4xNTIsMjAyIj48L3BhdGg+PHBhdGggc3R5bGU9ImZpbGw6bm9uZTsiIGNsYXNzPSJlZGdlLXRoaWNrbmVzcy1ub3JtYWwgZWRnZS1wYXR0ZXJuLXNvbGlkIGZsb3djaGFydC1saW5rIExTLXdpZHRoIExFLXJhZGl1cyIgaWQ9Ikwtd2lkdGgtcmFkaXVzLTAiIGQ9Ik0xODUuODc5LDE0MEwyMDMuMywxNDYuMTY3QzIyMC43MiwxNTIuMzMzLDI1NS41NjEsMTY0LjY2NywyNzIuOTgyLDE3NUMyOTAuNDAyLDE4NS4zMzMsMjkwLjQwMiwxOTMuNjY3LDI5MC40MDIsMTk3LjgzM0wyOTAuNDAyLDIwMiI+PC9wYXRoPjxwYXRoIHN0eWxlPSJmaWxsOm5vbmU7IiBjbGFzcz0iZWRnZS10aGlja25lc3Mtbm9ybWFsIGVkZ2UtcGF0dGVybi1zb2xpZCBmbG93Y2hhcnQtbGluayBMUy1sZW5ndGggTEUtcGF0aF9sZW5ndGgiIGlkPSJMLWxlbmd0aC1wYXRoX2xlbmd0aC0wIiBkPSJNNjA3LjI3MywzMS4xNzVMNTkzLjE0NCwzNi42NDZDNTc5LjAxNCw0Mi4xMTcsNTUwLjc1NSw1My4wNTgsNTM2LjYyNiw2NC42OTZDNTIyLjQ5Niw3Ni4zMzMsNTIyLjQ5Niw4OC42NjcsNTIyLjQ5Niw5NC44MzNMNTIyLjQ5NiwxMDEiPjwvcGF0aD48cGF0aCBzdHlsZT0iZmlsbDpub25lOyIgY2xhc3M9ImVkZ2UtdGhpY2tuZXNzLW5vcm1hbCBlZGdlLXBhdHRlcm4tc29saWQgZmxvd2NoYXJ0LWxpbmsgTFMtcGF0aF9sZW5ndGggTEUtZGlzdGFuY2UiIGlkPSJMLXBhdGhfbGVuZ3RoLWRpc3RhbmNlLTAiIGQ9Ik01MjIuNDk2LDE0MEw1MjIuNDk2LDE0Ni4xNjdDNTIyLjQ5NiwxNTIuMzMzLDUyMi40OTYsMTY0LjY2Nyw1MjIuNDk2LDE3NUM1MjIuNDk2LDE4NS4zMzMsNTIyLjQ5NiwxOTMuNjY3LDUyMi40OTYsMTk3LjgzM0w1MjIuNDk2LDIwMiI+PC9wYXRoPjxwYXRoIHN0eWxlPSJmaWxsOm5vbmU7IiBjbGFzcz0iZWRnZS10aGlja25lc3Mtbm9ybWFsIGVkZ2UtcGF0dGVybi1zb2xpZCBmbG93Y2hhcnQtbGluayBMUy1kaXN0YW5jZSBMRS1yYWRpYWxfZGlzdGFuY2UiIGlkPSJMLWRpc3RhbmNlLXJhZGlhbF9kaXN0YW5jZS0wIiBkPSJNNTIyLjQ5NiwyNDFMNTIyLjQ5NiwyNDUuMTY3QzUyMi40OTYsMjQ5LjMzMyw1MjIuNDk2LDI1Ny42NjcsNTIyLjQ5NiwyNjZDNTIyLjQ5NiwyNzQuMzMzLDUyMi40OTYsMjgyLjY2Nyw1MjIuNDk2LDI4Ni44MzNMNTIyLjQ5NiwyOTEiPjwvcGF0aD48cGF0aCBzdHlsZT0iZmlsbDpub25lOyIgY2xhc3M9ImVkZ2UtdGhpY2tuZXNzLW5vcm1hbCBlZGdlLXBhdHRlcm4tc29saWQgZmxvd2NoYXJ0LWxpbmsgTFMtbGVuZ3RoIExFLXdhdmVsZW5ndGgiIGlkPSJMLWxlbmd0aC13YXZlbGVuZ3RoLTAiIGQ9Ik02NTIuNDE3LDM5TDY1NS42Miw0My4xNjdDNjU4LjgyNCw0Ny4zMzMsNjY1LjIzLDU1LjY2Nyw2NjguNDMzLDY2QzY3MS42MzcsNzYuMzMzLDY3MS42MzcsODguNjY3LDY3MS42MzcsOTQuODMzTDY3MS42MzcsMTAxIj48L3BhdGg+PHBhdGggc3R5bGU9ImZpbGw6bm9uZTsiIGNsYXNzPSJlZGdlLXRoaWNrbmVzcy1ub3JtYWwgZWRnZS1wYXR0ZXJuLXNvbGlkIGZsb3djaGFydC1saW5rIExTLWxlbmd0aCBMRS1wb3NpdGlvbl92ZWN0b3IiIGlkPSJMLWxlbmd0aC1wb3NpdGlvbl92ZWN0b3ItMCIgZD0iTTY2Ny41NzgsMjYuMzU2TDY5NS4xNjksMzIuNjNDNzIyLjc2LDM4LjkwNCw3NzcuOTQzLDUxLjQ1Miw4MDUuNTM0LDYxLjg5M0M4MzMuMTI1LDcyLjMzMyw4MzMuMTI1LDgwLjY2Nyw4MzMuMTI1LDg0LjgzM0w4MzMuMTI1LDg5Ij48L3BhdGg+PHBhdGggc3R5bGU9ImZpbGw6bm9uZTsiIGNsYXNzPSJlZGdlLXRoaWNrbmVzcy1ub3JtYWwgZWRnZS1wYXR0ZXJuLXNvbGlkIGZsb3djaGFydC1saW5rIExTLWxlbmd0aCBMRS1kaXNwbGFjZW1lbnQiIGlkPSJMLWxlbmd0aC1kaXNwbGFjZW1lbnQtMCIgZD0iTTY2Ny41NzgsMjMuMTg3TDcyMy4yMTQsMjkuOTg5Qzc3OC44NDksMzYuNzkxLDg5MC4xMiw1MC4zOTYsOTQ1Ljc1NSw2MS4zNjRDMTAwMS4zOTEsNzIuMzMzLDEwMDEuMzkxLDgwLjY2NywxMDAxLjM5MSw4NC44MzNMMTAwMS4zOTEsODkiPjwvcGF0aD48cGF0aCBzdHlsZT0iZmlsbDpub25lOyIgY2xhc3M9ImVkZ2UtdGhpY2tuZXNzLW5vcm1hbCBlZGdlLXBhdHRlcm4tc29saWQgZmxvd2NoYXJ0LWxpbmsgTFMtcmFkaXVzIExFLXJhZGl1c19vZl9jdXJ2YXR1cmUiIGlkPSJMLXJhZGl1cy1yYWRpdXNfb2ZfY3VydmF0dXJlLTAiIGQ9Ik0yOTAuNDAyLDI0MUwyOTAuNDAyLDI0NS4xNjdDMjkwLjQwMiwyNDkuMzMzLDI5MC40MDIsMjU3LjY2NywyOTAuNDAyLDI2NkMyOTAuNDAyLDI3NC4zMzMsMjkwLjQwMiwyODIuNjY3LDI5MC40MDIsMjg2LjgzM0wyOTAuNDAyLDI5MSI+PC9wYXRoPjwvZz48ZyBjbGFzcz0iZWRnZUxhYmVscyI+PGcgY2xhc3M9ImVkZ2VMYWJlbCI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCwgMCkiIGNsYXNzPSJsYWJlbCI+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSIwIiB3aWR0aD0iMCI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPjxzcGFuIGNsYXNzPSJlZGdlTGFiZWwiPjwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48ZyBjbGFzcz0iZWRnZUxhYmVsIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLCAwKSIgY2xhc3M9ImxhYmVsIj48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjAiIHdpZHRoPSIwIj48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+PHNwYW4gY2xhc3M9ImVkZ2VMYWJlbCI+PC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIGNsYXNzPSJlZGdlTGFiZWwiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAsIDApIiBjbGFzcz0ibGFiZWwiPjxmb3JlaWduT2JqZWN0IGhlaWdodD0iMCIgd2lkdGg9IjAiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0iZWRnZUxhYmVsIj48L3NwYW4+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+PGcgY2xhc3M9ImVkZ2VMYWJlbCI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCwgMCkiIGNsYXNzPSJsYWJlbCI+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSIwIiB3aWR0aD0iMCI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPjxzcGFuIGNsYXNzPSJlZGdlTGFiZWwiPjwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48ZyBjbGFzcz0iZWRnZUxhYmVsIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLCAwKSIgY2xhc3M9ImxhYmVsIj48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjAiIHdpZHRoPSIwIj48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+PHNwYW4gY2xhc3M9ImVkZ2VMYWJlbCI+PC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIGNsYXNzPSJlZGdlTGFiZWwiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAsIDApIiBjbGFzcz0ibGFiZWwiPjxmb3JlaWduT2JqZWN0IGhlaWdodD0iMCIgd2lkdGg9IjAiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0iZWRnZUxhYmVsIj48L3NwYW4+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+PGcgY2xhc3M9ImVkZ2VMYWJlbCI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCwgMCkiIGNsYXNzPSJsYWJlbCI+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSIwIiB3aWR0aD0iMCI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPjxzcGFuIGNsYXNzPSJlZGdlTGFiZWwiPjwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48ZyBjbGFzcz0iZWRnZUxhYmVsIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLCAwKSIgY2xhc3M9ImxhYmVsIj48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjAiIHdpZHRoPSIwIj48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+PHNwYW4gY2xhc3M9ImVkZ2VMYWJlbCI+PC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIGNsYXNzPSJlZGdlTGFiZWwiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAsIDApIiBjbGFzcz0ibGFiZWwiPjxmb3JlaWduT2JqZWN0IGhlaWdodD0iMCIgd2lkdGg9IjAiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0iZWRnZUxhYmVsIj48L3NwYW4+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+PGcgY2xhc3M9ImVkZ2VMYWJlbCI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCwgMCkiIGNsYXNzPSJsYWJlbCI+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSIwIiB3aWR0aD0iMCI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPjxzcGFuIGNsYXNzPSJlZGdlTGFiZWwiPjwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48ZyBjbGFzcz0iZWRnZUxhYmVsIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLCAwKSIgY2xhc3M9ImxhYmVsIj48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjAiIHdpZHRoPSIwIj48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+PHNwYW4gY2xhc3M9ImVkZ2VMYWJlbCI+PC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIGNsYXNzPSJlZGdlTGFiZWwiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAsIDApIiBjbGFzcz0ibGFiZWwiPjxmb3JlaWduT2JqZWN0IGhlaWdodD0iMCIgd2lkdGg9IjAiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0iZWRnZUxhYmVsIj48L3NwYW4+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+PC9nPjxnIGNsYXNzPSJub2RlcyI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNjM3LjQyNTc4MTI1LCAxOS41KSIgaWQ9ImZsb3djaGFydC1sZW5ndGgtMTg4IiBjbGFzcz0ibm9kZSBkZWZhdWx0IGRlZmF1bHQgZmxvd2NoYXJ0LWxhYmVsIj48cmVjdCBoZWlnaHQ9IjM5IiB3aWR0aD0iNjAuMzA0Njg3NSIgeT0iLTE5LjUiIHg9Ii0zMC4xNTIzNDM3NSIgcnk9IjAiIHJ4PSIwIiBzdHlsZT0iIiBjbGFzcz0iYmFzaWMgbGFiZWwtY29udGFpbmVyIj48L3JlY3Q+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTIyLjY1MjM0Mzc1LCAtMTIpIiBzdHlsZT0iIiBjbGFzcz0ibGFiZWwiPjxyZWN0PjwvcmVjdD48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjI0IiB3aWR0aD0iNDUuMzA0Njg3NSI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPjxzcGFuIGNsYXNzPSJub2RlTGFiZWwiPmxlbmd0aDwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzAuNzkyOTY4NzUsIDEyMC41KSIgaWQ9ImZsb3djaGFydC13aWR0aC0xODkiIGNsYXNzPSJub2RlIGRlZmF1bHQgZGVmYXVsdCBmbG93Y2hhcnQtbGFiZWwiPjxyZWN0IGhlaWdodD0iMzkiIHdpZHRoPSIxMjIuNDI5Njg3NSIgeT0iLTE5LjUiIHg9Ii02MS4yMTQ4NDM3NSIgcnk9IjAiIHJ4PSIwIiBzdHlsZT0iIiBjbGFzcz0iYmFzaWMgbGFiZWwtY29udGFpbmVyIj48L3JlY3Q+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTUzLjcxNDg0Mzc1LCAtMTIpIiBzdHlsZT0iIiBjbGFzcz0ibGFiZWwiPjxyZWN0PjwvcmVjdD48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjI0IiB3aWR0aD0iMTA3LjQyOTY4NzUiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0ibm9kZUxhYmVsIj53aWR0aCwgYnJlYWR0aDwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMzEuOTc2NTYyNSwgMTIwLjUpIiBpZD0iZmxvd2NoYXJ0LWhlaWdodC0xOTEiIGNsYXNzPSJub2RlIGRlZmF1bHQgZGVmYXVsdCBmbG93Y2hhcnQtbGFiZWwiPjxyZWN0IGhlaWdodD0iMzkiIHdpZHRoPSIxNzkuOTM3NSIgeT0iLTE5LjUiIHg9Ii04OS45Njg3NSIgcnk9IjAiIHJ4PSIwIiBzdHlsZT0iIiBjbGFzcz0iYmFzaWMgbGFiZWwtY29udGFpbmVyIj48L3JlY3Q+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTgyLjQ2ODc1LCAtMTIpIiBzdHlsZT0iIiBjbGFzcz0ibGFiZWwiPjxyZWN0PjwvcmVjdD48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjI0IiB3aWR0aD0iMTY0LjkzNzUiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0ibm9kZUxhYmVsIj5oZWlnaHQsIGRlcHRoLCBhbHRpdHVkZTwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0MC41MzEyNSwgMjIxLjUpIiBpZD0iZmxvd2NoYXJ0LXRoaWNrbmVzcy0xOTMiIGNsYXNzPSJub2RlIGRlZmF1bHQgZGVmYXVsdCBmbG93Y2hhcnQtbGFiZWwiPjxyZWN0IGhlaWdodD0iMzkiIHdpZHRoPSI4MS4wNjI1IiB5PSItMTkuNSIgeD0iLTQwLjUzMTI1IiByeT0iMCIgcng9IjAiIHN0eWxlPSIiIGNsYXNzPSJiYXNpYyBsYWJlbC1jb250YWluZXIiPjwvcmVjdD48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMzMuMDMxMjUsIC0xMikiIHN0eWxlPSIiIGNsYXNzPSJsYWJlbCI+PHJlY3Q+PC9yZWN0Pjxmb3JlaWduT2JqZWN0IGhlaWdodD0iMjQiIHdpZHRoPSI2Ni4wNjI1Ij48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+PHNwYW4gY2xhc3M9Im5vZGVMYWJlbCI+dGhpY2tuZXNzPC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE3MS4xNTIzNDM3NSwgMjIxLjUpIiBpZD0iZmxvd2NoYXJ0LWRpYW1ldGVyLTE5NSIgY2xhc3M9Im5vZGUgZGVmYXVsdCBkZWZhdWx0IGZsb3djaGFydC1sYWJlbCI+PHJlY3QgaGVpZ2h0PSIzOSIgd2lkdGg9IjgwLjE3OTY4NzUiIHk9Ii0xOS41IiB4PSItNDAuMDg5ODQzNzUiIHJ5PSIwIiByeD0iMCIgc3R5bGU9IiIgY2xhc3M9ImJhc2ljIGxhYmVsLWNvbnRhaW5lciI+PC9yZWN0PjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0zMi41ODk4NDM3NSwgLTEyKSIgc3R5bGU9IiIgY2xhc3M9ImxhYmVsIj48cmVjdD48L3JlY3Q+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSIyNCIgd2lkdGg9IjY1LjE3OTY4NzUiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0ibm9kZUxhYmVsIj5kaWFtZXRlcjwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyOTAuNDAyMzQzNzUsIDIyMS41KSIgaWQ9ImZsb3djaGFydC1yYWRpdXMtMTk3IiBjbGFzcz0ibm9kZSBkZWZhdWx0IGRlZmF1bHQgZmxvd2NoYXJ0LWxhYmVsIj48cmVjdCBoZWlnaHQ9IjM5IiB3aWR0aD0iNTguMzIwMzEyNSIgeT0iLTE5LjUiIHg9Ii0yOS4xNjAxNTYyNSIgcnk9IjAiIHJ4PSIwIiBzdHlsZT0iIiBjbGFzcz0iYmFzaWMgbGFiZWwtY29udGFpbmVyIj48L3JlY3Q+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTIxLjY2MDE1NjI1LCAtMTIpIiBzdHlsZT0iIiBjbGFzcz0ibGFiZWwiPjxyZWN0PjwvcmVjdD48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjI0IiB3aWR0aD0iNDMuMzIwMzEyNSI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPjxzcGFuIGNsYXNzPSJub2RlTGFiZWwiPnJhZGl1czwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1MjIuNDk2MDkzNzUsIDEyMC41KSIgaWQ9ImZsb3djaGFydC1wYXRoX2xlbmd0aC0xOTkiIGNsYXNzPSJub2RlIGRlZmF1bHQgZGVmYXVsdCBmbG93Y2hhcnQtbGFiZWwiPjxyZWN0IGhlaWdodD0iMzkiIHdpZHRoPSIxMDEuMTAxNTYyNSIgeT0iLTE5LjUiIHg9Ii01MC41NTA3ODEyNSIgcnk9IjAiIHJ4PSIwIiBzdHlsZT0iIiBjbGFzcz0iYmFzaWMgbGFiZWwtY29udGFpbmVyIj48L3JlY3Q+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTQzLjA1MDc4MTI1LCAtMTIpIiBzdHlsZT0iIiBjbGFzcz0ibGFiZWwiPjxyZWN0PjwvcmVjdD48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjI0IiB3aWR0aD0iODYuMTAxNTYyNSI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPjxzcGFuIGNsYXNzPSJub2RlTGFiZWwiPnBhdGhfbGVuZ3RoPC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDUyMi40OTYwOTM3NSwgMjIxLjUpIiBpZD0iZmxvd2NoYXJ0LWRpc3RhbmNlLTIwMSIgY2xhc3M9Im5vZGUgZGVmYXVsdCBkZWZhdWx0IGZsb3djaGFydC1sYWJlbCI+PHJlY3QgaGVpZ2h0PSIzOSIgd2lkdGg9Ijc1LjA5Mzc1IiB5PSItMTkuNSIgeD0iLTM3LjU0Njg3NSIgcnk9IjAiIHJ4PSIwIiBzdHlsZT0iIiBjbGFzcz0iYmFzaWMgbGFiZWwtY29udGFpbmVyIj48L3JlY3Q+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTMwLjA0Njg3NSwgLTEyKSIgc3R5bGU9IiIgY2xhc3M9ImxhYmVsIj48cmVjdD48L3JlY3Q+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSIyNCIgd2lkdGg9IjYwLjA5Mzc1Ij48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+PHNwYW4gY2xhc3M9Im5vZGVMYWJlbCI+ZGlzdGFuY2U8L3NwYW4+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNTIyLjQ5NjA5Mzc1LCAzMTAuNSkiIGlkPSJmbG93Y2hhcnQtcmFkaWFsX2Rpc3RhbmNlLTIwMyIgY2xhc3M9Im5vZGUgZGVmYXVsdCBkZWZhdWx0IGZsb3djaGFydC1sYWJlbCI+PHJlY3QgaGVpZ2h0PSIzOSIgd2lkdGg9IjEyNC43MTA5Mzc1IiB5PSItMTkuNSIgeD0iLTYyLjM1NTQ2ODc1IiByeT0iMCIgcng9IjAiIHN0eWxlPSIiIGNsYXNzPSJiYXNpYyBsYWJlbC1jb250YWluZXIiPjwvcmVjdD48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNTQuODU1NDY4NzUsIC0xMikiIHN0eWxlPSIiIGNsYXNzPSJsYWJlbCI+PHJlY3Q+PC9yZWN0Pjxmb3JlaWduT2JqZWN0IGhlaWdodD0iMjQiIHdpZHRoPSIxMDkuNzEwOTM3NSI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPjxzcGFuIGNsYXNzPSJub2RlTGFiZWwiPnJhZGlhbF9kaXN0YW5jZTwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSg2NzEuNjM2NzE4NzUsIDEyMC41KSIgaWQ9ImZsb3djaGFydC13YXZlbGVuZ3RoLTIwNSIgY2xhc3M9Im5vZGUgZGVmYXVsdCBkZWZhdWx0IGZsb3djaGFydC1sYWJlbCI+PHJlY3QgaGVpZ2h0PSIzOSIgd2lkdGg9Ijk3LjE3OTY4NzUiIHk9Ii0xOS41IiB4PSItNDguNTg5ODQzNzUiIHJ5PSIwIiByeD0iMCIgc3R5bGU9IiIgY2xhc3M9ImJhc2ljIGxhYmVsLWNvbnRhaW5lciI+PC9yZWN0PjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC00MS4wODk4NDM3NSwgLTEyKSIgc3R5bGU9IiIgY2xhc3M9ImxhYmVsIj48cmVjdD48L3JlY3Q+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSIyNCIgd2lkdGg9IjgyLjE3OTY4NzUiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0ibm9kZUxhYmVsIj53YXZlbGVuZ3RoPC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDgzMy4xMjUsIDEyMC41KSIgaWQ9ImZsb3djaGFydC1wb3NpdGlvbl92ZWN0b3ItMjA3IiBjbGFzcz0ibm9kZSBkZWZhdWx0IGRlZmF1bHQgZmxvd2NoYXJ0LWxhYmVsIj48cmVjdCBoZWlnaHQ9IjYzIiB3aWR0aD0iMTI1Ljc5Njg3NSIgeT0iLTMxLjUiIHg9Ii02Mi44OTg0Mzc1IiByeT0iMCIgcng9IjAiIHN0eWxlPSIiIGNsYXNzPSJiYXNpYyBsYWJlbC1jb250YWluZXIiPjwvcmVjdD48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNTUuMzk4NDM3NSwgLTI0KSIgc3R5bGU9IiIgY2xhc3M9ImxhYmVsIj48cmVjdD48L3JlY3Q+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSI0OCIgd2lkdGg9IjExMC43OTY4NzUiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0ibm9kZUxhYmVsIj5wb3NpdGlvbl92ZWN0b3I8YnIvPnt2ZWN0b3J9PC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEwMDEuMzkwNjI1LCAxMjAuNSkiIGlkPSJmbG93Y2hhcnQtZGlzcGxhY2VtZW50LTIwOSIgY2xhc3M9Im5vZGUgZGVmYXVsdCBkZWZhdWx0IGZsb3djaGFydC1sYWJlbCI+PHJlY3QgaGVpZ2h0PSI2MyIgd2lkdGg9IjExMC43MzQzNzUiIHk9Ii0zMS41IiB4PSItNTUuMzY3MTg3NSIgcnk9IjAiIHJ4PSIwIiBzdHlsZT0iIiBjbGFzcz0iYmFzaWMgbGFiZWwtY29udGFpbmVyIj48L3JlY3Q+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTQ3Ljg2NzE4NzUsIC0yNCkiIHN0eWxlPSIiIGNsYXNzPSJsYWJlbCI+PHJlY3Q+PC9yZWN0Pjxmb3JlaWduT2JqZWN0IGhlaWdodD0iNDgiIHdpZHRoPSI5NS43MzQzNzUiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0ibm9kZUxhYmVsIj5kaXNwbGFjZW1lbnQ8YnIvPnt2ZWN0b3J9PC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI5MC40MDIzNDM3NSwgMzEwLjUpIiBpZD0iZmxvd2NoYXJ0LXJhZGl1c19vZl9jdXJ2YXR1cmUtMjExIiBjbGFzcz0ibm9kZSBkZWZhdWx0IGRlZmF1bHQgZmxvd2NoYXJ0LWxhYmVsIj48cmVjdCBoZWlnaHQ9IjM5IiB3aWR0aD0iMTU4Ljc1NzgxMjUiIHk9Ii0xOS41IiB4PSItNzkuMzc4OTA2MjUiIHJ5PSIwIiByeD0iMCIgc3R5bGU9IiIgY2xhc3M9ImJhc2ljIGxhYmVsLWNvbnRhaW5lciI+PC9yZWN0PjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC03MS44Nzg5MDYyNSwgLTEyKSIgc3R5bGU9IiIgY2xhc3M9ImxhYmVsIj48cmVjdD48L3JlY3Q+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSIyNCIgd2lkdGg9IjE0My43NTc4MTI1Ij48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+PHNwYW4gY2xhc3M9Im5vZGVMYWJlbCI+cmFkaXVzX29mX2N1cnZhdHVyZTwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48L2c+PC9nPjwvZz48L3N2Zz4=" /></p>
<p>Each of the above quantities expresses some kind of <em>length</em>,
and each can be measured with meters, which is the unit defined by the
<span class="citation" data-cites="SI">[<a href="#ref-SI" role="doc-biblioref">SI</a>]</span> for quantities of <em>length</em>.
However, each has different properties, usage, and sometimes even a
different character (<em>position vector</em> and <em>displacement</em>
are vector quantities).</p>
<p>The below presents how such a hierarchy tree can be defined in the
library:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> dim_length <span class="op">:</span> base_dimension<span class="op">&lt;</span><span class="st">&quot;L&quot;</span><span class="op">&gt;</span> <span class="op">{}</span> dim_length;</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> length <span class="op">:</span> quantity_spec<span class="op">&lt;</span>dim_length<span class="op">&gt;</span> <span class="op">{}</span> length;</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> width <span class="op">:</span> quantity_spec<span class="op">&lt;</span>length<span class="op">&gt;</span> <span class="op">{}</span> width;</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">auto</span> breadth <span class="op">=</span> width;</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> height <span class="op">:</span> quantity_spec<span class="op">&lt;</span>length<span class="op">&gt;</span> <span class="op">{}</span> height;</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">auto</span> depth <span class="op">=</span> height;</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">auto</span> altitude <span class="op">=</span> height;</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> thickness <span class="op">:</span> quantity_spec<span class="op">&lt;</span>width<span class="op">&gt;</span> <span class="op">{}</span> thickness;</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> diameter <span class="op">:</span> quantity_spec<span class="op">&lt;</span>width<span class="op">&gt;</span> <span class="op">{}</span> diameter;</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> radius <span class="op">:</span> quantity_spec<span class="op">&lt;</span>width<span class="op">&gt;</span> <span class="op">{}</span> radius;</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> radius_of_curvature <span class="op">:</span> quantity_spec<span class="op">&lt;</span>radius<span class="op">&gt;</span> <span class="op">{}</span> radius_of_curvature;</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> path_length <span class="op">:</span> quantity_spec<span class="op">&lt;</span>length<span class="op">&gt;</span> <span class="op">{}</span> path_length;</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">auto</span> arc_length <span class="op">=</span> path_length;</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> distance <span class="op">:</span> quantity_spec<span class="op">&lt;</span>path_length<span class="op">&gt;</span> <span class="op">{}</span> distance;</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> radial_distance <span class="op">:</span> quantity_spec<span class="op">&lt;</span>distance<span class="op">&gt;</span> <span class="op">{}</span> radial_distance;</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> wavelength <span class="op">:</span> quantity_spec<span class="op">&lt;</span>length<span class="op">&gt;</span> <span class="op">{}</span> wavelength;</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> position_vector <span class="op">:</span> quantity_spec<span class="op">&lt;</span>length, quantity_character<span class="op">::</span>vector<span class="op">&gt;</span> <span class="op">{}</span> position_vector;</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> displacement <span class="op">:</span> quantity_spec<span class="op">&lt;</span>length, quantity_character<span class="op">::</span>vector<span class="op">&gt;</span> <span class="op">{}</span> displacement;</span></code></pre></div>
<p>In the above code:</p>
<ul>
<li><code class="sourceCode default">length</code> takes the base
dimension to indicate that we are creating a base quantity that will
serve as a root for a tree of quantities of the same kind,</li>
<li><code class="sourceCode default">width</code> and following
quantities are branches and leaves of this tree with the parent always
provided as the argument to
<code class="sourceCode default">quantity_spec</code> class
template,</li>
<li><code class="sourceCode default">breadth</code> is an alias name for
the same quantity as <code class="sourceCode default">width</code>.</li>
</ul>
<p>Please note that some quantities may be specified by <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span> as vector or tensor
quantities (e.g.,
<code class="sourceCode default">displacement</code>).</p>
<h3 data-number="13.1.3" id="converting-between-quantities-of-the-same-kind"><span class="header-section-number">13.1.3</span> Converting between
quantities of the same kind<a href="#converting-between-quantities-of-the-same-kind" class="self-link"></a></h3>
<p>Quantity conversion rules can be defined based on the same hierarchy
of quantities of kind length.</p>
<ol type="1">
<li><p><strong>Implicit conversions</strong></p>
<ul>
<li>Every <em>width</em> is a <em>length</em>.</li>
<li>Every <em>radius</em> is a <em>width</em>.</li>
</ul>
<div class="sourceCode" id="cb59"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>implicitly_convertible<span class="op">(</span>isq<span class="op">::</span>width, isq<span class="op">::</span>length<span class="op">))</span>;</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>implicitly_convertible<span class="op">(</span>isq<span class="op">::</span>radius, isq<span class="op">::</span>length<span class="op">))</span>;</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>implicitly_convertible<span class="op">(</span>isq<span class="op">::</span>radius, isq<span class="op">::</span>width<span class="op">))</span>;</span></code></pre></div>
<p>Implicit conversions are allowed on copy-initialization:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> foo<span class="op">(</span>quantity<span class="op">&lt;</span>isq<span class="op">::</span>length<span class="op">&lt;</span>m<span class="op">&gt;&gt;</span> q<span class="op">)</span>;</span></code></pre></div>
<div class="sourceCode" id="cb61"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>isq<span class="op">::</span>width<span class="op">&lt;</span>m<span class="op">&gt;&gt;</span> q1 <span class="op">=</span> <span class="dv">42</span> <span class="op">*</span> m;</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>isq<span class="op">::</span>length<span class="op">&lt;</span>m<span class="op">&gt;&gt;</span> q2 <span class="op">=</span> q1;  <span class="co">// implicit quantity conversion</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>foo<span class="op">(</span>q1<span class="op">)</span>;                           <span class="co">// implicit quantity conversion</span></span></code></pre></div></li>
<li><p><strong>Explicit conversions</strong></p>
<ul>
<li>Not every <em>length</em> is a <em>width</em>.</li>
<li>Not every <em>width</em> is a <em>radius</em>.</li>
</ul>
<div class="sourceCode" id="cb62"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(!</span>implicitly_convertible<span class="op">(</span>isq<span class="op">::</span>length, isq<span class="op">::</span>width<span class="op">))</span>;</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(!</span>implicitly_convertible<span class="op">(</span>isq<span class="op">::</span>length, isq<span class="op">::</span>radius<span class="op">))</span>;</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(!</span>implicitly_convertible<span class="op">(</span>isq<span class="op">::</span>width, isq<span class="op">::</span>radius<span class="op">))</span>;</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>explicitly_convertible<span class="op">(</span>isq<span class="op">::</span>length, isq<span class="op">::</span>width<span class="op">))</span>;</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>explicitly_convertible<span class="op">(</span>isq<span class="op">::</span>length, isq<span class="op">::</span>radius<span class="op">))</span>;</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>explicitly_convertible<span class="op">(</span>isq<span class="op">::</span>width, isq<span class="op">::</span>radius<span class="op">))</span>;</span></code></pre></div>
<p>Explicit conversions are forced by passing the quantity to a call
operator of a <code class="sourceCode default">quantity_spec</code>
type:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>isq<span class="op">::</span>length<span class="op">&lt;</span>m<span class="op">&gt;&gt;</span> q1 <span class="op">=</span> <span class="dv">42</span> <span class="op">*</span> m;</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>isq<span class="op">::</span>height<span class="op">&lt;</span>m<span class="op">&gt;&gt;</span> q2 <span class="op">=</span> isq<span class="op">::</span>height<span class="op">(</span>q1<span class="op">)</span>;  <span class="co">// explicit quantity conversion</span></span></code></pre></div></li>
<li><p><strong>Explicit casts</strong></p>
<ul>
<li><em>height</em> is never a <em>width</em>, and vice versa.</li>
<li>Both <em>height</em> and <em>width</em> are quantities of kind
<em>length</em>.</li>
</ul>
<div class="sourceCode" id="cb64"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(!</span>implicitly_convertible<span class="op">(</span>isq<span class="op">::</span>height, isq<span class="op">::</span>width<span class="op">))</span>;</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(!</span>explicitly_convertible<span class="op">(</span>isq<span class="op">::</span>height, isq<span class="op">::</span>width<span class="op">))</span>;</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>castable<span class="op">(</span>isq<span class="op">::</span>height, isq<span class="op">::</span>width<span class="op">))</span>;</span></code></pre></div>
<p>Explicit casts are forced with a dedicated
<code class="sourceCode default">quantity_cast</code> function:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>isq<span class="op">::</span>width<span class="op">&lt;</span>m<span class="op">&gt;&gt;</span> q1 <span class="op">=</span> <span class="dv">42</span> <span class="op">*</span> m;</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>isq<span class="op">::</span>height<span class="op">&lt;</span>m<span class="op">&gt;&gt;</span> q2 <span class="op">=</span> quantity_cast<span class="op">&lt;</span>isq<span class="op">::</span>height<span class="op">&gt;(</span>q1<span class="op">)</span>;  <span class="co">// explicit quantity cast</span></span></code></pre></div></li>
<li><p><strong>No conversion</strong></p>
<ul>
<li><em>time</em> has nothing in common with <em>length</em>.</li>
</ul>
<div class="sourceCode" id="cb66"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(!</span>implicitly_convertible<span class="op">(</span>isq<span class="op">::</span>time, isq<span class="op">::</span>length<span class="op">))</span>;</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(!</span>explicitly_convertible<span class="op">(</span>isq<span class="op">::</span>time, isq<span class="op">::</span>length<span class="op">))</span>;</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(!</span>castable<span class="op">(</span>isq<span class="op">::</span>time, isq<span class="op">::</span>length<span class="op">))</span>;</span></code></pre></div>
<p>Even the explicit casts will not force such a conversion:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> foo<span class="op">(</span>quantity<span class="op">&lt;</span>isq<span class="op">::</span>length<span class="op">[</span>m<span class="op">]&gt;)</span>;</span></code></pre></div>
<div class="sourceCode" id="cb68"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>foo<span class="op">(</span>quantity_cast<span class="op">&lt;</span>isq<span class="op">::</span>length<span class="op">&gt;(</span><span class="dv">42</span> <span class="op">*</span> s<span class="op">))</span>; <span class="co">// Compile-time error</span></span></code></pre></div></li>
</ol>
<h3 data-number="13.1.4" id="comparing-adding-and-subtracting-quantities-of-the-same-kind"><span class="header-section-number">13.1.4</span> Comparing, adding, and
subtracting quantities of the same kind<a href="#comparing-adding-and-subtracting-quantities-of-the-same-kind" class="self-link"></a></h3>
<p><span class="citation" data-cites="ISO-GUIDE">[<a href="#ref-ISO-GUIDE" role="doc-biblioref">ISO/IEC Guide 99</a>]</span>
explicitly states that <em>width</em> and <em>height</em> are quantities
of the same kind and as such they:</p>
<ul>
<li>are mutually comparable, and</li>
<li>can be added and subtracted.</li>
</ul>
<p>If we take the above for granted, the only reasonable result of
<code class="sourceCode default">1 * width + 1 * height</code> is
<code class="sourceCode default">2 * length</code>, where the result of
<code class="sourceCode default">length</code> is known as a common
quantity type. A result of such an equation is always the first common
node in a hierarchy tree of the same kind. For example:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>common_quantity_spec<span class="op">(</span>isq<span class="op">::</span>width, isq<span class="op">::</span>height<span class="op">)</span> <span class="op">==</span> isq<span class="op">::</span>length<span class="op">)</span>;</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>common_quantity_spec<span class="op">(</span>isq<span class="op">::</span>thickness, isq<span class="op">::</span>radius<span class="op">)</span> <span class="op">==</span> isq<span class="op">::</span>width<span class="op">)</span>;</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>common_quantity_spec<span class="op">(</span>isq<span class="op">::</span>distance, isq<span class="op">::</span>path_length<span class="op">)</span> <span class="op">==</span> isq<span class="op">::</span>path_length<span class="op">)</span>;</span></code></pre></div>
<div class="sourceCode" id="cb70"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>quantity q <span class="op">=</span> isq<span class="op">::</span>thickness<span class="op">(</span><span class="dv">1</span> <span class="op">*</span> m<span class="op">)</span> <span class="op">+</span> isq<span class="op">::</span>radius<span class="op">(</span><span class="dv">1</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>q<span class="op">.</span>quantity_spec <span class="op">==</span> isq<span class="op">::</span>width<span class="op">)</span>;</span></code></pre></div>
<p>One could argue that allowing to add or compare quantities of
<em>height</em> and <em>width</em> might be a safety issue, but we need
to be consistent with the requirements of <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span>. Moreover, from our
experience, disallowing such operations and requiring an explicit cast
to a common quantity in every single place makes the code so cluttered
with casts that it nearly renders the library unusable.</p>
<p>Fortunately, the above-mentioned conversion rules make the code safe
by construction anyway. Let’s analyze the following example:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> horizontal_length <span class="op">:</span> quantity_spec<span class="op">&lt;</span>isq<span class="op">::</span>length<span class="op">&gt;</span> <span class="op">{}</span> horizontal_length;</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> christmas <span class="op">{</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> gift <span class="op">{</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  quantity<span class="op">&lt;</span>horizontal_length<span class="op">[</span>m<span class="op">]&gt;</span> length;</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>  quantity<span class="op">&lt;</span>isq<span class="op">::</span>width<span class="op">[</span>m<span class="op">]&gt;</span> width;</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>  quantity<span class="op">&lt;</span>isq<span class="op">::</span>height<span class="op">[</span>m<span class="op">]&gt;</span> height;</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>;</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>array<span class="op">&lt;</span>quantity<span class="op">&lt;</span>isq<span class="op">::</span>length<span class="op">[</span>m<span class="op">]&gt;</span>, <span class="dv">2</span><span class="op">&gt;</span> gift_wrapping_paper_size<span class="op">(</span><span class="kw">const</span> gift<span class="op">&amp;</span> g<span class="op">)</span></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> <span class="kw">auto</span> dim1 <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> g<span class="op">.</span>width <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> g<span class="op">.</span>height <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> g<span class="op">.</span>width;</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> <span class="kw">auto</span> dim2 <span class="op">=</span> g<span class="op">.</span>length <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> <span class="fl">0.75</span> <span class="op">*</span> g<span class="op">.</span>height;</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="op">{</span> dim1, dim2 <span class="op">}</span>;</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>  <span class="co">// namespace christmas</span></span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span></span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> christmas<span class="op">::</span>gift lego <span class="op">=</span> <span class="op">{</span> horizontal_length<span class="op">(</span><span class="dv">40</span> <span class="op">*</span> cm<span class="op">)</span>, isq<span class="op">::</span>width<span class="op">(</span><span class="dv">30</span> <span class="op">*</span> cm<span class="op">)</span>, isq<span class="op">::</span>height<span class="op">(</span><span class="dv">15</span> <span class="op">*</span> cm<span class="op">)</span> <span class="op">}</span>;</span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a>  <span class="kw">auto</span> paper <span class="op">=</span> christmas<span class="op">::</span>gift_wrapping_paper_size<span class="op">(</span>lego<span class="op">)</span>;</span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;Paper needed to pack a lego box:</span><span class="sc">\n</span><span class="st">&quot;</span>;</span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;- &quot;</span> <span class="op">&lt;&lt;</span> paper<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">&lt;&lt;</span> <span class="st">&quot; X &quot;</span> <span class="op">&lt;&lt;</span> paper<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>;  <span class="co">// - 1.05 m X 0.625 m</span></span>
<span id="cb71-27"><a href="#cb71-27" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;- area = &quot;</span> <span class="op">&lt;&lt;</span> paper<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">*</span> paper<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>;     <span class="co">// - area = 0.65625 m²</span></span>
<span id="cb71-28"><a href="#cb71-28" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>In the beginning, we introduce a custom quantity
<code class="sourceCode default">horizontal_length</code> of a kind
<em>length</em>, which then, together with
<code class="sourceCode default">isq::width</code> and
<code class="sourceCode default">isq::height</code>, are used to define
the dimensions of a Christmas gift. Next, we provide a function that
calculates the dimensions of a gift wrapping paper with some wraparound.
The result of both those expressions is a quantity of
<code class="sourceCode default">isq::length</code>, as this is the
closest common quantity for the arguments used in this quantity
equation.</p>
<p>Regarding safety, it is important to mention here, that thanks to the
conversion rules provided above, it would be impossible to accidentally
do the following:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> foo<span class="op">(</span>quantity<span class="op">&lt;</span>horizontal_length<span class="op">[</span>m<span class="op">]&gt;</span> q<span class="op">)</span>;</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>isq<span class="op">::</span>width<span class="op">[</span>m<span class="op">]&gt;</span> q1 <span class="op">=</span> dim1;  <span class="co">// Compile-time error</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>isq<span class="op">::</span>height<span class="op">[</span>m<span class="op">]&gt;</span> q2<span class="op">{</span>dim1<span class="op">}</span>;  <span class="co">// Compile-time error</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>foo<span class="op">(</span>dim1<span class="op">)</span>;                          <span class="co">// Compile-time error</span></span></code></pre></div>
<p>The reason of compilation errors above is the fact that
<code class="sourceCode default">isq::length</code> is not implicitly
convertible to the quantities defined based on it. To make the above
code compile, an explicit conversion of a quantity type is needed:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> foo<span class="op">(</span>quantity<span class="op">&lt;</span>horizontal_length<span class="op">[</span>m<span class="op">]&gt;</span> q<span class="op">)</span>;</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>isq<span class="op">::</span>width<span class="op">[</span>m<span class="op">]&gt;</span> q1 <span class="op">=</span> isq<span class="op">::</span>width<span class="op">(</span>dim1<span class="op">)</span>;</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>isq<span class="op">::</span>height<span class="op">[</span>m<span class="op">]&gt;</span> q2<span class="op">{</span>isq<span class="op">::</span>height<span class="op">(</span>dim1<span class="op">)}</span>;</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>foo<span class="op">(</span>horizontal_length<span class="op">(</span>dim1<span class="op">))</span>;</span></code></pre></div>
<p>To summarize, rules for addition, subtraction, and comparison of
quantities improve the library usability, while the conversion rules
enhance the safety of the library compared to the libraries that do not
model quantity kinds.</p>
<h3 data-number="13.1.5" id="hierarchies-of-derived-quantities"><span class="header-section-number">13.1.5</span> Hierarchies of derived
quantities<a href="#hierarchies-of-derived-quantities" class="self-link"></a></h3>
<p>The same rules propagate to derived quantities. For example, we can
define strongly typed horizontal length and area:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> horizontal_length <span class="op">:</span> quantity_spec<span class="op">&lt;</span>isq<span class="op">::</span>length<span class="op">&gt;</span> <span class="op">{}</span> horizontal_length;</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> horizontal_area <span class="op">:</span> quantity_spec<span class="op">&lt;</span>isq<span class="op">::</span>area, horizontal_length <span class="op">*</span> isq<span class="op">::</span>width<span class="op">&gt;</span> <span class="op">{}</span> horizontal_area;</span></code></pre></div>
<p>The first definition says that a
<code class="sourceCode default">horizontal_length</code> is a more
specialized quantity than
<code class="sourceCode default">isq::length</code> and belongs to the
same quantity kind. The second line defines a
<code class="sourceCode default">horizontal_area</code>, which is a more
specialized quantity than
<code class="sourceCode default">isq::area</code>, so it has a more
constrained recipe as well. Thanks to that:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>implicitly_convertible<span class="op">(</span>horizontal_length, isq<span class="op">::</span>length<span class="op">))</span>;</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(!</span>implicitly_convertible<span class="op">(</span>isq<span class="op">::</span>length, horizontal_length<span class="op">))</span>;</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>explicitly_convertible<span class="op">(</span>isq<span class="op">::</span>length, horizontal_length<span class="op">))</span>;</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>implicitly_convertible<span class="op">(</span>horizontal_area, isq<span class="op">::</span>area<span class="op">))</span>;</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(!</span>implicitly_convertible<span class="op">(</span>isq<span class="op">::</span>area, horizontal_area<span class="op">))</span>;</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>explicitly_convertible<span class="op">(</span>isq<span class="op">::</span>area, horizontal_area<span class="op">))</span>;</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>implicitly_convertible<span class="op">(</span>isq<span class="op">::</span>length <span class="op">*</span> isq<span class="op">::</span>length, isq<span class="op">::</span>area<span class="op">))</span>;</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(!</span>implicitly_convertible<span class="op">(</span>isq<span class="op">::</span>length <span class="op">*</span> isq<span class="op">::</span>length, horizontal_area<span class="op">))</span>;</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>explicitly_convertible<span class="op">(</span>isq<span class="op">::</span>length <span class="op">*</span> isq<span class="op">::</span>length, horizontal_area<span class="op">))</span>;</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>implicitly_convertible<span class="op">(</span>horizontal_length <span class="op">*</span> isq<span class="op">::</span>width, isq<span class="op">::</span>area<span class="op">))</span>;</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>implicitly_convertible<span class="op">(</span>horizontal_length <span class="op">*</span> isq<span class="op">::</span>width, horizontal_area<span class="op">))</span>;</span></code></pre></div>
<p>Unfortunately, derived quantity equations often do not automatically
form a hierarchy tree. This is why sometimes it is not obvious what such
a tree should look like. Also, the <span class="citation" data-cites="ISO-GUIDE">[<a href="#ref-ISO-GUIDE" role="doc-biblioref">ISO/IEC Guide 99</a>]</span> explicitly states:</p>
<blockquote>
<p>The division of ‘quantity’ according to ‘kind of quantity’ is, to
some extent, arbitrary.</p>
</blockquote>
<p>The below presents some arbitrary hierarchy of derived quantities of
kind <em>energy</em>:</p>
<p><img src="data:image/svg+xml;base64,PHN2ZyBhcmlhLXJvbGVkZXNjcmlwdGlvbj0iZmxvd2NoYXJ0LXYyIiByb2xlPSJncmFwaGljcy1kb2N1bWVudCBkb2N1bWVudCIgdmlld0JveD0iLTggLTggMTM4OS41NTQ2ODc1IDM5NCIgc3R5bGU9Im1heC13aWR0aDogMTAwJTsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGlkPSJncmFwaC1kaXYiIGhlaWdodD0iMTAwJSIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxzdHlsZT5AaW1wb3J0IHVybCgiaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvZm9udC1hd2Vzb21lLzYuNC4yL2Nzcy9hbGwubWluLmNzcyIpOyc8L3N0eWxlPjxzdHlsZT4jZ3JhcGgtZGl2e2ZvbnQtZmFtaWx5OiJ0cmVidWNoZXQgbXMiLHZlcmRhbmEsYXJpYWwsc2Fucy1zZXJpZjtmb250LXNpemU6MTZweDtmaWxsOiMzMzM7fSNncmFwaC1kaXYgLmVycm9yLWljb257ZmlsbDojNTUyMjIyO30jZ3JhcGgtZGl2IC5lcnJvci10ZXh0e2ZpbGw6IzU1MjIyMjtzdHJva2U6IzU1MjIyMjt9I2dyYXBoLWRpdiAuZWRnZS10aGlja25lc3Mtbm9ybWFse3N0cm9rZS13aWR0aDoycHg7fSNncmFwaC1kaXYgLmVkZ2UtdGhpY2tuZXNzLXRoaWNre3N0cm9rZS13aWR0aDozLjVweDt9I2dyYXBoLWRpdiAuZWRnZS1wYXR0ZXJuLXNvbGlke3N0cm9rZS1kYXNoYXJyYXk6MDt9I2dyYXBoLWRpdiAuZWRnZS1wYXR0ZXJuLWRhc2hlZHtzdHJva2UtZGFzaGFycmF5OjM7fSNncmFwaC1kaXYgLmVkZ2UtcGF0dGVybi1kb3R0ZWR7c3Ryb2tlLWRhc2hhcnJheToyO30jZ3JhcGgtZGl2IC5tYXJrZXJ7ZmlsbDojMzMzMzMzO3N0cm9rZTojMzMzMzMzO30jZ3JhcGgtZGl2IC5tYXJrZXIuY3Jvc3N7c3Ryb2tlOiMzMzMzMzM7fSNncmFwaC1kaXYgc3Zne2ZvbnQtZmFtaWx5OiJ0cmVidWNoZXQgbXMiLHZlcmRhbmEsYXJpYWwsc2Fucy1zZXJpZjtmb250LXNpemU6MTZweDt9I2dyYXBoLWRpdiAubGFiZWx7Zm9udC1mYW1pbHk6InRyZWJ1Y2hldCBtcyIsdmVyZGFuYSxhcmlhbCxzYW5zLXNlcmlmO2NvbG9yOiMzMzM7fSNncmFwaC1kaXYgLmNsdXN0ZXItbGFiZWwgdGV4dHtmaWxsOiMzMzM7fSNncmFwaC1kaXYgLmNsdXN0ZXItbGFiZWwgc3BhbiwjZ3JhcGgtZGl2IHB7Y29sb3I6IzMzMzt9I2dyYXBoLWRpdiAubGFiZWwgdGV4dCwjZ3JhcGgtZGl2IHNwYW4sI2dyYXBoLWRpdiBwe2ZpbGw6IzMzMztjb2xvcjojMzMzO30jZ3JhcGgtZGl2IC5ub2RlIHJlY3QsI2dyYXBoLWRpdiAubm9kZSBjaXJjbGUsI2dyYXBoLWRpdiAubm9kZSBlbGxpcHNlLCNncmFwaC1kaXYgLm5vZGUgcG9seWdvbiwjZ3JhcGgtZGl2IC5ub2RlIHBhdGh7ZmlsbDojRUNFQ0ZGO3N0cm9rZTojOTM3MERCO3N0cm9rZS13aWR0aDoxcHg7fSNncmFwaC1kaXYgLmZsb3djaGFydC1sYWJlbCB0ZXh0e3RleHQtYW5jaG9yOm1pZGRsZTt9I2dyYXBoLWRpdiAubm9kZSAubGFiZWx7dGV4dC1hbGlnbjpjZW50ZXI7fSNncmFwaC1kaXYgLm5vZGUuY2xpY2thYmxle2N1cnNvcjpwb2ludGVyO30jZ3JhcGgtZGl2IC5hcnJvd2hlYWRQYXRoe2ZpbGw6IzMzMzMzMzt9I2dyYXBoLWRpdiAuZWRnZVBhdGggLnBhdGh7c3Ryb2tlOiMzMzMzMzM7c3Ryb2tlLXdpZHRoOjIuMHB4O30jZ3JhcGgtZGl2IC5mbG93Y2hhcnQtbGlua3tzdHJva2U6IzMzMzMzMztmaWxsOm5vbmU7fSNncmFwaC1kaXYgLmVkZ2VMYWJlbHtiYWNrZ3JvdW5kLWNvbG9yOiNlOGU4ZTg7dGV4dC1hbGlnbjpjZW50ZXI7fSNncmFwaC1kaXYgLmVkZ2VMYWJlbCByZWN0e29wYWNpdHk6MC41O2JhY2tncm91bmQtY29sb3I6I2U4ZThlODtmaWxsOiNlOGU4ZTg7fSNncmFwaC1kaXYgLmxhYmVsQmtne2JhY2tncm91bmQtY29sb3I6cmdiYSgyMzIsIDIzMiwgMjMyLCAwLjUpO30jZ3JhcGgtZGl2IC5jbHVzdGVyIHJlY3R7ZmlsbDojZmZmZmRlO3N0cm9rZTojYWFhYTMzO3N0cm9rZS13aWR0aDoxcHg7fSNncmFwaC1kaXYgLmNsdXN0ZXIgdGV4dHtmaWxsOiMzMzM7fSNncmFwaC1kaXYgLmNsdXN0ZXIgc3BhbiwjZ3JhcGgtZGl2IHB7Y29sb3I6IzMzMzt9I2dyYXBoLWRpdiBkaXYubWVybWFpZFRvb2x0aXB7cG9zaXRpb246YWJzb2x1dGU7dGV4dC1hbGlnbjpjZW50ZXI7bWF4LXdpZHRoOjIwMHB4O3BhZGRpbmc6MnB4O2ZvbnQtZmFtaWx5OiJ0cmVidWNoZXQgbXMiLHZlcmRhbmEsYXJpYWwsc2Fucy1zZXJpZjtmb250LXNpemU6MTJweDtiYWNrZ3JvdW5kOmhzbCg4MCwgMTAwJSwgOTYuMjc0NTA5ODAzOSUpO2JvcmRlcjoxcHggc29saWQgI2FhYWEzMztib3JkZXItcmFkaXVzOjJweDtwb2ludGVyLWV2ZW50czpub25lO3otaW5kZXg6MTAwO30jZ3JhcGgtZGl2IC5mbG93Y2hhcnRUaXRsZVRleHR7dGV4dC1hbmNob3I6bWlkZGxlO2ZvbnQtc2l6ZToxOHB4O2ZpbGw6IzMzMzt9I2dyYXBoLWRpdiA6cm9vdHstLW1lcm1haWQtZm9udC1mYW1pbHk6InRyZWJ1Y2hldCBtcyIsdmVyZGFuYSxhcmlhbCxzYW5zLXNlcmlmO308L3N0eWxlPjxnPjxtYXJrZXIgb3JpZW50PSJhdXRvIiBtYXJrZXJIZWlnaHQ9IjEyIiBtYXJrZXJXaWR0aD0iMTIiIG1hcmtlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgcmVmWT0iNSIgcmVmWD0iNiIgdmlld0JveD0iMCAwIDEwIDEwIiBjbGFzcz0ibWFya2VyIGZsb3djaGFydCIgaWQ9ImdyYXBoLWRpdl9mbG93Y2hhcnQtcG9pbnRFbmQiPjxwYXRoIHN0eWxlPSJzdHJva2Utd2lkdGg6IDE7IHN0cm9rZS1kYXNoYXJyYXk6IDEsIDA7IiBjbGFzcz0iYXJyb3dNYXJrZXJQYXRoIiBkPSJNIDAgMCBMIDEwIDUgTCAwIDEwIHoiPjwvcGF0aD48L21hcmtlcj48bWFya2VyIG9yaWVudD0iYXV0byIgbWFya2VySGVpZ2h0PSIxMiIgbWFya2VyV2lkdGg9IjEyIiBtYXJrZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIHJlZlk9IjUiIHJlZlg9IjQuNSIgdmlld0JveD0iMCAwIDEwIDEwIiBjbGFzcz0ibWFya2VyIGZsb3djaGFydCIgaWQ9ImdyYXBoLWRpdl9mbG93Y2hhcnQtcG9pbnRTdGFydCI+PHBhdGggc3R5bGU9InN0cm9rZS13aWR0aDogMTsgc3Ryb2tlLWRhc2hhcnJheTogMSwgMDsiIGNsYXNzPSJhcnJvd01hcmtlclBhdGgiIGQ9Ik0gMCA1IEwgMTAgMTAgTCAxMCAwIHoiPjwvcGF0aD48L21hcmtlcj48bWFya2VyIG9yaWVudD0iYXV0byIgbWFya2VySGVpZ2h0PSIxMSIgbWFya2VyV2lkdGg9IjExIiBtYXJrZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIHJlZlk9IjUiIHJlZlg9IjExIiB2aWV3Qm94PSIwIDAgMTAgMTAiIGNsYXNzPSJtYXJrZXIgZmxvd2NoYXJ0IiBpZD0iZ3JhcGgtZGl2X2Zsb3djaGFydC1jaXJjbGVFbmQiPjxjaXJjbGUgc3R5bGU9InN0cm9rZS13aWR0aDogMTsgc3Ryb2tlLWRhc2hhcnJheTogMSwgMDsiIGNsYXNzPSJhcnJvd01hcmtlclBhdGgiIHI9IjUiIGN5PSI1IiBjeD0iNSI+PC9jaXJjbGU+PC9tYXJrZXI+PG1hcmtlciBvcmllbnQ9ImF1dG8iIG1hcmtlckhlaWdodD0iMTEiIG1hcmtlcldpZHRoPSIxMSIgbWFya2VyVW5pdHM9InVzZXJTcGFjZU9uVXNlIiByZWZZPSI1IiByZWZYPSItMSIgdmlld0JveD0iMCAwIDEwIDEwIiBjbGFzcz0ibWFya2VyIGZsb3djaGFydCIgaWQ9ImdyYXBoLWRpdl9mbG93Y2hhcnQtY2lyY2xlU3RhcnQiPjxjaXJjbGUgc3R5bGU9InN0cm9rZS13aWR0aDogMTsgc3Ryb2tlLWRhc2hhcnJheTogMSwgMDsiIGNsYXNzPSJhcnJvd01hcmtlclBhdGgiIHI9IjUiIGN5PSI1IiBjeD0iNSI+PC9jaXJjbGU+PC9tYXJrZXI+PG1hcmtlciBvcmllbnQ9ImF1dG8iIG1hcmtlckhlaWdodD0iMTEiIG1hcmtlcldpZHRoPSIxMSIgbWFya2VyVW5pdHM9InVzZXJTcGFjZU9uVXNlIiByZWZZPSI1LjIiIHJlZlg9IjEyIiB2aWV3Qm94PSIwIDAgMTEgMTEiIGNsYXNzPSJtYXJrZXIgY3Jvc3MgZmxvd2NoYXJ0IiBpZD0iZ3JhcGgtZGl2X2Zsb3djaGFydC1jcm9zc0VuZCI+PHBhdGggc3R5bGU9InN0cm9rZS13aWR0aDogMjsgc3Ryb2tlLWRhc2hhcnJheTogMSwgMDsiIGNsYXNzPSJhcnJvd01hcmtlclBhdGgiIGQ9Ik0gMSwxIGwgOSw5IE0gMTAsMSBsIC05LDkiPjwvcGF0aD48L21hcmtlcj48bWFya2VyIG9yaWVudD0iYXV0byIgbWFya2VySGVpZ2h0PSIxMSIgbWFya2VyV2lkdGg9IjExIiBtYXJrZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIHJlZlk9IjUuMiIgcmVmWD0iLTEiIHZpZXdCb3g9IjAgMCAxMSAxMSIgY2xhc3M9Im1hcmtlciBjcm9zcyBmbG93Y2hhcnQiIGlkPSJncmFwaC1kaXZfZmxvd2NoYXJ0LWNyb3NzU3RhcnQiPjxwYXRoIHN0eWxlPSJzdHJva2Utd2lkdGg6IDI7IHN0cm9rZS1kYXNoYXJyYXk6IDEsIDA7IiBjbGFzcz0iYXJyb3dNYXJrZXJQYXRoIiBkPSJNIDEsMSBsIDksOSBNIDEwLDEgbCAtOSw5Ij48L3BhdGg+PC9tYXJrZXI+PGcgY2xhc3M9InJvb3QiPjxnIGNsYXNzPSJjbHVzdGVycyI+PC9nPjxnIGNsYXNzPSJlZGdlUGF0aHMiPjxwYXRoIHN0eWxlPSJmaWxsOm5vbmU7IiBjbGFzcz0iZWRnZS10aGlja25lc3Mtbm9ybWFsIGVkZ2UtcGF0dGVybi1zb2xpZCBmbG93Y2hhcnQtbGluayBMUy1lbmVyZ3kgTEUtbWVjaGFuaWNhbF9lbmVyZ3kiIGlkPSJMLWVuZXJneS1tZWNoYW5pY2FsX2VuZXJneS0wIiBkPSJNMTAwOC41MiwzOS40MjVMOTEzLjY0LDQ3LjUyMUM4MTguNzYsNTUuNjE3LDYyOS4wMDEsNzEuODA4LDUzNC4xMjIsODQuMDcxQzQzOS4yNDIsOTYuMzMzLDQzOS4yNDIsMTA0LjY2Nyw0MzkuMjQyLDEwOC44MzNMNDM5LjI0MiwxMTMiPjwvcGF0aD48cGF0aCBzdHlsZT0iZmlsbDpub25lOyIgY2xhc3M9ImVkZ2UtdGhpY2tuZXNzLW5vcm1hbCBlZGdlLXBhdHRlcm4tc29saWQgZmxvd2NoYXJ0LWxpbmsgTFMtbWVjaGFuaWNhbF9lbmVyZ3kgTEUtcG90ZW50aWFsX2VuZXJneSIgaWQ9IkwtbWVjaGFuaWNhbF9lbmVyZ3ktcG90ZW50aWFsX2VuZXJneS0wIiBkPSJNMzk5LjU4MSwxNTJMMzkxLjEwNywxNTYuMTY3QzM4Mi42MzIsMTYwLjMzMywzNjUuNjgzLDE2OC42NjcsMzU3LjIwOSwxNzlDMzQ4LjczNCwxODkuMzMzLDM0OC43MzQsMjAxLjY2NywzNDguNzM0LDIwNy44MzNMMzQ4LjczNCwyMTQiPjwvcGF0aD48cGF0aCBzdHlsZT0iZmlsbDpub25lOyIgY2xhc3M9ImVkZ2UtdGhpY2tuZXNzLW5vcm1hbCBlZGdlLXBhdHRlcm4tc29saWQgZmxvd2NoYXJ0LWxpbmsgTFMtcG90ZW50aWFsX2VuZXJneSBMRS1ncmF2aXRhdGlvbmFsX3BvdGVudGlhbF9lbmVyZ3kiIGlkPSJMLXBvdGVudGlhbF9lbmVyZ3ktZ3Jhdml0YXRpb25hbF9wb3RlbnRpYWxfZW5lcmd5LTAiIGQ9Ik0yODMuNTczLDI1M0wyNjIuOTY2LDI1OS4xNjdDMjQyLjM2LDI2NS4zMzMsMjAxLjE0NywyNzcuNjY3LDE4MC41NCwyODhDMTU5LjkzNCwyOTguMzMzLDE1OS45MzQsMzA2LjY2NywxNTkuOTM0LDMxMC44MzNMMTU5LjkzNCwzMTUiPjwvcGF0aD48cGF0aCBzdHlsZT0iZmlsbDpub25lOyIgY2xhc3M9ImVkZ2UtdGhpY2tuZXNzLW5vcm1hbCBlZGdlLXBhdHRlcm4tc29saWQgZmxvd2NoYXJ0LWxpbmsgTFMtcG90ZW50aWFsX2VuZXJneSBMRS1lbGFzdGljX3BvdGVudGlhbF9lbmVyZ3kiIGlkPSJMLXBvdGVudGlhbF9lbmVyZ3ktZWxhc3RpY19wb3RlbnRpYWxfZW5lcmd5LTAiIGQ9Ik00MTMuODk2LDI1M0w0MzQuNTAyLDI1OS4xNjdDNDU1LjEwOSwyNjUuMzMzLDQ5Ni4zMjIsMjc3LjY2Nyw1MTYuOTI5LDI4OEM1MzcuNTM1LDI5OC4zMzMsNTM3LjUzNSwzMDYuNjY3LDUzNy41MzUsMzEwLjgzM0w1MzcuNTM1LDMxNSI+PC9wYXRoPjxwYXRoIHN0eWxlPSJmaWxsOm5vbmU7IiBjbGFzcz0iZWRnZS10aGlja25lc3Mtbm9ybWFsIGVkZ2UtcGF0dGVybi1zb2xpZCBmbG93Y2hhcnQtbGluayBMUy1tZWNoYW5pY2FsX2VuZXJneSBMRS1raW5ldGljX2VuZXJneSIgaWQ9IkwtbWVjaGFuaWNhbF9lbmVyZ3kta2luZXRpY19lbmVyZ3ktMCIgZD0iTTUxNS44MiwxNDYuNzcyTDU0Mi44NTIsMTUxLjgxQzU2OS44ODQsMTU2Ljg0OCw2MjMuOTQ4LDE2Ni45MjQsNjUwLjk4LDE3Ni4xMjlDNjc4LjAxMiwxODUuMzMzLDY3OC4wMTIsMTkzLjY2Nyw2NzguMDEyLDE5Ny44MzNMNjc4LjAxMiwyMDIiPjwvcGF0aD48cGF0aCBzdHlsZT0iZmlsbDpub25lOyIgY2xhc3M9ImVkZ2UtdGhpY2tuZXNzLW5vcm1hbCBlZGdlLXBhdHRlcm4tc29saWQgZmxvd2NoYXJ0LWxpbmsgTFMtZW5lcmd5IExFLWVudGhhbHB5IiBpZD0iTC1lbmVyZ3ktZW50aGFscHktMCIgZD0iTTExMDEuMzk1LDYzTDExMDEuMzk1LDY3LjE2N0MxMTAxLjM5NSw3MS4zMzMsMTEwMS4zOTUsNzkuNjY3LDExMDEuMzk1LDg4QzExMDEuMzk1LDk2LjMzMywxMTAxLjM5NSwxMDQuNjY3LDExMDEuMzk1LDEwOC44MzNMMTEwMS4zOTUsMTEzIj48L3BhdGg+PHBhdGggc3R5bGU9ImZpbGw6bm9uZTsiIGNsYXNzPSJlZGdlLXRoaWNrbmVzcy1ub3JtYWwgZWRnZS1wYXR0ZXJuLXNvbGlkIGZsb3djaGFydC1saW5rIExTLWVudGhhbHB5IExFLWludGVybmFsX2VuZXJneSIgaWQ9IkwtZW50aGFscHktaW50ZXJuYWxfZW5lcmd5LTAiIGQ9Ik0xMDYyLjY1MiwxNDMuMzkzTDEwNDIuNzMyLDE0OC45OTRDMTAyMi44MTEsMTU0LjU5Niw5ODIuOTcsMTY1Ljc5OCw5NjMuMDQ5LDE3Ny41NjZDOTQzLjEyOSwxODkuMzMzLDk0My4xMjksMjAxLjY2Nyw5NDMuMTI5LDIwNy44MzNMOTQzLjEyOSwyMTQiPjwvcGF0aD48cGF0aCBzdHlsZT0iZmlsbDpub25lOyIgY2xhc3M9ImVkZ2UtdGhpY2tuZXNzLW5vcm1hbCBlZGdlLXBhdHRlcm4tc29saWQgZmxvd2NoYXJ0LWxpbmsgTFMtaW50ZXJuYWxfZW5lcmd5IExFLUhlbG1ob2x0el9lbmVyZ3kiIGlkPSJMLWludGVybmFsX2VuZXJneS1IZWxtaG9sdHpfZW5lcmd5LTAiIGQ9Ik05NDMuMTI5LDI1M0w5NDMuMTI5LDI1OS4xNjdDOTQzLjEyOSwyNjUuMzMzLDk0My4xMjksMjc3LjY2Nyw5NDMuMTI5LDI5MEM5NDMuMTI5LDMwMi4zMzMsOTQzLjEyOSwzMTQuNjY3LDk0My4xMjksMzIwLjgzM0w5NDMuMTI5LDMyNyI+PC9wYXRoPjxwYXRoIHN0eWxlPSJmaWxsOm5vbmU7IiBjbGFzcz0iZWRnZS10aGlja25lc3Mtbm9ybWFsIGVkZ2UtcGF0dGVybi1zb2xpZCBmbG93Y2hhcnQtbGluayBMUy1lbnRoYWxweSBMRS1HaWJic19lbmVyZ3kiIGlkPSJMLWVudGhhbHB5LUdpYmJzX2VuZXJneS0wIiBkPSJNMTE0MC4xMzcsMTQzLjM5M0wxMTYwLjA1NywxNDguOTk0QzExNzkuOTc4LDE1NC41OTYsMTIxOS44MTksMTY1Ljc5OCwxMjM5Ljc0LDE3Ny41NjZDMTI1OS42NiwxODkuMzMzLDEyNTkuNjYsMjAxLjY2NywxMjU5LjY2LDIwNy44MzNMMTI1OS42NiwyMTQiPjwvcGF0aD48cGF0aCBzdHlsZT0iZmlsbDpub25lOyIgY2xhc3M9ImVkZ2UtdGhpY2tuZXNzLW5vcm1hbCBlZGdlLXBhdHRlcm4tc29saWQgZmxvd2NoYXJ0LWxpbmsgTFMtZW5lcmd5IExFLWFjdGl2ZV9lbmVyZ3kiIGlkPSJMLWVuZXJneS1hY3RpdmVfZW5lcmd5LTAiIGQ9Ik0xMTgzLjA3NCw2M0wxMTkzLjg3OCw2Ny4xNjdDMTIwNC42ODIsNzEuMzMzLDEyMjYuMjksNzkuNjY3LDEyMzcuMDk0LDg4QzEyNDcuODk4LDk2LjMzMywxMjQ3Ljg5OCwxMDQuNjY3LDEyNDcuODk4LDEwOC44MzNMMTI0Ny44OTgsMTEzIj48L3BhdGg+PC9nPjxnIGNsYXNzPSJlZGdlTGFiZWxzIj48ZyBjbGFzcz0iZWRnZUxhYmVsIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLCAwKSIgY2xhc3M9ImxhYmVsIj48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjAiIHdpZHRoPSIwIj48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+PHNwYW4gY2xhc3M9ImVkZ2VMYWJlbCI+PC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIGNsYXNzPSJlZGdlTGFiZWwiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAsIDApIiBjbGFzcz0ibGFiZWwiPjxmb3JlaWduT2JqZWN0IGhlaWdodD0iMCIgd2lkdGg9IjAiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0iZWRnZUxhYmVsIj48L3NwYW4+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+PGcgY2xhc3M9ImVkZ2VMYWJlbCI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCwgMCkiIGNsYXNzPSJsYWJlbCI+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSIwIiB3aWR0aD0iMCI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPjxzcGFuIGNsYXNzPSJlZGdlTGFiZWwiPjwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48ZyBjbGFzcz0iZWRnZUxhYmVsIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLCAwKSIgY2xhc3M9ImxhYmVsIj48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjAiIHdpZHRoPSIwIj48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+PHNwYW4gY2xhc3M9ImVkZ2VMYWJlbCI+PC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIGNsYXNzPSJlZGdlTGFiZWwiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAsIDApIiBjbGFzcz0ibGFiZWwiPjxmb3JlaWduT2JqZWN0IGhlaWdodD0iMCIgd2lkdGg9IjAiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0iZWRnZUxhYmVsIj48L3NwYW4+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+PGcgY2xhc3M9ImVkZ2VMYWJlbCI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCwgMCkiIGNsYXNzPSJsYWJlbCI+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSIwIiB3aWR0aD0iMCI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPjxzcGFuIGNsYXNzPSJlZGdlTGFiZWwiPjwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48ZyBjbGFzcz0iZWRnZUxhYmVsIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLCAwKSIgY2xhc3M9ImxhYmVsIj48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjAiIHdpZHRoPSIwIj48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+PHNwYW4gY2xhc3M9ImVkZ2VMYWJlbCI+PC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIGNsYXNzPSJlZGdlTGFiZWwiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAsIDApIiBjbGFzcz0ibGFiZWwiPjxmb3JlaWduT2JqZWN0IGhlaWdodD0iMCIgd2lkdGg9IjAiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0iZWRnZUxhYmVsIj48L3NwYW4+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+PGcgY2xhc3M9ImVkZ2VMYWJlbCI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCwgMCkiIGNsYXNzPSJsYWJlbCI+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSIwIiB3aWR0aD0iMCI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPjxzcGFuIGNsYXNzPSJlZGdlTGFiZWwiPjwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48ZyBjbGFzcz0iZWRnZUxhYmVsIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLCAwKSIgY2xhc3M9ImxhYmVsIj48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjAiIHdpZHRoPSIwIj48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+PHNwYW4gY2xhc3M9ImVkZ2VMYWJlbCI+PC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjwvZz48ZyBjbGFzcz0ibm9kZXMiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDExMDEuMzk0NTMxMjUsIDMxLjUpIiBpZD0iZmxvd2NoYXJ0LWVuZXJneS0xNDMiIGNsYXNzPSJub2RlIGRlZmF1bHQgZGVmYXVsdCBmbG93Y2hhcnQtbGFiZWwiPjxyZWN0IGhlaWdodD0iNjMiIHdpZHRoPSIxODUuNzUiIHk9Ii0zMS41IiB4PSItOTIuODc1IiByeT0iMCIgcng9IjAiIHN0eWxlPSIiIGNsYXNzPSJiYXNpYyBsYWJlbC1jb250YWluZXIiPjwvcmVjdD48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtODUuMzc1LCAtMjQpIiBzdHlsZT0iIiBjbGFzcz0ibGFiZWwiPjxyZWN0PjwvcmVjdD48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjQ4IiB3aWR0aD0iMTcwLjc1Ij48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+PHNwYW4gY2xhc3M9Im5vZGVMYWJlbCI+ZW5lcmd5PGJyLz4obWFzcyAqIGxlbmd0aDxzdXA+Mjwvc3VwPiAvIHRpbWU8c3VwPjI8L3N1cD4pPC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQzOS4yNDIxODc1LCAxMzIuNSkiIGlkPSJmbG93Y2hhcnQtbWVjaGFuaWNhbF9lbmVyZ3ktMTQ1IiBjbGFzcz0ibm9kZSBkZWZhdWx0IGRlZmF1bHQgZmxvd2NoYXJ0LWxhYmVsIj48cmVjdCBoZWlnaHQ9IjM5IiB3aWR0aD0iMTUzLjE1NjI1IiB5PSItMTkuNSIgeD0iLTc2LjU3ODEyNSIgcnk9IjAiIHJ4PSIwIiBzdHlsZT0iIiBjbGFzcz0iYmFzaWMgbGFiZWwtY29udGFpbmVyIj48L3JlY3Q+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTY5LjA3ODEyNSwgLTEyKSIgc3R5bGU9IiIgY2xhc3M9ImxhYmVsIj48cmVjdD48L3JlY3Q+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSIyNCIgd2lkdGg9IjEzOC4xNTYyNSI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPjxzcGFuIGNsYXNzPSJub2RlTGFiZWwiPm1lY2hhbmljYWxfZW5lcmd5PC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDM0OC43MzQzNzUsIDIzMy41KSIgaWQ9ImZsb3djaGFydC1wb3RlbnRpYWxfZW5lcmd5LTE0NyIgY2xhc3M9Im5vZGUgZGVmYXVsdCBkZWZhdWx0IGZsb3djaGFydC1sYWJlbCI+PHJlY3QgaGVpZ2h0PSIzOSIgd2lkdGg9IjEzNy4wNzAzMTI1IiB5PSItMTkuNSIgeD0iLTY4LjUzNTE1NjI1IiByeT0iMCIgcng9IjAiIHN0eWxlPSIiIGNsYXNzPSJiYXNpYyBsYWJlbC1jb250YWluZXIiPjwvcmVjdD48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNjEuMDM1MTU2MjUsIC0xMikiIHN0eWxlPSIiIGNsYXNzPSJsYWJlbCI+PHJlY3Q+PC9yZWN0Pjxmb3JlaWduT2JqZWN0IGhlaWdodD0iMjQiIHdpZHRoPSIxMjIuMDcwMzEyNSI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPjxzcGFuIGNsYXNzPSJub2RlTGFiZWwiPnBvdGVudGlhbF9lbmVyZ3k8L3NwYW4+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTU5LjkzMzU5Mzc1LCAzNDYuNSkiIGlkPSJmbG93Y2hhcnQtZ3Jhdml0YXRpb25hbF9wb3RlbnRpYWxfZW5lcmd5LTE0OSIgY2xhc3M9Im5vZGUgZGVmYXVsdCBkZWZhdWx0IGZsb3djaGFydC1sYWJlbCI+PHJlY3QgaGVpZ2h0PSI2MyIgd2lkdGg9IjMxOS44NjcxODc1IiB5PSItMzEuNSIgeD0iLTE1OS45MzM1OTM3NSIgcnk9IjAiIHJ4PSIwIiBzdHlsZT0iIiBjbGFzcz0iYmFzaWMgbGFiZWwtY29udGFpbmVyIj48L3JlY3Q+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTE1Mi40MzM1OTM3NSwgLTI0KSIgc3R5bGU9IiIgY2xhc3M9ImxhYmVsIj48cmVjdD48L3JlY3Q+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSI0OCIgd2lkdGg9IjMwNC44NjcxODc1Ij48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+PHNwYW4gY2xhc3M9Im5vZGVMYWJlbCI+Z3Jhdml0YXRpb25hbF9wb3RlbnRpYWxfZW5lcmd5PGJyLz4obWFzcyAqIGFjY2VsZXJhdGlvbl9vZl9mcmVlX2ZhbGwgKiBoZWlnaHQpPC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDUzNy41MzUxNTYyNSwgMzQ2LjUpIiBpZD0iZmxvd2NoYXJ0LWVsYXN0aWNfcG90ZW50aWFsX2VuZXJneS0xNTEiIGNsYXNzPSJub2RlIGRlZmF1bHQgZGVmYXVsdCBmbG93Y2hhcnQtbGFiZWwiPjxyZWN0IGhlaWdodD0iNjMiIHdpZHRoPSIzMzUuMzM1OTM3NSIgeT0iLTMxLjUiIHg9Ii0xNjcuNjY3OTY4NzUiIHJ5PSIwIiByeD0iMCIgc3R5bGU9IiIgY2xhc3M9ImJhc2ljIGxhYmVsLWNvbnRhaW5lciI+PC9yZWN0PjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xNjAuMTY3OTY4NzUsIC0yNCkiIHN0eWxlPSIiIGNsYXNzPSJsYWJlbCI+PHJlY3Q+PC9yZWN0Pjxmb3JlaWduT2JqZWN0IGhlaWdodD0iNDgiIHdpZHRoPSIzMjAuMzM1OTM3NSI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPjxzcGFuIGNsYXNzPSJub2RlTGFiZWwiPmVsYXN0aWNfcG90ZW50aWFsX2VuZXJneTxici8+KHNwcmluZ19jb25zdGFudCAqIGFtb3VudF9vZl9jb21wcmVzc2lvbjxzdXA+Mjwvc3VwPik8L3NwYW4+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNjc4LjAxMTcxODc1LCAyMzMuNSkiIGlkPSJmbG93Y2hhcnQta2luZXRpY19lbmVyZ3ktMTUzIiBjbGFzcz0ibm9kZSBkZWZhdWx0IGRlZmF1bHQgZmxvd2NoYXJ0LWxhYmVsIj48cmVjdCBoZWlnaHQ9IjYzIiB3aWR0aD0iMTI0Ljk2MDkzNzUiIHk9Ii0zMS41IiB4PSItNjIuNDgwNDY4NzUiIHJ5PSIwIiByeD0iMCIgc3R5bGU9IiIgY2xhc3M9ImJhc2ljIGxhYmVsLWNvbnRhaW5lciI+PC9yZWN0PjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC01NC45ODA0Njg3NSwgLTI0KSIgc3R5bGU9IiIgY2xhc3M9ImxhYmVsIj48cmVjdD48L3JlY3Q+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSI0OCIgd2lkdGg9IjEwOS45NjA5Mzc1Ij48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+PHNwYW4gY2xhc3M9Im5vZGVMYWJlbCI+a2luZXRpY19lbmVyZ3k8YnIvPihtYXNzICogc3BlZWQ8c3VwPjI8L3N1cD4pPC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDExMDEuMzk0NTMxMjUsIDEzMi41KSIgaWQ9ImZsb3djaGFydC1lbnRoYWxweS0xNTUiIGNsYXNzPSJub2RlIGRlZmF1bHQgZGVmYXVsdCBmbG93Y2hhcnQtbGFiZWwiPjxyZWN0IGhlaWdodD0iMzkiIHdpZHRoPSI3Ny40ODQzNzUiIHk9Ii0xOS41IiB4PSItMzguNzQyMTg3NSIgcnk9IjAiIHJ4PSIwIiBzdHlsZT0iIiBjbGFzcz0iYmFzaWMgbGFiZWwtY29udGFpbmVyIj48L3JlY3Q+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTMxLjI0MjE4NzUsIC0xMikiIHN0eWxlPSIiIGNsYXNzPSJsYWJlbCI+PHJlY3Q+PC9yZWN0Pjxmb3JlaWduT2JqZWN0IGhlaWdodD0iMjQiIHdpZHRoPSI2Mi40ODQzNzUiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0ibm9kZUxhYmVsIj5lbnRoYWxweTwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSg5NDMuMTI4OTA2MjUsIDIzMy41KSIgaWQ9ImZsb3djaGFydC1pbnRlcm5hbF9lbmVyZ3ktMTU3IiBjbGFzcz0ibm9kZSBkZWZhdWx0IGRlZmF1bHQgZmxvd2NoYXJ0LWxhYmVsIj48cmVjdCBoZWlnaHQ9IjM5IiB3aWR0aD0iMzA1LjI3MzQzNzUiIHk9Ii0xOS41IiB4PSItMTUyLjYzNjcxODc1IiByeT0iMCIgcng9IjAiIHN0eWxlPSIiIGNsYXNzPSJiYXNpYyBsYWJlbC1jb250YWluZXIiPjwvcmVjdD48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTQ1LjEzNjcxODc1LCAtMTIpIiBzdHlsZT0iIiBjbGFzcz0ibGFiZWwiPjxyZWN0PjwvcmVjdD48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjI0IiB3aWR0aD0iMjkwLjI3MzQzNzUiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0ibm9kZUxhYmVsIj5pbnRlcm5hbF9lbmVyZ3ksIHRoZXJtb2R5bmFtaWNfZW5lcmd5PC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDk0My4xMjg5MDYyNSwgMzQ2LjUpIiBpZD0iZmxvd2NoYXJ0LUhlbG1ob2x0el9lbmVyZ3ktMTU5IiBjbGFzcz0ibm9kZSBkZWZhdWx0IGRlZmF1bHQgZmxvd2NoYXJ0LWxhYmVsIj48cmVjdCBoZWlnaHQ9IjM5IiB3aWR0aD0iMjk0Ljc3MzQzNzUiIHk9Ii0xOS41IiB4PSItMTQ3LjM4NjcxODc1IiByeT0iMCIgcng9IjAiIHN0eWxlPSIiIGNsYXNzPSJiYXNpYyBsYWJlbC1jb250YWluZXIiPjwvcmVjdD48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTM5Ljg4NjcxODc1LCAtMTIpIiBzdHlsZT0iIiBjbGFzcz0ibGFiZWwiPjxyZWN0PjwvcmVjdD48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjI0IiB3aWR0aD0iMjc5Ljc3MzQzNzUiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0ibm9kZUxhYmVsIj5IZWxtaG9sdHpfZW5lcmd5LCBIZWxtaG9sdHpfZnVuY3Rpb248L3NwYW4+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTI1OS42NjAxNTYyNSwgMjMzLjUpIiBpZD0iZmxvd2NoYXJ0LUdpYmJzX2VuZXJneS0xNjEiIGNsYXNzPSJub2RlIGRlZmF1bHQgZGVmYXVsdCBmbG93Y2hhcnQtbGFiZWwiPjxyZWN0IGhlaWdodD0iMzkiIHdpZHRoPSIyMjcuNzg5MDYyNSIgeT0iLTE5LjUiIHg9Ii0xMTMuODk0NTMxMjUiIHJ5PSIwIiByeD0iMCIgc3R5bGU9IiIgY2xhc3M9ImJhc2ljIGxhYmVsLWNvbnRhaW5lciI+PC9yZWN0PjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xMDYuMzk0NTMxMjUsIC0xMikiIHN0eWxlPSIiIGNsYXNzPSJsYWJlbCI+PHJlY3Q+PC9yZWN0Pjxmb3JlaWduT2JqZWN0IGhlaWdodD0iMjQiIHdpZHRoPSIyMTIuNzg5MDYyNSI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPjxzcGFuIGNsYXNzPSJub2RlTGFiZWwiPkdpYmJzX2VuZXJneSwgR2liYnNfZnVuY3Rpb248L3NwYW4+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTI0Ny44OTg0Mzc1LCAxMzIuNSkiIGlkPSJmbG93Y2hhcnQtYWN0aXZlX2VuZXJneS0xNjMiIGNsYXNzPSJub2RlIGRlZmF1bHQgZGVmYXVsdCBmbG93Y2hhcnQtbGFiZWwiPjxyZWN0IGhlaWdodD0iMzkiIHdpZHRoPSIxMTUuNTIzNDM3NSIgeT0iLTE5LjUiIHg9Ii01Ny43NjE3MTg3NSIgcnk9IjAiIHJ4PSIwIiBzdHlsZT0iIiBjbGFzcz0iYmFzaWMgbGFiZWwtY29udGFpbmVyIj48L3JlY3Q+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTUwLjI2MTcxODc1LCAtMTIpIiBzdHlsZT0iIiBjbGFzcz0ibGFiZWwiPjxyZWN0PjwvcmVjdD48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjI0IiB3aWR0aD0iMTAwLjUyMzQzNzUiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0ibm9kZUxhYmVsIj5hY3RpdmVfZW5lcmd5PC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjwvZz48L2c+PC9nPjwvc3ZnPg==" /></p>
<p>Notice, that even though all of those quantities have the same
dimension and can be expressed in the same units, they have different
quantity equations used to create them implicitly:</p>
<ul>
<li><p><code class="sourceCode default">energy</code> is the most
generic one and thus can be created from base quantities of
<code class="sourceCode default">mass</code>,
<code class="sourceCode default">length</code>, and
<code class="sourceCode default">time</code>. As those are also the
roots of quantities of their kinds and all other quantities are
implicitly convertible to them, it means that an
<code class="sourceCode default">energy</code> can be implicitly
constructed from any quantity having proper powers of <em>mass</em>,
<em>length</em>, and <em>time</em>.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>implicitly_convertible<span class="op">(</span>isq<span class="op">::</span>mass <span class="op">*</span> pow<span class="op">&lt;</span><span class="dv">2</span><span class="op">&gt;(</span>isq<span class="op">::</span>length<span class="op">)</span> <span class="op">/</span> pow<span class="op">&lt;</span><span class="dv">2</span><span class="op">&gt;(</span>isq<span class="op">::</span>time<span class="op">)</span>, isq<span class="op">::</span>energy<span class="op">))</span>;</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>implicitly_convertible<span class="op">(</span>isq<span class="op">::</span>mass <span class="op">*</span> pow<span class="op">&lt;</span><span class="dv">2</span><span class="op">&gt;(</span>isq<span class="op">::</span>height<span class="op">)</span> <span class="op">/</span> pow<span class="op">&lt;</span><span class="dv">2</span><span class="op">&gt;(</span>isq<span class="op">::</span>time<span class="op">)</span>, isq<span class="op">::</span>energy<span class="op">))</span>;</span></code></pre></div></li>
<li><p><code class="sourceCode default">mechanical_energy</code> is a
more “specialized” quantity than
<code class="sourceCode default">energy</code> (not every
<code class="sourceCode default">energy</code> is a
<code class="sourceCode default">mechanical_energy</code>). It is why an
explicit cast is needed to convert from either
<code class="sourceCode default">energy</code> or the results of its
quantity equation.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(!</span>implicitly_convertible<span class="op">(</span>isq<span class="op">::</span>energy, isq<span class="op">::</span>mechanical_energy<span class="op">))</span>;</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>explicitly_convertible<span class="op">(</span>isq<span class="op">::</span>energy, isq<span class="op">::</span>mechanical_energy<span class="op">))</span>;</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(!</span>implicitly_convertible<span class="op">(</span>isq<span class="op">::</span>mass <span class="op">*</span> pow<span class="op">&lt;</span><span class="dv">2</span><span class="op">&gt;(</span>isq<span class="op">::</span>length<span class="op">)</span> <span class="op">/</span> pow<span class="op">&lt;</span><span class="dv">2</span><span class="op">&gt;(</span>isq<span class="op">::</span>time<span class="op">)</span>, isq<span class="op">::</span>mechanical_energy<span class="op">))</span>;</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>explicitly_convertible<span class="op">(</span>isq<span class="op">::</span>mass <span class="op">*</span> pow<span class="op">&lt;</span><span class="dv">2</span><span class="op">&gt;(</span>isq<span class="op">::</span>length<span class="op">)</span> <span class="op">/</span> pow<span class="op">&lt;</span><span class="dv">2</span><span class="op">&gt;(</span>isq<span class="op">::</span>time<span class="op">)</span>, isq<span class="op">::</span>mechanical_energy<span class="op">))</span>;</span></code></pre></div></li>
<li><p><code class="sourceCode default">gravitational_potential_energy</code>
is not only even more specialized one but additionally, it is special in
a way that it provides its own “constrained” quantity equation. Maybe
not every <code class="sourceCode default">mass * pow&lt;2&gt;(length) / pow&lt;2&gt;(time)</code>
is a
<code class="sourceCode default">gravitational_potential_energy</code>,
but every <code class="sourceCode default">mass * acceleration_of_free_fall * height</code>
is.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(!</span>implicitly_convertible<span class="op">(</span>isq<span class="op">::</span>energy, gravitational_potential_energy<span class="op">))</span>;</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>explicitly_convertible<span class="op">(</span>isq<span class="op">::</span>energy, gravitational_potential_energy<span class="op">))</span>;</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(!</span>implicitly_convertible<span class="op">(</span>isq<span class="op">::</span>mass <span class="op">*</span> pow<span class="op">&lt;</span><span class="dv">2</span><span class="op">&gt;(</span>isq<span class="op">::</span>length<span class="op">)</span> <span class="op">/</span> pow<span class="op">&lt;</span><span class="dv">2</span><span class="op">&gt;(</span>isq<span class="op">::</span>time<span class="op">)</span>, gravitational_potential_energy<span class="op">))</span>;</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>explicitly_convertible<span class="op">(</span>isq<span class="op">::</span>mass <span class="op">*</span> pow<span class="op">&lt;</span><span class="dv">2</span><span class="op">&gt;(</span>isq<span class="op">::</span>length<span class="op">)</span> <span class="op">/</span> pow<span class="op">&lt;</span><span class="dv">2</span><span class="op">&gt;(</span>isq<span class="op">::</span>time<span class="op">)</span>, gravitational_potential_energy<span class="op">))</span>;</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>implicitly_convertible<span class="op">(</span>isq<span class="op">::</span>mass <span class="op">*</span> isq<span class="op">::</span>acceleration_of_free_fall <span class="op">*</span> isq<span class="op">::</span>height, gravitational_potential_energy<span class="op">))</span>;</span></code></pre></div></li>
</ul>
<h3 data-number="13.1.6" id="modeling-a-quantity-kind"><span class="header-section-number">13.1.6</span> Modeling a quantity kind<a href="#modeling-a-quantity-kind" class="self-link"></a></h3>
<p>In the physical units library, we also need an abstraction describing
an entire family of quantities of the same kind. Such quantities have
not only the same dimension but also can be expressed in the same
units.</p>
<p>To annotate a quantity to represent its kind (and not just a
hierarchy tree’s root quantity), we introduced a
<code class="sourceCode default">kind_of&lt;&gt;</code> specifier. For
example, to express any quantity of <em>length</em>, we need to specify
<code class="sourceCode default">kind_of&lt;isq::length&gt;</code>. That
entity behaves as any quantity of its kind. This means that it is
implicitly convertible to any quantity in a tree:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(!</span>implicitly_convertible<span class="op">(</span>isq<span class="op">::</span>length, isq<span class="op">::</span>height<span class="op">))</span>;</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>implicitly_convertible<span class="op">(</span>kind_of<span class="op">&lt;</span>isq<span class="op">::</span>length<span class="op">&gt;</span>, isq<span class="op">::</span>height<span class="op">))</span>;</span></code></pre></div>
<p>Additionally, the result of operations on quantity kinds is also a
quantity kind:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>same_type<span class="op">&lt;</span>kind_of<span class="op">&lt;</span>isq<span class="op">::</span>length<span class="op">&gt;</span> <span class="op">/</span> kind_of<span class="op">&lt;</span>isq<span class="op">::</span>time<span class="op">&gt;</span>, kind_of<span class="op">&lt;</span>isq<span class="op">::</span>length <span class="op">/</span> isq<span class="op">::</span>time<span class="op">&gt;&gt;)</span>;</span></code></pre></div>
<p>However, if at least one equation’s operand is not a quantity kind,
the result becomes a “strong” quantity where all the kinds are converted
to the hierarchy tree’s root quantities:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(!</span>same_type<span class="op">&lt;</span>kind_of<span class="op">&lt;</span>isq<span class="op">::</span>length<span class="op">&gt;</span> <span class="op">/</span> isq<span class="op">::</span>time, kind_of<span class="op">&lt;</span>isq<span class="op">::</span>length <span class="op">/</span> isq<span class="op">::</span>time<span class="op">&gt;&gt;)</span>;</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>same_type<span class="op">&lt;</span>kind_of<span class="op">&lt;</span>isq<span class="op">::</span>length<span class="op">&gt;</span> <span class="op">/</span> isq<span class="op">::</span>time, isq<span class="op">::</span>length <span class="op">/</span> isq<span class="op">::</span>time<span class="op">&gt;)</span>;</span></code></pre></div>
<p>Please note that only a root quantity from the hierarchy tree or the
one marked with <code class="sourceCode default">is_kind</code>
specifier in the <code class="sourceCode default">quantity_spec</code>
definition can be put as a template parameter to the
<code class="sourceCode default">kind_of</code> specifier. For example,
<code class="sourceCode default">kind_of&lt;isq::width&gt;</code> will
fail to compile. However, we can call
<code class="sourceCode default">get_kind(q)</code> to obtain a kind of
any quantity:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>get_kind<span class="op">(</span>isq<span class="op">::</span>width<span class="op">)</span> <span class="op">==</span> kind_of<span class="op">&lt;</span>isq<span class="op">::</span>length<span class="op">&gt;)</span>;</span></code></pre></div>
<h2 data-number="13.2" id="systems-of-units"><span class="header-section-number">13.2</span> Systems of units<a href="#systems-of-units" class="self-link"></a></h2>
<p>Modeling a system of units is the most important feature and a
selling point of every physical units library. Thanks to that, the
library can protect users from performing invalid operations on
quantities and provide automated conversion factors between various
compatible units.</p>
<p>Probably all the libraries in the wild model the <span class="citation" data-cites="SI">[<a href="#ref-SI" role="doc-biblioref">SI</a>]</span> or at least most of it (refer to <a href="#si-units-of-quantities-of-the-same-dimension-but-different-kinds">SI
units of quantities of the same dimension but different kinds</a> for
more details) and many of them provide support for additional units
belonging to various other systems (e.g., imperial).</p>
<h3 data-number="13.2.1" id="systems-of-units-are-based-on-systems-of-quantities"><span class="header-section-number">13.2.1</span> Systems of units are based
on systems of quantities<a href="#systems-of-units-are-based-on-systems-of-quantities" class="self-link"></a></h3>
<p>Systems of quantities specify a set of quantities and equations
relating to those quantities. Those equations do not take any unit or a
numerical representation into account at all. In order to create a
quantity, we need to add those missing pieces of information. This is
where a system of units kicks in.</p>
<p>The <span class="citation" data-cites="SI">[<a href="#ref-SI" role="doc-biblioref">SI</a>]</span> is explicitly stated to be based on
the ISQ. Among others, it defines seven base units, one for each base
quantity. In the library, this is expressed by associating a quantity
kind to a unit being defined:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> metre <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;m&quot;</span>, kind_of<span class="op">&lt;</span>isq<span class="op">::</span>length<span class="op">&gt;&gt;</span> <span class="op">{}</span> metre;</span></code></pre></div>
<p>The
<code class="sourceCode default">kind_of&lt;isq::length&gt;</code> above
states explicitly that this unit has an associated quantity kind. In
other words, <code class="sourceCode default">si::metre</code> (and
scaled units based on it) can be used to express the amount of any
quantity of kind <em>length</em>.</p>
<p>Associated units are so useful and common in the library that they
got their own <a href="#AssociatedUnit-concept"><code class="sourceCode default">AssociatedUnit&lt;T&gt;</code></a>
concept to improve the interfaces.</p>
<p>Please note that for some systems of units (e.g., natural units), a
unit may not have an associated quantity type. For example, if we define
the speed of light constant as
<code class="sourceCode default">c = 1</code>, we can define a system
where both <em>length</em> and <em>time</em> will be measured in
seconds, and <em>speed</em> will be a quantity measured with the unit
<code class="sourceCode default">one</code>. In such case, the
definition will look as follows:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> second <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;s&quot;</span><span class="op">&gt;</span> <span class="op">{}</span> second;</span></code></pre></div>
<h3 data-number="13.2.2" id="units-compose"><span class="header-section-number">13.2.2</span> Units compose<a href="#units-compose" class="self-link"></a></h3>
<p>One of the strongest points of the <span class="citation" data-cites="SI">[<a href="#ref-SI" role="doc-biblioref">SI</a>]</span>
system is that its units compose. This allows providing thousands of
different units for hundreds of various quantities with a really small
set of predefined units and prefixes. For example, one can write:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>si<span class="op">::</span>metre <span class="op">/</span> si<span class="op">::</span>second<span class="op">&gt;</span> q;</span></code></pre></div>
<p>to express a quantity of speed. The resulting quantity type is
implicitly inferred from the unit equation by repeating exactly the same
operations on the associated quantity kinds.</p>
<p>Also, as units are regular values, we can easily provide a helper
ad-hoc unit with:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="kw">constexpr</span> <span class="kw">auto</span> mps <span class="op">=</span> si<span class="op">::</span>metre <span class="op">/</span> si<span class="op">::</span>second;</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>mps<span class="op">&gt;</span> q;</span></code></pre></div>
<h3 data-number="13.2.3" id="many-shades-of-the-same-unit"><span class="header-section-number">13.2.3</span> Many shades of the same
unit<a href="#many-shades-of-the-same-unit" class="self-link"></a></h3>
<p>The <span class="citation" data-cites="SI">[<a href="#ref-SI" role="doc-biblioref">SI</a>]</span> provides the names for 22 common
coherent units of 22 derived quantities.</p>
<p>Each such named derived unit is a result of a specific predefined
unit equation. For example, a unit of power quantity is defined as:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> watt <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;W&quot;</span>, joule <span class="op">/</span> second<span class="op">&gt;</span> <span class="op">{}</span> watt;</span></code></pre></div>
<p>However, a power quantity can be expressed in other units as well.
For example, the following:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> q1 <span class="op">=</span> <span class="dv">42</span> <span class="op">*</span> W;</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> q1 <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>;</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> q1<span class="op">.</span>in<span class="op">(</span>J <span class="op">/</span> s<span class="op">)</span> <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>;</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> q1<span class="op">.</span>in<span class="op">(</span>N <span class="op">*</span> m <span class="op">/</span> s<span class="op">)</span> <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>;</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> q1<span class="op">.</span>in<span class="op">(</span>kg <span class="op">*</span> m2 <span class="op">/</span> s3<span class="op">)</span> <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>;</span></code></pre></div>
<p>prints:</p>
<pre class="text"><code>42 W
42 J/s
42 N m/s
42 kg m²/s³</code></pre>
<p>All of the above quantities are equivalent and mean exactly the
same.</p>
<h3 data-number="13.2.4" id="constraining-a-derived-unit-to-work-only-with-a-specific-derived-quantity"><span class="header-section-number">13.2.4</span> Constraining a derived unit
to work only with a specific derived quantity<a href="#constraining-a-derived-unit-to-work-only-with-a-specific-derived-quantity" class="self-link"></a></h3>
<p>Some derived units are valid only for specific derived quantities.
For example, <span class="citation" data-cites="SI">[<a href="#ref-SI" role="doc-biblioref">SI</a>]</span> specifies both hertz and becquerel
derived units with the same unit equation <span class="math inline">\(s^{-1}\)</span>. However, it also explicitly
states:</p>
<blockquote>
<p>The hertz shall only be used for periodic phenomena and the becquerel
shall only be used for stochastic processes in activity referred to a
radionuclide.</p>
</blockquote>
<p>This is why it is important for the library to allow constraining
such units to be used only with a specific quantity kind:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> hertz <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;Hz&quot;</span>, one <span class="op">/</span> second, kind_of<span class="op">&lt;</span>isq<span class="op">::</span>frequency<span class="op">&gt;&gt;</span> <span class="op">{}</span> hertz;</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> becquerel <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;Bq&quot;</span>, one <span class="op">/</span> second, kind_of<span class="op">&lt;</span>isq<span class="op">::</span>activity<span class="op">&gt;&gt;</span> <span class="op">{}</span> becquerel;</span></code></pre></div>
<p>With the above, <code class="sourceCode default">hertz</code> can
only be used for <em>frequencies</em>, while
<code class="sourceCode default">becquerel</code> should only be used
for quantities of <em>activity</em>. This means that the following
equation will not compile, improving the type-safety of the library:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> q <span class="op">=</span> <span class="dv">1</span> <span class="op">*</span> Hz <span class="op">+</span> <span class="dv">1</span> <span class="op">*</span> Bq;   <span class="co">// Fails to compile</span></span></code></pre></div>
<h3 data-number="13.2.5" id="prefixed-units"><span class="header-section-number">13.2.5</span> Prefixed units<a href="#prefixed-units" class="self-link"></a></h3>
<p>Besides named units, the <a href="../../appendix/glossary.md#si">SI</a> specifies also 24 prefixes
(all being a power of <code class="sourceCode default">10</code>) that
can be prepended to all named units to obtain various scaled versions of
them.</p>
<p>Implementation of <code class="sourceCode default">std::ratio</code>
provided by all major compilers is able to express only 16 of them. This
is why, we had to find an alternative way to represent a unit’s
magnitude in a more flexible way.</p>
<p>Each prefix is implemented as:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span>PrefixableUnit U<span class="op">&gt;</span> <span class="kw">struct</span> quecto_ <span class="op">:</span> prefixed_unit<span class="op">&lt;</span><span class="st">&quot;q&quot;</span>, mag_power<span class="op">&lt;</span><span class="dv">10</span>, <span class="op">-</span><span class="dv">30</span><span class="op">&gt;</span>, U<span class="op">{}&gt;</span> <span class="op">{}</span>;</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span>PrefixableUnit <span class="kw">auto</span> U<span class="op">&gt;</span> <span class="kw">inline</span> <span class="kw">constexpr</span> quecto_<span class="op">&lt;</span>std<span class="op">::</span>remove_const_t<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>U<span class="op">)&gt;&gt;</span> quecto;</span></code></pre></div>
<p>and then a unit can be prefixed in the following way:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">auto</span> qm <span class="op">=</span> quecto<span class="op">&lt;</span>metre<span class="op">&gt;</span>;</span></code></pre></div>
<p>The usage of <code class="sourceCode default">mag_power</code> not
only enables providing support for SI prefixes, but it can also
efficiently represent any rational magnitude. For example, <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span> (part 13) prefixes used
in the IT industry can be implemented as:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span>PrefixableUnit U<span class="op">&gt;</span> <span class="kw">struct</span> yobi_ <span class="op">:</span> prefixed_unit<span class="op">&lt;</span><span class="st">&quot;Yi&quot;</span>, mag_power<span class="op">&lt;</span><span class="dv">2</span>, <span class="dv">80</span><span class="op">&gt;</span>, U<span class="op">{}&gt;</span> <span class="op">{}</span>;</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span>PrefixableUnit <span class="kw">auto</span> U<span class="op">&gt;</span> <span class="kw">inline</span> <span class="kw">constexpr</span> yobi_<span class="op">&lt;</span>std<span class="op">::</span>remove_const_t<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>U<span class="op">)&gt;&gt;</span> yobi;</span></code></pre></div>
<p><em>Please note that to improve the readability of generated types
that are exposed in compiler errors and debugger, the variable template
takes an NTTP and converts it to its type before passing the argument to
the associated class template.</em></p>
<h3 data-number="13.2.6" id="scaled-units"><span class="header-section-number">13.2.6</span> Scaled units<a href="#scaled-units" class="self-link"></a></h3>
<p>In the <span class="citation" data-cites="SI">[<a href="#ref-SI" role="doc-biblioref">SI</a>]</span>, all units are either base or
derived units or prefixed versions of those. However, those are not the
only options possible.</p>
<p>For example, there is a list of off-system units accepted for use
with <span class="citation" data-cites="SI">[<a href="#ref-SI" role="doc-biblioref">SI</a>]</span>. All of those are scaled versions of
the <span class="citation" data-cites="SI">[<a href="#ref-SI" role="doc-biblioref">SI</a>]</span> units with ratios that can’t be
explicitly expressed with predefined SI prefixes. Those include units
like minute, hour, or electronvolt:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> minute <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;min&quot;</span>, mag<span class="op">&lt;</span><span class="dv">60</span><span class="op">&gt;</span> <span class="op">*</span> si<span class="op">::</span>second<span class="op">&gt;</span> <span class="op">{}</span> minute;</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> hour <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;h&quot;</span>, mag<span class="op">&lt;</span><span class="dv">60</span><span class="op">&gt;</span> <span class="op">*</span> minute<span class="op">&gt;</span> <span class="op">{}</span> hour;</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> electronvolt <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;eV&quot;</span>,</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>    mag<span class="op">&lt;</span>ratio<span class="op">{</span><span class="dv">1&#39;602&#39;176&#39;634</span>, <span class="dv">1&#39;000&#39;000&#39;000</span><span class="op">}&gt;</span> <span class="op">*</span> mag_power<span class="op">&lt;</span><span class="dv">10</span>, <span class="op">-</span><span class="dv">19</span><span class="op">&gt;</span> <span class="op">*</span> si<span class="op">::</span>joule<span class="op">&gt;</span> <span class="op">{}</span> electronvolt;</span></code></pre></div>
<p>Also, units of other systems of units are often defined in terms of
scaled versions of other (often SI) units. For example, the
international yard is defined as:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> yard <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;yd&quot;</span>, mag<span class="op">&lt;</span>ratio<span class="op">{</span><span class="dv">9&#39;144</span>, <span class="dv">10&#39;000</span><span class="op">}&gt;</span> <span class="op">*</span> si<span class="op">::</span>metre<span class="op">&gt;</span> <span class="op">{}</span> yard;</span></code></pre></div>
<p>and then a <code class="sourceCode default">foot</code> can be
defined as:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> foot <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;ft&quot;</span>, mag<span class="op">&lt;</span>ratio<span class="op">{</span><span class="dv">1</span>, <span class="dv">3</span><span class="op">}&gt;</span> <span class="op">*</span> yard<span class="op">&gt;</span> <span class="op">{}</span> foot;</span></code></pre></div>
<p>For some units, a magnitude might also be irrational. The best
example here is a <code class="sourceCode default">degree</code> which
is defined using a floating-point magnitude having a factor of the
number π (Pi):</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> mag_pi <span class="op">:</span> magnitude<span class="op">&lt;</span>std<span class="op">::</span>numbers<span class="op">::</span>pi_v<span class="op">&lt;</span><span class="dt">long</span> <span class="dt">double</span><span class="op">&gt;&gt;</span> <span class="op">{}</span> mag_pi;</span></code></pre></div>
<div class="sourceCode" id="cb98"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> degree <span class="op">:</span> named_unit<span class="op">&lt;{</span><span class="st">u8&quot;°&quot;</span>, <span class="st">&quot;deg&quot;</span><span class="op">}</span>, mag_pi <span class="op">/</span> mag<span class="op">&lt;</span><span class="dv">180</span><span class="op">&gt;</span> <span class="op">*</span> si<span class="op">::</span>radian<span class="op">&gt;</span> <span class="op">{}</span> degree;</span></code></pre></div>
<h3 data-number="13.2.7" id="unit-symbols"><span class="header-section-number">13.2.7</span> Unit symbols<a href="#unit-symbols" class="self-link"></a></h3>
<p>Units are available via their full names or through their short
symbols. To use a long version it is enough to type:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>quantity q <span class="op">=</span> <span class="dv">42</span> <span class="op">*</span> si<span class="op">::</span>metre;</span></code></pre></div>
<p>The same can be obtained using an optional unit symbol:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> si<span class="op">::</span>unit_symbols;</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>quantity q <span class="op">=</span> <span class="dv">42</span> <span class="op">*</span> m;</span></code></pre></div>
<p>Unit symbols introduce a lot of short identifiers into the current
namespace, and that is why they are opt-in. A user has to explicitly
“import” them from a dedicated
<code class="sourceCode default">unit_symbols</code> namespace.</p>
<h1 data-number="14" id="safety-1"><span class="header-section-number">14</span> Safety<a href="#safety-1" class="self-link"></a></h1>
<h2 data-number="14.1" id="safety-features"><span class="header-section-number">14.1</span> Safety features<a href="#safety-features" class="self-link"></a></h2>
<p>This chapter describes the features that enforce safety in our code
bases. It starts with obvious things, but then it moves to probably less
known benefits of using physical quantities and units libraries. This
chapter also serves as a proof that it is not easy to implement such a
library correctly, and that there are many cases where the lack of
experience or time for the development of such a utility may easily lead
to safety issues as well.</p>
<p>Before we go through all the features, it is essential to note that
they do not introduce any runtime overhead over the raw unsafe code
doing the same thing. This is a massive benefit of C++ compared to other
programming languages (e.g., Python, Java, etc.).</p>
<h3 data-number="14.1.1" id="safe-unit-conversions"><span class="header-section-number">14.1.1</span> Safe unit conversions<a href="#safe-unit-conversions" class="self-link"></a></h3>
<p>The first thing that comes to our mind when discussing the safety of
such libraries is automated unit conversions between values of the same
physical quantity. This is probably the most important subject here. We
learned about its huge benefits long ago thanks to the
<code class="sourceCode default">std::chrono::duration</code> that made
conversions of time durations error-proof.</p>
<p>Unit conversions are typically performed either via a converting
constructor or a dedicated conversion function:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> q1 <span class="op">=</span> <span class="dv">5</span> <span class="op">*</span> km;</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> q1<span class="op">.</span>in<span class="op">(</span>m<span class="op">)</span> <span class="op">&lt;&lt;</span> <span class="ch">&#39;</span><span class="sc">\n</span><span class="ch">&#39;</span>;</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>si<span class="op">::</span>metre, <span class="dt">int</span><span class="op">&gt;</span> q2 <span class="op">=</span> q1;</span></code></pre></div>
<p>Such a feature benefits from the fact that the library knows about
the magnitudes of the source and destination units at compile-time, and
may use that information to calculate and apply a conversion factor
automatically for the user.</p>
<p>In <code class="sourceCode default">std::chrono::duration</code>, the
magnitude of a unit is always expressed with
<code class="sourceCode default">std::ratio</code>. This is not enough
for a general-purpose physical units library. Some of the derived units
have huge or tiny ratios. The difference from the base units is so huge
that it cannot be expressed with
<code class="sourceCode default">std::ratio</code>, which is implemented
in terms of <code class="sourceCode default">std::intmax_t</code>. This
makes it impossible to define units like electronvolt (eV), where 1 eV =
1.602176634×10<sup>−19</sup> J, or Dalton (Da), where 1 Da =
1.660539040(20)×10<sup>−27</sup> kg. Moreover, some conversions, such as
radian to a degree, require a conversion factor based on an irrational
number like pi.</p>
<h3 data-number="14.1.2" id="preventing-truncation-of-data"><span class="header-section-number">14.1.2</span> Preventing truncation of
data<a href="#preventing-truncation-of-data" class="self-link"></a></h3>
<p>The second safety feature of such libraries is preventing accidental
truncation of a quantity value. If we try the operations above with
swapped units, both conversions should fail to compile:</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> q1 <span class="op">=</span> <span class="dv">5</span> <span class="op">*</span> m;</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> q1<span class="op">.</span>in<span class="op">(</span>km<span class="op">)</span> <span class="op">&lt;&lt;</span> <span class="ch">&#39;</span><span class="sc">\n</span><span class="ch">&#39;</span>;              <span class="co">// Compile-time error</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>si<span class="op">::</span>kilo<span class="op">&lt;</span>si<span class="op">::</span>metre<span class="op">&gt;</span>, <span class="dt">int</span><span class="op">&gt;</span> q2 <span class="op">=</span> q1;  <span class="co">// Compile-time error</span></span></code></pre></div>
<p>We can’t preserve the value of a source quantity when we convert it
to one with a unit of a lower resolution while dealing with an integral
representation type for a quantity. In the example above, converting
<code class="sourceCode default">5</code> meters would result in
<code class="sourceCode default">0</code> kilometers if internal
conversion is performed using regular integer arithmetic.</p>
<p>While this could be a valid behavior, the problem arises when the
user expects to be able to convert the quantity back to the original
unit without loss of information. So the library should prevent such
conversions from happening implicitly. This is why it offers the named
cast <code class="sourceCode default">value_cast</code> for these
conversions marked as unsafe.</p>
<p>To make the above conversions compile, we could use a floating-point
representation type:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> q1 <span class="op">=</span> <span class="fl">5.</span> <span class="op">*</span> m;    <span class="co">// source quantity uses `double` as a representation type</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> q1<span class="op">.</span>in<span class="op">(</span>km<span class="op">)</span> <span class="op">&lt;&lt;</span> <span class="ch">&#39;</span><span class="sc">\n</span><span class="ch">&#39;</span>;</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>si<span class="op">::</span>kilo<span class="op">&lt;</span>si<span class="op">::</span>metre<span class="op">&gt;&gt;</span> q2 <span class="op">=</span> q1;</span></code></pre></div>
<p>or:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> q1 <span class="op">=</span> <span class="dv">5</span> <span class="op">*</span> m;     <span class="co">// source quantity uses `int` as a representation type</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> value_cast<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span>q1<span class="op">).</span>in<span class="op">(</span>km<span class="op">)</span> <span class="op">&lt;&lt;</span> <span class="ch">&#39;</span><span class="sc">\n</span><span class="ch">&#39;</span>;</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>si<span class="op">::</span>kilo<span class="op">&lt;</span>si<span class="op">::</span>metre<span class="op">&gt;&gt;</span> q2 <span class="op">=</span> q1;  <span class="co">// `double` by default</span></span></code></pre></div>
<p>Another possibility would be to force such a truncating conversion
explicitly from the code:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> q1 <span class="op">=</span> <span class="dv">5</span> <span class="op">*</span> m;     <span class="co">// source quantity uses `int` as a representation type</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> q1<span class="op">.</span>force_in<span class="op">(</span>km<span class="op">)</span> <span class="op">&lt;&lt;</span> <span class="ch">&#39;</span><span class="sc">\n</span><span class="ch">&#39;</span>;</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>si<span class="op">::</span>kilo<span class="op">&lt;</span>si<span class="op">::</span>metre<span class="op">&gt;</span>, <span class="dt">int</span><span class="op">&gt;</span> q2 <span class="op">=</span> value_cast<span class="op">&lt;</span>km<span class="op">&gt;(</span>q1<span class="op">)</span>;</span></code></pre></div>
<p>The code above makes it clear that “something bad” may happen here if
we are not extra careful.</p>
<p>Another case for truncation happens when we assign a quantity with a
floating-point representation type to the one using an integral
representation type for its value:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> q1 <span class="op">=</span> <span class="fl">2.5</span> <span class="op">*</span> m;</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>si<span class="op">::</span>metre, <span class="dt">int</span><span class="op">&gt;</span> q2 <span class="op">=</span> q1;  <span class="co">// Compile-time error</span></span></code></pre></div>
<p>Such an operation should fail to compile as well. Again, to force
such a truncation, we have to be explicit in the code:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> q1 <span class="op">=</span> <span class="fl">2.5</span> <span class="op">*</span> m;</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>si<span class="op">::</span>metre, <span class="dt">int</span><span class="op">&gt;</span> q2 <span class="op">=</span> value_cast<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span>q1<span class="op">)</span>;</span></code></pre></div>
<p>As we can see, it is essential not to allow such truncating
conversions to happen implicitly, and a good physical quantities and
units library should fail at compile-time in case an user makes such a
mistake.</p>
<h3 data-number="14.1.3" id="safety-introduced-by-the-affine-space-abstractions"><span class="header-section-number">14.1.3</span> Safety introduced by the
affine space abstractions<a href="#safety-introduced-by-the-affine-space-abstractions" class="self-link"></a></h3>
<p>The affine space has two types of entities:</p>
<ul>
<li>point - a position specified with coordinate values (e.g.,
<em>location</em>, <em>address</em>, etc.)</li>
<li>vector - the difference between two points (e.g., <em>shift</em>,
<em>offset</em>, <em>displacement</em>, <em>duration</em>, etc.)</li>
</ul>
<p>One can do a limited set of operations in affine space on points and
vectors. This greatly helps to prevent quantity equations that do not
have physical sense.</p>
<p>People often think that affine space is needed only to model
<em>temperatures</em> and maybe <em>time</em> points (following the <a href="https://en.cppreference.com/w/cpp/chrono/time_point"><code class="sourceCode default">std::chrono::time_point</code></a>
example). Still, the applicability of this concept is much wider.</p>
<p>For example, if we would like to model a Mount Everest climbing
expedition, we would deal with two kinds of altitude-related entities.
The first would be absolute <em>altitudes above the mean sea level</em>
(points) like <em>base camp altitude</em>, <em>mount peak altitude</em>,
etc. The second one would be the <em>heights of daily climbs</em>
(vectors). Although it makes physical sense to add <em>heights of daily
climbs</em>, there is no sense in adding <em>altitudes</em>. What does
adding the <em>altitude</em> of a base camp and the mountain peak mean
after all?</p>
<p>Modeling such affine space entities with the
<code class="sourceCode default">quantity</code> (vector) and
<code class="sourceCode default">quantity_point</code> (point) class
templates improves the overall project’s safety by only providing the
operators defined by the concepts.</p>
<p>The following operations are not allowed in the affine space:</p>
<ul>
<li><strong>adding</strong> two
<code class="sourceCode default">quantity_point</code> objects
<ul>
<li>It is physically impossible to add the positions of home and Denver
airport.</li>
</ul></li>
<li><strong>subtracting</strong> a
<code class="sourceCode default">quantity_point</code> from a
<code class="sourceCode default">quantity</code>
<ul>
<li>What would it mean to subtract the DEN airport location from a
distance?</li>
</ul></li>
<li><strong>multiplying/dividing</strong> a
<code class="sourceCode default">quantity_point</code> with a scalar
<ul>
<li>What is the position of <code class="sourceCode default">2 *</code>
DEN airport location?</li>
</ul></li>
<li><strong>multiplying/dividing</strong> a
<code class="sourceCode default">quantity_point</code> with a quantity
<ul>
<li>What would multiplying a distance with the DEN airport location
mean?</li>
</ul></li>
<li><strong>multiplying/dividing</strong> two
<code class="sourceCode default">quantity_point</code> objects
<ul>
<li>What would multiplying the home and DEN airport location mean?</li>
</ul></li>
<li><strong>mixing</strong>
<code class="sourceCode default">quantity_points</code> of different
quantity kinds
<ul>
<li>It is physically impossible to subtract ISQ time from ISQ
length.</li>
</ul></li>
<li><strong>mixing</strong>
<code class="sourceCode default">quantity_points</code> of inconvertible
quantities
<ul>
<li>What does it mean to subtract a distance point to DEN airport from
the Mount Everest base camp altitude?</li>
</ul></li>
<li><strong>mixing</strong>
<code class="sourceCode default">quantity_points</code> of convertible
quantities but with unrelated origins
<ul>
<li>How to subtract a point on our trip to CppCon measured relatively to
our home location from a point measured relative to the center of the
Solar System?</li>
</ul></li>
</ul>
<p>The usage of <code class="sourceCode default">quantity_point</code>,
and affine space types in general, improves expressiveness and
type-safety of the code we write.</p>
<h3 data-number="14.1.4" id="explicit-is-not-explicit-enough"><span class="header-section-number">14.1.4</span>
<code class="sourceCode default">explicit</code> is not explicit
enough<a href="#explicit-is-not-explicit-enough" class="self-link"></a></h3>
<p>Consider the following structure and a code using it:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> X <span class="op">{</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>vector<span class="op">&lt;</span>std<span class="op">::</span>chrono<span class="op">::</span>milliseconds<span class="op">&gt;</span> vec;</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ...</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>;</span></code></pre></div>
<div class="sourceCode" id="cb109"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>X x;</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>x<span class="op">.</span>vec<span class="op">.</span>emplace_back<span class="op">(</span><span class="dv">42</span><span class="op">)</span>;</span></code></pre></div>
<p>Everything works fine for years until, at some point, someone changes
the structure to:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> X <span class="op">{</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>vector<span class="op">&lt;</span>std<span class="op">::</span>chrono<span class="op">::</span>microseconds<span class="op">&gt;</span> vec;</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ...</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>;</span></code></pre></div>
<p>The code continues to compile fine, but all the calculations are now
off by orders of magnitude. This is why a good quantities and units
library should not provide an explicit quantity constructor taking a raw
value.</p>
<p>To solve this issue, a quantity always requires information about
both a number and a unit during construction:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> X <span class="op">{</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>vector<span class="op">&lt;</span>quantity<span class="op">&lt;</span>si<span class="op">::</span>milli<span class="op">&lt;</span>si<span class="op">::</span>second<span class="op">&gt;&gt;&gt;</span> vec;</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ...</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>;</span></code></pre></div>
<div class="sourceCode" id="cb112"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>X x;</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>x<span class="op">.</span>vec<span class="op">.</span>emplace_back<span class="op">(</span><span class="dv">42</span><span class="op">)</span>;       <span class="co">// Compile-time error</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>x<span class="op">.</span>vec<span class="op">.</span>emplace_back<span class="op">(</span><span class="dv">42</span> <span class="op">*</span> ms<span class="op">)</span>;  <span class="co">// OK</span></span></code></pre></div>
<p>For consistency and to prevent similar safety issues, the
<code class="sourceCode default">quantity_point</code> using explicit
point origins can’t be created from a standalone value of a
<code class="sourceCode default">quantity</code> (contrary to the
<code class="sourceCode default">std::chrono::time_point</code> design).
Such a point has to always be associated with an explicit origin:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>quantity_point qp1 <span class="op">=</span> mean_sea_level <span class="op">+</span> <span class="dv">42</span> <span class="op">*</span> m;</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>quantity_point qp2 <span class="op">=</span> default_ac_temperature <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> deg_C;</span></code></pre></div>
<h3 data-number="14.1.5" id="safe-quantity-numerical-value-getters"><span class="header-section-number">14.1.5</span> Safe quantity numerical
value getters<a href="#safe-quantity-numerical-value-getters" class="self-link"></a></h3>
<p>Continuing our previous example, let’s assume that we have an
underlying “legacy” API that requires us to pass a raw numerical value
of a quantity and that we do the following to use it:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> legacy_func<span class="op">(</span>std<span class="op">::</span><span class="dt">int64_t</span> seconds<span class="op">)</span>;</span></code></pre></div>
<div class="sourceCode" id="cb115"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>X x;</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>x<span class="op">.</span>vec<span class="op">.</span>emplace_back<span class="op">(</span><span class="dv">42</span><span class="bu">s</span><span class="op">)</span>;</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>legacy_func<span class="op">(</span>x<span class="op">.</span>vec<span class="op">[</span><span class="dv">0</span><span class="op">].</span>count<span class="op">())</span>;</span></code></pre></div>
<p>The preceding code is incorrect. Even though the duration stores a
quantity equal to 42 s, it is not stored in seconds (it’s either
microseconds or milliseconds, depending on which of the interfaces from
the previous chapter is the current one). Such issues can be prevented
with the usage of
<code class="sourceCode default">std::chrono::duration_cast</code>:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>legacy_func<span class="op">(</span>duration_cast<span class="op">&lt;</span>seconds<span class="op">&gt;(</span>x<span class="op">.</span>vec<span class="op">[</span><span class="dv">0</span><span class="op">]).</span>count<span class="op">())</span>;</span></code></pre></div>
<p>However, users often forget about this step, especially when, at the
moment of writing such code, the duration stores the underlying raw
value in the expected unit. But as we know, the interface can be
refactored at any point to use a different unit, and the code using an
underlying numerical value without the usage of an explicit cast will
become incorrect.</p>
<p>To prevent such safety issues, the library exposes only the interface
that returns a quantity numerical value in the required unit to ensure
that no data truncation happens:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>X x;</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>x<span class="op">.</span>vec<span class="op">.</span>emplace_back<span class="op">(</span><span class="dv">42</span> <span class="op">*</span> s<span class="op">)</span>;</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>legacy_func<span class="op">(</span>x<span class="op">.</span>vec<span class="op">[</span><span class="dv">0</span><span class="op">].</span>numerical_value_in<span class="op">(</span>si<span class="op">::</span>second<span class="op">))</span>;</span></code></pre></div>
<p>or in case we are fine with data truncation:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>X x;</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>x<span class="op">.</span>vec<span class="op">.</span>emplace_back<span class="op">(</span><span class="dv">42</span> <span class="op">*</span> s<span class="op">)</span>;</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>legacy_func<span class="op">(</span>x<span class="op">.</span>vec<span class="op">[</span><span class="dv">0</span><span class="op">].</span>force_numerical_value_in<span class="op">(</span>si<span class="op">::</span>second<span class="op">))</span>;</span></code></pre></div>
<p>As the above member functions may need to do a conversion to provide
a value in the expected unit, their results are prvalues.</p>
<h3 data-number="14.1.6" id="preventing-dangling-references"><span class="header-section-number">14.1.6</span> Preventing dangling
references<a href="#preventing-dangling-references" class="self-link"></a></h3>
<p>Besides returning prvalues, sometimes users need to get an actual
reference to the underlying numerical value stored in a
<code class="sourceCode default">quantity</code>. For those cases, the
library exposes <code class="sourceCode default">quantity::numerical_value_ref_in(Unit)</code>
that participates in overload resolution only:</p>
<ul>
<li>for lvalues (rvalue reference qualified overload is explicitly
deleted),</li>
<li>when the provided <code class="sourceCode default">Unit</code> has
the same magnitude as the one currently used by the quantity.</li>
</ul>
<p>The first condition above aims to limit the possibility of dangling
references. We want to increase the chances that the reference/pointer
provided to an underlying API remains valid for the time of its usage.
(We’re much less concerned about performance aspects for a
<code class="sourceCode default">quantity</code> here, as we expect the
majority (if not all) of representation types to be cheap to copy.)</p>
<p>That said, we acknowledge that this approach to preventing dangling
references conflates value category with lifetime. While it may prevent
the majority of dangling references, it also admits both false positives
and false negatives, as explained in <span class="citation" data-cites="VCINL">[<a href="#ref-VCINL" role="doc-biblioref">Value
Category Is Not Lifetime</a>]</span>. We want to highlight this dilemma
for the committee’s consideration.</p>
<p>In case we do decide to keep this policy of deleting rvalue
overloads, here’s an example of code that it would prevent from
compiling.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> legacy_func<span class="op">(</span><span class="kw">const</span> <span class="dt">int</span><span class="op">&amp;</span> seconds<span class="op">)</span>;</span></code></pre></div>
<div class="sourceCode" id="cb120"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>legacy_func<span class="op">((</span><span class="dv">4</span> <span class="op">*</span> s <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> s<span class="op">).</span>numerical_value_ref_in<span class="op">(</span>si<span class="op">::</span>second<span class="op">))</span>;  <span class="co">// Compile-time error</span></span></code></pre></div>
<p>The library also goes one step further, by implementing all compound
assignments, pre-increment, and pre-decrement operators as non-member
functions that preserve the initial value category. Thanks to that, the
following will also not compile:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>si<span class="op">::</span>second, <span class="dt">int</span><span class="op">&gt;</span> get_duration<span class="op">()</span>;</span></code></pre></div>
<div class="sourceCode" id="cb122"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>legacy_func<span class="op">((</span><span class="dv">4</span> <span class="op">*</span> s <span class="op">+=</span> <span class="dv">2</span> <span class="op">*</span> s<span class="op">).</span>numerical_value_ref_in<span class="op">(</span>si<span class="op">::</span>second<span class="op">))</span>;    <span class="co">// Compile-time error</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>legacy_func<span class="op">((++</span>get_duration<span class="op">()).</span>numerical_value_ref_in<span class="op">(</span>si<span class="op">::</span>second<span class="op">))</span>;  <span class="co">// Compile-time error</span></span></code></pre></div>
<p>The second condition above enables the usage of various equivalent
units. For example, <code class="sourceCode default">J</code> is
equivalent to <code class="sourceCode default">N * m</code>, and
<code class="sourceCode default">kg * m2 / s2</code>. As those have the
same magnitude, it does not matter exactly which one is being used here,
as the same numerical value should be returned for all of them.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> legacy_func<span class="op">(</span><span class="kw">const</span> <span class="dt">int</span><span class="op">&amp;</span> joules<span class="op">)</span>;</span></code></pre></div>
<div class="sourceCode" id="cb124"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>quantity q1 <span class="op">=</span> <span class="dv">42</span> <span class="op">*</span> J;</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>quantity q2 <span class="op">=</span> <span class="dv">42</span> <span class="op">*</span> N <span class="op">*</span> <span class="op">(</span><span class="dv">2</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>quantity q3 <span class="op">=</span> <span class="dv">42</span> <span class="op">*</span> kJ;</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>legacy_func<span class="op">(</span>q1<span class="op">.</span>numerical_value_ref_in<span class="op">(</span>si<span class="op">::</span>joule<span class="op">))</span>; <span class="co">// OK</span></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>legacy_func<span class="op">(</span>q2<span class="op">.</span>numerical_value_ref_in<span class="op">(</span>si<span class="op">::</span>joule<span class="op">))</span>; <span class="co">// OK</span></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>legacy_func<span class="op">(</span>q3<span class="op">.</span>numerical_value_ref_in<span class="op">(</span>si<span class="op">::</span>joule<span class="op">))</span>; <span class="co">// Compile-time error</span></span></code></pre></div>
<h3 data-number="14.1.7" id="quantity-kinds-improve-safety"><span class="header-section-number">14.1.7</span> Quantity kinds improve
safety<a href="#quantity-kinds-improve-safety" class="self-link"></a></h3>
<p>What should be the result of the following quantity equation?</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> res <span class="op">=</span> <span class="dv">1</span> <span class="op">*</span> Hz <span class="op">+</span> <span class="dv">1</span> <span class="op">*</span> Bq <span class="op">+</span> <span class="dv">1</span> <span class="op">*</span> Bd;</span></code></pre></div>
<p>We have checked a few leading libraries on the market, and here are
the results:</p>
<ul>
<li><span class="citation" data-cites="BOOST-UNITS">[<a href="#ref-BOOST-UNITS" role="doc-biblioref">Boost.Units</a>]</span>
claims the answer to be 2 Hz (bauds are not supported by it, so we
removed it from the equation),</li>
<li><span class="citation" data-cites="NHOLTHAUS-UNITS">[<a href="#ref-NHOLTHAUS-UNITS" role="doc-biblioref">nholthaus/units</a>]</span> claims it is 2
s<sup>-1</sup> (no support for bauds as well),</li>
<li><span class="citation" data-cites="PINT">[<a href="#ref-PINT" role="doc-biblioref">Pint</a>]</span> library in Python claims that the
result is 3.0 Hz,</li>
<li><span class="citation" data-cites="JSR-385">[<a href="#ref-JSR-385" role="doc-biblioref">JSR 385</a>]</span> library in Java throws an
exception saying that we can’t add those quantities.</li>
</ul>
<p>Now let’s check what <span class="citation" data-cites="ISO-GUIDE">[<a href="#ref-ISO-GUIDE" role="doc-biblioref">ISO/IEC Guide 99</a>]</span> says about quantity
kinds:</p>
<ul>
<li>Quantities may be grouped together into categories of quantities
that are <strong>mutually comparable</strong></li>
<li>Mutually comparable quantities are called <strong>quantities of the
same kind</strong></li>
<li>Two or more quantities <strong>cannot be added or subtracted unless
they belong to the same category of mutually comparable
quantities</strong></li>
<li>Quantities of the <strong>same kind</strong> within a given system
of quantities <strong>have the same quantity dimension</strong></li>
<li>Quantities of the <strong>same dimension are not necessarily of the
same kind</strong></li>
</ul>
<p><span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span> also explicitly
notes:</p>
<blockquote>
<p><strong>Measurement units of quantities of the same quantity
dimension may be designated by the same name and symbol even when the
quantities are not of the same kind</strong>. For example, joule per
kelvin and J/K are respectively the name and symbol of both a
measurement unit of heat capacity and a measurement unit of entropy,
which are generally not considered to be quantities of the same kind.
<strong>However, in some cases special measurement unit names are
restricted to be used with quantities of specific kind only</strong>.
For example, the measurement unit ‘second to the power minus one’ (1/s)
is called hertz (Hz) when used for frequencies and becquerel (Bq) when
used for activities of radionuclides. As another example, the joule (J)
is used as a unit of energy, but never as a unit of moment of force,
i.e. the newton metre (N · m).</p>
</blockquote>
<p>To summarize the above, <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span> explicitly states that
<em>frequency</em> is measured in Hz and <em>activity</em> is measured
in Bq, which are quantities of different kinds. As such, they should not
be able to be compared, added, or subtracted. So, the only library from
the above that was correct was <span class="citation" data-cites="JSR-385">[<a href="#ref-JSR-385" role="doc-biblioref">JSR
385</a>]</span>. The rest of them are wrong to allow such operations.
Doing so may lead to vulnerable safety issues when two unrelated
quantities of the same dimension are accidentally added or assigned to
each other.</p>
<p>The reason for most of the libraries on the market to be wrong in
this field is the fact that their quantities are implemented only in
terms of the concept of dimension. However, we’ve learned that a
dimension is not enough to describe a quantity.</p>
<p>The library goes beyond that and properly models quantity kinds. We
believe that it is a significant feature that improves the safety of the
library.</p>
<h3 data-number="14.1.8" id="additional-safety-introduced-by-modeling-various-quantities-of-the-same-kind"><span class="header-section-number">14.1.8</span> Additional safety introduced
by modeling various quantities of the same kind<a href="#additional-safety-introduced-by-modeling-various-quantities-of-the-same-kind" class="self-link"></a></h3>
<p>Proper modeling of distinct kinds for quantities of the same
dimension is often not enough from the safety point of view. Most of the
libraries allow us to write the following code in the type-safe way:</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>isq<span class="op">::</span>speed<span class="op">[</span>m<span class="op">/</span>s<span class="op">]&gt;</span> avg_speed<span class="op">(</span>quantity<span class="op">&lt;</span>isq<span class="op">::</span>length<span class="op">[</span>m<span class="op">]&gt;</span> l, quantity<span class="op">&lt;</span>isq<span class="op">::</span>time<span class="op">[</span>s<span class="op">]&gt;</span> t<span class="op">)</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> l <span class="op">/</span> t;</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>However, they fail when we need to model an abstraction using more
than one quantity of the same kind:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Box <span class="op">{</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>  quantity<span class="op">&lt;</span>isq<span class="op">::</span>area<span class="op">[</span>m2<span class="op">]&gt;</span> base_;</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>  quantity<span class="op">&lt;</span>isq<span class="op">::</span>length<span class="op">[</span>m<span class="op">]&gt;</span> height_;</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span><span class="op">:</span></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>  Box<span class="op">(</span>quantity<span class="op">&lt;</span>isq<span class="op">::</span>length<span class="op">[</span>m<span class="op">]&gt;</span> l, quantity<span class="op">&lt;</span>isq<span class="op">::</span>length<span class="op">[</span>m<span class="op">]&gt;</span> w, quantity<span class="op">&lt;</span>isq<span class="op">::</span>length<span class="op">[</span>m<span class="op">]&gt;</span> h<span class="op">)</span></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span> base_<span class="op">(</span>l <span class="op">*</span> w<span class="op">)</span>, height_<span class="op">(</span>h<span class="op">)</span></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>  <span class="op">{}</span></span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ...</span></span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>;</span></code></pre></div>
<p>This does not provide strongly typed interfaces anymore.</p>
<p>Again, it turns out that <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span> has an answer. This
specification standardizes hundreds of quantities, many of which are of
the same kind. Various quantities of the same kind are not a flat set.
They form a hierarchy tree which influences:</p>
<ul>
<li>conversion rules,</li>
<li>the quantity type being the result of adding or subtracting
different quantities of the same kind.</li>
</ul>
<p>More information on this subject can be found in the <a href="#systems-of-quantities">Systems of quantities</a> chapter.</p>
<h3 data-number="14.1.9" id="non-negative-quantities"><span class="header-section-number">14.1.9</span> Non-negative quantities<a href="#non-negative-quantities" class="self-link"></a></h3>
<!-- TODO refactor this to state that we can benefit for points -->
<p>Some quantity types are defined by <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span> as explicitly
non-negative. Those include quantities like width, thickness, diameter,
and radius. However, it turns out that it is possible to have negative
values of quantities defined as non-negative. For example,
<code class="sourceCode default">-1 * isq::diameter[mm]</code> could
represent a change in the diameter of some object. Also, a subtraction
<code class="sourceCode default">4 * width[mm] - 6 * width[mm]</code>
results in a negative value as the width of the second argument is
larger than the first one.</p>
<p>Non-negative quantities are not limited to those explicitly stated as
being non-negative in <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span>.
Some quantities are implicitly non-negative from their definition. The
most obvious example here might be scalar quantities specified as
magnitudes of a vector quantity. For example, speed is defined as the
magnitude of velocity. Again,
<code class="sourceCode default">-1 * speed[m/s]</code> could represent
a change in average speed between two measurements.</p>
<p>This means that enforcing such constraints for quantity types might
be impossible as those typically are used to represent a difference
between two states or measurements. However, we could apply such
constraints to quantity points, which, by definition, describe the
absolute quantity values. For example, when height is the measure of an
object, a negative value is physically meaningless.</p>
<p>Such logic errors could be detected at runtime with contracts or some
other preconditions or invariants checks.</p>
<!-- Lots of exciting discussion at https://github.com/mpusz/mp-units/issues/468 -->
<h3 data-number="14.1.10" id="safe-operations-of-vector-and-tensor-quantities"><span class="header-section-number">14.1.10</span> Safe operations of vector
and tensor quantities<a href="#safe-operations-of-vector-and-tensor-quantities" class="self-link"></a></h3>
<!-- TODO revise after POC is done -->
<p>While talking about quantities and units libraries, everyone expects
that the library will protect (preferably at compile-time) from
accidentally replacing multiplication with division operations or vice
versa. Everyone knows and expects that the multiplication of
<em>length</em> and <em>time</em> should not result in <em>speed</em>.
It does not mean that such a quantity equation is invalid. It just
results in a quantity of a different type.</p>
<p>If we expect the above protection for scalar quantities, we should
also strive to provide similar guarantees for vector and tensor
quantities. First, the multiplication or division of two vectors or
tensors is not even mathematically defined. Such operations should be
impossible on quantities using vector or tensor representation
types.</p>
<p>What multiplication and division are for scalars, the dot and cross
products are for vector quantities. The result of the first one is a
scalar. The second one results in a vector perpendicular to both vectors
passed as arguments. A good quantities and units library should protect
the user from making such an error of accidentally replacing those
operations.</p>
<p>Vector and tensor quantities can be implemented in two ways:</p>
<ol type="1">
<li><p>Encapsulating multiple quantities into a homogeneous vector or
tensor representation type</p>
<p>This solution is the most common in the C++ market. It requires the
quantities library to provide only basic arithmetic operations
(addition, subtraction, multiplication, and division) which are being
used to calculate the result of linear algebra math. However, this
solution can’t provide any compile-time safety described above, and will
also crash when someone passes a proper vector and tensor representation
type to a quantity, expecting it to work.</p></li>
<li><p>Encapsulating a vector or tensor as a representation type of a
quantity</p>
<p>This provides all the required type safety, but requires the library
to implement more operations on quantities and properly constrain them
so they are selectively enabled when needed. Besides <span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span>, the only library that
supports such an approach is <span class="citation" data-cites="PINT">[<a href="#ref-PINT" role="doc-biblioref">Pint</a>]</span>. Such a solution requires the
following operations to be exposed for quantity types (note that
character refers to the algebraic structure of either scalar, vector and
tensor):</p>
<ul>
<li><code class="sourceCode default">a + b</code> - addition where both
arguments should be of the same quantity kind and character</li>
<li><code class="sourceCode default">a - b</code> - subtraction where
both arguments should be of the same quantity kind and character</li>
<li><code class="sourceCode default">a % b</code> - modulo where both
arguments should be of the same quantity kind and character</li>
<li><code class="sourceCode default">a * b</code> - multiplication where
one of the arguments has to be a scalar</li>
<li><code class="sourceCode default">a / b</code> - division where the
divisor has to be scalar</li>
<li><code class="sourceCode default">a ⋅ b</code> - dot product of two
vectors</li>
<li><code class="sourceCode default">a × b</code> - cross product of two
vectors</li>
<li><code class="sourceCode default">|a|</code> - magnitude of a
vector</li>
<li><code class="sourceCode default">a ⊗ b</code> - tensor product of
two vectors or tensors</li>
<li><code class="sourceCode default">a ⋅ b</code> - inner product of two
tensors</li>
<li><code class="sourceCode default">a ⋅ b</code> - inner product of
tensor and vector</li>
<li><code class="sourceCode default">a : b</code> - scalar product of
two tensors</li>
</ul></li>
</ol>
<p>Additionally, the library knows the expected quantity character,
which is provided (implicitly or explicitly) in the definition of each
quantity type. Thanks to that, it prevents the user, for example, from
providing a scalar representation type for <em>force</em> or a vector
representation for <em>power</em> quantities.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>velocity<span class="op">&gt;</span> q1 <span class="op">=</span> <span class="dv">60</span> <span class="op">*</span> km <span class="op">/</span> h;                             <span class="co">// Compile-time error</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>velocity<span class="op">&gt;</span> q2 <span class="op">=</span> la_vector<span class="op">{</span><span class="dv">0</span>, <span class="dv">0</span>, <span class="op">-</span><span class="dv">60</span><span class="op">}</span> <span class="op">*</span> km <span class="op">/</span> h;           <span class="co">// OK</span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>force<span class="op">&gt;</span> q3 <span class="op">=</span> <span class="dv">80</span> <span class="op">*</span> kg <span class="op">*</span> <span class="op">(</span><span class="dv">10</span> <span class="op">*</span> m <span class="op">/</span> s2<span class="op">)</span>;                    <span class="co">// Compile-time error</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>force<span class="op">&gt;</span> q4 <span class="op">=</span> <span class="dv">80</span> <span class="op">*</span> kg <span class="op">*</span> <span class="op">(</span>la_vector<span class="op">{</span><span class="dv">0</span>, <span class="dv">0</span>, <span class="op">-</span><span class="dv">10</span><span class="op">}</span> <span class="op">*</span> m <span class="op">/</span> s2<span class="op">)</span>;  <span class="co">// OK</span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>power<span class="op">&gt;</span> q5 <span class="op">=</span> q2 <span class="op">*</span> q4;                                    <span class="co">// Compile-time error</span></span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>power<span class="op">&gt;</span> q5 <span class="op">=</span> dot<span class="op">(</span>q2, q4<span class="op">)</span>;                                <span class="co">// OK</span></span></code></pre></div>
<p><em>Note: <code class="sourceCode default">q1</code> and
<code class="sourceCode default">q3</code> can be permitted to compile
by explicitly specializing the
<code class="sourceCode default">is_vector&lt;T&gt;</code> trait for the
representation type.</em></p>
<p>As we can see above, such features additionally improves the
compile-time safety of the library by ensuring that quantities are
created with proper quantity equations and are using correct
representation types.</p>
<h2 data-number="14.2" id="safety-pitfalls"><span class="header-section-number">14.2</span> Safety pitfalls<a href="#safety-pitfalls" class="self-link"></a></h2>
<h3 data-number="14.2.1" id="integer-division"><span class="header-section-number">14.2.1</span> Integer division<a href="#integer-division" class="self-link"></a></h3>
<p>The physical units library can’t do any runtime branching logic for
the division operator. All logic has to be done at compile-time when the
actual values are not known, and the quantity types can’t change at
runtime.</p>
<p>If we expect
<code class="sourceCode default">120 * km / (2 * h)</code> to return
<code class="sourceCode default">60 km / h</code>, we have to agree with
the fact that <code class="sourceCode default">5 * km / (24 * h)</code>
returns <code class="sourceCode default">0 km/h</code>. We can’t do a
range check at runtime to dynamically adjust scales and types based on
the values of provided function arguments.</p>
<p>The same applies to:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span><span class="dv">5</span> <span class="op">*</span> h <span class="op">/</span> <span class="op">(</span><span class="dv">120</span> <span class="op">*</span> min<span class="op">)</span> <span class="op">==</span> <span class="dv">0</span> <span class="op">*</span> one<span class="op">)</span>;</span></code></pre></div>
<p>This is why floating-point representation types are recommended as a
default to store the numerical value of a quantity. Some popular
physical units libraries even <a href="https://aurora-opensource.github.io/au/main/troubleshooting/#integer-division-forbidden">forbid
integer division at all</a>.</p>
<p>The problem is similar to the one described in the section about
accidental truncation of values through conversion. While the consequent
use of floating-point representation types may be a good idea, it is not
always possible. Especially in close-to-the-metal applications and small
embedded systems, the use of floating-point types is sometimes not an
option, either for performance reasons or lack of hardware support.
Having different operators for safe floating-point operations and unsafe
integer operations would hurt generic programming. As such, users should
instead use safer representation types.</p>
<h3 data-number="14.2.2" id="lack-of-safe-numeric-types"><span class="header-section-number">14.2.2</span> Lack of safe numeric types<a href="#lack-of-safe-numeric-types" class="self-link"></a></h3>
<p>Integers can overflow on arithmetics. This has already caused some
expensive failures in engineering <span class="citation" data-cites="ARIANE">[<a href="#ref-ARIANE" role="doc-biblioref">Ariane
flight V88</a>]</span>.</p>
<p>Integers can also be truncated during assignment to a narrower
type.</p>
<p>Floating-point types may lose precision during assignment to a
narrower type. Conversion from
<code class="sourceCode default">std::int64_t</code> to
<code class="sourceCode default">double</code> may also lose
precision.</p>
<p>If we had safe numeric types in the C++ standard library, they could
easily be used as a <code class="sourceCode default">quantity</code>
representation type in the physical quantities and units library, which
would address these safety concerns.</p>
<p>Also, having a type trait informing if a conversion from one type to
another is value-preserving would help to address some of the issues
mentioned above.</p>
<h3 data-number="14.2.3" id="potential-surprises-during-units-composition"><span class="header-section-number">14.2.3</span> Potential surprises during
units composition<a href="#potential-surprises-during-units-composition" class="self-link"></a></h3>
<p>One of the most essential requirements for a good physical quantities
and units library is to implement units in such a way that they compose.
With that, one can easily create any derived unit using a simple unit
equation on other base or derived units. For example:</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="kw">constexpr</span> Unit <span class="kw">auto</span> kmph <span class="op">=</span> km <span class="op">/</span> h;</span></code></pre></div>
<p>We can also easily obtain a quantity with:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>quantity q <span class="op">=</span> <span class="dv">60</span> <span class="op">*</span> km <span class="op">/</span> h;</span></code></pre></div>
<p>Such a solution is an industry standard and is implemented not only
in this library, but also is available for many years now in both <span class="citation" data-cites="BOOST-UNITS">[<a href="#ref-BOOST-UNITS" role="doc-biblioref">Boost.Units</a>]</span> and <span class="citation" data-cites="PINT">[<a href="#ref-PINT" role="doc-biblioref">Pint</a>]</span>.</p>
<p>We believe that is the correct thing to do. However, we want to make
it straight in this paper that some potential issues are associated with
such a syntax. Inexperienced users are often surprised by the results of
the following expression:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>quantity q <span class="op">=</span> <span class="dv">60</span> <span class="op">*</span> km <span class="op">/</span> <span class="dv">2</span> <span class="op">*</span> h;</span></code></pre></div>
<p>This looks like like <code class="sourceCode default">30 km/h</code>,
right? But it is not. Thanks to the order of operations, it results in
<code class="sourceCode default">30 km⋅h</code>. In case we want to
divide <code class="sourceCode default">60 km</code> by
<code class="sourceCode default">2 h</code>, parentheses are needed:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>quantity q <span class="op">=</span> <span class="dv">60</span> <span class="op">*</span> km <span class="op">/</span> <span class="op">(</span><span class="dv">2</span> <span class="op">*</span> h<span class="op">)</span>;</span></code></pre></div>
<p>Another surprising issue may result from the following code:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> make_length<span class="op">(</span>T v<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> v <span class="op">*</span> si<span class="op">::</span>metre; <span class="op">}</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> v <span class="op">=</span> <span class="dv">42</span>;</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>quantity q <span class="op">=</span> make_length<span class="op">(</span>v<span class="op">)</span>;</span></code></pre></div>
<p>This might look like a good idea, but let’s consider what would
happen if the user provided a quantity as input:</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> v <span class="op">=</span> <span class="dv">42</span> <span class="op">*</span> m;</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>quantity q <span class="op">=</span> make_length<span class="op">(</span>v<span class="op">)</span>;</span></code></pre></div>
<p>The above function call will result in a quantity of <em>area</em>
instead of the expected quantity of <em>length</em>.</p>
<p>The issues mentioned above could be turned into compilation errors by
disallowing multiplying or dividing a quantity by a unit. The <span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span> library initially provided
such an approach, but with time, we decided this to not be
user-friendly. Forcing the user to put the parenthesis around all
derived units in quantity equations like the one below, was too verbose
and confusing:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>quantity q <span class="op">=</span> <span class="dv">60</span> <span class="op">*</span> <span class="op">(</span>km <span class="op">/</span> h<span class="op">)</span>;</span></code></pre></div>
<p>It is important to notice that the problems mentioned above will
always surface with a compile-time error at some point in the user’s
code when they assign the resulting quantity to one with an explicitly
provided quantity type.</p>
<p>Below, we provide a few examples that correctly detect such issues at
compile-time:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>si<span class="op">::</span>kilo<span class="op">&lt;</span>si<span class="op">::</span>metre<span class="op">&gt;</span> <span class="op">/</span> non_si<span class="op">::</span>hour, <span class="dt">int</span><span class="op">&gt;</span> q1 <span class="op">=</span> <span class="dv">60</span> <span class="op">*</span> km <span class="op">/</span> <span class="dv">2</span> <span class="op">*</span> h;             <span class="co">// Compile-time error</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>isq<span class="op">::</span>speed<span class="op">[</span>si<span class="op">::</span>kilo<span class="op">&lt;</span>si<span class="op">::</span>metre<span class="op">&gt;</span> <span class="op">/</span> non_si<span class="op">::</span>hour<span class="op">]</span>, <span class="dt">int</span><span class="op">&gt;</span> q2 <span class="op">=</span> <span class="dv">60</span> <span class="op">*</span> km <span class="op">/</span> <span class="dv">2</span> <span class="op">*</span> h; <span class="co">// Compile-time error</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>speed<span class="op">&gt;</span> <span class="kw">auto</span> q3 <span class="op">=</span> <span class="dv">60</span> <span class="op">*</span> km <span class="op">/</span> <span class="dv">2</span> <span class="op">*</span> h;                                   <span class="co">// Compile-time error</span></span></code></pre></div>
<div class="sourceCode" id="cb138"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> make_length<span class="op">(</span>T v<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> v <span class="op">*</span> si<span class="op">::</span>metre; <span class="op">}</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> v <span class="op">=</span> <span class="dv">42</span> <span class="op">*</span> m;</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>si<span class="op">::</span>metre, <span class="dt">int</span><span class="op">&gt;</span> q1 <span class="op">=</span> make_length<span class="op">(</span>v<span class="op">)</span>;           <span class="co">// Compile-time error</span></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>isq<span class="op">::</span>length<span class="op">[</span>si<span class="op">::</span>metre<span class="op">]&gt;</span> q2 <span class="op">=</span> make_length<span class="op">(</span>v<span class="op">)</span>;   <span class="co">// Compile-time error</span></span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>length<span class="op">&gt;</span> q3 <span class="op">=</span> make_length<span class="op">(</span>v<span class="op">)</span>;            <span class="co">// Compile-time error</span></span></code></pre></div>
<div class="sourceCode" id="cb139"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>length<span class="op">&gt;</span> <span class="kw">auto</span> make_length<span class="op">(</span>T v<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> v <span class="op">*</span> si<span class="op">::</span>metre; <span class="op">}</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> v <span class="op">=</span> <span class="dv">42</span> <span class="op">*</span> m;</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>quantity q <span class="op">=</span> make_length<span class="op">(</span>v<span class="op">)</span>;  <span class="co">// Compile-time error</span></span></code></pre></div>
<div class="sourceCode" id="cb140"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span>Representation T<span class="op">&gt;</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> make_length<span class="op">(</span>T v<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> v <span class="op">*</span> si<span class="op">::</span>metre; <span class="op">}</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> v <span class="op">=</span> <span class="dv">42</span> <span class="op">*</span> m;</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>quantity q <span class="op">=</span> make_length<span class="op">(</span>v<span class="op">)</span>;  <span class="co">// Compile-time error</span></span></code></pre></div>
<h3 data-number="14.2.4" id="limitations-of-systems-of-quantities"><span class="header-section-number">14.2.4</span> Limitations of systems of
quantities<a href="#limitations-of-systems-of-quantities" class="self-link"></a></h3>
<p>As stated before, modeling systems of quantities and various
quantities of the same kind significantly improves the safety of the
project. However, it is essential to mention here that such modeling is
not ideal and there might be some pitfalls and surprises associated with
some corner cases.</p>
<h4 data-number="14.2.4.1" id="allowing-irrational-quantity-combinations"><span class="header-section-number">14.2.4.1</span> Allowing irrational
quantity combinations<a href="#allowing-irrational-quantity-combinations" class="self-link"></a></h4>
<p>Everyone probably agrees that multiplying two <em>lengths</em> is an
<em>area</em>, and that area should be implicitly convertible to the
result of such a multiplication:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>implicitly_convertible<span class="op">(</span>isq<span class="op">::</span>length <span class="op">*</span> isq<span class="op">::</span>length, isq<span class="op">::</span>area<span class="op">))</span>;</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>implicitly_convertible<span class="op">(</span>isq<span class="op">::</span>area, isq<span class="op">::</span>length <span class="op">*</span> isq<span class="op">::</span>length<span class="op">))</span>;</span></code></pre></div>
<p>Also, probably no one would be surprised by the fact that the
multiplication of <em>width</em> and <em>height</em> is also convertible
to <em>area</em>. Still, the reverse operation is not valid in this
case. Not every <em>area</em> is an <em>area</em> over <em>width</em>
and <em>height</em>, so we need an explicit cast to force such a
conversion:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>implicitly_convertible<span class="op">(</span>isq<span class="op">::</span>width <span class="op">*</span> isq<span class="op">::</span>height, isq<span class="op">::</span>area<span class="op">))</span>;</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(!</span>implicitly_convertible<span class="op">(</span>isq<span class="op">::</span>area, isq<span class="op">::</span>width <span class="op">*</span> isq<span class="op">::</span>height<span class="op">))</span>;</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>explicitly_convertible<span class="op">(</span>isq<span class="op">::</span>area, isq<span class="op">::</span>width <span class="op">*</span> isq<span class="op">::</span>height<span class="op">))</span>;</span></code></pre></div>
<p>However, it might be surprising to some that the similar behavior
will also be observed for the product of two <em>heights</em>:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>implicitly_convertible<span class="op">(</span>isq<span class="op">::</span>height <span class="op">*</span> isq<span class="op">::</span>height, isq<span class="op">::</span>area<span class="op">))</span>;</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(!</span>implicitly_convertible<span class="op">(</span>isq<span class="op">::</span>area, isq<span class="op">::</span>height <span class="op">*</span> isq<span class="op">::</span>height<span class="op">))</span>;</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>explicitly_convertible<span class="op">(</span>isq<span class="op">::</span>area, isq<span class="op">::</span>height <span class="op">*</span> isq<span class="op">::</span>height<span class="op">))</span>;</span></code></pre></div>
<p>For humans, it is hard to imagine how two <em>heights</em> form an
<em>area</em>, but the library’s logic has no way to prevent such
operations.</p>
<h4 data-number="14.2.4.2" id="arithmetic-and-compatibility-of-quantities-of-dimension-one"><span class="header-section-number">14.2.4.2</span> Arithmetic and
compatibility of quantities of dimension one<a href="#arithmetic-and-compatibility-of-quantities-of-dimension-one" class="self-link"></a></h4>
<p>Some pitfalls might also arise when dealing with quantities of
dimension one (also known as dimensionless quantities).</p>
<p>If we divide two quantities of the same kind, we end up with a
quantity of dimension one. For example, we can divide two
<em>lengths</em> to get a <em>slope of the ramp</em> or two
<em>durations</em> to get the <em>clock accuracy</em>. Those ratios mean
something fundamentally different, but from the dimensional analysis
standpoint, they are mutually comparable.</p>
<p>The above means that the following code is valid:</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>quantity q1 <span class="op">=</span> <span class="dv">1</span> <span class="op">*</span> m <span class="op">/</span> <span class="op">(</span><span class="dv">10</span> <span class="op">*</span> m<span class="op">)</span> <span class="op">+</span> <span class="dv">1</span> <span class="op">*</span> us <span class="op">/</span> <span class="op">(</span><span class="dv">1</span> <span class="op">*</span> h<span class="op">)</span>;</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>quantity q2 <span class="op">=</span> isq<span class="op">::</span>length<span class="op">(</span><span class="dv">1</span> <span class="op">*</span> m<span class="op">)</span> <span class="op">/</span> isq<span class="op">::</span>length<span class="op">(</span><span class="dv">10</span> <span class="op">*</span> m<span class="op">)</span> <span class="op">+</span> isq<span class="op">::</span>time<span class="op">(</span><span class="dv">1</span> <span class="op">*</span> us<span class="op">)</span> <span class="op">/</span> isq<span class="op">::</span>time<span class="op">(</span><span class="dv">1</span> <span class="op">*</span> h<span class="op">)</span>;</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>quantity q3 <span class="op">=</span> isq<span class="op">::</span>height<span class="op">(</span><span class="dv">1</span> <span class="op">*</span> m<span class="op">)</span> <span class="op">/</span> isq<span class="op">::</span>length<span class="op">(</span><span class="dv">10</span> <span class="op">*</span> m<span class="op">)</span> <span class="op">+</span> isq<span class="op">::</span>time<span class="op">(</span><span class="dv">1</span> <span class="op">*</span> us<span class="op">)</span> <span class="op">/</span> isq<span class="op">::</span>time<span class="op">(</span><span class="dv">1</span> <span class="op">*</span> h<span class="op">)</span>;</span></code></pre></div>
<p>The fact that the above code compiles fine might again be surprising
to some users of such a library. The result of all such quantity
equations is a <code class="sourceCode default">dimensionless</code>
quantity as it is the root of this hierarchy tree.</p>
<p>Now, let’s try to convert such results to some quantities of
dimension one. The <code class="sourceCode default">q1</code> was
obtained from the expression that only used units in the equation, which
means that the actual result of it is a quantity of
<code class="sourceCode default">kind_of&lt;dimensionless&gt;</code>,
which behaves like any quantity from the tree. Because of it, all of the
below will compile for <code class="sourceCode default">q1</code>:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>si<span class="op">::</span>metre <span class="op">/</span> si<span class="op">::</span>metre<span class="op">&gt;</span> ok1 <span class="op">=</span> q1;</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;(</span>isq<span class="op">::</span>length <span class="op">/</span> isq<span class="op">::</span>length<span class="op">)[</span>m <span class="op">/</span> m<span class="op">]&gt;</span> ok2 <span class="op">=</span> q1;</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;(</span>isq<span class="op">::</span>height <span class="op">/</span> isq<span class="op">::</span>length<span class="op">)[</span>m <span class="op">/</span> m<span class="op">]&gt;</span> ok3 <span class="op">=</span> q1;</span></code></pre></div>
<p>For <code class="sourceCode default">q2</code> and
<code class="sourceCode default">q3</code>, the two first conversions
also succeed. The first one passes because all quantities of a kind are
convertible to such kind. The type of the second quantity is <code class="sourceCode default">quantity&lt;dimensionless[one]&gt;</code> in
disguise. Such a quantity is a root of the kind tree, so again, all the
quantities from such a tree are convertible to it.</p>
<p>The third conversion fails in both cases, though. Not every
dimensionless quantity is a result of dividing height and length, so an
explicit conversion would be needed to force it to work.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>si<span class="op">::</span>metre <span class="op">/</span> si<span class="op">::</span>metre<span class="op">&gt;</span> ok4 <span class="op">=</span> q2;</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;(</span>isq<span class="op">::</span>length <span class="op">/</span> isq<span class="op">::</span>length<span class="op">)[</span>m <span class="op">/</span> m<span class="op">]&gt;</span> ok5 <span class="op">=</span> q2;</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;(</span>isq<span class="op">::</span>height <span class="op">/</span> isq<span class="op">::</span>length<span class="op">)[</span>m <span class="op">/</span> m<span class="op">]&gt;</span> bad1 <span class="op">=</span> q2;  <span class="co">// Compile-time error</span></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>si<span class="op">::</span>metre <span class="op">/</span> si<span class="op">::</span>metre<span class="op">&gt;</span> ok6 <span class="op">=</span> q3;</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;(</span>isq<span class="op">::</span>length <span class="op">/</span> isq<span class="op">::</span>length<span class="op">)[</span>m <span class="op">/</span> m<span class="op">]&gt;</span> ok7 <span class="op">=</span> q3;</span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;(</span>isq<span class="op">::</span>height <span class="op">/</span> isq<span class="op">::</span>length<span class="op">)[</span>m <span class="op">/</span> m<span class="op">]&gt;</span> bad2 <span class="op">=</span> q3;  <span class="co">// Compile-time error</span></span></code></pre></div>
<h3 data-number="14.2.5" id="potential-surprises-while-working-with-temperatures"><span class="header-section-number">14.2.5</span> Potential surprises while
working with temperatures<a href="#potential-surprises-while-working-with-temperatures" class="self-link"></a></h3>
<p><em>Temperature</em> support is one the most challenging parts of any
physical quantities and units library design. This is why it is probably
reasonable to dedicate a chapter to this subject to describe how they
are intended to work and what are the potential pitfalls or
surprises.</p>
<p>First, let’s run the following code:</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>quantity q1 <span class="op">=</span> isq<span class="op">::</span>thermodynamic_temperature<span class="op">(</span><span class="fl">30.</span> <span class="op">*</span> K<span class="op">)</span>;</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>quantity q2 <span class="op">=</span> isq<span class="op">::</span>Celsius_temperature<span class="op">(</span><span class="fl">30.</span> <span class="op">*</span> deg_C<span class="op">)</span>;</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;q1: {}, {}, {}&quot;</span>, q1, q1<span class="op">.</span>in<span class="op">(</span>deg_C<span class="op">)</span>, q1<span class="op">.</span>in<span class="op">(</span>deg_F<span class="op">))</span>;</span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;q2: {}, {}, {}&quot;</span>, q2<span class="op">.</span>in<span class="op">(</span>K<span class="op">)</span>, q2, q2<span class="op">.</span>in<span class="op">(</span>deg_F<span class="op">))</span>;</span></code></pre></div>
<p>This outputs:</p>
<pre class="text"><code>q1: 30 K, 30 °C, 54 °F
q2: 30 K, 30 °C, 54 °F</code></pre>
<p>Also doing the following:</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>quantity q3 <span class="op">=</span> isq<span class="op">::</span>Celsius_temperature<span class="op">(</span>q1<span class="op">)</span>;</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>quantity q4 <span class="op">=</span> isq<span class="op">::</span>thermodynamic_temperature<span class="op">(</span>q2<span class="op">)</span>;</span></code></pre></div>
<p>outputs:</p>
<pre class="text"><code>q3: 30 K
q4: 30 °C</code></pre>
<p>Even though <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span>
provides dedicated quantity types for <em>thermodynamic temperature</em>
and <em>Celsius temperature</em>, it explicitly states in the
description of the first one:</p>
<blockquote>
<p>Differences of thermodynamic temperatures or changes may be expressed
either in kelvin, symbol K, or in degrees Celsius, symbol °C</p>
</blockquote>
<p>In the description of the second quantity type, we can read:</p>
<blockquote>
<p>The unit degree Celsius is a special name for the kelvin for use in
stating values of Celsius temperature. The unit degree Celsius is by
definition equal in magnitude to the kelvin. A difference or interval of
temperature may be expressed in kelvin or in degrees Celsius.</p>
</blockquote>
<p>As the <code class="sourceCode default">quantity</code> is a
differential quantity type, it is okay to use any <em>temperature</em>
unit for those, and the results should differ only by the conversion
factor. No offset should be applied here to convert between the origins
of different unit scales.</p>
<p>It is important to mention here that the existence of <em>Celsius
temperature</em> quantity type in <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span> is controversial.</p>
<p><span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span> (part 1) says:</p>
<blockquote>
<p>The system of quantities presented in this document is named the
International System of Quantities (ISQ), in all languages. This name
was not used in ISO 31 series, from which the present harmonized series
has evolved. However, the ISQ does appear in ISO/IEC Guide 99 and is the
system of quantities underlying the International System of Units,
denoted “SI”, in all languages according to the SI Brochure.</p>
</blockquote>
<p>According to the <span class="citation" data-cites="ISO-GUIDE">[<a href="#ref-ISO-GUIDE" role="doc-biblioref">ISO/IEC Guide 99</a>]</span>,
a system of quantities is a “set of quantities together with a set of
non-contradictory equations relating those quantities”. It also defines
the system of units as “set of base units and derived units, together
with their multiples and submultiples, defined in accordance with given
rules, for a given system of quantities”.</p>
<p>To say it explicitly, the system of quantities should not assume or
use any specific units in its definitions. It is essential as various
systems of units can be defined on top of it, and none of those should
be favored.</p>
<p>However, the <em>Celsius temperature</em> quantity type is defined in
<span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span> (part 5) as:</p>
<blockquote>
<p>temperature difference from the thermodynamic temperature of the ice
point is called the Celsius temperature <span class="math inline">\(t\)</span>, which is defined by the quantity
equation:</p>
<p><span class="math inline">\(t = T − T_0\)</span></p>
<p>where <span class="math inline">\(T\)</span> is thermodynamic
temperature (item 5-1) and <span class="math inline">\(T_0 =
273,15\:K\)</span></p>
</blockquote>
<p><em>Celsius temperature</em> is an exceptional quantity in the ISQ as
it uses specific SI units in its definition. This breaks the direction
of dependencies between systems of quantities and units and imposes
significant implementation issues.</p>
<p>As <span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span>
implementation clearly distinguishes between systems of quantities and
units and assumes that the latter directly depends on the former, this
quantity definition does not enforce any units or offsets. It is defined
as just a more specialized quantity of the kind of <em>thermodynamic
temperature</em>. We have added the Celsius temperature quantity type
for completeness and to gain more experience with it. Still, maybe a
good decision would be to skip it in the standardization process not to
confuse users.</p>
<p>After quoting the official definitions and terms and presenting how
quantities work, let’s discuss quantity points. Those describe specific
points and are measured relative to a provided origin:</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>quantity_point qp1 <span class="op">=</span> si<span class="op">::</span>zeroth_kelvin <span class="op">+</span> isq<span class="op">::</span>thermodynamic_temperature<span class="op">(</span><span class="fl">300.</span> <span class="op">*</span> K<span class="op">)</span>;</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>quantity_point qp2 <span class="op">=</span> si<span class="op">::</span>zeroth_degree_Celsius <span class="op">+</span> isq<span class="op">::</span>Celsius_temperature<span class="op">(</span><span class="fl">30.</span> <span class="op">*</span> deg_C<span class="op">)</span>;</span></code></pre></div>
<p>The above provides two different temperature points. The first one is
measured as a relative quantity to the absolute zero
(<code class="sourceCode default">0 K</code>), and the second one stores
the value relative to the ice point being the beginning of the degree
Celsius scale.</p>
<p>Thanks to the
<code class="sourceCode default">default_point_origin</code> used in the
<code class="sourceCode default">quantity_point</code> class template
definition and benefiting from the fact that units of temperature have
point origins provided in their definitions we can obtain exactly the
same quantity points with the following:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>quantity_point qp3<span class="op">{</span>isq<span class="op">::</span>thermodynamic_temperature<span class="op">(</span><span class="fl">300.</span> <span class="op">*</span> K<span class="op">)}</span>;</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>quantity_point qp4<span class="op">{</span>isq<span class="op">::</span>Celsius_temperature<span class="op">(</span><span class="fl">30.</span> <span class="op">*</span> deg_C<span class="op">)}</span>;</span></code></pre></div>
<p>It is essential to understand that the origins of quantity points
will not change if we convert their units:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>quantity_point qp3 <span class="op">=</span> qp1<span class="op">.</span>in<span class="op">(</span>deg_C<span class="op">)</span>;</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>quantity_point qp4 <span class="op">=</span> qp2<span class="op">.</span>in<span class="op">(</span>K<span class="op">)</span>;</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>std<span class="op">::</span>is_same_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>qp3<span class="op">.</span>point_origin<span class="op">)</span>, <span class="kw">decltype</span><span class="op">(</span>si<span class="op">::</span>absolute_zero<span class="op">)&gt;)</span>;</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>std<span class="op">::</span>is_same_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>qp4<span class="op">.</span>point_origin<span class="op">)</span>, <span class="kw">decltype</span><span class="op">(</span>si<span class="op">::</span>ice_point<span class="op">)&gt;)</span>;</span></code></pre></div>
<p>If we want to obtain the values of quantities in specific units
relative to the origins of their scales, we have to be explicit. We can
do it in several ways:</p>
<ol type="1">
<li><p>Subtracting points to obtain the quantity:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;qp1: {}, {}, {}&quot;</span>,</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>            qp1 <span class="op">-</span> si<span class="op">::</span>zeroth_kelvin,</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>            <span class="op">(</span>qp1 <span class="op">-</span> si<span class="op">::</span>zeroth_degree_Celsius<span class="op">).</span>in<span class="op">(</span>deg_C<span class="op">)</span>,</span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>            <span class="op">(</span>qp1 <span class="op">-</span> usc<span class="op">::</span>zeroth_degree_Fahrenheit<span class="op">).</span>in<span class="op">(</span>deg_F<span class="op">))</span>;</span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;qp2: {:{%N:.2f} %U}, {}, {}&quot;</span>,</span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a>            <span class="op">(</span>qp2 <span class="op">-</span> si<span class="op">::</span>zeroth_kelvin<span class="op">).</span>in<span class="op">(</span>K<span class="op">)</span>,</span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a>            qp2 <span class="op">-</span> si<span class="op">::</span>zeroth_degree_Celsius,</span>
<span id="cb152-8"><a href="#cb152-8" aria-hidden="true" tabindex="-1"></a>            <span class="op">(</span>qp2 <span class="op">-</span> usc<span class="op">::</span>zeroth_degree_Fahrenheit<span class="op">).</span>in<span class="op">(</span>deg_F<span class="op">))</span>;</span></code></pre></div></li>
<li><p>Using
<code class="sourceCode default">quantity_from(PonitOrigin)</code>
member function:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;qp1: {}, {}, {}&quot;</span>,</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>            qp1<span class="op">.</span>quantity_from<span class="op">(</span>si<span class="op">::</span>zeroth_kelvin<span class="op">)</span>,</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>            qp1<span class="op">.</span>quantity_from<span class="op">(</span>si<span class="op">::</span>zeroth_degree_Celsius<span class="op">).</span>in<span class="op">(</span>deg_C<span class="op">)</span>,</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>            qp1<span class="op">.</span>quantity_from<span class="op">(</span>usc<span class="op">::</span>zeroth_degree_Fahrenheit<span class="op">).</span>in<span class="op">(</span>deg_F<span class="op">))</span>;</span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;qp2: {:{%N:.2f} %U}, {}, {}&quot;</span>,</span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>            qp2<span class="op">.</span>quantity_from<span class="op">(</span>si<span class="op">::</span>zeroth_kelvin<span class="op">).</span>in<span class="op">(</span>K<span class="op">)</span>,</span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>            qp2<span class="op">.</span>quantity_from<span class="op">(</span>si<span class="op">::</span>zeroth_degree_Celsius<span class="op">)</span>,</span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a>            qp2<span class="op">.</span>quantity_from<span class="op">(</span>usc<span class="op">::</span>zeroth_degree_Fahrenheit<span class="op">).</span>in<span class="op">(</span>deg_F<span class="op">))</span>;</span></code></pre></div></li>
<li><p>Using
<code class="sourceCode default">quantity_from_zero()</code> member
function that will use the point origin defined for the current
unit:</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>fmt<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;qp1: {}, {}, {}&quot;</span>,</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>            qp1<span class="op">.</span>quantity_from_zero<span class="op">()</span>,</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>            qp1<span class="op">.</span>in<span class="op">(</span>deg_C<span class="op">).</span>quantity_from_zero<span class="op">()</span>,</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>            qp1<span class="op">.</span>in<span class="op">(</span>deg_F<span class="op">).</span>quantity_from_zero<span class="op">())</span>;</span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>fmt<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;qp2: {:{%N:.2f} %U}, {}, {}&quot;</span>,</span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>            qp2<span class="op">.</span>in<span class="op">(</span>K<span class="op">).</span>quantity_from_zero<span class="op">()</span>,</span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>            qp2<span class="op">.</span>quantity_from_zero<span class="op">()</span>,</span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>            qp2<span class="op">.</span>in<span class="op">(</span>deg_F<span class="op">).</span>quantity_from_zero<span class="op">())</span>;</span></code></pre></div></li>
</ol>
<p>All of the cases above will provide the same output:</p>
<pre class="text"><code>qp1: 300 K, 26.85 °C, 80.33 °F
qp2: 303.15 K, 30 °C, 86 °F</code></pre>
<p>Of course, all other combinations are also possible. For example,
nothing should prevent us from checking how many degrees of Celsius are
there starting from the
<code class="sourceCode default">zeroth_degree_Fahrenheit</code> for a
quantity point using kelvins with the
<code class="sourceCode default">zeroth_kelvin</code> origin:</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>quantity q <span class="op">=</span> qp1<span class="op">.</span>quantity_from<span class="op">(</span>usc<span class="op">::</span>zeroth_degree_Fahrenheit<span class="op">).</span>in<span class="op">(</span>deg_C<span class="op">)</span>;</span></code></pre></div>
<h3 data-number="14.2.6" id="structural-types"><span class="header-section-number">14.2.6</span> Structural types<a href="#structural-types" class="self-link"></a></h3>
<p>The <code class="sourceCode default">quantity</code> and
<code class="sourceCode default">quantity_point</code> class templates
are structural types to allow them to be passed as template arguments.
For example, we can write the following:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="kw">constexpr</span> <span class="kw">struct</span> amsterdam_sea_level <span class="op">:</span> absolute_point_origin<span class="op">&lt;</span>isq<span class="op">::</span>altitude<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> amsterdam_sea_level;</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a><span class="kw">constexpr</span> <span class="kw">struct</span> mediterranean_sea_level <span class="op">:</span> relative_point_origin<span class="op">&lt;</span>amsterdam_sea_level <span class="op">+</span> isq<span class="op">::</span>altitude<span class="op">(-</span><span class="dv">27</span> <span class="op">*</span> cm<span class="op">)&gt;</span> <span class="op">{</span></span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> mediterranean_sea_level;</span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> altitude_DE <span class="op">=</span> quantity_point<span class="op">&lt;</span>isq<span class="op">::</span>altitude<span class="op">[</span>m<span class="op">]</span>, amsterdam_sea_level<span class="op">&gt;</span>;</span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> altitude_CH <span class="op">=</span> quantity_point<span class="op">&lt;</span>isq<span class="op">::</span>altitude<span class="op">[</span>m<span class="op">]</span>, mediterranean_sea_level<span class="op">&gt;</span>;</span></code></pre></div>
<p>Unfortunately, current language rules require that all member data of
a structural type are public. This could be considered a safety issue.
We try really hard to provide unit-safe interfaces, but at the same time
expose the public “naked” data member that can be freely read or
manipulated by anyone.</p>
<p>Hopefully, this requirement on structural types will be relaxed
before the library gets standardized.</p>
<h1 data-number="15" id="text-output"><span class="header-section-number">15</span> Text output<a href="#text-output" class="self-link"></a></h1>
<p>A quantity value contains a numerical value and a unit. Both of them
may have various text representations. Not only numbers but also units
can be formatted in many different ways. Additionally, every dimension
can be represented as a text as well.</p>
<p>This chapter will discuss the different options we have here.</p>
<p><em>Note: For now, there is no standardized way to handle formatted
text input in the C++ standard library, so this paper does not propose
any approach to convert text to quantities. If <span class="citation" data-cites="P1729R3">[<a href="#ref-P1729R3" role="doc-biblioref">P1729R3</a>]</span> will be accepted by the LEWG,
then we will add a proper “Text input” chapter as well.</em></p>
<h2 data-number="15.1" id="symbols"><span class="header-section-number">15.1</span> Symbols<a href="#symbols" class="self-link"></a></h2>
<p>The definitions of dimensions, units, prefixes, and constants require
unique text symbols to be assigned for each entity. Those symbols can be
composed to express dimensions and units of base and derived
quantities.</p>
<h3 data-number="15.1.1" id="symbol-definition-examples"><span class="header-section-number">15.1.1</span> Symbol definition examples<a href="#symbol-definition-examples" class="self-link"></a></h3>
<p><em>Note: The below code examples are based on the latest version of
the <span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span> library
and might not be the final version proposed for
standardization.</em></p>
<p>Dimensions:</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> dim_length <span class="op">:</span> base_dimension<span class="op">&lt;</span><span class="st">&quot;L&quot;</span><span class="op">&gt;</span> <span class="op">{}</span> dim_length;</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> dim_mass <span class="op">:</span> base_dimension<span class="op">&lt;</span><span class="st">&quot;M&quot;</span><span class="op">&gt;</span> <span class="op">{}</span> dim_mass;</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> dim_time <span class="op">:</span> base_dimension<span class="op">&lt;</span><span class="st">&quot;T&quot;</span><span class="op">&gt;</span> <span class="op">{}</span> dim_time;</span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> dim_electric_current <span class="op">:</span> base_dimension<span class="op">&lt;</span><span class="st">&quot;I&quot;</span><span class="op">&gt;</span> <span class="op">{}</span> dim_electric_current;</span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> dim_thermodynamic_temperature <span class="op">:</span> base_dimension<span class="op">&lt;{</span><span class="st">u8&quot;Θ&quot;</span>, <span class="st">&quot;O&quot;</span><span class="op">}&gt;</span> <span class="op">{}</span> dim_thermodynamic_temperature;</span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> dim_amount_of_substance <span class="op">:</span> base_dimension<span class="op">&lt;</span><span class="st">&quot;N&quot;</span><span class="op">&gt;</span> <span class="op">{}</span> dim_amount_of_substance;</span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> dim_luminous_intensity <span class="op">:</span> base_dimension<span class="op">&lt;</span><span class="st">&quot;J&quot;</span><span class="op">&gt;</span> <span class="op">{}</span> dim_luminous_intensity;</span></code></pre></div>
<p>Units:</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> second <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;s&quot;</span>, kind_of<span class="op">&lt;</span>isq<span class="op">::</span>time<span class="op">&gt;&gt;</span> <span class="op">{}</span> second;</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> metre <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;m&quot;</span>, kind_of<span class="op">&lt;</span>isq<span class="op">::</span>length<span class="op">&gt;&gt;</span> <span class="op">{}</span> metre;</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> gram <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;g&quot;</span>, kind_of<span class="op">&lt;</span>isq<span class="op">::</span>mass<span class="op">&gt;&gt;</span> <span class="op">{}</span> gram;</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> kilogram <span class="op">:</span> <span class="kw">decltype</span><span class="op">(</span>kilo<span class="op">&lt;</span>gram<span class="op">&gt;)</span> <span class="op">{}</span> kilogram;</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> newton <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;N&quot;</span>, kilogram <span class="op">*</span> metre <span class="op">/</span> square<span class="op">(</span>second<span class="op">)&gt;</span> <span class="op">{}</span> newton;</span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> joule <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;J&quot;</span>, newton <span class="op">*</span> metre<span class="op">&gt;</span> <span class="op">{}</span> joule;</span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> watt <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;W&quot;</span>, joule <span class="op">/</span> second<span class="op">&gt;</span> <span class="op">{}</span> watt;</span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> coulomb <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;C&quot;</span>, ampere <span class="op">*</span> second<span class="op">&gt;</span> <span class="op">{}</span> coulomb;</span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> volt <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;V&quot;</span>, watt <span class="op">/</span> ampere<span class="op">&gt;</span> <span class="op">{}</span> volt;</span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> farad <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;F&quot;</span>, coulomb <span class="op">/</span> volt<span class="op">&gt;</span> <span class="op">{}</span> farad;</span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> ohm <span class="op">:</span> named_unit<span class="op">&lt;{</span><span class="st">u8&quot;Ω&quot;</span>, <span class="st">&quot;ohm&quot;</span><span class="op">}</span>, volt <span class="op">/</span> ampere<span class="op">&gt;</span> <span class="op">{}</span> ohm;</span></code></pre></div>
<p>Prefixes:</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span>PrefixableUnit <span class="kw">auto</span> U<span class="op">&gt;</span> <span class="kw">struct</span> micro_ <span class="op">:</span> prefixed_unit<span class="op">&lt;{</span><span class="st">u8&quot;µ&quot;</span>, <span class="st">&quot;u&quot;</span><span class="op">}</span>, mag_power<span class="op">&lt;</span><span class="dv">10</span>, <span class="op">-</span><span class="dv">6</span><span class="op">&gt;</span>, U<span class="op">&gt;</span> <span class="op">{}</span>;</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span>PrefixableUnit <span class="kw">auto</span> U<span class="op">&gt;</span> <span class="kw">struct</span> milli_ <span class="op">:</span> prefixed_unit<span class="op">&lt;</span><span class="st">&quot;m&quot;</span>, mag_power<span class="op">&lt;</span><span class="dv">10</span>, <span class="op">-</span><span class="dv">3</span><span class="op">&gt;</span>, U<span class="op">&gt;</span> <span class="op">{}</span>;</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span>PrefixableUnit <span class="kw">auto</span> U<span class="op">&gt;</span> <span class="kw">struct</span> centi_ <span class="op">:</span> prefixed_unit<span class="op">&lt;</span><span class="st">&quot;c&quot;</span>, mag_power<span class="op">&lt;</span><span class="dv">10</span>, <span class="op">-</span><span class="dv">2</span><span class="op">&gt;</span>, U<span class="op">&gt;</span> <span class="op">{}</span>;</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span>PrefixableUnit <span class="kw">auto</span> U<span class="op">&gt;</span> <span class="kw">struct</span> deci_  <span class="op">:</span> prefixed_unit<span class="op">&lt;</span><span class="st">&quot;d&quot;</span>, mag_power<span class="op">&lt;</span><span class="dv">10</span>, <span class="op">-</span><span class="dv">1</span><span class="op">&gt;</span>, U<span class="op">&gt;</span> <span class="op">{}</span>;</span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span>PrefixableUnit <span class="kw">auto</span> U<span class="op">&gt;</span> <span class="kw">struct</span> deca_  <span class="op">:</span> prefixed_unit<span class="op">&lt;</span><span class="st">&quot;da&quot;</span>, mag_power<span class="op">&lt;</span><span class="dv">10</span>, <span class="dv">1</span><span class="op">&gt;</span>, U<span class="op">&gt;</span> <span class="op">{}</span>;</span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span>PrefixableUnit <span class="kw">auto</span> U<span class="op">&gt;</span> <span class="kw">struct</span> hecto_ <span class="op">:</span> prefixed_unit<span class="op">&lt;</span><span class="st">&quot;h&quot;</span>, mag_power<span class="op">&lt;</span><span class="dv">10</span>, <span class="dv">2</span><span class="op">&gt;</span>, U<span class="op">&gt;</span> <span class="op">{}</span>;</span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span>PrefixableUnit <span class="kw">auto</span> U<span class="op">&gt;</span> <span class="kw">struct</span> kilo_  <span class="op">:</span> prefixed_unit<span class="op">&lt;</span><span class="st">&quot;k&quot;</span>, mag_power<span class="op">&lt;</span><span class="dv">10</span>, <span class="dv">3</span><span class="op">&gt;</span>, U<span class="op">&gt;</span> <span class="op">{}</span>;</span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span>PrefixableUnit <span class="kw">auto</span> U<span class="op">&gt;</span> <span class="kw">struct</span> mega_  <span class="op">:</span> prefixed_unit<span class="op">&lt;</span><span class="st">&quot;M&quot;</span>, mag_power<span class="op">&lt;</span><span class="dv">10</span>, <span class="dv">6</span><span class="op">&gt;</span>, U<span class="op">&gt;</span> <span class="op">{}</span>;</span></code></pre></div>
<p>Constants:</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> hyperfine_structure_transition_frequency_of_cs <span class="op">:</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>  named_unit<span class="op">&lt;{</span><span class="st">u8&quot;Δν_Cs&quot;</span>, <span class="st">&quot;dv_Cs&quot;</span><span class="op">}</span>, mag<span class="op">&lt;</span><span class="dv">9&#39;192&#39;631&#39;770</span><span class="op">&gt;</span> <span class="op">*</span> hertz<span class="op">&gt;</span> <span class="op">{}</span> hyperfine_structure_transition_frequency_of_cs;</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> speed_of_light_in_vacuum <span class="op">:</span></span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>  named_unit<span class="op">&lt;</span><span class="st">&quot;c&quot;</span>, mag<span class="op">&lt;</span><span class="dv">299&#39;792&#39;458</span><span class="op">&gt;</span> <span class="op">*</span> metre <span class="op">/</span> second<span class="op">&gt;</span> <span class="op">{}</span> speed_of_light_in_vacuum;</span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> planck_constant <span class="op">:</span></span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a>  named_unit<span class="op">&lt;</span><span class="st">&quot;h&quot;</span>, mag<span class="op">&lt;</span>ratio<span class="op">{</span><span class="dv">662&#39;607&#39;015</span>, <span class="dv">100&#39;000&#39;000</span><span class="op">}&gt;</span> <span class="op">*</span> mag_power<span class="op">&lt;</span><span class="dv">10</span>, <span class="op">-</span><span class="dv">34</span><span class="op">&gt;</span> <span class="op">*</span> joule <span class="op">*</span> second<span class="op">&gt;</span> <span class="op">{}</span> planck_constant;</span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> elementary_charge <span class="op">:</span></span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a>  named_unit<span class="op">&lt;</span><span class="st">&quot;e&quot;</span>, mag<span class="op">&lt;</span>ratio<span class="op">{</span><span class="dv">1&#39;602&#39;176&#39;634</span>, <span class="dv">1&#39;000&#39;000&#39;000</span><span class="op">}&gt;</span> <span class="op">*</span> mag_power<span class="op">&lt;</span><span class="dv">10</span>, <span class="op">-</span><span class="dv">19</span><span class="op">&gt;</span> <span class="op">*</span> coulomb<span class="op">&gt;</span> <span class="op">{}</span> elementary_charge;</span>
<span id="cb160-9"><a href="#cb160-9" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> boltzmann_constant <span class="op">:</span></span>
<span id="cb160-10"><a href="#cb160-10" aria-hidden="true" tabindex="-1"></a>  named_unit<span class="op">&lt;</span><span class="st">&quot;k&quot;</span>, mag<span class="op">&lt;</span>ratio<span class="op">{</span><span class="dv">1&#39;380&#39;649</span>, <span class="dv">1&#39;000&#39;000</span><span class="op">}&gt;</span> <span class="op">*</span> mag_power<span class="op">&lt;</span><span class="dv">10</span>, <span class="op">-</span><span class="dv">23</span><span class="op">&gt;</span> <span class="op">*</span> joule <span class="op">/</span> kelvin<span class="op">&gt;</span> <span class="op">{}</span> boltzmann_constant;</span>
<span id="cb160-11"><a href="#cb160-11" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> avogadro_constant <span class="op">:</span></span>
<span id="cb160-12"><a href="#cb160-12" aria-hidden="true" tabindex="-1"></a>  named_unit<span class="op">&lt;</span><span class="st">&quot;N_A&quot;</span>, mag<span class="op">&lt;</span>ratio<span class="op">{</span><span class="dv">602&#39;214&#39;076</span>, <span class="dv">100&#39;000&#39;000</span><span class="op">}&gt;</span> <span class="op">*</span> mag_power<span class="op">&lt;</span><span class="dv">10</span>, <span class="dv">23</span><span class="op">&gt;</span> <span class="op">/</span> mole<span class="op">&gt;</span> <span class="op">{}</span> avogadro_constant;</span>
<span id="cb160-13"><a href="#cb160-13" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> luminous_efficacy <span class="op">:</span></span>
<span id="cb160-14"><a href="#cb160-14" aria-hidden="true" tabindex="-1"></a>  named_unit<span class="op">&lt;</span><span class="st">&quot;K_cd&quot;</span>, mag<span class="op">&lt;</span><span class="dv">683</span><span class="op">&gt;</span> <span class="op">*</span> lumen <span class="op">/</span> watt<span class="op">&gt;</span> <span class="op">{}</span> luminous_efficacy;</span></code></pre></div>
<h3 data-number="15.1.2" id="lack-of-unicode-subscript-characters"><span class="header-section-number">15.1.2</span> Lack of Unicode subscript
characters<a href="#lack-of-unicode-subscript-characters" class="self-link"></a></h3>
<p>Unicode provides only a minimal set of characters available as
subscripts, which are often used to differentiate various constants and
quantities of the same kind. To workaround this issue, <span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span> uses ’_’ character to specify
that the following characters should be considered a subscript of the
symbol.</p>
<h3 data-number="15.1.3" id="symbols-for-quantity-types"><span class="header-section-number">15.1.3</span> Symbols for quantity types<a href="#symbols-for-quantity-types" class="self-link"></a></h3>
<p>Although the ISQ defined in <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span> provides symbols for each
quantity type, there is little use for them in the C++ code. In the
<span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span> project, we never had a
request to provide such symbol definitions. Even though having them for
completeness could be nice, they seem to not be required by the domain
experts for their daily jobs. Also, it is worth noting that providing
those raises some additional standardization and implementation
challenges.</p>
<p>If we decide to provide symbols, the rest of this chapter provides
the domain information to assess the complexity and potential issues
with standardization and implementation of those.</p>
<p>All ISQ quantities have an official symbol assigned in their
definitions, and how those should be printed is exactly specified. <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span> explicitly states:</p>
<blockquote>
<p>The quantity symbols shall be written in italic (sloping) type,
irrespective of the type used in the rest of the text.</p>
</blockquote>
<p>Additionally, <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span>
provides additional requirements for printing quantities of vector and
tensor characters:</p>
<ul>
<li>vectors should be printed with a boldface type or have a right arrow
above the letter symbol (e.g., <strong><em>a</em></strong> or <span class="math inline">\(\mathit{\overrightarrow{a}}\)</span>),</li>
<li>tensors should use either boldface sans serif type or have two
arrows above the letter symbol (e.g., <strong><em>T</em></strong> or
<span class="math inline">\(\overrightarrow{\overrightarrow{T}}\)</span>).</li>
</ul>
<p><em>Note: In the above examples, the second symbol with arrows above
should also use letters written in italics. The author could not find a
way to format it properly in this document.</em></p>
<p>There are also a few requirements for printing subscripts of quantity
types. <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span>
states:</p>
<blockquote>
<p>The following principles for the printing of subscripts apply:</p>
<ul>
<li>A subscript that represents a physical quantity or a mathematical
variable, such as a running number, is printed in italic (sloping)
type.</li>
<li>Other subscripts, such as those representing words or fixed numbers,
are printed in roman (upright) type.</li>
</ul>
</blockquote>
<p>It is worth noting that only a limited set of Unicode characters are
available as subscripts. Those are often used to differentiate various
quantities of the same kind.</p>
<p>For example, it is impossible to encode the symbols of the following
quantities:</p>
<ul>
<li><em>c</em><sub>sat</sub> - <em>specific heat capacity at saturated
vapour pressure</em>,</li>
<li><em>μ</em><sub>JT</sub> - <em>Joule-Thomson coefficient</em>,</li>
<li><em>w</em><sub>H<sub>2</sub>O</sub> - <em>mass fraction of
water</em>,</li>
<li><em>σ</em><sub>Ω,E</sub> - <em>direction and energy distribution of
cross section</em>,</li>
<li><em>d</em><sub>1/2</sub> - <em>half-value thickness</em>,</li>
<li><em>Φ</em><sub>e,λ</sub> - <em>spectral radiant flux</em>.</li>
</ul>
<p>It is important to state that the same issues are related to constant
definitions. For them, in the <a href="#symbol-definition-examples">Symbol definition examples</a>
chapter, we proposed to use the ’_’ character instead, as stated in <a href="#lack-of-unicode-subscript-characters">Lack of Unicode subscript
characters</a>. We could use the same practice here.</p>
<p>Another challenge here might be related to the fact that <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span> often provides more than
one symbol for the same quantity. For example:</p>
<ul>
<li><em>frequency</em> can use <em>f</em> or <em>ν</em>,</li>
<li><em>time constant</em> can use <em>τ</em> or <em>T</em> (<em>T</em>
is also the only symbol provided for the <em>period duration</em>
quantity),</li>
<li><em>thickness</em> can use <em>d</em> or <em>δ</em>,</li>
<li><em>diameter</em> can use <em>d</em> or <em>D</em> (which again
conflicts with the <em>diameter</em> symbol).</li>
</ul>
<p>Last but not least, it is worth noting that symbols of ISQ base
quantities are not necessary the same as official dimension symbols of
those quantities:</p>
<table>
<colgroup>
<col style="width: 40%" />
<col style="width: 33%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th><div style="text-align:center">
<strong>Quantity type</strong>
</div></th>
<th style="text-align: center;"><div style="text-align:center">
<strong>Quantity type symbol</strong>
</div></th>
<th style="text-align: center;"><div style="text-align:center">
<strong>Dimension symbol</strong>
</div></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>length</em></td>
<td style="text-align: center;"><em>l</em>, <em>L</em></td>
<td style="text-align: center;">L</td>
</tr>
<tr class="even">
<td><em>mass</em></td>
<td style="text-align: center;"><em>m</em></td>
<td style="text-align: center;">M</td>
</tr>
<tr class="odd">
<td><em>time</em></td>
<td style="text-align: center;"><em>t</em></td>
<td style="text-align: center;">T</td>
</tr>
<tr class="even">
<td><em>electric current</em></td>
<td style="text-align: center;"><em>I</em>, <em>i</em></td>
<td style="text-align: center;">I</td>
</tr>
<tr class="odd">
<td><em>thermodynamic temperature</em></td>
<td style="text-align: center;"><em>T</em>, <em>Θ</em></td>
<td style="text-align: center;">Θ</td>
</tr>
<tr class="even">
<td><em>amount of substance</em></td>
<td style="text-align: center;"><em>n</em>(X)</td>
<td style="text-align: center;">N</td>
</tr>
<tr class="odd">
<td><em>luminous intensity</em></td>
<td style="text-align: center;"><em>I</em><sub>v</sub>,
(<em>I</em>)</td>
<td style="text-align: center;">J</td>
</tr>
</tbody>
</table>
<p>Founding a way to define, use, and print named quantity types is not
enough. What should also be covered here is the text output of derived
quantities. There are plenty of operations that one might do on scalar,
vector, and tensor quantities, and all of them result in another
quantity type, which should also be able to be printed in the console
text output.</p>
<p>Taking all the challenges and issues mentioned above, we do not
propose providing quantity type symbols in their definitions and any
text input/output support for those.</p>
<h3 data-number="15.1.4" id="fixed_string"><span class="header-section-number">15.1.4</span>
<code class="sourceCode default">fixed_string</code><a href="#fixed_string" class="self-link"></a></h3>
<p>As shown above, symbols are provided as class NTTPs in the library.
This means that the string type used for such a purpose has to satisfy
the structural type requirements of the C++ language. One of such
requirements is to expose all the data members publicly. So far, none of
the existing string types in the C++ standard library satisfies such
requirements. This is why we need to introduce a new type.</p>
<p>Such type should:</p>
<ul>
<li>satisfy structural type requirements,</li>
<li>be equality comparable and potentially totally ordered,</li>
<li>store and provide concatenation support for zero-ended strings,</li>
<li>provide storage that, if set at compile time, would also be
available for read-only access at runtime,</li>
<li>provide at least read-only access to the contained storage.</li>
</ul>
<p>Such a type does not need to expose a string-like interface. In case
its interface is immutable, we can easily wrap it with
<code class="sourceCode default">std::string_view</code> to get such an
interface for free.</p>
<p>This type is being proposed separately in <span class="citation" data-cites="P3094R0">[<a href="#ref-P3094R0" role="doc-biblioref">P3094R0</a>]</span>.</p>
<h3 data-number="15.1.5" id="symbol_text"><span class="header-section-number">15.1.5</span>
<code class="sourceCode default">symbol_text</code><a href="#symbol_text" class="self-link"></a></h3>
<p>Many symbols of units, prefixes, and constants require using a
Unicode character set. For example:</p>
<ul>
<li>Θ - thermodynamic temperature dimension</li>
<li>µ - micro</li>
<li>Ω - ohm</li>
<li>°C - degree Celsius</li>
<li>°F - degree Fahrenheit</li>
<li>° - degree</li>
<li>′ - arcminute</li>
<li>″ - arcsecond</li>
<li>ᵍ - gradian</li>
<li>Å - angstrom</li>
<li>M_☉ - solar mass</li>
<li>Δν_Cs - hyperfine structure transition frequency of Cs</li>
<li>g₀ - standard gravity</li>
<li>μ₀ - magnetic constant</li>
<li>c₀ - speed of light</li>
<li>H₀ - hubble constant</li>
</ul>
<p>The library should provide such Unicode output by default to be
consistent with official systems’ specifications.</p>
<p>On the other hand, plenty of terminals do not support Unicode
characters. Also, general engineering experience shows that people often
prefer to work with a basic literal character set. This is why all such
entities should provide an alternative spelling in their
definitions.</p>
<p>This is where <code class="sourceCode default">symbol_text</code>
comes into play. It is a simple wrapper over the two
<code class="sourceCode default">fixed_string</code> objects:</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span>std<span class="op">::</span><span class="dt">size_t</span> N, std<span class="op">::</span><span class="dt">size_t</span> M<span class="op">&gt;</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> symbol_text <span class="op">{</span></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>  fixed_u8string<span class="op">&lt;</span>N<span class="op">&gt;</span> unicode_;  <span class="co">// exposition only</span></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>  fixed_string<span class="op">&lt;</span>M<span class="op">&gt;</span> ascii_;      <span class="co">// exposition only</span></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">constexpr</span> <span class="kw">explicit</span><span class="op">(</span><span class="kw">false</span><span class="op">)</span> symbol_text<span class="op">(</span><span class="dt">char</span> ch<span class="op">)</span>;</span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">constexpr</span> <span class="kw">explicit</span><span class="op">(</span><span class="kw">false</span><span class="op">)</span> symbol_text<span class="op">(</span><span class="kw">const</span> <span class="dt">char</span> <span class="op">(&amp;</span>txt<span class="op">)[</span>N <span class="op">+</span> <span class="dv">1</span><span class="op">])</span>;</span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">constexpr</span> <span class="kw">explicit</span><span class="op">(</span><span class="kw">false</span><span class="op">)</span> symbol_text<span class="op">(</span><span class="kw">const</span> fixed_string<span class="op">&lt;</span>N<span class="op">&gt;&amp;</span> txt<span class="op">)</span>;</span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">constexpr</span> symbol_text<span class="op">(</span><span class="kw">const</span> <span class="dt">char8_t</span> <span class="op">(&amp;</span>u<span class="op">)[</span>N <span class="op">+</span> <span class="dv">1</span><span class="op">]</span>, <span class="kw">const</span> <span class="dt">char</span> <span class="op">(&amp;</span>a<span class="op">)[</span>M <span class="op">+</span> <span class="dv">1</span><span class="op">])</span>;</span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">constexpr</span> symbol_text<span class="op">(</span><span class="kw">const</span> fixed_u8string<span class="op">&lt;</span>N<span class="op">&gt;&amp;</span> u, <span class="kw">const</span> fixed_string<span class="op">&lt;</span>M<span class="op">&gt;&amp;</span> a<span class="op">)</span>;</span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a>  <span class="op">[[</span><span class="at">nodiscard</span><span class="op">]]</span> <span class="kw">constexpr</span> <span class="kw">const</span> <span class="kw">auto</span><span class="op">&amp;</span> unicode<span class="op">()</span> <span class="kw">const</span>;</span>
<span id="cb161-12"><a href="#cb161-12" aria-hidden="true" tabindex="-1"></a>  <span class="op">[[</span><span class="at">nodiscard</span><span class="op">]]</span> <span class="kw">constexpr</span> <span class="kw">const</span> <span class="kw">auto</span><span class="op">&amp;</span> ascii<span class="op">()</span> <span class="kw">const</span>;</span>
<span id="cb161-13"><a href="#cb161-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-14"><a href="#cb161-14" aria-hidden="true" tabindex="-1"></a>  <span class="op">[[</span><span class="at">nodiscard</span><span class="op">]]</span> <span class="kw">constexpr</span> <span class="dt">bool</span> empty<span class="op">()</span> <span class="kw">const</span>;</span>
<span id="cb161-15"><a href="#cb161-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-16"><a href="#cb161-16" aria-hidden="true" tabindex="-1"></a>  <span class="kw">template</span><span class="op">&lt;</span>std<span class="op">::</span><span class="dt">size_t</span> N2, std<span class="op">::</span><span class="dt">size_t</span> M2<span class="op">&gt;</span></span>
<span id="cb161-17"><a href="#cb161-17" aria-hidden="true" tabindex="-1"></a>  <span class="op">[[</span><span class="at">nodiscard</span><span class="op">]]</span> <span class="kw">constexpr</span> <span class="kw">friend</span> symbol_text<span class="op">&lt;</span>N <span class="op">+</span> N2, M <span class="op">+</span> M2<span class="op">&gt;</span> <span class="kw">operator</span><span class="op">+(</span><span class="kw">const</span> symbol_text<span class="op">&amp;</span> lhs,</span>
<span id="cb161-18"><a href="#cb161-18" aria-hidden="true" tabindex="-1"></a>                                                                       <span class="kw">const</span> symbol_text<span class="op">&lt;</span>N2, M2<span class="op">&gt;&amp;</span> rhs<span class="op">)</span>;</span>
<span id="cb161-19"><a href="#cb161-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-20"><a href="#cb161-20" aria-hidden="true" tabindex="-1"></a>  <span class="kw">template</span><span class="op">&lt;</span>std<span class="op">::</span><span class="dt">size_t</span> N2, std<span class="op">::</span><span class="dt">size_t</span> M2<span class="op">&gt;</span></span>
<span id="cb161-21"><a href="#cb161-21" aria-hidden="true" tabindex="-1"></a>  <span class="op">[[</span><span class="at">nodiscard</span><span class="op">]]</span> <span class="kw">friend</span> <span class="kw">constexpr</span> <span class="kw">auto</span> <span class="kw">operator</span><span class="op">&lt;=&gt;(</span><span class="kw">const</span> symbol_text<span class="op">&amp;</span> lhs, <span class="kw">const</span> symbol_text<span class="op">&lt;</span>N2, M2<span class="op">&gt;&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span>;</span>
<span id="cb161-22"><a href="#cb161-22" aria-hidden="true" tabindex="-1"></a>  <span class="kw">template</span><span class="op">&lt;</span>std<span class="op">::</span><span class="dt">size_t</span> N2, std<span class="op">::</span><span class="dt">size_t</span> M2<span class="op">&gt;</span></span>
<span id="cb161-23"><a href="#cb161-23" aria-hidden="true" tabindex="-1"></a>  <span class="op">[[</span><span class="at">nodiscard</span><span class="op">]]</span> <span class="kw">friend</span> <span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">==(</span><span class="kw">const</span> symbol_text<span class="op">&amp;</span> lhs, <span class="kw">const</span> symbol_text<span class="op">&lt;</span>N2, M2<span class="op">&gt;&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span>;</span>
<span id="cb161-24"><a href="#cb161-24" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>;</span>
<span id="cb161-25"><a href="#cb161-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-26"><a href="#cb161-26" aria-hidden="true" tabindex="-1"></a>symbol_text<span class="op">(</span><span class="dt">char</span><span class="op">)</span> <span class="op">-&gt;</span> symbol_text<span class="op">&lt;</span><span class="dv">1</span>, <span class="dv">1</span><span class="op">&gt;</span>;</span>
<span id="cb161-27"><a href="#cb161-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-28"><a href="#cb161-28" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span>std<span class="op">::</span><span class="dt">size_t</span> N<span class="op">&gt;</span></span>
<span id="cb161-29"><a href="#cb161-29" aria-hidden="true" tabindex="-1"></a>symbol_text<span class="op">(</span><span class="kw">const</span> <span class="dt">char</span> <span class="op">(&amp;)[</span>N<span class="op">])</span> <span class="op">-&gt;</span> symbol_text<span class="op">&lt;</span>N <span class="op">-</span> <span class="dv">1</span>, N <span class="op">-</span> <span class="dv">1</span><span class="op">&gt;</span>;</span>
<span id="cb161-30"><a href="#cb161-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-31"><a href="#cb161-31" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span>std<span class="op">::</span><span class="dt">size_t</span> N<span class="op">&gt;</span></span>
<span id="cb161-32"><a href="#cb161-32" aria-hidden="true" tabindex="-1"></a>symbol_text<span class="op">(</span><span class="kw">const</span> fixed_string<span class="op">&lt;</span>N<span class="op">&gt;&amp;)</span> <span class="op">-&gt;</span> symbol_text<span class="op">&lt;</span>N, N<span class="op">&gt;</span>;</span>
<span id="cb161-33"><a href="#cb161-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-34"><a href="#cb161-34" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span>std<span class="op">::</span><span class="dt">size_t</span> N, std<span class="op">::</span><span class="dt">size_t</span> M<span class="op">&gt;</span></span>
<span id="cb161-35"><a href="#cb161-35" aria-hidden="true" tabindex="-1"></a>symbol_text<span class="op">(</span><span class="kw">const</span> <span class="dt">char8_t</span> <span class="op">(&amp;)[</span>N<span class="op">]</span>, <span class="kw">const</span> <span class="dt">char</span> <span class="op">(&amp;)[</span>M<span class="op">])</span> <span class="op">-&gt;</span> symbol_text<span class="op">&lt;</span>N <span class="op">-</span> <span class="dv">1</span>, M <span class="op">-</span> <span class="dv">1</span><span class="op">&gt;</span>;</span>
<span id="cb161-36"><a href="#cb161-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-37"><a href="#cb161-37" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span>std<span class="op">::</span><span class="dt">size_t</span> N, std<span class="op">::</span><span class="dt">size_t</span> M<span class="op">&gt;</span></span>
<span id="cb161-38"><a href="#cb161-38" aria-hidden="true" tabindex="-1"></a>symbol_text<span class="op">(</span><span class="kw">const</span> fixed_u8string<span class="op">&lt;</span>N<span class="op">&gt;&amp;</span>, <span class="kw">const</span> fixed_string<span class="op">&lt;</span>M<span class="op">&gt;&amp;)</span> <span class="op">-&gt;</span> symbol_text<span class="op">&lt;</span>N, M<span class="op">&gt;</span>;</span></code></pre></div>
<p><em>Note: There is literally no way in the current version of the C++
language to output Unicode character types
(<code class="sourceCode default">char8_t</code>,
<code class="sourceCode default">char16_t</code>, and
<code class="sourceCode default">char32_t</code>) to the console, the
<span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span> library currently uses
<code class="sourceCode default">char</code> to encode both
strings.</em></p>
<h3 data-number="15.1.6" id="derived-dimensions-symbols-generation"><span class="header-section-number">15.1.6</span> Derived dimensions symbols
generation<a href="#derived-dimensions-symbols-generation" class="self-link"></a></h3>
<p>TBD</p>
<h3 data-number="15.1.7" id="derived-unit-symbols-generation"><span class="header-section-number">15.1.7</span> Derived unit symbols
generation<a href="#derived-unit-symbols-generation" class="self-link"></a></h3>
<p>Based on the provided definitions for base units, the library creates
symbols for derived ones.</p>
<h4 data-number="15.1.7.1" id="unit_symbol_formatting"><span class="header-section-number">15.1.7.1</span>
<code class="sourceCode default">unit_symbol_formatting</code><a href="#unit_symbol_formatting" class="self-link"></a></h4>
<p><code class="sourceCode default">unit_symbol_formatting</code> is a
data type describing the configuration of the symbol generation
algorithm. It contains three orthogonal fields, and each of them has a
default value.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="kw">enum</span> <span class="kw">class</span> text_encoding <span class="op">:</span> std<span class="op">::</span><span class="dt">int8_t</span> <span class="op">{</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>  unicode,  <span class="co">// m³;  µs</span></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>  ascii,    <span class="co">// m^3; us</span></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>  default_encoding <span class="op">=</span> unicode</span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>;</span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a><span class="kw">enum</span> <span class="kw">class</span> unit_symbol_solidus <span class="op">:</span> std<span class="op">::</span><span class="dt">int8_t</span> <span class="op">{</span></span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>  one_denominator,  <span class="co">// m/s;   kg m⁻¹ s⁻¹</span></span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>  always,           <span class="co">// m/s;   kg/(m s)</span></span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a>  never,            <span class="co">// m s⁻¹; kg m⁻¹ s⁻¹</span></span>
<span id="cb162-11"><a href="#cb162-11" aria-hidden="true" tabindex="-1"></a>  default_denominator <span class="op">=</span> one_denominator</span>
<span id="cb162-12"><a href="#cb162-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>;</span>
<span id="cb162-13"><a href="#cb162-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-14"><a href="#cb162-14" aria-hidden="true" tabindex="-1"></a><span class="kw">enum</span> <span class="kw">class</span> unit_symbol_separator <span class="op">:</span> std<span class="op">::</span><span class="dt">int8_t</span> <span class="op">{</span></span>
<span id="cb162-15"><a href="#cb162-15" aria-hidden="true" tabindex="-1"></a>  space,          <span class="co">// kg m²/s²</span></span>
<span id="cb162-16"><a href="#cb162-16" aria-hidden="true" tabindex="-1"></a>  half_high_dot,  <span class="co">// kg⋅m²/s²  (valid only for Unicode encoding)</span></span>
<span id="cb162-17"><a href="#cb162-17" aria-hidden="true" tabindex="-1"></a>  default_separator <span class="op">=</span> space</span>
<span id="cb162-18"><a href="#cb162-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>;</span>
<span id="cb162-19"><a href="#cb162-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-20"><a href="#cb162-20" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> unit_symbol_formatting <span class="op">{</span></span>
<span id="cb162-21"><a href="#cb162-21" aria-hidden="true" tabindex="-1"></a>  text_encoding encoding <span class="op">=</span> text_encoding<span class="op">::</span>default_encoding;</span>
<span id="cb162-22"><a href="#cb162-22" aria-hidden="true" tabindex="-1"></a>  unit_symbol_solidus solidus <span class="op">=</span> unit_symbol_solidus<span class="op">::</span>default_denominator;</span>
<span id="cb162-23"><a href="#cb162-23" aria-hidden="true" tabindex="-1"></a>  unit_symbol_separator separator <span class="op">=</span> unit_symbol_separator<span class="op">::</span>default_separator;</span>
<span id="cb162-24"><a href="#cb162-24" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>;</span></code></pre></div>
<h4 data-number="15.1.7.2" id="unit_symbol"><span class="header-section-number">15.1.7.2</span>
<code class="sourceCode default">unit_symbol()</code><a href="#unit_symbol" class="self-link"></a></h4>
<p>Returns a <code class="sourceCode default">fixed_string</code>
storing the symbol of the unit for the provided configuration:</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span>unit_symbol_formatting fmt <span class="op">=</span> unit_symbol_formatting<span class="op">{}</span>, <span class="kw">typename</span> CharT <span class="op">=</span> <span class="dt">char</span>, Unit U<span class="op">&gt;</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="op">[[</span><span class="at">nodiscard</span><span class="op">]]</span> <span class="kw">consteval</span> <span class="kw">auto</span> unit_symbol<span class="op">(</span>U<span class="op">)</span>;</span></code></pre></div>
<p><em>Note 1: This function could return a
<code class="sourceCode default">std::string_view</code> pointing to the
internal static buffer.</em></p>
<p><em>Note 2: It could be refactored to
<code class="sourceCode default">unit_symbol(U, fmt)</code> when <span class="citation" data-cites="P1045R1">[<a href="#ref-P1045R1" role="doc-biblioref">P1045R1</a>]</span> is available.</em></p>
<p>For example:</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>unit_symbol<span class="op">&lt;{.</span>solidus <span class="op">=</span> unit_symbol_solidus<span class="op">::</span>never,</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>                           <span class="op">.</span>separator <span class="op">=</span> unit_symbol_separator<span class="op">::</span>half_high_dot<span class="op">}&gt;(</span>kg <span class="op">*</span> m <span class="op">/</span> s2<span class="op">)</span> <span class="op">==</span> <span class="st">&quot;kg⋅m⋅s⁻²&quot;</span><span class="op">)</span>;</span></code></pre></div>
<h4 data-number="15.1.7.3" id="unit_symbol_to"><span class="header-section-number">15.1.7.3</span>
<code class="sourceCode default">unit_symbol_to()</code><a href="#unit_symbol_to" class="self-link"></a></h4>
<p>Inserts the generated unit symbol to the output text iterator at
runtime based on the provided configuration.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span><span class="kw">typename</span> CharT <span class="op">=</span> <span class="dt">char</span>, std<span class="op">::</span>output_iterator<span class="op">&lt;</span>CharT<span class="op">&gt;</span> Out, Unit U<span class="op">&gt;</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="kw">constexpr</span> Out unit_symbol_to<span class="op">(</span>Out out, U u, unit_symbol_formatting fmt <span class="op">=</span> unit_symbol_formatting<span class="op">{})</span>;</span></code></pre></div>
<p>For example:</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>string txt;</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>unit_symbol_to<span class="op">(</span>std<span class="op">::</span>back_inserter<span class="op">(</span>txt<span class="op">)</span>, kg <span class="op">*</span> m <span class="op">/</span> s2,</span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>               <span class="op">{.</span>solidus <span class="op">=</span> unit_symbol_solidus<span class="op">::</span>never, <span class="op">.</span>separator <span class="op">=</span> unit_symbol_separator<span class="op">::</span>half_high_dot<span class="op">})</span>;</span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> txt <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>;</span></code></pre></div>
<p>The above prints:</p>
<pre class="text"><code>kg⋅m⋅s⁻²</code></pre>
<h2 data-number="15.2" id="space_before_unit_symbol-customization-point"><span class="header-section-number">15.2</span>
<code class="sourceCode default">space_before_unit_symbol</code>
customization point<a href="#space_before_unit_symbol-customization-point" class="self-link"></a></h2>
<p>The <span class="citation" data-cites="SI">[<a href="#ref-SI" role="doc-biblioref">SI</a>]</span> says:</p>
<blockquote>
<p>The numerical value always precedes the unit and a space is always
used to separate the unit from the number. … The only exceptions to this
rule are for the unit symbols for degree, minute and second for plane
angle, <code class="sourceCode default">°</code>,
<code class="sourceCode default">′</code> and
<code class="sourceCode default">″</code>, respectively, for which no
space is left between the numerical value and the unit symbol.</p>
</blockquote>
<p>There are more units with such properties. For example, percent
(<code class="sourceCode default">%</code>) and per
mille(<code class="sourceCode default">‰</code>).</p>
<p>To support the above, the library exposes
<code class="sourceCode default">space_before_unit_symbol</code>
customization point. By default, its value is
<code class="sourceCode default">true</code> for all the units. This
means that a number and a unit will be separated by the space in the
output text. To change this behavior, a user should provide a partial
specialization for a specific unit:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;&gt;</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="dt">bool</span> space_before_unit_symbol<span class="op">&lt;</span>non_si<span class="op">::</span>degree<span class="op">&gt;</span> <span class="op">=</span> <span class="kw">false</span>;</span></code></pre></div>
<p>The above works only for the default formatting or for the format
strings that use <code class="sourceCode default">%?</code> placement
field
(<code class="sourceCode default">std::format(&quot;{}&quot;, q)</code>
is equivalent to <code class="sourceCode default">std::format(&quot;{:%N%?%U}&quot;, q)</code>).</p>
<p>In case a user provides custom format specification (e.g., <code class="sourceCode default">std::format(&quot;{:%N %U}&quot;, q)</code>),
the library will always obey this specification for all the units (no
matter what the actual value of the
<code class="sourceCode default">space_before_unit_symbol</code>
customization point is) and the separating space will always be used in
this case.</p>
<h2 data-number="15.3" id="output-streams"><span class="header-section-number">15.3</span> Output streams<a href="#output-streams" class="self-link"></a></h2>
<p>The easiest way to print a dimension, unit, or quantity is to provide
its object to the output stream:</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> quantity v1 <span class="op">=</span> avg_speed<span class="op">(</span><span class="fl">220.</span> <span class="op">*</span> km, <span class="dv">2</span> <span class="op">*</span> h<span class="op">)</span>;</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> quantity v2 <span class="op">=</span> avg_speed<span class="op">(</span><span class="fl">140.</span> <span class="op">*</span> mi, <span class="dv">2</span> <span class="op">*</span> h<span class="op">)</span>;</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> v1 <span class="op">&lt;&lt;</span> <span class="ch">&#39;</span><span class="sc">\n</span><span class="ch">&#39;</span>;            <span class="co">// 110 km/h</span></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> v2 <span class="op">&lt;&lt;</span> <span class="ch">&#39;</span><span class="sc">\n</span><span class="ch">&#39;</span>;            <span class="co">// 70 mi/h</span></span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> v2<span class="op">.</span>unit <span class="op">&lt;&lt;</span> <span class="ch">&#39;</span><span class="sc">\n</span><span class="ch">&#39;</span>;       <span class="co">// mi/h</span></span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> v2<span class="op">.</span>dimension <span class="op">&lt;&lt;</span> <span class="ch">&#39;</span><span class="sc">\n</span><span class="ch">&#39;</span>;  <span class="co">// LT⁻¹</span></span></code></pre></div>
<p>The text output will always print the value using the default
formatting for this entity.</p>
<h3 data-number="15.3.1" id="output-stream-formatting"><span class="header-section-number">15.3.1</span> Output stream formatting<a href="#output-stream-formatting" class="self-link"></a></h3>
<p>Only basic formatting can be applied for output streams. It includes
control over width, fill, and alignment.</p>
<p>The numerical value of the quantity will be printed according to the
current stream state and standard manipulators may be used to customize
that (assuming that the underlying representation type respects
them).</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;|&quot;</span> <span class="op">&lt;&lt;</span> std<span class="op">::</span>setw<span class="op">(</span><span class="dv">10</span><span class="op">)</span> <span class="op">&lt;&lt;</span> <span class="dv">123</span> <span class="op">*</span> m <span class="op">&lt;&lt;</span> <span class="st">&quot;|</span><span class="sc">\n</span><span class="st">&quot;</span>;                       <span class="co">// |     123 m|</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;|&quot;</span> <span class="op">&lt;&lt;</span> std<span class="op">::</span>setw<span class="op">(</span><span class="dv">10</span><span class="op">)</span> <span class="op">&lt;&lt;</span> std<span class="op">::</span>left <span class="op">&lt;&lt;</span> <span class="dv">123</span> <span class="op">*</span> m <span class="op">&lt;&lt;</span> <span class="st">&quot;|</span><span class="sc">\n</span><span class="st">&quot;</span>;          <span class="co">// |123 m     |</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;|&quot;</span> <span class="op">&lt;&lt;</span> std<span class="op">::</span>setw<span class="op">(</span><span class="dv">10</span><span class="op">)</span> <span class="op">&lt;&lt;</span> std<span class="op">::</span>setfill<span class="op">(</span><span class="ch">&#39;*&#39;</span><span class="op">)</span> <span class="op">&lt;&lt;</span> <span class="dv">123</span> <span class="op">*</span> m <span class="op">&lt;&lt;</span> <span class="st">&quot;|</span><span class="sc">\n</span><span class="st">&quot;</span>;  <span class="co">// |123 m*****|</span></span></code></pre></div>
<p>Detailed formatting of any entity may be obtained with
<code class="sourceCode default">std::format()</code> usage and then
provided to the stream output if needed.</p>
<p><em>Note: Custom stream manipulators may be provided to control a
dimension and unit symbol output if requested by WG21.</em></p>
<h2 data-number="15.4" id="text-formatting"><span class="header-section-number">15.4</span> Text formatting<a href="#text-formatting" class="self-link"></a></h2>
<p>The library provides custom formatters for
<code class="sourceCode default">std::format</code> facility, which
allows fine-grained control over what and how it is being printed in the
text output.</p>
<h3 data-number="15.4.1" id="controlling-width-fill-and-alignment"><span class="header-section-number">15.4.1</span> Controlling width, fill, and
alignment<a href="#controlling-width-fill-and-alignment" class="self-link"></a></h3>
<p>Formatting grammar for all the entities provides control over width,
fill, and alignment. The C++ standard grammar tokens
<code class="sourceCode default">fill-and-align</code> and
<code class="sourceCode default">width</code> are being used. They treat
the entity as a contiguous text to be aligned. For example, here are a
few examples of the quantity numerical value and symbol formatting:</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;|{:0}|&quot;</span>, <span class="dv">123</span> <span class="op">*</span> m<span class="op">)</span>;     <span class="co">// |123 m|</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;|{:10}|&quot;</span>, <span class="dv">123</span> <span class="op">*</span> m<span class="op">)</span>;    <span class="co">// |     123 m|</span></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;|{:&lt;10}|&quot;</span>, <span class="dv">123</span> <span class="op">*</span> m<span class="op">)</span>;   <span class="co">// |123 m     |</span></span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;|{:&gt;10}|&quot;</span>, <span class="dv">123</span> <span class="op">*</span> m<span class="op">)</span>;   <span class="co">// |     123 m|</span></span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;|{:^10}|&quot;</span>, <span class="dv">123</span> <span class="op">*</span> m<span class="op">)</span>;   <span class="co">// |  123 m   |</span></span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;|{:*&lt;10}|&quot;</span>, <span class="dv">123</span> <span class="op">*</span> m<span class="op">)</span>;  <span class="co">// |123 m*****|</span></span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;|{:*&gt;10}|&quot;</span>, <span class="dv">123</span> <span class="op">*</span> m<span class="op">)</span>;  <span class="co">// |*****123 m|</span></span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;|{:*^10}|&quot;</span>, <span class="dv">123</span> <span class="op">*</span> m<span class="op">)</span>;  <span class="co">// |**123 m***|</span></span></code></pre></div>
<p>It is important to note that in the second line above, the quantity
text is aligned to the right by default, which is consistent with the
formatting of numeric types. Units and dimensions behave as text and,
thus, are aligned to the left by default.</p>
<h3 data-number="15.4.2" id="dimension-formatting"><span class="header-section-number">15.4.2</span> Dimension formatting<a href="#dimension-formatting" class="self-link"></a></h3>
<pre class="bnf"><code>dimension-format-spec ::= [fill-and-align] [width] [dimension-spec]
dimension-spec        ::= [text-encoding]
text-encoding         ::= &#39;U&#39; | &#39;A&#39;</code></pre>
<p>In the above grammar:</p>
<ul>
<li><code class="sourceCode default">fill-and-align</code> and
<code class="sourceCode default">width</code> tokens are defined in the
<a href="https://wg21.link/format.string.std">format.string.std</a>
chapter of the C++ standard specification,</li>
<li><code class="sourceCode default">text-encoding</code> token
specifies the symbol text encoding:
<ul>
<li><code class="sourceCode default">U</code> (default) uses the
<strong>Unicode</strong> symbols defined by <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span> (e.g.,
<code class="sourceCode default">LT⁻²</code>),</li>
<li><code class="sourceCode default">A</code> forces non-standard
<strong>ASCII</strong>-only output (e.g.,
<code class="sourceCode default">LT^-2</code>).</li>
</ul></li>
</ul>
<p>Dimension symbols of some quantities are specified to use Unicode
signs by the ISQ (e.g., <code class="sourceCode default">Θ</code> symbol
for the <em>thermodynamic temperature</em> dimension). The library
follows this by default. From the engineering point of view, sometimes
Unicode text might not be the best solution as terminals of many
(especially embedded) devices can output only letters from the basic
literal character set only. In such a case, the dimension symbol can be
forced to be printed using such characters thanks to
<code class="sourceCode default">text-encoding</code> token:</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;{}&quot;</span>, isq<span class="op">::</span>dim_thermodynamic_temperature<span class="op">)</span>;   <span class="co">// Θ</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;{:A}&quot;</span>, isq<span class="op">::</span>dim_thermodynamic_temperature<span class="op">)</span>; <span class="co">// O</span></span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;{}&quot;</span>, isq<span class="op">::</span>power<span class="op">.</span>dimension<span class="op">)</span>;                 <span class="co">// L²MT⁻³</span></span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;{:A}&quot;</span>, isq<span class="op">::</span>power<span class="op">.</span>dimension<span class="op">)</span>;               <span class="co">// L^2MT^-3</span></span></code></pre></div>
<h3 data-number="15.4.3" id="unit-formatting"><span class="header-section-number">15.4.3</span> Unit formatting<a href="#unit-formatting" class="self-link"></a></h3>
<pre class="bnf"><code>unit-format-spec      ::= [fill-and-align] [width] [unit-spec]
unit-spec             ::= [text-encoding] [unit-symbol-solidus] [unit-symbol-separator] [L]
                          [text-encoding] [unit-symbol-separator] [unit-symbol-solidus] [L]
                          [unit-symbol-solidus] [text-encoding] [unit-symbol-separator] [L]
                          [unit-symbol-solidus] [unit-symbol-separator] [text-encoding] [L]
                          [unit-symbol-separator] [text-encoding] [unit-symbol-solidus] [L]
                          [unit-symbol-separator] [unit-symbol-solidus] [text-encoding] [L]
unit-symbol-solidus   ::= &#39;1&#39; | &#39;a&#39; | &#39;n&#39;
unit-symbol-separator ::= &#39;s&#39; | &#39;d&#39;</code></pre>
<p>In the above grammar:</p>
<ul>
<li><code class="sourceCode default">fill-and-align</code> and
<code class="sourceCode default">width</code> tokens are defined in the
<a href="https://wg21.link/format.string.std">format.string.std</a>
chapter of the C++ standard specification,</li>
<li><code class="sourceCode default">unit-symbol-solidus</code> token
specifies how the division of units should look like:
<ul>
<li>‘1’ (default) outputs <code class="sourceCode default">/</code> only
when there is only <strong>one</strong> unit in the denominator,
otherwise negative exponents are printed (e.g.,
<code class="sourceCode default">m/s</code>,
<code class="sourceCode default">kg m⁻¹ s⁻¹</code>)</li>
<li>‘a’ <strong>always</strong> uses solidus (e.g.,
<code class="sourceCode default">m/s</code>,
<code class="sourceCode default">kg/(m s)</code>)</li>
<li>‘n’ <strong>never</strong> prints solidus, which means that negative
exponents are always used (e.g.,
<code class="sourceCode default">m s⁻¹</code>,
<code class="sourceCode default">kg m⁻¹ s⁻¹</code>)</li>
</ul></li>
<li><code class="sourceCode default">unit-symbol-separator</code> token
specifies how multiplied unit symbols should be separated:
<ul>
<li>‘s’ (default) uses <strong>space</strong> as a separator (e.g.,
<code class="sourceCode default">kg m²/s²</code>)</li>
<li>‘d’ uses half-high <strong>dot</strong>
(<code class="sourceCode default">⋅</code>) as a separator (e.g.,
<code class="sourceCode default">kg⋅m²/s²</code>) (requires the Unicode
encoding)</li>
</ul></li>
<li>‘L’ is reserved for possible future localization use in case C++
standard library gets access to the ICU-like database.</li>
</ul>
<p><em>Note: The intent of the above grammar was that the elements of
<code class="sourceCode default">unit-spec</code> can appear in any
order as they have unique characters. Users shouldn’t have to remember
the order of those tokens to control the formatting of a unit
symbol.</em></p>
<p>Unit symbols of some quantities are specified to use Unicode signs by
the <span class="citation" data-cites="SI">[<a href="#ref-SI" role="doc-biblioref">SI</a>]</span> (e.g.,
<code class="sourceCode default">Ω</code> symbol for the
<em>resistance</em> quantity). The library follows this by default. From
the engineering point of view, sometimes Unicode text might not be the
best solution as terminals of many (especially embedded) devices can
output only letters from the basic literal character set only. In such a
case, the unit symbol can be forced to be printed using such characters
thanks to <code class="sourceCode default">text-encoding</code>
token:</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;{}&quot;</span>, si<span class="op">::</span>ohm<span class="op">)</span>;      <span class="co">// Ω</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;{:A}&quot;</span>, si<span class="op">::</span>ohm<span class="op">)</span>;    <span class="co">// ohm</span></span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;{}&quot;</span>, us<span class="op">)</span>;           <span class="co">// µs</span></span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;{:A}&quot;</span>, us<span class="op">)</span>;         <span class="co">// us</span></span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;{}&quot;</span>, m <span class="op">/</span> s2<span class="op">)</span>;       <span class="co">// m/s²</span></span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;{:A}&quot;</span>, m <span class="op">/</span> s2<span class="op">)</span>;     <span class="co">// m/s^2</span></span></code></pre></div>
<p>Additionally, both <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span> and
<span class="citation" data-cites="SI">[<a href="#ref-SI" role="doc-biblioref">SI</a>]</span> leave some freedom on how to print
unit symbols. This is why two additional tokens were introduced.</p>
<p><code class="sourceCode default">unit-symbol-solidus</code> specifies
how the division of units should look like. By default,
<code class="sourceCode default">/</code> will be used only when the
denominator contains only one unit. However, with the ‘a’ or ‘n’
options, we can force the facility to print the
<code class="sourceCode default">/</code> character always (even when
there are more units in the denominator), or never, in which case a
parenthesis will be added to enclose all denominator units.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;{}&quot;</span>, m <span class="op">/</span> s<span class="op">)</span>;          <span class="co">// m/s</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;{}&quot;</span>, kg <span class="op">/</span> m <span class="op">/</span> s2<span class="op">)</span>;    <span class="co">// kg m⁻¹ s⁻²</span></span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;{:a}&quot;</span>, m <span class="op">/</span> s<span class="op">)</span>;        <span class="co">// m/s</span></span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;{:a}&quot;</span>, kg <span class="op">/</span> m <span class="op">/</span> s2<span class="op">)</span>;  <span class="co">// kg/(m s²)</span></span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;{:n}&quot;</span>, m <span class="op">/</span> s<span class="op">)</span>;        <span class="co">// m s⁻¹</span></span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;{:n}&quot;</span>, kg <span class="op">/</span> m <span class="op">/</span> s2<span class="op">)</span>;  <span class="co">// kg m⁻¹ s⁻²</span></span></code></pre></div>
<p>Also, there are a few options to separate the units being multiplied.
<span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span> (part 1) says:</p>
<blockquote>
<p>When symbols for quantities are combined in a product of two or more
quantities, this combination is indicated in one of the following ways:
<code class="sourceCode default">ab</code>,
<code class="sourceCode default">a b</code>,
<code class="sourceCode default">a · b</code>,
<code class="sourceCode default">a × b</code></p>
<p><em>NOTE 1</em> In some fields, e.g., vector algebra, distinction is
made between <code class="sourceCode default">a ∙ b</code> and
<code class="sourceCode default">a × b</code>.</p>
</blockquote>
<p>The library supports <code class="sourceCode default">a b</code> and
<code class="sourceCode default">a · b</code> only. Additionally, we
decided that the extraneous space in the latter case makes the result
too verbose, so we decided just to use the
<code class="sourceCode default">·</code> symbol as a separator.</p>
<p>The <code class="sourceCode default">unit-symbol-separator</code>
token allows us to obtain the following outputs:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;{}&quot;</span>, kg <span class="op">*</span> m2 <span class="op">/</span> s2<span class="op">)</span>;    <span class="co">// kg m²/s²</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;{:d}&quot;</span>, kg <span class="op">*</span> m2 <span class="op">/</span> s2<span class="op">)</span>;  <span class="co">// kg⋅m²/s²</span></span></code></pre></div>
<p><em>Note: ‘d’ requires the Unicode encoding to be set.</em></p>
<h3 data-number="15.4.4" id="quantity-formatting"><span class="header-section-number">15.4.4</span> Quantity formatting<a href="#quantity-formatting" class="self-link"></a></h3>
<pre class="bnf"><code>quantity-format-spec        ::= [fill-and-align] [width] [quantity-specs]
quantity-specs              ::= conversion-spec
                                quantity-specs conversion-spec
                                quantity-specs literal-char
literal-char                ::= &lt;any character other than &#39;{&#39;, &#39;}&#39;, or &#39;%&#39;&gt;
conversion-spec             ::= placement-spec
                                subentity-replacement-field
placement-spec              ::= &#39;%&#39; placement-type
placement-type              ::= &#39;N&#39; | &#39;U&#39; | &#39;D&#39; | &#39;?&#39; | &#39;%&#39;
subentity-replacement-field ::= &#39;{&#39; &#39;%&#39; subentity-id [format-specifier] &#39;}&#39;
subentity-id                ::= literal-char
                                subentity-id literal-char
format-specifier            ::= &#39;:&#39; format-spec
format-spec                 ::= &lt;as specified by the formatter for the argument type; cannot start with &#39;}&#39;&gt;</code></pre>
<p>In the above grammar:</p>
<ul>
<li><code class="sourceCode default">fill-and-align</code> and
<code class="sourceCode default">width</code> tokens are defined in the
<a href="https://wg21.link/format.string.std">format.string.std</a>
chapter of the C++ standard specification,</li>
<li><code class="sourceCode default">placement-type</code> token
specifies which entity should be put and where:
<ul>
<li>‘N’ inserts a default-formatted numerical value of the
quantity,</li>
<li>‘U’ inserts a default-formatted unit of the quantity,</li>
<li>‘D’ inserts a default-formatted dimension of the quantity,</li>
<li>‘?’ inserts an optional separator between the number and a unit
based on the value of
<code class="sourceCode default">space_before_unit_symbol</code> for
this unit,</li>
<li>‘%’ just inserts ‘%’ character.</li>
</ul></li>
<li><code class="sourceCode default">subentity-replacement-field</code>
token allows the composition of formatters. The following identifiers
are recognized by the quantity formatter:
<ul>
<li>‘N’ passes <code class="sourceCode default">format-spec</code> to
the <code class="sourceCode default">formatter</code> specialization for
the quantity representation type,</li>
<li>‘U’ passes <code class="sourceCode default">format-spec</code> to
the <code class="sourceCode default">formatter</code> specialization for
the unit type,</li>
<li>‘D’ passes <code class="sourceCode default">format-spec</code> to
the <code class="sourceCode default">formatter</code> specialization for
the dimension type.</li>
</ul></li>
</ul>
<h4 data-number="15.4.4.1" id="default-formatting"><span class="header-section-number">15.4.4.1</span> Default formatting<a href="#default-formatting" class="self-link"></a></h4>
<p>To format <code class="sourceCode default">quantity</code> values,
the formatting facility uses
<code class="sourceCode default">quantity-format-spec</code>. If left
empty, the default formatting is applied. The same default formatting is
also applied to the output streams. This is why the following code lines
produce the same output:</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;Distance: &quot;</span> <span class="op">&lt;&lt;</span> <span class="dv">123</span> <span class="op">*</span> km <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>;</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> std<span class="op">::</span>format<span class="op">(</span><span class="st">&quot;Distance: {}</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="dv">123</span> <span class="op">*</span> km<span class="op">)</span>;</span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> std<span class="op">::</span>format<span class="op">(</span><span class="st">&quot;Distance: {:%N%?%U}</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="dv">123</span> <span class="op">*</span> km<span class="op">)</span>;</span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> std<span class="op">::</span>format<span class="op">(</span><span class="st">&quot;Distance: {:{%N}%?{%U}}</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="dv">123</span> <span class="op">*</span> km<span class="op">)</span>;</span></code></pre></div>
<p>Please note that for some quantities the
<code class="sourceCode default">{:%N %U}</code> format may provide a
different output than the default one, as some units have
<code class="sourceCode default">space_before_unit_symbol</code>
customization point explicitly set to
<code class="sourceCode default">false</code> (e.g.,
<code class="sourceCode default">%</code> and
<code class="sourceCode default">°</code>).</p>
<h4 data-number="15.4.4.2" id="quantity-numerical-value-unit-symbol-or-both"><span class="header-section-number">15.4.4.2</span> Quantity numerical value,
unit symbol, or both?<a href="#quantity-numerical-value-unit-symbol-or-both" class="self-link"></a></h4>
<p>Thanks to the grammar provided above, the user can easily decide to
either:</p>
<ul>
<li><p>print a whole quantity:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;Speed: {}&quot;</span>, <span class="dv">120</span> <span class="op">*</span> km <span class="op">/</span> h<span class="op">)</span>;</span></code></pre></div>
<pre class="text"><code>Speed: 120 km/h</code></pre></li>
<li><p>provide custom quantity formatting:</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;Speed: {:%N in %U}&quot;</span>, <span class="dv">120</span> <span class="op">*</span> km <span class="op">/</span> h<span class="op">)</span>;</span></code></pre></div>
<pre class="text"><code>Speed: 120 in km/h</code></pre></li>
<li><p>provide custom formatting for components:</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;Speed: {:{%N:.2f} {%U:n}}&quot;</span>, <span class="fl">100.</span> <span class="op">*</span> km <span class="op">/</span> <span class="op">(</span><span class="dv">3</span> <span class="op">*</span> h<span class="op">))</span>;</span></code></pre></div>
<pre class="text"><code>Speed: 33.33 km h⁻¹</code></pre></li>
<li><p>print only specific components (numerical value, unit, or
dimension):</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;Speed:</span><span class="sc">\n</span><span class="st">- number: {0:%N}</span><span class="sc">\n</span><span class="st">- unit: {0:%U}</span><span class="sc">\n</span><span class="st">- dimension: {0:%D}&quot;</span>, <span class="dv">120</span> <span class="op">*</span> km <span class="op">/</span> h<span class="op">)</span>;</span></code></pre></div>
<pre class="text"><code>Speed:
- number: 120
- unit: km/h
- dimension: LT⁻¹</code></pre></li>
</ul>
<p><code class="sourceCode default">placement-spec</code> and
<code class="sourceCode default">subentity-replacement-field</code>
greatly simplify element access and formatting of the quantity. Without
them the second case above would require the following:</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> <span class="kw">auto</span> q <span class="op">=</span> <span class="dv">120</span> <span class="op">*</span> km <span class="op">/</span> h;</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;Speed:</span><span class="sc">\n</span><span class="st">- number: {}</span><span class="sc">\n</span><span class="st">- unit: {}</span><span class="sc">\n</span><span class="st">- dimension: {}&quot;</span>,</span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>             q<span class="op">.</span>numerical_value_ref_in<span class="op">(</span>q<span class="op">.</span>unit<span class="op">)</span>, q<span class="op">.</span>unit, q<span class="op">.</span>dimension<span class="op">)</span>;</span></code></pre></div>
<p>Providing such support also simplifies the specification and
implementation effort of this library. Initially, <span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span> library was providing
numerical value modifiers inplace of its format specification, but
it:</p>
<ul>
<li>worked only with fundamental arithmetic types and was not able to
adjust to different format specifications of custom representation
types,</li>
<li>was quite hard to parse and format everything in a 100% compatible
way with the formatting specified in the C++ standard and already
implemented in the underlying standard library.</li>
</ul>
<p><em>Note 1: The above grammar allows repeating the same field many
times, possibly with a different format spec. For example, <code class="sourceCode default">std::println(&quot;Speed: {:%N {%N:.4f} {%N:.2f} {%U:n}}&quot;, 100. * km / (3 * h))</code>.</em></p>
<h2 data-number="15.5" id="quantity-point-text-output"><span class="header-section-number">15.5</span> Quantity point text output<a href="#quantity-point-text-output" class="self-link"></a></h2>
<p>The library does not provide a text output for quantity points. The
quantity stored inside is just an implementation detail of this type. It
is a vector from a specific origin. Without the knowledge of the origin,
the vector by itself is useless as we can’t determine which point it
describes.</p>
<p>In the current library design, point origin does not provide any text
in its definition. Even if we could add such information to the point’s
definition, we would not know how to output it in the text. There may be
many ways to do it. For example, should we prepend or append the origin
part to the quantity text?</p>
<p>For example, the text output of
<code class="sourceCode default">42 m</code> for a quantity point may
mean many things. It may be an offset from the mountain top, sea level,
or maybe the center of Mars. Printing
<code class="sourceCode default">42 m AMSL</code> for altitudes above
mean sea level is a much better solution, but the library does not have
enough information to print it that way by itself.</p>
<h2 data-number="15.6" id="text-output-open-questions"><span class="header-section-number">15.6</span> Text output open questions<a href="#text-output-open-questions" class="self-link"></a></h2>
<ol type="1">
<li>Are we OK with the usage of ’_’ for denoting a subsript
identifier?</li>
<li>Are we OK with no text output support of quantity types?</li>
<li>How to name a non-Unicode accessor member function (e.g.,
<code class="sourceCode default">.ascii()</code>)? The same name should
consistently be used in
<code class="sourceCode default">text_encoding</code> and in the
formatting grammar.</li>
<li>Should <code class="sourceCode default">unit_symbol()</code> and
<code class="sourceCode default">dimension_symbol</code> return
<code class="sourceCode default">std::string_view</code> or
<code class="sourceCode default">basic_fixed_string</code>?</li>
<li>Do we care about ostreams enough to introduce custom manipulators to
format dimensions and units?</li>
<li>What about the localization for units? Will we get something like
ICU in the C++ standard?</li>
<li><code class="sourceCode default">std::chrono::duration</code> uses
‘Q’ and ‘q’ for a number and a unit. In the grammar above, we proposed
using ‘N’ and ‘U’ for them, respectively. We also introduced ‘D’ for
dimensions. Are we OK with this?</li>
<li>Should we provide text support for quantity points? What about
temperatires?</li>
</ol>
<h1 data-number="16" id="design-details-and-rationale"><span class="header-section-number">16</span> Design details and rationale<a href="#design-details-and-rationale" class="self-link"></a></h1>
<p><em>Note: This chapter provides more design details and rationale for
them. It tries to not repeat information already provided in the
previous chapters so a reader is expected to be familar with them
already.</em></p>
<h2 data-number="16.1" id="conventions"><span class="header-section-number">16.1</span> Conventions<a href="#conventions" class="self-link"></a></h2>
<h3 data-number="16.1.1" id="new-style-of-definitions"><span class="header-section-number">16.1.1</span> New style of definitions<a href="#new-style-of-definitions" class="self-link"></a></h3>
<p>The <span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span> library
decided to use a rather unusual pattern to define entities, but it
proved really successful, and we got great feedback from users so
far.</p>
<p>Here is how we define metre and second <span class="citation" data-cites="SI">[<a href="#ref-SI" role="doc-biblioref">SI</a>]</span>
base units:</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> metre <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;m&quot;</span>, kind_of<span class="op">&lt;</span>isq<span class="op">::</span>length<span class="op">&gt;&gt;</span> <span class="op">{}</span> metre;</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> second <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;s&quot;</span>, kind_of<span class="op">&lt;</span>isq<span class="op">::</span>time<span class="op">&gt;&gt;</span> <span class="op">{}</span> second;</span></code></pre></div>
<p>Please note that the above reuses the same identifier for a type and
its value. The rationale behind this is that:</p>
<ul>
<li>Users always work with values and never have to spell such a type
name.</li>
<li>The types appear in the compilation errors and during
debugging.</li>
</ul>
<p>To improve compiler errors’ readability and make it easier to
correlate them with a user’s written code, a new idiom in the library is
to use the same identifier for a type and its instance.</p>
<h3 data-number="16.1.2" id="strong-types-instead-of-aliases"><span class="header-section-number">16.1.2</span> Strong types instead of
aliases<a href="#strong-types-instead-of-aliases" class="self-link"></a></h3>
<p>Let’s look again at the above units definitions. Another essential
point to notice is that all the types describing entities in the library
are short, nicely named identifiers that derive from longer, more
verbose class template instantiations. This is really important to
improve the user experience while debugging the program or analyzing the
compilation error.</p>
<p><em>Note: Such a practice is rare in the industry. Some popular C++
physical units libraries generate enormously long error
messages.</em></p>
<h3 data-number="16.1.3" id="entities-composability"><span class="header-section-number">16.1.3</span> Entities composability<a href="#entities-composability" class="self-link"></a></h3>
<p>Many physical units libraries (in C++ or any other programming
language) assign strong types to library entities (e.g., derived units).
While <code class="sourceCode default">metre_per_second</code> as a type
may not look too scary, consider, for example, units of angular
momentum. If we followed this path, its coherent unit would look like
<code class="sourceCode default">kilogram_metre_sq_per_second</code>.
Now, consider how many scaled versions of this unit you would predefine
in the library to ensure that all users are happy with your choice? How
expensive would it be from the implementation point of view? How
expensive would it be to standardize?</p>
<p>This is why, in this library, we put a strong requirement to make
everything as composable as possible. For example, to create a quantity
with a unit of <em>speed</em>, one may write:</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>si<span class="op">::</span>metre <span class="op">/</span> si<span class="op">::</span>second<span class="op">&gt;</span> q;</span></code></pre></div>
<p>In case we use such a unit often and would prefer to have a handy
helper for it, we can always do something like this:</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="kw">constexpr</span> <span class="kw">auto</span> metre_per_second <span class="op">=</span> si<span class="op">::</span>metre <span class="op">/</span> si<span class="op">::</span>second;</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>metre_per_second<span class="op">&gt;</span> q;</span></code></pre></div>
<p>or choose any shorter identifier of our choice.</p>
<p>Coming back to the angular momentum case, thanks to the composability
of units, a user can create such a quantity in the following way:</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> mp_units<span class="op">::</span>si<span class="op">::</span>unit_symbols;</span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> q <span class="op">=</span> la_vector<span class="op">{</span><span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span><span class="op">}</span> <span class="op">*</span> isq<span class="op">::</span>angular_momentum<span class="op">[</span>kg <span class="op">*</span> m2 <span class="op">/</span> s<span class="op">]</span>;</span></code></pre></div>
<p>It is a much better solution. It is terse and easy to understand.
Please also notice how easy it is to obtain any scaled version of such a
unit (e.g.,
<code class="sourceCode default">mg * square(mm) / min</code>) without
having to introduce hundreds of types to predefine them.</p>
<h3 data-number="16.1.4" id="value-based-equations"><span class="header-section-number">16.1.4</span> Value-based equations<a href="#value-based-equations" class="self-link"></a></h3>
<p>This library is based on C++20, significantly improving user
experience. One such improvement is the usage of value-based
equations.</p>
<p>As we have learned above, the entities are being used as values in
the code, and they compose. Moreover, derived entities can be defined in
the library using such value-based equations. This is a considerable
improvement compared to what we can find in other physical units
libraries or what we have to deal with when we want to write some
equations for <code class="sourceCode default">std::ratio</code>.</p>
<p>For example, below are a few definitions of the <span class="citation" data-cites="SI">[<a href="#ref-SI" role="doc-biblioref">SI</a>]</span> derived units showing the power of
C++20 extensions to Non-Type Template Parameters, which allow us to
directly pass a result of the value-based unit equation to a class
template definition:</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> newton <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;N&quot;</span>, kilogram <span class="op">*</span> metre <span class="op">/</span> square<span class="op">(</span>second<span class="op">)&gt;</span> <span class="op">{}</span> newton;</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> pascal <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;Pa&quot;</span>, newton <span class="op">/</span> square<span class="op">(</span>metre<span class="op">)&gt;</span> <span class="op">{}</span> pascal;</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> joule <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;J&quot;</span>, newton <span class="op">*</span> metre<span class="op">&gt;</span> <span class="op">{}</span> joule;</span></code></pre></div>
<h2 data-number="16.2" id="framework-entities"><span class="header-section-number">16.2</span> Framework entities<a href="#framework-entities" class="self-link"></a></h2>
<p>The below graph presents the most important entities of the library’s
framework and how they relate to each other.</p>
<p><img src="data:image/svg+xml;base64,PHN2ZyBhcmlhLXJvbGVkZXNjcmlwdGlvbj0iZmxvd2NoYXJ0LXYyIiByb2xlPSJncmFwaGljcy1kb2N1bWVudCBkb2N1bWVudCIgdmlld0JveD0iLTggLTggNDUxLjQxNzk2ODc1IDQxMSIgc3R5bGU9Im1heC13aWR0aDogMTAwJTsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGlkPSJncmFwaC1kaXYiIGhlaWdodD0iMTAwJSIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxzdHlsZT5AaW1wb3J0IHVybCgiaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvZm9udC1hd2Vzb21lLzYuNC4yL2Nzcy9hbGwubWluLmNzcyIpOyc8L3N0eWxlPjxzdHlsZT4jZ3JhcGgtZGl2e2ZvbnQtZmFtaWx5OiJ0cmVidWNoZXQgbXMiLHZlcmRhbmEsYXJpYWwsc2Fucy1zZXJpZjtmb250LXNpemU6MTZweDtmaWxsOiMzMzM7fSNncmFwaC1kaXYgLmVycm9yLWljb257ZmlsbDojNTUyMjIyO30jZ3JhcGgtZGl2IC5lcnJvci10ZXh0e2ZpbGw6IzU1MjIyMjtzdHJva2U6IzU1MjIyMjt9I2dyYXBoLWRpdiAuZWRnZS10aGlja25lc3Mtbm9ybWFse3N0cm9rZS13aWR0aDoycHg7fSNncmFwaC1kaXYgLmVkZ2UtdGhpY2tuZXNzLXRoaWNre3N0cm9rZS13aWR0aDozLjVweDt9I2dyYXBoLWRpdiAuZWRnZS1wYXR0ZXJuLXNvbGlke3N0cm9rZS1kYXNoYXJyYXk6MDt9I2dyYXBoLWRpdiAuZWRnZS1wYXR0ZXJuLWRhc2hlZHtzdHJva2UtZGFzaGFycmF5OjM7fSNncmFwaC1kaXYgLmVkZ2UtcGF0dGVybi1kb3R0ZWR7c3Ryb2tlLWRhc2hhcnJheToyO30jZ3JhcGgtZGl2IC5tYXJrZXJ7ZmlsbDojMzMzMzMzO3N0cm9rZTojMzMzMzMzO30jZ3JhcGgtZGl2IC5tYXJrZXIuY3Jvc3N7c3Ryb2tlOiMzMzMzMzM7fSNncmFwaC1kaXYgc3Zne2ZvbnQtZmFtaWx5OiJ0cmVidWNoZXQgbXMiLHZlcmRhbmEsYXJpYWwsc2Fucy1zZXJpZjtmb250LXNpemU6MTZweDt9I2dyYXBoLWRpdiAubGFiZWx7Zm9udC1mYW1pbHk6InRyZWJ1Y2hldCBtcyIsdmVyZGFuYSxhcmlhbCxzYW5zLXNlcmlmO2NvbG9yOiMzMzM7fSNncmFwaC1kaXYgLmNsdXN0ZXItbGFiZWwgdGV4dHtmaWxsOiMzMzM7fSNncmFwaC1kaXYgLmNsdXN0ZXItbGFiZWwgc3BhbiwjZ3JhcGgtZGl2IHB7Y29sb3I6IzMzMzt9I2dyYXBoLWRpdiAubGFiZWwgdGV4dCwjZ3JhcGgtZGl2IHNwYW4sI2dyYXBoLWRpdiBwe2ZpbGw6IzMzMztjb2xvcjojMzMzO30jZ3JhcGgtZGl2IC5ub2RlIHJlY3QsI2dyYXBoLWRpdiAubm9kZSBjaXJjbGUsI2dyYXBoLWRpdiAubm9kZSBlbGxpcHNlLCNncmFwaC1kaXYgLm5vZGUgcG9seWdvbiwjZ3JhcGgtZGl2IC5ub2RlIHBhdGh7ZmlsbDojRUNFQ0ZGO3N0cm9rZTojOTM3MERCO3N0cm9rZS13aWR0aDoxcHg7fSNncmFwaC1kaXYgLmZsb3djaGFydC1sYWJlbCB0ZXh0e3RleHQtYW5jaG9yOm1pZGRsZTt9I2dyYXBoLWRpdiAubm9kZSAubGFiZWx7dGV4dC1hbGlnbjpjZW50ZXI7fSNncmFwaC1kaXYgLm5vZGUuY2xpY2thYmxle2N1cnNvcjpwb2ludGVyO30jZ3JhcGgtZGl2IC5hcnJvd2hlYWRQYXRoe2ZpbGw6IzMzMzMzMzt9I2dyYXBoLWRpdiAuZWRnZVBhdGggLnBhdGh7c3Ryb2tlOiMzMzMzMzM7c3Ryb2tlLXdpZHRoOjIuMHB4O30jZ3JhcGgtZGl2IC5mbG93Y2hhcnQtbGlua3tzdHJva2U6IzMzMzMzMztmaWxsOm5vbmU7fSNncmFwaC1kaXYgLmVkZ2VMYWJlbHtiYWNrZ3JvdW5kLWNvbG9yOiNlOGU4ZTg7dGV4dC1hbGlnbjpjZW50ZXI7fSNncmFwaC1kaXYgLmVkZ2VMYWJlbCByZWN0e29wYWNpdHk6MC41O2JhY2tncm91bmQtY29sb3I6I2U4ZThlODtmaWxsOiNlOGU4ZTg7fSNncmFwaC1kaXYgLmxhYmVsQmtne2JhY2tncm91bmQtY29sb3I6cmdiYSgyMzIsIDIzMiwgMjMyLCAwLjUpO30jZ3JhcGgtZGl2IC5jbHVzdGVyIHJlY3R7ZmlsbDojZmZmZmRlO3N0cm9rZTojYWFhYTMzO3N0cm9rZS13aWR0aDoxcHg7fSNncmFwaC1kaXYgLmNsdXN0ZXIgdGV4dHtmaWxsOiMzMzM7fSNncmFwaC1kaXYgLmNsdXN0ZXIgc3BhbiwjZ3JhcGgtZGl2IHB7Y29sb3I6IzMzMzt9I2dyYXBoLWRpdiBkaXYubWVybWFpZFRvb2x0aXB7cG9zaXRpb246YWJzb2x1dGU7dGV4dC1hbGlnbjpjZW50ZXI7bWF4LXdpZHRoOjIwMHB4O3BhZGRpbmc6MnB4O2ZvbnQtZmFtaWx5OiJ0cmVidWNoZXQgbXMiLHZlcmRhbmEsYXJpYWwsc2Fucy1zZXJpZjtmb250LXNpemU6MTJweDtiYWNrZ3JvdW5kOmhzbCg4MCwgMTAwJSwgOTYuMjc0NTA5ODAzOSUpO2JvcmRlcjoxcHggc29saWQgI2FhYWEzMztib3JkZXItcmFkaXVzOjJweDtwb2ludGVyLWV2ZW50czpub25lO3otaW5kZXg6MTAwO30jZ3JhcGgtZGl2IC5mbG93Y2hhcnRUaXRsZVRleHR7dGV4dC1hbmNob3I6bWlkZGxlO2ZvbnQtc2l6ZToxOHB4O2ZpbGw6IzMzMzt9I2dyYXBoLWRpdiA6cm9vdHstLW1lcm1haWQtZm9udC1mYW1pbHk6InRyZWJ1Y2hldCBtcyIsdmVyZGFuYSxhcmlhbCxzYW5zLXNlcmlmO308L3N0eWxlPjxnPjxtYXJrZXIgb3JpZW50PSJhdXRvIiBtYXJrZXJIZWlnaHQ9IjEyIiBtYXJrZXJXaWR0aD0iMTIiIG1hcmtlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgcmVmWT0iNSIgcmVmWD0iNiIgdmlld0JveD0iMCAwIDEwIDEwIiBjbGFzcz0ibWFya2VyIGZsb3djaGFydCIgaWQ9ImdyYXBoLWRpdl9mbG93Y2hhcnQtcG9pbnRFbmQiPjxwYXRoIHN0eWxlPSJzdHJva2Utd2lkdGg6IDE7IHN0cm9rZS1kYXNoYXJyYXk6IDEsIDA7IiBjbGFzcz0iYXJyb3dNYXJrZXJQYXRoIiBkPSJNIDAgMCBMIDEwIDUgTCAwIDEwIHoiPjwvcGF0aD48L21hcmtlcj48bWFya2VyIG9yaWVudD0iYXV0byIgbWFya2VySGVpZ2h0PSIxMiIgbWFya2VyV2lkdGg9IjEyIiBtYXJrZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIHJlZlk9IjUiIHJlZlg9IjQuNSIgdmlld0JveD0iMCAwIDEwIDEwIiBjbGFzcz0ibWFya2VyIGZsb3djaGFydCIgaWQ9ImdyYXBoLWRpdl9mbG93Y2hhcnQtcG9pbnRTdGFydCI+PHBhdGggc3R5bGU9InN0cm9rZS13aWR0aDogMTsgc3Ryb2tlLWRhc2hhcnJheTogMSwgMDsiIGNsYXNzPSJhcnJvd01hcmtlclBhdGgiIGQ9Ik0gMCA1IEwgMTAgMTAgTCAxMCAwIHoiPjwvcGF0aD48L21hcmtlcj48bWFya2VyIG9yaWVudD0iYXV0byIgbWFya2VySGVpZ2h0PSIxMSIgbWFya2VyV2lkdGg9IjExIiBtYXJrZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIHJlZlk9IjUiIHJlZlg9IjExIiB2aWV3Qm94PSIwIDAgMTAgMTAiIGNsYXNzPSJtYXJrZXIgZmxvd2NoYXJ0IiBpZD0iZ3JhcGgtZGl2X2Zsb3djaGFydC1jaXJjbGVFbmQiPjxjaXJjbGUgc3R5bGU9InN0cm9rZS13aWR0aDogMTsgc3Ryb2tlLWRhc2hhcnJheTogMSwgMDsiIGNsYXNzPSJhcnJvd01hcmtlclBhdGgiIHI9IjUiIGN5PSI1IiBjeD0iNSI+PC9jaXJjbGU+PC9tYXJrZXI+PG1hcmtlciBvcmllbnQ9ImF1dG8iIG1hcmtlckhlaWdodD0iMTEiIG1hcmtlcldpZHRoPSIxMSIgbWFya2VyVW5pdHM9InVzZXJTcGFjZU9uVXNlIiByZWZZPSI1IiByZWZYPSItMSIgdmlld0JveD0iMCAwIDEwIDEwIiBjbGFzcz0ibWFya2VyIGZsb3djaGFydCIgaWQ9ImdyYXBoLWRpdl9mbG93Y2hhcnQtY2lyY2xlU3RhcnQiPjxjaXJjbGUgc3R5bGU9InN0cm9rZS13aWR0aDogMTsgc3Ryb2tlLWRhc2hhcnJheTogMSwgMDsiIGNsYXNzPSJhcnJvd01hcmtlclBhdGgiIHI9IjUiIGN5PSI1IiBjeD0iNSI+PC9jaXJjbGU+PC9tYXJrZXI+PG1hcmtlciBvcmllbnQ9ImF1dG8iIG1hcmtlckhlaWdodD0iMTEiIG1hcmtlcldpZHRoPSIxMSIgbWFya2VyVW5pdHM9InVzZXJTcGFjZU9uVXNlIiByZWZZPSI1LjIiIHJlZlg9IjEyIiB2aWV3Qm94PSIwIDAgMTEgMTEiIGNsYXNzPSJtYXJrZXIgY3Jvc3MgZmxvd2NoYXJ0IiBpZD0iZ3JhcGgtZGl2X2Zsb3djaGFydC1jcm9zc0VuZCI+PHBhdGggc3R5bGU9InN0cm9rZS13aWR0aDogMjsgc3Ryb2tlLWRhc2hhcnJheTogMSwgMDsiIGNsYXNzPSJhcnJvd01hcmtlclBhdGgiIGQ9Ik0gMSwxIGwgOSw5IE0gMTAsMSBsIC05LDkiPjwvcGF0aD48L21hcmtlcj48bWFya2VyIG9yaWVudD0iYXV0byIgbWFya2VySGVpZ2h0PSIxMSIgbWFya2VyV2lkdGg9IjExIiBtYXJrZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIHJlZlk9IjUuMiIgcmVmWD0iLTEiIHZpZXdCb3g9IjAgMCAxMSAxMSIgY2xhc3M9Im1hcmtlciBjcm9zcyBmbG93Y2hhcnQiIGlkPSJncmFwaC1kaXZfZmxvd2NoYXJ0LWNyb3NzU3RhcnQiPjxwYXRoIHN0eWxlPSJzdHJva2Utd2lkdGg6IDI7IHN0cm9rZS1kYXNoYXJyYXk6IDEsIDA7IiBjbGFzcz0iYXJyb3dNYXJrZXJQYXRoIiBkPSJNIDEsMSBsIDksOSBNIDEwLDEgbCAtOSw5Ij48L3BhdGg+PC9tYXJrZXI+PGcgY2xhc3M9InJvb3QiPjxnIGNsYXNzPSJjbHVzdGVycyI+PC9nPjxnIGNsYXNzPSJlZGdlUGF0aHMiPjxwYXRoIHN0eWxlPSJmaWxsOm5vbmU7IiBjbGFzcz0iZWRnZS10aGlja25lc3Mtbm9ybWFsIGVkZ2UtcGF0dGVybi1zb2xpZCBmbG93Y2hhcnQtbGluayBMUy1Vbml0IExFLVJlZmVyZW5jZSIgaWQ9IkwtVW5pdC1SZWZlcmVuY2UtMCIgZD0iTTIyLjUxMiwxMjhMMjIuNTEyLDEzMi4xNjdDMjIuNTEyLDEzNi4zMzMsMjIuNTEyLDE0NC42NjcsMjkuOTYzLDE1M0MzNy40MTUsMTYxLjMzMyw1Mi4zMTgsMTY5LjY2Nyw1OS43NjksMTczLjgzM0w2Ny4yMjEsMTc4Ij48L3BhdGg+PHBhdGggc3R5bGU9ImZpbGw6bm9uZTsiIGNsYXNzPSJlZGdlLXRoaWNrbmVzcy1ub3JtYWwgZWRnZS1wYXR0ZXJuLXNvbGlkIGZsb3djaGFydC1saW5rIExTLURpbWVuc2lvbiBMRS1RdWFudGl0eVNwZWMiIGlkPSJMLURpbWVuc2lvbi1RdWFudGl0eVNwZWMtMCIgZD0iTTE3MS42NzYsMzlMMTcxLjY3Niw0My4xNjdDMTcxLjY3Niw0Ny4zMzMsMTcxLjY3Niw1NS42NjcsMTcyLjYxMiw2NEMxNzMuNTQ4LDcyLjMzMywxNzUuNDIxLDgwLjY2NywxNzYuMzU3LDg0LjgzM0wxNzcuMjk0LDg5Ij48L3BhdGg+PHBhdGggc3R5bGU9ImZpbGw6bm9uZTsiIGNsYXNzPSJlZGdlLXRoaWNrbmVzcy1ub3JtYWwgZWRnZS1wYXR0ZXJuLXNvbGlkIGZsb3djaGFydC1saW5rIExTLXF1YW50aXR5X2NoYXJhY3RlciBMRS1RdWFudGl0eVNwZWMiIGlkPSJMLXF1YW50aXR5X2NoYXJhY3Rlci1RdWFudGl0eVNwZWMtMCIgZD0iTTMxOS4wNzcsMzlMMzEwLjMwNCw0My4xNjdDMzAxLjUzMiw0Ny4zMzMsMjgzLjk4Nyw1NS42NjcsMjY3LjI3Nyw2NEMyNTAuNTY4LDcyLjMzMywyMzQuNjk0LDgwLjY2NywyMjYuNzU3LDg0LjgzM0wyMTguODIsODkiPjwvcGF0aD48cGF0aCBzdHlsZT0iZmlsbDpub25lOyIgY2xhc3M9ImVkZ2UtdGhpY2tuZXNzLW5vcm1hbCBlZGdlLXBhdHRlcm4tc29saWQgZmxvd2NoYXJ0LWxpbmsgTFMtUXVhbnRpdHlTcGVjIExFLVJlZmVyZW5jZSIgaWQ9IkwtUXVhbnRpdHlTcGVjLVJlZmVyZW5jZS0wIiBkPSJNMTgxLjY3NiwxMjhMMTgxLjY3NiwxMzIuMTY3QzE4MS42NzYsMTM2LjMzMywxODEuNjc2LDE0NC42NjcsMTc0LjIyNCwxNTNDMTY2Ljc3MywxNjEuMzMzLDE1MS44NywxNjkuNjY3LDE0NC40MTgsMTczLjgzM0wxMzYuOTY3LDE3OCI+PC9wYXRoPjxwYXRoIHN0eWxlPSJmaWxsOm5vbmU7IiBjbGFzcz0iZWRnZS10aGlja25lc3Mtbm9ybWFsIGVkZ2UtcGF0dGVybi1zb2xpZCBmbG93Y2hhcnQtbGluayBMUy1SZWZlcmVuY2UgTEUtUXVhbnRpdHkiIGlkPSJMLVJlZmVyZW5jZS1RdWFudGl0eS0wIiBkPSJNMTAyLjA5NCwyMTdMMTAyLjA5NCwyMjEuMTY3QzEwMi4wOTQsMjI1LjMzMywxMDIuMDk0LDIzMy42NjcsMTExLjMwNSwyNDIuMjA5QzEyMC41MTcsMjUwLjc1LDEzOC45NCwyNTkuNTAxLDE0OC4xNTIsMjYzLjg3NkwxNTcuMzYzLDI2OC4yNTEiPjwvcGF0aD48cGF0aCBzdHlsZT0iZmlsbDpub25lO3N0cm9rZS13aWR0aDoycHg7c3Ryb2tlLWRhc2hhcnJheTozOyIgY2xhc3M9ImVkZ2UtdGhpY2tuZXNzLW5vcm1hbCBlZGdlLXBhdHRlcm4tZG90dGVkIGZsb3djaGFydC1saW5rIExTLXF1YW50aXR5X2NoYXJhY3RlciBMRS1SZXByZXNlbnRhdGlvbiIgaWQ9IkwtcXVhbnRpdHlfY2hhcmFjdGVyLVJlcHJlc2VudGF0aW9uLTAiIGQ9Ik0zNjQuNTE1LDM5TDM2NS40NTEsNDMuMTY3QzM2Ni4zODcsNDcuMzMzLDM2OC4yNiw1NS42NjcsMzY5LjE5Niw2Ny4yNUMzNzAuMTMzLDc4LjgzMywzNzAuMTMzLDkzLjY2NywzNzAuMTMzLDEwOC41QzM3MC4xMzMsMTIzLjMzMywzNzAuMTMzLDEzOC4xNjcsMzcwLjEzMywxNDkuNzVDMzcwLjEzMywxNjEuMzMzLDM3MC4xMzMsMTY5LjY2NywzNzAuMTMzLDE3My44MzNMMzcwLjEzMywxNzgiPjwvcGF0aD48cGF0aCBzdHlsZT0iZmlsbDpub25lOyIgY2xhc3M9ImVkZ2UtdGhpY2tuZXNzLW5vcm1hbCBlZGdlLXBhdHRlcm4tc29saWQgZmxvd2NoYXJ0LWxpbmsgTFMtUmVwcmVzZW50YXRpb24gTEUtUXVhbnRpdHkiIGlkPSJMLVJlcHJlc2VudGF0aW9uLVF1YW50aXR5LTAiIGQ9Ik0zNzAuMTMzLDIxN0wzNzAuMTMzLDIyMS4xNjdDMzcwLjEzMywyMjUuMzMzLDM3MC4xMzMsMjMzLjY2NywzNDcuNDc5LDI0My42MTZDMzI0LjgyNCwyNTMuNTY0LDI3OS41MTYsMjY1LjEyOSwyNTYuODYxLDI3MC45MTFMMjM0LjIwNywyNzYuNjkzIj48L3BhdGg+PHBhdGggc3R5bGU9ImZpbGw6bm9uZTsiIGNsYXNzPSJlZGdlLXRoaWNrbmVzcy1ub3JtYWwgZWRnZS1wYXR0ZXJuLXNvbGlkIGZsb3djaGFydC1saW5rIExTLVF1YW50aXR5IExFLVF1YW50aXR5UG9pbnQiIGlkPSJMLVF1YW50aXR5LVF1YW50aXR5UG9pbnQtMCIgZD0iTTE5NS43ODUsMzA2TDE5NS43ODUsMzEwLjE2N0MxOTUuNzg1LDMxNC4zMzMsMTk1Ljc4NSwzMjIuNjY3LDIwMi4xOTQsMzMxQzIwOC42MDIsMzM5LjMzMywyMjEuNDE5LDM0Ny42NjcsMjI3LjgyOCwzNTEuODMzTDIzNC4yMzYsMzU2Ij48L3BhdGg+PHBhdGggc3R5bGU9ImZpbGw6bm9uZTsiIGNsYXNzPSJlZGdlLXRoaWNrbmVzcy1ub3JtYWwgZWRnZS1wYXR0ZXJuLXNvbGlkIGZsb3djaGFydC1saW5rIExTLVBvaW50T3JpZ2luIExFLVF1YW50aXR5UG9pbnQiIGlkPSJMLVBvaW50T3JpZ2luLVF1YW50aXR5UG9pbnQtMCIgZD0iTTMzMi42NzIsMzA2TDMzMi42NzIsMzEwLjE2N0MzMzIuNjcyLDMxNC4zMzMsMzMyLjY3MiwzMjIuNjY3LDMyNi4yNjMsMzMxQzMxOS44NTUsMzM5LjMzMywzMDcuMDM4LDM0Ny42NjcsMzAwLjYyOSwzNTEuODMzTDI5NC4yMjEsMzU2Ij48L3BhdGg+PC9nPjxnIGNsYXNzPSJlZGdlTGFiZWxzIj48ZyBjbGFzcz0iZWRnZUxhYmVsIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLCAwKSIgY2xhc3M9ImxhYmVsIj48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjAiIHdpZHRoPSIwIj48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+PHNwYW4gY2xhc3M9ImVkZ2VMYWJlbCI+PC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIGNsYXNzPSJlZGdlTGFiZWwiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAsIDApIiBjbGFzcz0ibGFiZWwiPjxmb3JlaWduT2JqZWN0IGhlaWdodD0iMCIgd2lkdGg9IjAiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0iZWRnZUxhYmVsIj48L3NwYW4+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+PGcgY2xhc3M9ImVkZ2VMYWJlbCI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCwgMCkiIGNsYXNzPSJsYWJlbCI+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSIwIiB3aWR0aD0iMCI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPjxzcGFuIGNsYXNzPSJlZGdlTGFiZWwiPjwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48ZyBjbGFzcz0iZWRnZUxhYmVsIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLCAwKSIgY2xhc3M9ImxhYmVsIj48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjAiIHdpZHRoPSIwIj48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+PHNwYW4gY2xhc3M9ImVkZ2VMYWJlbCI+PC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIGNsYXNzPSJlZGdlTGFiZWwiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAsIDApIiBjbGFzcz0ibGFiZWwiPjxmb3JlaWduT2JqZWN0IGhlaWdodD0iMCIgd2lkdGg9IjAiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0iZWRnZUxhYmVsIj48L3NwYW4+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+PGcgY2xhc3M9ImVkZ2VMYWJlbCI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCwgMCkiIGNsYXNzPSJsYWJlbCI+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSIwIiB3aWR0aD0iMCI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPjxzcGFuIGNsYXNzPSJlZGdlTGFiZWwiPjwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48ZyBjbGFzcz0iZWRnZUxhYmVsIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLCAwKSIgY2xhc3M9ImxhYmVsIj48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjAiIHdpZHRoPSIwIj48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+PHNwYW4gY2xhc3M9ImVkZ2VMYWJlbCI+PC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIGNsYXNzPSJlZGdlTGFiZWwiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAsIDApIiBjbGFzcz0ibGFiZWwiPjxmb3JlaWduT2JqZWN0IGhlaWdodD0iMCIgd2lkdGg9IjAiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0iZWRnZUxhYmVsIj48L3NwYW4+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+PGcgY2xhc3M9ImVkZ2VMYWJlbCI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCwgMCkiIGNsYXNzPSJsYWJlbCI+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSIwIiB3aWR0aD0iMCI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPjxzcGFuIGNsYXNzPSJlZGdlTGFiZWwiPjwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48L2c+PGcgY2xhc3M9Im5vZGVzIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMi41MTE3MTg3NSwgMTA4LjUpIiBpZD0iZmxvd2NoYXJ0LVVuaXQtNDIiIGNsYXNzPSJub2RlIGRlZmF1bHQgZGVmYXVsdCBmbG93Y2hhcnQtbGFiZWwiPjxyZWN0IGhlaWdodD0iMzkiIHdpZHRoPSI0NS4wMjM0Mzc1IiB5PSItMTkuNSIgeD0iLTIyLjUxMTcxODc1IiByeT0iMCIgcng9IjAiIHN0eWxlPSIiIGNsYXNzPSJiYXNpYyBsYWJlbC1jb250YWluZXIiPjwvcmVjdD48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTUuMDExNzE4NzUsIC0xMikiIHN0eWxlPSIiIGNsYXNzPSJsYWJlbCI+PHJlY3Q+PC9yZWN0Pjxmb3JlaWduT2JqZWN0IGhlaWdodD0iMjQiIHdpZHRoPSIzMC4wMjM0Mzc1Ij48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+PHNwYW4gY2xhc3M9Im5vZGVMYWJlbCI+VW5pdDwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMDIuMDkzNzUsIDE5Ny41KSIgaWQ9ImZsb3djaGFydC1SZWZlcmVuY2UtNDMiIGNsYXNzPSJub2RlIGRlZmF1bHQgZGVmYXVsdCBmbG93Y2hhcnQtbGFiZWwiPjxyZWN0IGhlaWdodD0iMzkiIHdpZHRoPSIxNTEuNTg1OTM3NSIgeT0iLTE5LjUiIHg9Ii03NS43OTI5Njg3NSIgcnk9IjAiIHJ4PSIwIiBzdHlsZT0iIiBjbGFzcz0iYmFzaWMgbGFiZWwtY29udGFpbmVyIj48L3JlY3Q+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTY4LjI5Mjk2ODc1LCAtMTIpIiBzdHlsZT0iIiBjbGFzcz0ibGFiZWwiPjxyZWN0PjwvcmVjdD48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjI0IiB3aWR0aD0iMTM2LjU4NTkzNzUiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0ibm9kZUxhYmVsIj5RdWFudGl0eSByZWZlcmVuY2U8L3NwYW4+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTcxLjY3NTc4MTI1LCAxOS41KSIgaWQ9ImZsb3djaGFydC1EaW1lbnNpb24tNDQiIGNsYXNzPSJub2RlIGRlZmF1bHQgZGVmYXVsdCBmbG93Y2hhcnQtbGFiZWwiPjxyZWN0IGhlaWdodD0iMzkiIHdpZHRoPSI4OC40OTIxODc1IiB5PSItMTkuNSIgeD0iLTQ0LjI0NjA5Mzc1IiByeT0iMCIgcng9IjAiIHN0eWxlPSIiIGNsYXNzPSJiYXNpYyBsYWJlbC1jb250YWluZXIiPjwvcmVjdD48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMzYuNzQ2MDkzNzUsIC0xMikiIHN0eWxlPSIiIGNsYXNzPSJsYWJlbCI+PHJlY3Q+PC9yZWN0Pjxmb3JlaWduT2JqZWN0IGhlaWdodD0iMjQiIHdpZHRoPSI3My40OTIxODc1Ij48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+PHNwYW4gY2xhc3M9Im5vZGVMYWJlbCI+RGltZW5zaW9uPC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE4MS42NzU3ODEyNSwgMTA4LjUpIiBpZD0iZmxvd2NoYXJ0LVF1YW50aXR5U3BlYy00NSIgY2xhc3M9Im5vZGUgZGVmYXVsdCBkZWZhdWx0IGZsb3djaGFydC1sYWJlbCI+PHJlY3QgaGVpZ2h0PSIzOSIgd2lkdGg9IjE3My4zMDQ2ODc1IiB5PSItMTkuNSIgeD0iLTg2LjY1MjM0Mzc1IiByeT0iMCIgcng9IjAiIHN0eWxlPSIiIGNsYXNzPSJiYXNpYyBsYWJlbC1jb250YWluZXIiPjwvcmVjdD48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNzkuMTUyMzQzNzUsIC0xMikiIHN0eWxlPSIiIGNsYXNzPSJsYWJlbCI+PHJlY3Q+PC9yZWN0Pjxmb3JlaWduT2JqZWN0IGhlaWdodD0iMjQiIHdpZHRoPSIxNTguMzA0Njg3NSI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPjxzcGFuIGNsYXNzPSJub2RlTGFiZWwiPlF1YW50aXR5IHNwZWNpZmljYXRpb248L3NwYW4+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzYwLjEzMjgxMjUsIDE5LjUpIiBpZD0iZmxvd2NoYXJ0LXF1YW50aXR5X2NoYXJhY3Rlci00NiIgY2xhc3M9Im5vZGUgZGVmYXVsdCBkZWZhdWx0IGZsb3djaGFydC1sYWJlbCI+PHJlY3QgaGVpZ2h0PSIzOSIgd2lkdGg9IjE1MC41NzAzMTI1IiB5PSItMTkuNSIgeD0iLTc1LjI4NTE1NjI1IiByeT0iMCIgcng9IjAiIHN0eWxlPSIiIGNsYXNzPSJiYXNpYyBsYWJlbC1jb250YWluZXIiPjwvcmVjdD48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNjcuNzg1MTU2MjUsIC0xMikiIHN0eWxlPSIiIGNsYXNzPSJsYWJlbCI+PHJlY3Q+PC9yZWN0Pjxmb3JlaWduT2JqZWN0IGhlaWdodD0iMjQiIHdpZHRoPSIxMzUuNTcwMzEyNSI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPjxzcGFuIGNsYXNzPSJub2RlTGFiZWwiPlF1YW50aXR5IGNoYXJhY3Rlcjwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxOTUuNzg1MTU2MjUsIDI4Ni41KSIgaWQ9ImZsb3djaGFydC1RdWFudGl0eS01MSIgY2xhc3M9Im5vZGUgZGVmYXVsdCBkZWZhdWx0IGZsb3djaGFydC1sYWJlbCI+PHJlY3QgaGVpZ2h0PSIzOSIgd2lkdGg9Ijc2Ljg0Mzc1IiB5PSItMTkuNSIgeD0iLTM4LjQyMTg3NSIgcnk9IjAiIHJ4PSIwIiBzdHlsZT0iIiBjbGFzcz0iYmFzaWMgbGFiZWwtY29udGFpbmVyIj48L3JlY3Q+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTMwLjkyMTg3NSwgLTEyKSIgc3R5bGU9IiIgY2xhc3M9ImxhYmVsIj48cmVjdD48L3JlY3Q+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSIyNCIgd2lkdGg9IjYxLjg0Mzc1Ij48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+PHNwYW4gY2xhc3M9Im5vZGVMYWJlbCI+UXVhbnRpdHk8L3NwYW4+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzcwLjEzMjgxMjUsIDE5Ny41KSIgaWQ9ImZsb3djaGFydC1SZXByZXNlbnRhdGlvbi01MyIgY2xhc3M9Im5vZGUgZGVmYXVsdCBkZWZhdWx0IGZsb3djaGFydC1sYWJlbCI+PHJlY3QgaGVpZ2h0PSIzOSIgd2lkdGg9IjEyMy4xNzk2ODc1IiB5PSItMTkuNSIgeD0iLTYxLjU4OTg0Mzc1IiByeT0iMCIgcng9IjAiIHN0eWxlPSIiIGNsYXNzPSJiYXNpYyBsYWJlbC1jb250YWluZXIiPjwvcmVjdD48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNTQuMDg5ODQzNzUsIC0xMikiIHN0eWxlPSIiIGNsYXNzPSJsYWJlbCI+PHJlY3Q+PC9yZWN0Pjxmb3JlaWduT2JqZWN0IGhlaWdodD0iMjQiIHdpZHRoPSIxMDguMTc5Njg3NSI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPjxzcGFuIGNsYXNzPSJub2RlTGFiZWwiPlJlcHJlc2VudGF0aW9uPC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI2NC4yMjg1MTU2MjUsIDM3NS41KSIgaWQ9ImZsb3djaGFydC1RdWFudGl0eVBvaW50LTU3IiBjbGFzcz0ibm9kZSBkZWZhdWx0IGRlZmF1bHQgZmxvd2NoYXJ0LWxhYmVsIj48cmVjdCBoZWlnaHQ9IjM5IiB3aWR0aD0iMTE4LjgxMjUiIHk9Ii0xOS41IiB4PSItNTkuNDA2MjUiIHJ5PSIwIiByeD0iMCIgc3R5bGU9IiIgY2xhc3M9ImJhc2ljIGxhYmVsLWNvbnRhaW5lciI+PC9yZWN0PjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC01MS45MDYyNSwgLTEyKSIgc3R5bGU9IiIgY2xhc3M9ImxhYmVsIj48cmVjdD48L3JlY3Q+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSIyNCIgd2lkdGg9IjEwMy44MTI1Ij48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+PHNwYW4gY2xhc3M9Im5vZGVMYWJlbCI+UXVhbnRpdHkgcG9pbnQ8L3NwYW4+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzMyLjY3MTg3NSwgMjg2LjUpIiBpZD0iZmxvd2NoYXJ0LVBvaW50T3JpZ2luLTU4IiBjbGFzcz0ibm9kZSBkZWZhdWx0IGRlZmF1bHQgZmxvd2NoYXJ0LWxhYmVsIj48cmVjdCBoZWlnaHQ9IjM5IiB3aWR0aD0iOTYuOTI5Njg3NSIgeT0iLTE5LjUiIHg9Ii00OC40NjQ4NDM3NSIgcnk9IjAiIHJ4PSIwIiBzdHlsZT0iIiBjbGFzcz0iYmFzaWMgbGFiZWwtY29udGFpbmVyIj48L3JlY3Q+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTQwLjk2NDg0Mzc1LCAtMTIpIiBzdHlsZT0iIiBjbGFzcz0ibGFiZWwiPjxyZWN0PjwvcmVjdD48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjI0IiB3aWR0aD0iODEuOTI5Njg3NSI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPjxzcGFuIGNsYXNzPSJub2RlTGFiZWwiPlBvaW50IG9yaWdpbjwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48L2c+PC9nPjwvZz48L3N2Zz4=" style="display: block; margin-left: auto; margin-right: auto; width: 60%;" /></p>
<p>Some of the entities were already introduced in the <a href="#quick-domain-introduction">Quick domain introduction</a> chapter.
Below we describe the remaining ones.</p>
<h3 data-number="16.2.1" id="quantity-character"><span class="header-section-number">16.2.1</span> Quantity character<a href="#quantity-character" class="self-link"></a></h3>
<p><span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span> explicitly states that
quantities (even of the same kind) may have different characters:</p>
<ul>
<li>scalar,</li>
<li>vector,</li>
<li>tensor.</li>
</ul>
<p>The quantity character in the library is implemented with the
<code class="sourceCode default">quantity_character</code>
enumeration:</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="kw">enum</span> <span class="kw">class</span> quantity_character <span class="op">{</span> scalar, vector, tensor <span class="op">}</span>;</span></code></pre></div>
<p>More information on quantity characters can be found in the
[Character of a quantity] chapter.</p>
<h3 data-number="16.2.2" id="quantity-specification"><span class="header-section-number">16.2.2</span> Quantity specification<a href="#quantity-specification" class="self-link"></a></h3>
<p>Dimension is not enough to describe a quantity. This is why <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span> provides hundreds of
named quantity types. It turns out that there are many more quantity
types in the ISQ than the named units in the <span class="citation" data-cites="SI">[<a href="#ref-SI" role="doc-biblioref">SI</a>]</span>.</p>
<p>This is why the library introduces a quantity specification entity
that stores:</p>
<ul>
<li><a href="#dimension">Dimension</a>,</li>
<li><a href="#quantity-type">Quantity type</a>,</li>
<li><a href="#quantity-character">Quantity character</a>,</li>
<li>the quantity equation being the recipe to create this quantity (only
for derived quantities that specify such a recipe).</li>
</ul>
<p>For example:</p>
<ul>
<li><code class="sourceCode default">isq::length</code>,
<code class="sourceCode default">isq::mass</code>,
<code class="sourceCode default">isq::time</code>,
<code class="sourceCode default">isq::electric_current</code>,
<code class="sourceCode default">isq::thermodynamic_temperature</code>,
<code class="sourceCode default">isq::amount_of_substance</code>, and
<code class="sourceCode default">isq::luminous_intensity</code> are the
specifications of base quantities in the ISQ.</li>
<li><code class="sourceCode default">isq::width</code>,
<code class="sourceCode default">isq::height</code>,
<code class="sourceCode default">isq::radius</code>, and
<code class="sourceCode default">isq::position_vector</code> are only a
few of many quantities of a kind length specified in the ISQ.</li>
<li><code class="sourceCode default">isq::area</code>,
<code class="sourceCode default">isq::speed</code>,
<code class="sourceCode default">isq::moment_of_force</code> are only a
few of many derived quantities provided in the ISQ.</li>
</ul>
<h3 data-number="16.2.3" id="unit"><span class="header-section-number">16.2.3</span> Unit<a href="#unit" class="self-link"></a></h3>
<p>A unit is a concrete amount of a quantity that allows us to measure
the values of quantities of the same kind and represent the result as a
number being the ratio of the two quantities.</p>
<p>For example:</p>
<ul>
<li><code class="sourceCode default">si::second</code>,
<code class="sourceCode default">si::metre</code>,
<code class="sourceCode default">si::kilogram</code>,
<code class="sourceCode default">si::ampere</code>,
<code class="sourceCode default">si::kelvin</code>,
<code class="sourceCode default">si::mole</code>, and
<code class="sourceCode default">si::candela</code> are the base units
of the <span class="citation" data-cites="SI">[<a href="#ref-SI" role="doc-biblioref">SI</a>]</span>.</li>
<li><code class="sourceCode default">si::kilo&lt;si::metre&gt;</code> is
a prefixed unit of length.</li>
<li><code class="sourceCode default">si::radian</code>,
<code class="sourceCode default">si::newton</code>, and
<code class="sourceCode default">si::watt</code> are examples of named
derived units within the <span class="citation" data-cites="SI">[<a href="#ref-SI" role="doc-biblioref">SI</a>]</span>.</li>
<li><code class="sourceCode default">non_si::minute</code> is an example
of a scaled unit of time.</li>
<li><code class="sourceCode default">si::si2019::speed_of_light_in_vacuum</code>
is a physical constant standardized by the SI in 2019.</li>
</ul>
<p><em>Note: In this library, physical constants are also implemented as
units.</em></p>
<h3 data-number="16.2.4" id="quantity-representation"><span class="header-section-number">16.2.4</span> Quantity representation<a href="#quantity-representation" class="self-link"></a></h3>
<p>Quantity representation defines the type used to store the numerical
value of a quantity. Such a type should be of a specific quantity
character provided in the quantity specification.</p>
<p><em>Note: By default, all floating-point and integral (besides
<code class="sourceCode default">bool</code>) types are treated as
scalars.</em></p>
<h3 data-number="16.2.5" id="point-origin"><span class="header-section-number">16.2.5</span> Point origin<a href="#point-origin" class="self-link"></a></h3>
<p>In the affine space theory, the point origin specifies where the
“zero” of our measurement’s scale is.</p>
<p>In this library, we have two types of point origins:</p>
<ul>
<li>absolute - defines an absolute “zero” for our point,</li>
<li>relative - defines an origin that has some “offset” relative to an
absolute point.</li>
</ul>
<p><em>Note: More information on this subject can be found in <a href="#the-affine-space">The affine space</a> chapter.</em></p>
<h3 data-number="16.2.6" id="quantity-point"><span class="header-section-number">16.2.6</span> Quantity point<a href="#quantity-point" class="self-link"></a></h3>
<p>Quantity point implements a point in the affine space theory. Its
value can be easily created by adding/subtracting the quantity with a
point origin.</p>
<p><em>Note: More information on this subject can be found in <a href="#the-affine-space">The affine space</a> chapter.</em></p>
<h2 data-number="16.3" id="concepts"><span class="header-section-number">16.3</span> Concepts<a href="#concepts" class="self-link"></a></h2>
<p>This chapter enumerates all the user-facing concepts in the
library.</p>
<!-- TODO Remove this note in the future -->
<p><em>Note 1: We understand that at this stage of the paper, without a
detailed synopsis, it might be too early to review exact definitions of
concepts. We list them here so the reader can familiarize with the count
and granularity of them, so to have a better idea about the scope and
look and feel of the library.</em></p>
<p><em>Note 2: Initially, C++20 was meant to use
<code class="sourceCode default">CamelCase</code> for all the concept
identifiers. Frustratingly,
<code class="sourceCode default">CamelCase</code> concepts got dropped
from the C++ standard at the last moment before releasing C++20. Now, we
are facing the predictable consequences of running out of names. As long
as some concepts in the library could be easily named with a
<code class="sourceCode default">standard_case</code> there are some
that are hard to distinguish from the corresponding type names, such as
<code class="sourceCode default">Quantity</code>,
<code class="sourceCode default">QuantityPoint</code>,
<code class="sourceCode default">QuantitySpec</code>, or
<code class="sourceCode default">Reference</code>. This is why we
decided to use <code class="sourceCode default">CamelCase</code>
consistently for all the concept identifiers to make it clear when we
are talking about a type or concept identifier. However, we are aware
that this might be a temporary solution. In case the library gets
standardized, we can expect the LEWG to bikeshed/rename all of the
concept identifiers to a
<code class="sourceCode default">standard_case</code>, even if it will
result in a harder to understand code.</em></p>
<h3 data-number="16.3.1" id="Dimension-concept"><span class="header-section-number">16.3.1</span>
<code class="sourceCode default">Dimension&lt;T&gt; concept</code><a href="#Dimension-concept" class="self-link"></a></h3>
<p><code class="sourceCode default">Dimension</code> concept matches a
dimension of either a base or derived quantity:</p>
<ul>
<li>Base dimensions are explicitly defined by the user by inheriting
from the instantiation of a
<code class="sourceCode default">base_dimension</code> class template.
It should be instantiated with a unique symbol identifier describing
this dimension in a specific system of quantities.</li>
<li>Derived dimensions are implicitly created by the library’s framework
based on the quantity equation provided in the quantity
specification.</li>
</ul>
<h4 data-number="16.3.1.1" id="DimensionOf-concept"><span class="header-section-number">16.3.1.1</span>
<code class="sourceCode default">DimensionOf&lt;T, V&gt;</code>
concept<a href="#DimensionOf-concept" class="self-link"></a></h4>
<p><code class="sourceCode default">DimensionOf</code> concept is
satisfied when both arguments satisfy a <a href="#Dimension-concept"><code class="sourceCode default">Dimension</code></a>
concept and when they compare equal.</p>
<h3 data-number="16.3.2" id="QuantitySpec-concept"><span class="header-section-number">16.3.2</span>
<code class="sourceCode default">QuantitySpec&lt;T&gt; concept</code><a href="#QuantitySpec-concept" class="self-link"></a></h3>
<p><code class="sourceCode default">QuantitySpec</code> concept matches
all the quantity specifications including:</p>
<ul>
<li>Base quantities defined by a user by inheriting from the
<code class="sourceCode default">quantity_spec</code> class template
instantiated with a base dimension argument.</li>
<li>Derived named quantities defined by a user by inheriting from the
<code class="sourceCode default">quantity_spec</code> class template
instantiated with a result of a quantity equation passed as an
argument.</li>
<li>Other named quantities forming a hierarchy of quantities of the same
kind defined by a user by inheriting from the
<code class="sourceCode default">quantity_spec</code> class template
instantiated with another “parent” quantity specification passed as an
argument.</li>
<li>Quantity kinds describing a family of mutually comparable
quantities.</li>
<li>Intermediate derived quantity specifications being a result of a
quantity equations on other specifications.</li>
</ul>
<h4 data-number="16.3.2.1" id="QuantitySpecOf-concept"><span class="header-section-number">16.3.2.1</span>
<code class="sourceCode default">QuantitySpecOf&lt;T, V&gt;</code>
concept<a href="#QuantitySpecOf-concept" class="self-link"></a></h4>
<p><code class="sourceCode default">QuantitySpecOf</code> concept is
satisfied when both arguments satisfy a <a href="#QuantitySpec-concept"><code class="sourceCode default">QuantitySpec</code></a>
concept and when <code class="sourceCode default">T</code> is implicitly
convertible to <code class="sourceCode default">V</code>.</p>
<p>Additionally:</p>
<ul>
<li><code class="sourceCode default">T</code> should not be a nested
quantity specification of <code class="sourceCode default">V</code></li>
<li>either <code class="sourceCode default">T</code> is quantity kind or
<code class="sourceCode default">V</code> should not be a nested
quantity specification of <code class="sourceCode default">T</code></li>
</ul>
<p>Those additional conditions are required to make the following
work:</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>ReferenceOf<span class="op">&lt;</span>si<span class="op">::</span>radian, isq<span class="op">::</span>angular_measure<span class="op">&gt;)</span>;</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(!</span>ReferenceOf<span class="op">&lt;</span>si<span class="op">::</span>radian, dimensionless<span class="op">&gt;)</span>;</span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(!</span>ReferenceOf<span class="op">&lt;</span>isq<span class="op">::</span>angular_measure<span class="op">[</span>si<span class="op">::</span>radian<span class="op">]</span>, dimensionless<span class="op">&gt;)</span>;</span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>ReferenceOf<span class="op">&lt;</span>one, isq<span class="op">::</span>angular_measure<span class="op">&gt;)</span>;</span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(!</span>ReferenceOf<span class="op">&lt;</span>dimensionless<span class="op">[</span>one<span class="op">]</span>, isq<span class="op">::</span>angular_measure<span class="op">&gt;)</span>;</span></code></pre></div>
<h3 data-number="16.3.3" id="Unit-concept"><span class="header-section-number">16.3.3</span>
<code class="sourceCode default">Unit&lt;T&gt;</code> concept<a href="#Unit-concept" class="self-link"></a></h3>
<p><code class="sourceCode default">Unit</code> concept matches all the
units in the library including:</p>
<ul>
<li>Base units defined by a user by inheriting from the
<code class="sourceCode default">named_unit</code> class template
instantiated with a unique symbol identifier describing this unit in a
specific system of units.</li>
<li>Named scaled units defined by a user by inheriting from the
<code class="sourceCode default">named_unit</code> class template
instantiated with a unique symbol identifier and a product of
multiplying another unit with some magnitude.</li>
<li>Prefixed units defined by a user by inheriting from the
<code class="sourceCode default">prefixed_unit</code> class template
instantiated with a prefix symbol, a magnitude, and a unit to be
prefixed.</li>
<li>Derived named units defined by a user by inheriting from the
<code class="sourceCode default">named_unit</code> class template
instantiated with a unique symbol identifier and a result of unit
equation passed as an argument.</li>
<li>Derived unnamed units being a result of a unit equations on other
units.</li>
</ul>
<p><em>Note: Physical constants are also implemented as units.</em></p>
<h4 data-number="16.3.3.1" id="AssociatedUnit-concept"><span class="header-section-number">16.3.3.1</span>
<code class="sourceCode default">AssociatedUnit&lt;T&gt;</code>
concept<a href="#AssociatedUnit-concept" class="self-link"></a></h4>
<p><code class="sourceCode default">AssociatedUnit</code> concept
describes a unit with an associated quantity and is satisfied by:</p>
<ul>
<li>All units derived from a
<code class="sourceCode default">named_unit</code> class template
instantiated with a unique symbol identifier and a <a href="#QuantitySpec-concept"><code class="sourceCode default">QuantitySpec</code></a>
of a quantity kind.</li>
<li>All units being a result of unit equations on other associated
units.</li>
</ul>
<p>All units in the <span class="citation" data-cites="SI">[<a href="#ref-SI" role="doc-biblioref">SI</a>]</span> have associated
quantities. For example,
<code class="sourceCode default">si::second</code> is specified to
measure <code class="sourceCode default">isq::time</code>.</p>
<p>Natural units typically do not have an associated quantity. For
example, if we assume <code class="sourceCode default">c = 1</code>, a
<code class="sourceCode default">natural::second</code> unit can be used
to measure both <code class="sourceCode default">time</code> and
<code class="sourceCode default">length</code>. In such case,
<code class="sourceCode default">speed</code> would have a unit of
<code class="sourceCode default">one</code>.</p>
<h4 data-number="16.3.3.2" id="PrefixableUnit-concept"><span class="header-section-number">16.3.3.2</span>
<code class="sourceCode default">PrefixableUnit&lt;T&gt;</code>
concept<a href="#PrefixableUnit-concept" class="self-link"></a></h4>
<p><code class="sourceCode default">PrefixableUnit</code> concept is
satisfied by all units derived from a
<code class="sourceCode default">named_unit</code> class template for
which a customization point
<code class="sourceCode default">unit_can_be_prefixed&lt;T{}&gt;</code>
was not explicitly set to <code class="sourceCode default">false</code>.
Such units can be passed as an argument to a
<code class="sourceCode default">prefixed_unit</code> class
template.</p>
<p>All units in the <span class="citation" data-cites="SI">[<a href="#ref-SI" role="doc-biblioref">SI</a>]</span> can be prefixed with
SI-defined prefixes.</p>
<p>Some off-system units like
<code class="sourceCode default">non_si::day</code> can’t be prefixed.
To enforce that, the following has to be provided:</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;&gt;</span> <span class="kw">inline</span> <span class="kw">constexpr</span> <span class="dt">bool</span> unit_can_be_prefixed<span class="op">&lt;</span>non_si<span class="op">::</span>day<span class="op">&gt;</span> <span class="op">=</span> <span class="kw">false</span>;</span></code></pre></div>
<h4 data-number="16.3.3.3" id="UnitOf-concept"><span class="header-section-number">16.3.3.3</span>
<code class="sourceCode default">UnitOf&lt;T, V&gt;</code> concept<a href="#UnitOf-concept" class="self-link"></a></h4>
<p><code class="sourceCode default">UnitOf</code> concept is satisfied
for all units <code class="sourceCode default">T</code> matching an <a href="#AssociatedUnit-concept"><code class="sourceCode default">AssociatedUnit</code></a>
concept with an associated quantity type implicitly convertible to
<code class="sourceCode default">V</code>.</p>
<p>Additionally, the kind of <code class="sourceCode default">V</code>
and the kind of quantity type associated with
<code class="sourceCode default">T</code> must be the same, or the
quantity type associated with <code class="sourceCode default">T</code>
may not be derived from the kind of
<code class="sourceCode default">V</code>.</p>
<p>This condition is required to make
<code class="sourceCode default">dimensionless[si::radian]</code>
invalid as <code class="sourceCode default">si::radian</code> should be
only used for
<code class="sourceCode default">isq::angular_measure</code>, which is a
nested quantity kind within the dimensionless quantities tree.</p>
<h4 data-number="16.3.3.4" id="UnitCompatibleWith-concept"><span class="header-section-number">16.3.3.4</span> <code class="sourceCode default">UnitCompatibleWith&lt;T, V1, V2&gt;</code>
concept<a href="#UnitCompatibleWith-concept" class="self-link"></a></h4>
<p><code class="sourceCode default">UnitCompatibleWith</code> concept is
satisfied for all units <code class="sourceCode default">T</code>
when:</p>
<ul>
<li><code class="sourceCode default">V1</code> is a <a href="#Unit-concept"><code class="sourceCode default">Unit</code></a>,</li>
<li><code class="sourceCode default">V2</code> is a <a href="#QuantitySpec-concept"><code class="sourceCode default">QuantitySpec</code></a>,</li>
<li><code class="sourceCode default">T</code> and
<code class="sourceCode default">V1</code> are defined in terms of the
same reference unit,</li>
<li>if <code class="sourceCode default">T</code> is an <a href="#AssociatedUnit-concept"><code class="sourceCode default">AssociatedUnit</code></a>
it should satisfy <a href="#UnitOf-concept"><code class="sourceCode default">UnitOf&lt;V2&gt;</code></a>.</li>
</ul>
<h3 data-number="16.3.4" id="Reference-concept"><span class="header-section-number">16.3.4</span>
<code class="sourceCode default">Reference&lt;T&gt;</code> concept<a href="#Reference-concept" class="self-link"></a></h3>
<p><code class="sourceCode default">Reference</code> concept is
satisfied by all quantity reference types. Such types provide all the
meta-information required to create a <a href="#Quantity-concept"><code class="sourceCode default">Quantity</code></a>.</p>
<p>A <code class="sourceCode default">Reference</code> can either
be:</p>
<ul>
<li>An <a href="#AssociatedUnit-concept"><code class="sourceCode default">AssociatedUnit</code></a>.</li>
<li>The instantiation of a
<code class="sourceCode default">reference</code> class template with a
<a href="#QuantitySpec-concept"><code class="sourceCode default">QuantitySpec</code></a>
passed as the first template argument and a <a href="#Unit-concept"><code class="sourceCode default">Unit</code></a>
passed as the second one.</li>
</ul>
<h4 data-number="16.3.4.1" id="ReferenceOf-concept"><span class="header-section-number">16.3.4.1</span>
<code class="sourceCode default">ReferenceOf&lt;T, V&gt;</code>
concept<a href="#ReferenceOf-concept" class="self-link"></a></h4>
<p><code class="sourceCode default">ReferenceOf</code> concept is
satisfied by references <code class="sourceCode default">T</code> which
have a quantity specification that satisfies <a href="#QuantitySpecOf-concept"><code class="sourceCode default">QuantitySpecOf&lt;V&gt;</code></a>
concept. |</p>
<h3 data-number="16.3.5" id="Representation-concept"><span class="header-section-number">16.3.5</span>
<code class="sourceCode default">Representation&lt;T&gt;</code>
concept<a href="#Representation-concept" class="self-link"></a></h3>
<p><code class="sourceCode default">Representation</code> concept
constraints a type of a number that stores the value of a quantity.</p>
<h4 data-number="16.3.5.1" id="RepresentationOf-concept"><span class="header-section-number">16.3.5.1</span>
<code class="sourceCode default">RepresentationOf&lt;T, Ch&gt;</code>
concept<a href="#RepresentationOf-concept" class="self-link"></a></h4>
<p><code class="sourceCode default">RepresentationOf</code> concept is
satisfied by all <a href="#Representation-concept"><code class="sourceCode default">Representation</code></a>
types that are of a specified quantity character
<code class="sourceCode default">Ch</code>.</p>
<p>A user can declare a custom representation type to be of a specific
character by providing the specialization with
<code class="sourceCode default">true</code> for one or more of the
following variable templates:</p>
<ul>
<li><code class="sourceCode default">is_scalar&lt;T&gt;</code></li>
<li><code class="sourceCode default">is_vector&lt;T&gt;</code></li>
<li><code class="sourceCode default">is_tensor&lt;T&gt;</code></li>
</ul>
<p>If we want to use scalar types to also express vector quantities
(e.g., ignoring the “direction” of the vector) the following definition
can be provided to enable such a behavior:</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span><span class="kw">class</span> T<span class="op">&gt;</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">requires</span> is_scalar<span class="op">&lt;</span>T<span class="op">&gt;</span></span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="dt">bool</span> is_vector<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="op">=</span> <span class="kw">true</span>;</span></code></pre></div>
<h3 data-number="16.3.6" id="Quantity-concept"><span class="header-section-number">16.3.6</span>
<code class="sourceCode default">Quantity&lt;T&gt;</code> concept<a href="#Quantity-concept" class="self-link"></a></h3>
<p><code class="sourceCode default">Quantity</code> concept matches
every quantity in the library and is satisfied by all types being or
deriving from an instantiation of a
<code class="sourceCode default">quantity</code> class template.</p>
<h4 data-number="16.3.6.1" id="QuantityOf-concept"><span class="header-section-number">16.3.6.1</span>
<code class="sourceCode default">QuantityOf&lt;T, V&gt;</code> concept<a href="#QuantityOf-concept" class="self-link"></a></h4>
<p><code class="sourceCode default">QuantityOf</code> concept is
satisfied by all the quantities for which a <a href="#QuantitySpecOf-concept"><code class="sourceCode default">QuantitySpecOf&lt;V&gt;</code></a>
is <code class="sourceCode default">true</code>.</p>
<h3 data-number="16.3.7" id="PointOrigin-concept"><span class="header-section-number">16.3.7</span>
<code class="sourceCode default">PointOrigin&lt;T&gt;</code> concept<a href="#PointOrigin-concept" class="self-link"></a></h3>
<p><code class="sourceCode default">PointOrigin</code> concept matches
all quantity point origins in the library. It is satisfied by
either:</p>
<ul>
<li>All types derived from an
<code class="sourceCode default">absolute_point_origin</code> class
template.</li>
<li>All types derived from a
<code class="sourceCode default">relative_point_origin</code> class
template.</li>
</ul>
<h4 data-number="16.3.7.1" id="PointOriginFor-concept"><span class="header-section-number">16.3.7.1</span>
<code class="sourceCode default">PointOriginFor&lt;T, V&gt;</code>
concept<a href="#PointOriginFor-concept" class="self-link"></a></h4>
<p><code class="sourceCode default">PointOriginFor</code> concept is
satisfied by all <a href="#PointOrigin-concept"><code class="sourceCode default">PointOrigin</code></a>
types that have quantity type implicitly convertible from quantity
specification <code class="sourceCode default">V</code>, which means
that <code class="sourceCode default">V</code> must satisfy <a href="#QuantitySpecOf-concept"><code class="sourceCode default">QuantitySpecOf&lt;T::quantity_spec&gt;</code></a>.</p>
<p>For example, <code class="sourceCode default">si::ice_point</code>
can serve as a point origin for <em>points</em> of
<code class="sourceCode default">isq::Celsius_temperature</code> because
this quantity type implicitly converts to
<code class="sourceCode default">isq::thermodynamic_temperature</code>.</p>
<p>However, if we define
<code class="sourceCode default">mean_sea_level</code> in the following
way:</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> mean_sea_level <span class="op">:</span> absolute_point_origin<span class="op">&lt;</span>isq<span class="op">::</span>altitude<span class="op">&gt;</span> <span class="op">{}</span> mean_sea_level;</span></code></pre></div>
<p>then it can’t be used as a point origin for <em>points</em> of
<code class="sourceCode default">isq::length</code> or
<code class="sourceCode default">isq::width</code> as none of them is
implicitly convertible to
<code class="sourceCode default">isq::altitude</code>:</p>
<ul>
<li>not every <em>length</em> is an <em>altitude</em>,</li>
<li><em>width</em> is not compatible with <em>altitude</em>.</li>
</ul>
<h3 data-number="16.3.8" id="QuantityPoint-concept"><span class="header-section-number">16.3.8</span>
<code class="sourceCode default">QuantityPoint&lt;T&gt;</code> concept<a href="#QuantityPoint-concept" class="self-link"></a></h3>
<p><code class="sourceCode default">QuantityPoint</code> concept is
satisfied by all types being either a specialization or derived from
<code class="sourceCode default">quantity_point</code> class
template.</p>
<h4 data-number="16.3.8.1" id="QuantityPointOf-concept"><span class="header-section-number">16.3.8.1</span>
<code class="sourceCode default">QuantityPointOf&lt;T, V&gt;</code>
concept<a href="#QuantityPointOf-concept" class="self-link"></a></h4>
<p><code class="sourceCode default">QuantityPointOf</code> concept is
satisfied by all the quantity points
<code class="sourceCode default">T</code> that match the following value
<code class="sourceCode default">V</code>:</p>
<table>
<colgroup>
<col style="width: 12%" />
<col style="width: 87%" />
</colgroup>
<thead>
<tr class="header">
<th><div style="text-align:center">
<strong><code class="sourceCode default">V</code></strong>
</div></th>
<th><div style="text-align:center">
<strong>Condition</strong>
</div></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code class="sourceCode default">QuantitySpec</code></td>
<td>The quantity point quantity specification satisfies <a href="#QuantitySpecOf-concept"><code class="sourceCode default">QuantitySpecOf&lt;V&gt;</code></a>
concept.</td>
</tr>
<tr class="even">
<td><code class="sourceCode default">PointOrigin</code></td>
<td>The <em>point</em> and <code class="sourceCode default">V</code>
have the same absolute point origin.</td>
</tr>
</tbody>
</table>
<h3 data-number="16.3.9" id="QuantityLike-concept"><span class="header-section-number">16.3.9</span>
<code class="sourceCode default">QuantityLike&lt;T&gt;</code> concept<a href="#QuantityLike-concept" class="self-link"></a></h3>
<p><code class="sourceCode default">QuantityLike</code> concept provides
interoperability with other libraries and is satisfied by a type
<code class="sourceCode default">T</code> for which an instantiation of
<code class="sourceCode default">quantity_like_traits</code> type trait
yields a valid type that provides:</p>
<ul>
<li>Static data member <code class="sourceCode default">reference</code>
that matches the <a href="#Reference-concept"><code class="sourceCode default">Reference</code></a>
concept,</li>
<li><code class="sourceCode default">rep</code> type that matches <a href="#RepresentationOf-concept"><code class="sourceCode default">RepresentationOf</code></a>
concept with the character provided in
<code class="sourceCode default">reference</code>.</li>
<li><code class="sourceCode default">to_numerical_value(T)</code> static
member function returning a raw value of the quantity packed in either
<code class="sourceCode default">convert_explicitly</code> or
<code class="sourceCode default">convert_implicitly</code> wrapper that
enables implicit conversion in the latter case.</li>
<li><code class="sourceCode default">from_numerical_value(rep)</code>
static member function returning
<code class="sourceCode default">T</code> packed in either
<code class="sourceCode default">convert_explicitly</code> or
<code class="sourceCode default">convert_implicitly</code> wrapper that
enables implicit conversion in the latter case.</li>
</ul>
<p>For example, this is how support for
<code class="sourceCode default">std::chrono::seconds</code> can be
provided:</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;&gt;</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> quantity_like_traits<span class="op">&lt;</span>std<span class="op">::</span>chrono<span class="op">::</span>seconds<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">static</span> <span class="kw">constexpr</span> <span class="kw">auto</span> reference <span class="op">=</span> si<span class="op">::</span>second;</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">using</span> rep <span class="op">=</span> std<span class="op">::</span>chrono<span class="op">::</span>seconds<span class="op">::</span>rep;</span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">[[</span><span class="at">nodiscard</span><span class="op">]]</span> <span class="kw">static</span> <span class="kw">constexpr</span> convert_implicitly<span class="op">&lt;</span>rep<span class="op">&gt;</span> to_numerical_value<span class="op">(</span><span class="kw">const</span> std<span class="op">::</span>chrono<span class="op">::</span>seconds<span class="op">&amp;</span> q<span class="op">)</span></span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a>  <span class="op">{</span></span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> q<span class="op">.</span>count<span class="op">()</span>;</span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb191-10"><a href="#cb191-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-11"><a href="#cb191-11" aria-hidden="true" tabindex="-1"></a>  <span class="op">[[</span><span class="at">nodiscard</span><span class="op">]]</span> <span class="kw">static</span> <span class="kw">constexpr</span> convert_implicitly<span class="op">&lt;</span>std<span class="op">::</span>chrono<span class="op">::</span>seconds<span class="op">&gt;</span> from_numerical_value<span class="op">(</span><span class="kw">const</span> rep<span class="op">&amp;</span> v<span class="op">)</span></span>
<span id="cb191-12"><a href="#cb191-12" aria-hidden="true" tabindex="-1"></a>  <span class="op">{</span></span>
<span id="cb191-13"><a href="#cb191-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> std<span class="op">::</span>chrono<span class="op">::</span>seconds<span class="op">(</span>v<span class="op">)</span>;</span>
<span id="cb191-14"><a href="#cb191-14" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb191-15"><a href="#cb191-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>;</span>
<span id="cb191-16"><a href="#cb191-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-17"><a href="#cb191-17" aria-hidden="true" tabindex="-1"></a>quantity q <span class="op">=</span> <span class="dv">42</span><span class="bu">s</span>;</span>
<span id="cb191-18"><a href="#cb191-18" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>chrono<span class="op">::</span>seconds dur <span class="op">=</span> <span class="dv">42</span> <span class="op">*</span> s;</span></code></pre></div>
<h3 data-number="16.3.10" id="QuantityPointLike-concept"><span class="header-section-number">16.3.10</span>
<code class="sourceCode default">QuantityPointLike&lt;T&gt;</code>
concept<a href="#QuantityPointLike-concept" class="self-link"></a></h3>
<p><code class="sourceCode default">QuantityPointLike</code> concept
provides interoperability with other libraries and is satisfied by a
type <code class="sourceCode default">T</code> for which an
instantiation of
<code class="sourceCode default">quantity_point_like_traits</code> type
trait yields a valid type that provides:</p>
<ul>
<li>Static data member <code class="sourceCode default">reference</code>
that matches the <a href="#Reference-concept"><code class="sourceCode default">Reference</code></a>
concept.</li>
<li>Static data member
<code class="sourceCode default">point_origin</code> that matches the <a href="#PointOrigin-concept"><code class="sourceCode default">PointOrigin</code></a>
concept.</li>
<li><code class="sourceCode default">rep</code> type that matches <a href="#RepresentationOf-concept"><code class="sourceCode default">RepresentationOf</code></a>
concept with the character provided in
<code class="sourceCode default">reference</code>.</li>
<li><code class="sourceCode default">to_quantity(T)</code> static member
function returning the <code class="sourceCode default">quantity</code>
being the offset of the point from the origin packed in either
<code class="sourceCode default">convert_explicitly</code> or
<code class="sourceCode default">convert_implicitly</code> wrapper that
enables implicit conversion in the latter case.</li>
<li><code class="sourceCode default">from_quantity(quantity&lt;reference, rep&gt;)</code>
static member function returning
<code class="sourceCode default">T</code> packed in either
<code class="sourceCode default">convert_explicitly</code> or
<code class="sourceCode default">convert_implicitly</code> wrapper that
enables implicit conversion in the latter case.</li>
</ul>
<p>For eample, this is how support for a
<code class="sourceCode default">std::chrono::time_point</code> of
<code class="sourceCode default">std::chrono::seconds</code> can be
provided:</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span><span class="kw">typename</span> C<span class="op">&gt;</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> quantity_point_like_traits<span class="op">&lt;</span>std<span class="op">::</span>chrono<span class="op">::</span>time_point<span class="op">&lt;</span>C, std<span class="op">::</span>chrono<span class="op">::</span>seconds<span class="op">&gt;&gt;</span> <span class="op">{</span></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">using</span> T <span class="op">=</span> std<span class="op">::</span>chrono<span class="op">::</span>time_point<span class="op">&lt;</span>C, std<span class="op">::</span>chrono<span class="op">::</span>seconds<span class="op">&gt;</span>;</span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">static</span> <span class="kw">constexpr</span> <span class="kw">auto</span> reference <span class="op">=</span> si<span class="op">::</span>second;</span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">static</span> <span class="kw">constexpr</span> <span class="kw">struct</span> point_origin <span class="op">:</span> absolute_point_origin<span class="op">&lt;</span>isq<span class="op">::</span>time<span class="op">&gt;</span> <span class="op">{}</span> point_origin<span class="op">{}</span>;</span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">using</span> rep <span class="op">=</span> std<span class="op">::</span>chrono<span class="op">::</span>seconds<span class="op">::</span>rep;</span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a>  <span class="op">[[</span><span class="at">nodiscard</span><span class="op">]]</span> <span class="kw">static</span> <span class="kw">constexpr</span> convert_implicitly<span class="op">&lt;</span>quantity<span class="op">&lt;</span>reference, rep<span class="op">&gt;&gt;</span> to_quantity<span class="op">(</span><span class="kw">const</span> T<span class="op">&amp;</span> qp<span class="op">)</span></span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true" tabindex="-1"></a>  <span class="op">{</span></span>
<span id="cb192-10"><a href="#cb192-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> quantity<span class="op">{</span>qp<span class="op">.</span>time_since_epoch<span class="op">()}</span>;</span>
<span id="cb192-11"><a href="#cb192-11" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb192-12"><a href="#cb192-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-13"><a href="#cb192-13" aria-hidden="true" tabindex="-1"></a>  <span class="op">[[</span><span class="at">nodiscard</span><span class="op">]]</span> <span class="kw">static</span> <span class="kw">constexpr</span> convert_implicitly<span class="op">&lt;</span>T<span class="op">&gt;</span> from_quantity<span class="op">(</span><span class="kw">const</span> quantity<span class="op">&lt;</span>reference, rep<span class="op">&gt;&amp;</span> q<span class="op">)</span></span>
<span id="cb192-14"><a href="#cb192-14" aria-hidden="true" tabindex="-1"></a>  <span class="op">{</span></span>
<span id="cb192-15"><a href="#cb192-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> T<span class="op">(</span>q<span class="op">)</span>;</span>
<span id="cb192-16"><a href="#cb192-16" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb192-17"><a href="#cb192-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>;</span>
<span id="cb192-18"><a href="#cb192-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-19"><a href="#cb192-19" aria-hidden="true" tabindex="-1"></a>quantity_point qp <span class="op">=</span> time_point_cast<span class="op">&lt;</span>std<span class="op">::</span>chrono<span class="op">::</span>seconds<span class="op">&gt;(</span>std<span class="op">::</span>chrono<span class="op">::</span>system_clock<span class="op">::</span>now<span class="op">())</span>;</span>
<span id="cb192-20"><a href="#cb192-20" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>chrono<span class="op">::</span>sys_seconds q <span class="op">=</span> qp <span class="op">+</span> <span class="dv">42</span> <span class="op">*</span> s;</span></code></pre></div>
<h2 data-number="16.4" id="operations-on-units-dimensions-and-quantity-types"><span class="header-section-number">16.4</span> Operations on units,
dimensions, and quantity types<a href="#operations-on-units-dimensions-and-quantity-types" class="self-link"></a></h2>
<p>Modern C++ physical quantities and units library should expose
compile-time constants for units, dimensions, and quantity types. Each
of such constants should be of a different type. Said otherwise, every
unit, dimension, and quantity type has a unique type and a compile-time
instance. This allows us to do regular algebra on such identifiers and
get proper types as results of such operations.</p>
<p>The operations exposed by such a library should include at least:</p>
<ul>
<li>multiplication
(e.g. <code class="sourceCode default">newton * metre</code>),</li>
<li>division
(e.g. <code class="sourceCode default">metre / second</code>),</li>
<li>power
(e.g. <code class="sourceCode default">pow&lt;2&gt;(metre)</code> or
<code class="sourceCode default">pow&lt;1, 2&gt;(metre * metre)</code>).</li>
</ul>
<p>To improve the usability of the library, we also recommend
adding:</p>
<ul>
<li>square root
(e.g. <code class="sourceCode default">sqrt(metre * metre)</code> as
equivalent to
<code class="sourceCode default">pow&lt;1, 2&gt;(metre * metre)</code>),</li>
<li>cubic root
(e.g. <code class="sourceCode default">cbrt(metre * metre * metre)</code>
as equivalent to <code class="sourceCode default">pow&lt;1, 3&gt;(metre * metre * metre)</code>),</li>
<li>inversion
(e.g. <code class="sourceCode default">inverse(second)</code> as
equivalent to
<code class="sourceCode default">one / second</code>).</li>
</ul>
<p>Additionally, for units only, to improve the readability of the code,
it makes sense to expose the following:</p>
<ul>
<li>square power
(e.g. <code class="sourceCode default">square(metre)</code> is
equivalent to
<code class="sourceCode default">pow&lt;2&gt;(metre)</code>),</li>
<li>cubic power
(e.g. <code class="sourceCode default">cubic(metre)</code> is equivalent
to <code class="sourceCode default">pow&lt;3&gt;(metre)</code>).</li>
</ul>
<p>The above two functions could also be considered for dimensions and
quantity types. However,
<code class="sourceCode default">cubic(length)</code> does not seem to
make much sense, and probably
<code class="sourceCode default">pow&lt;3&gt;(length)</code> should be
preferred instead.</p>
<h2 data-number="16.5" id="expression-templates"><span class="header-section-number">16.5</span> Expression templates<a href="#expression-templates" class="self-link"></a></h2>
<p>Modern C++ physical quantities and units libraries use opaque types
to improve the user experience while analyzing compile-time errors or
inspecting types in a debugger. This is a huge usability improvement
over the older libraries that use aliases to refer to long
instantiations of class templates.</p>
<h3 data-number="16.5.1" id="derived-entities"><span class="header-section-number">16.5.1</span> Derived entities<a href="#derived-entities" class="self-link"></a></h3>
<p>Having such strong types for entities is not enough. While doing
arithmetics on them, we get derived entities, and they also should be
easy to understand and correlate with the code written by the user. This
is where expression templates come into play.</p>
<p>The library should use the same unified approach to represent the
results of arithmetics on all kinds of entities. It is worth mentioning
that a generic purpose expression templates library is not a good
solution for a physical quantities and units library.</p>
<p>Let’s assume that we want to represent the results of the following
two unit equations:</p>
<ul>
<li><code class="sourceCode default">metre / second * second</code></li>
<li><code class="sourceCode default">metre * metre / metre</code></li>
</ul>
<p>Both of them should result in a type equivalent to
<code class="sourceCode default">metre</code>. A general-purpose library
will probably result with the types similar to the below:</p>
<ul>
<li><code class="sourceCode default">mul&lt;div&lt;metre, second&gt;, second&gt;</code></li>
<li><code class="sourceCode default">div&lt;mul&lt;metre, metre&gt;, metre&gt;</code></li>
</ul>
<p>Comparing such types for equivalence would not only be very expensive
at compile-time but would also be really confusing to the users
observing them in the compilation logs. This is why we need a dedicated
solution here.</p>
<p>In a physical quantities and units library, we need expression
templates to express the results of</p>
<ul>
<li>dimension equations,</li>
<li>quantity type equations,</li>
<li>unit equations, and</li>
<li>unit magnitude equations.</li>
</ul>
<p>If the above equation results in a derived entity, we must create a
type that clearly describes what we are dealing with. We need to pack a
simplified expression template into some container for that. There are
various possibilities here. The table below presents the types generated
from unit expressions by two leading products on the market in this
subject:</p>
<!-- markdownlint-disable MD013 -->
<table style="width:100%;">
<colgroup>
<col style="width: 9%" />
<col style="width: 42%" />
<col style="width: 47%" />
</colgroup>
<thead>
<tr class="header">
<th><div style="text-align:center">
<strong>Unit</strong>
</div></th>
<th><div style="text-align:center">
<strong><span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span></strong>
</div></th>
<th><div style="text-align:center">
<strong><span class="citation" data-cites="AU">[<a href="#ref-AU" role="doc-biblioref">Au</a>]</span></strong>
</div></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code class="sourceCode default">N⋅m</code></td>
<td><code class="sourceCode default">derived_unit&lt;metre, newton&gt;</code></td>
<td><code class="sourceCode default">UnitProduct&lt;Meters, Newtons&gt;</code></td>
</tr>
<tr class="even">
<td><code class="sourceCode default">1/s</code></td>
<td><code class="sourceCode default">derived_unit&lt;one, per&lt;second&gt;&gt;</code></td>
<td><code class="sourceCode default">Pow&lt;Seconds, -1&gt;</code></td>
</tr>
<tr class="odd">
<td><code class="sourceCode default">km/h</code></td>
<td><code class="sourceCode default">derived_unit&lt;kilo_&lt;metre&gt;, per&lt;hour&gt;&gt;</code></td>
<td><code class="sourceCode default">UnitProduct&lt;Kilo&lt;Meters&gt;, Pow&lt;Hours, -1&gt;&gt;</code></td>
</tr>
<tr class="even">
<td><code class="sourceCode default">kg⋅m²/(s³⋅K)</code></td>
<td><code class="sourceCode default">derived_unit&lt;kilogram, pow&lt;metre, 2&gt;, per&lt;kelvin, power&lt;second, 3&gt;&gt;&gt;</code></td>
<td><code class="sourceCode default">UnitProduct&lt;Pow&lt;Meters, 2&gt;, Kilo&lt;Grams&gt;, Pow&lt;Seconds, -3&gt;, Pow&lt;Kelvins, -1&gt;&gt;</code></td>
</tr>
<tr class="odd">
<td><code class="sourceCode default">m²/m</code></td>
<td><code class="sourceCode default">metre</code></td>
<td><code class="sourceCode default">Meters</code></td>
</tr>
<tr class="even">
<td><code class="sourceCode default">km/m</code></td>
<td><code class="sourceCode default">derived_unit&lt;kilo_&lt;metre&gt;, per&lt;metre&gt;&gt;</code></td>
<td><code class="sourceCode default">UnitProduct&lt;Pow&lt;Meters, -1&gt;, Kilo&lt;Meters&gt;&gt;</code></td>
</tr>
<tr class="odd">
<td><code class="sourceCode default">m/m</code></td>
<td><code class="sourceCode default">one</code></td>
<td><code class="sourceCode default">UnitProduct&lt;&gt;</code></td>
</tr>
</tbody>
</table>
<!-- markdownlint-enable MD013 -->
<p>It is a matter of taste which solution is better. While discussing
the pros and cons here, we should remember that our users often do not
have a scientific background. This is why we recommend to use syntax
that is as similar to the correct English language as possible. It
consistently uses the <code class="sourceCode default">derived_</code>
prefix for types representing derived units, dimensions, and quantity
specifications. Those are instantiated first with the contents of the
numerator followed by the entities of the denominator (if present)
enclosed in the <code class="sourceCode default">per&lt;...&gt;</code>
expression template.</p>
<h3 data-number="16.5.2" id="identities"><span class="header-section-number">16.5.2</span> Identities<a href="#identities" class="self-link"></a></h3>
<p>The arithmetics on units, dimensions, and quantity types require a
special identity value. Such value can be returned as a result of the
division of the same entities, or using it should not modify the
expression template on multiplication.</p>
<p>We chose the following names here:</p>
<ul>
<li><code class="sourceCode default">one</code> in the domain of
units,</li>
<li><code class="sourceCode default">dimension_one</code> in the domain
of dimensions,</li>
<li><code class="sourceCode default">dimensionless</code> in the domain
of quantity types.</li>
</ul>
<p>The above names were selected based on the following quote from <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span>:</p>
<blockquote>
<p>A quantity whose dimensional exponents are all equal to zero has the
dimensional product denoted A<sup>0</sup>B<sup>0</sup>C<sup>0</sup>… =
1, where the symbol 1 denotes the corresponding dimension. There is no
agreement on how to refer to such quantities. They have been called
<strong>dimensionless</strong> quantities (although this term should now
be avoided), quantities with <strong>dimension one</strong>, quantities
with dimension number, or quantities with the <strong>unit one</strong>.
Such quantities are dimensionally simply numbers. To avoid confusion, it
is helpful to use explicit units with these quantities where possible,
e.g., m/m, nmol/mol, rad, as specified in the SI Brochure.</p>
</blockquote>
<h3 data-number="16.5.3" id="supported-operations-and-their-results"><span class="header-section-number">16.5.3</span> Supported operations and
their results<a href="#supported-operations-and-their-results" class="self-link"></a></h3>
<p>The table below presents all the operations that can be done on
units, dimensions, and quantity types in a quantities and units library.
The right column presents corresponding expression templates being their
results:</p>
<table>
<colgroup>
<col style="width: 53%" />
<col style="width: 46%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"><div style="text-align:center">
<strong>Operation</strong>
</div></th>
<th style="text-align: center;"><div style="text-align:center">
<strong>Resulting template expression arguments</strong>
</div></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code class="sourceCode default">A * B</code></td>
<td style="text-align: center;"><code class="sourceCode default">A, B</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code class="sourceCode default">B * A</code></td>
<td style="text-align: center;"><code class="sourceCode default">A, B</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code class="sourceCode default">A * A</code></td>
<td style="text-align: center;"><code class="sourceCode default">power&lt;A, 2&gt;</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code class="sourceCode default">{identity} * A</code></td>
<td style="text-align: center;"><code class="sourceCode default">A</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code class="sourceCode default">A * {identity}</code></td>
<td style="text-align: center;"><code class="sourceCode default">A</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code class="sourceCode default">A / B</code></td>
<td style="text-align: center;"><code class="sourceCode default">A, per&lt;B&gt;</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code class="sourceCode default">A / A</code></td>
<td style="text-align: center;"><code class="sourceCode default">{identity}</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code class="sourceCode default">A / {identity}</code></td>
<td style="text-align: center;"><code class="sourceCode default">A</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code class="sourceCode default">{identity} / A</code></td>
<td style="text-align: center;"><code class="sourceCode default">{identity}, per&lt;A&gt;</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code class="sourceCode default">pow&lt;2&gt;(A)</code></td>
<td style="text-align: center;"><code class="sourceCode default">power&lt;A, 2&gt;</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code class="sourceCode default">pow&lt;2&gt;({identity})</code></td>
<td style="text-align: center;"><code class="sourceCode default">{identity}</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code class="sourceCode default">sqrt(A)</code>
or <code class="sourceCode default">pow&lt;1, 2&gt;(A)</code></td>
<td style="text-align: center;"><code class="sourceCode default">power&lt;A, 1, 2&gt;</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code class="sourceCode default">sqrt({identity})</code>
or
<code class="sourceCode default">pow&lt;1, 2&gt;({identity})</code></td>
<td style="text-align: center;"><code class="sourceCode default">{identity}</code></td>
</tr>
</tbody>
</table>
<h3 data-number="16.5.4" id="simplifying-the-resulting-expression-templates"><span class="header-section-number">16.5.4</span> Simplifying the resulting
expression templates<a href="#simplifying-the-resulting-expression-templates" class="self-link"></a></h3>
<p>To limit the length and improve the readability of generated types,
there are many rules to simplify the resulting expression template.</p>
<ol type="1">
<li><p><strong>Ordering</strong></p>
<p>The resulting comma-separated arguments of multiplication are always
sorted according to a specific predicate. This is why:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>A <span class="op">*</span> B <span class="op">==</span> B <span class="op">*</span> A<span class="op">)</span>;</span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>std<span class="op">::</span>is_same_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>A <span class="op">*</span> B<span class="op">)</span>, <span class="kw">decltype</span><span class="op">(</span>B <span class="op">*</span> A<span class="op">)&gt;)</span>;</span></code></pre></div>
<p>This is probably the most important of all the steps, as it allows
comparing types and enables the rest of the simplification rules.</p>
<p>Units and dimensions have unique symbols, but ordering quantity types
might not be that trivial. Although the ISQ defined in <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span> provides symbols for each
quantity, there is little use for them in the C++ code. This is caused
by the fact that such symbols use a lot of characters that are not
available with the Unicode encoding. Most of the limitations correspond
to Unicode providing only a minimal set of characters available as
subscripts, which are often used to differentiate various quantities of
the same kind. For example, it is impossible to encode the symbols of
the following quantities:</p>
<ul>
<li><em>c</em><sub>sat</sub> - <em>specific heat capacity at saturated
vapour pressure</em>,</li>
<li><em>μ</em><sub>JT</sub> - <em>Joule-Thomson coefficient</em>,</li>
<li><em>w</em><sub>H<sub>2</sub>O</sub> - <em>mass fraction of
water</em>,</li>
<li><em>σ</em><sub>Ω,E</sub> - <em>direction and energy distribution of
cross section</em>,</li>
<li><em>d</em><sub>1/2</sub> - <em>half-value thickness</em>,</li>
<li><em>Φ</em><sub>e,λ</sub> - <em>spectral radiant flux</em>.</li>
</ul>
<p>This is why the library chose to use type name identifiers in such
cases.</p></li>
<li><p><strong>Aggregation</strong></p>
<p>In case two of the same type identifiers are found next to each other
on the argument list, they will be aggregated in one entry:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;"><div style="text-align:center">
<strong>Before</strong>
</div></th>
<th style="text-align: center;"><div style="text-align:center">
<strong>After</strong>
</div></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code class="sourceCode default">A, A</code></td>
<td style="text-align: center;"><code class="sourceCode default">power&lt;A, 2&gt;</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code class="sourceCode default">A, power&lt;A, 2&gt;</code></td>
<td style="text-align: center;"><code class="sourceCode default">power&lt;A, 3&gt;</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code class="sourceCode default">power&lt;A, 1, 2&gt;, power&lt;A, 2&gt;</code></td>
<td style="text-align: center;"><code class="sourceCode default">power&lt;A, 5, 2&gt;</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code class="sourceCode default">power&lt;A, 1, 2&gt;, power&lt;A, 1, 2&gt;</code></td>
<td style="text-align: center;"><code class="sourceCode default">A</code></td>
</tr>
</tbody>
</table></li>
<li><p><strong>Simplification</strong></p>
<p>In case two of the same type identifiers are found in the numerator
and denominator argument lists, they are being simplified into one
entry:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;"><div style="text-align:center">
<strong>Before</strong>
</div></th>
<th style="text-align: center;"><div style="text-align:center">
<strong>After</strong>
</div></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code class="sourceCode default">A, per&lt;A&gt;</code></td>
<td style="text-align: center;"><code class="sourceCode default">{identity}</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code class="sourceCode default">power&lt;A, 2&gt;, per&lt;A&gt;</code></td>
<td style="text-align: center;"><code class="sourceCode default">A</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code class="sourceCode default">power&lt;A, 3&gt;, per&lt;A&gt;</code></td>
<td style="text-align: center;"><code class="sourceCode default">power&lt;A, 2&gt;</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code class="sourceCode default">A, per&lt;power&lt;A, 2&gt;&gt;</code></td>
<td style="text-align: center;"><code class="sourceCode default">{identity}, per&lt;A&gt;</code></td>
</tr>
</tbody>
</table>
<p>It is important to notice here that only the elements with exactly
the same type are being simplified. This means that, for example,
<code class="sourceCode default">m/m</code> results in
<code class="sourceCode default">one</code>, but
<code class="sourceCode default">km/m</code> will not be simplified. The
resulting derived unit will preserve both symbols and their relative
magnitude. This allows us to properly print symbols of some units or
constants that require such behavior. For example, the Hubble constant
is expressed in <code class="sourceCode default">km⋅s⁻¹⋅Mpc⁻¹</code>,
where both <code class="sourceCode default">km</code> and
<code class="sourceCode default">Mpc</code> are units of
<em>length</em>.</p></li>
<li><p><strong>Repacking</strong></p>
<p>In case an expression uses two results of some other operations, the
components of its arguments are repacked into one resulting type and
simplified there.</p>
<p>For example, assuming:</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="kw">constexpr</span> <span class="kw">auto</span> X <span class="op">=</span> A <span class="op">/</span> B;</span></code></pre></div>
<p>then:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;"><div style="text-align:center">
<strong>Operation</strong>
</div></th>
<th style="text-align: center;"><div style="text-align:center">
<strong>Resulting template expression arguments</strong>
</div></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code class="sourceCode default">X * B</code></td>
<td style="text-align: center;"><code class="sourceCode default">A</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code class="sourceCode default">X * A</code></td>
<td style="text-align: center;"><code class="sourceCode default">power&lt;A, 2&gt;, per&lt;B&gt;</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code class="sourceCode default">X * X</code></td>
<td style="text-align: center;"><code class="sourceCode default">power&lt;A, 2&gt;, per&lt;power&lt;B, 2&gt;&gt;</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code class="sourceCode default">X / X</code></td>
<td style="text-align: center;"><code class="sourceCode default">{identity}</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code class="sourceCode default">X / A</code></td>
<td style="text-align: center;"><code class="sourceCode default">{identity}, per&lt;B&gt;</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code class="sourceCode default">X / B</code></td>
<td style="text-align: center;"><code class="sourceCode default">A, per&lt;power&lt;B, 2&gt;&gt;</code></td>
</tr>
</tbody>
</table></li>
</ol>
<p>Please note that for as long as for the ordering step in some cases,
we use user-provided symbols, the aggregation, and the next steps do not
benefit from those. They always use type identifiers to determine
whether the operation should be performed.</p>
<p>Unit symbols are not guaranteed to be unique in the project. For
example, someone may use
<code class="sourceCode default">&quot;s&quot;</code> as a symbol for a
count of samples, which, when used in a unit expression with seconds,
would cause fatal consequences (e.g.,
<code class="sourceCode default">sample * second</code> would yield
<code class="sourceCode default">s²</code>, or
<code class="sourceCode default">sample / second</code> would result in
<code class="sourceCode default">one</code>).</p>
<p>Some units would provide worse text output if the ordering step used
type identifiers rather than unit symbols. For example, <code class="sourceCode default">si::metre * si::second * cgs::second</code>
would result in <code class="sourceCode default">s m s</code>, or
<code class="sourceCode default">newton * metre</code> would result in
<code class="sourceCode default">m N</code>, which is not how we
typically spell this unit. However, for the sake of consistency, we may
also consider changing the algorithm used for ordering to be based on
type identifiers.</p>
<h3 data-number="16.5.5" id="expression-templates-in-action"><span class="header-section-number">16.5.5</span> Expression templates in
action<a href="#expression-templates-in-action" class="self-link"></a></h3>
<p>Thanks to all of the steps described above, a user may write the code
like this one:</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> mp_units<span class="op">::</span>si<span class="op">::</span>unit_symbols;</span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>quantity speed <span class="op">=</span> isq<span class="op">::</span>speed<span class="op">(</span><span class="fl">60.</span> <span class="op">*</span> km <span class="op">/</span> h<span class="op">)</span>;</span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>quantity duration <span class="op">=</span> <span class="dv">8</span> <span class="op">*</span> s;</span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a>quantity acceleration1 <span class="op">=</span> speed <span class="op">/</span> duration;</span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a>quantity acceleration2 <span class="op">=</span> isq<span class="op">::</span>acceleration<span class="op">(</span>acceleration1<span class="op">.</span>in<span class="op">(</span>m <span class="op">/</span> s2<span class="op">))</span>;</span>
<span id="cb195-6"><a href="#cb195-6" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;acceleration: &quot;</span> <span class="op">&lt;&lt;</span> acceleration1 <span class="op">&lt;&lt;</span> <span class="st">&quot; (&quot;</span> <span class="op">&lt;&lt;</span> acceleration2 <span class="op">&lt;&lt;</span> <span class="st">&quot;)</span><span class="sc">\n</span><span class="st">&quot;</span>;</span></code></pre></div>
<p>the text output provides:</p>
<pre class="text"><code>acceleration: 7.5 km h⁻¹ s⁻¹ (2.08333 m/s²)</code></pre>
<p>The above program will produce the following types for
<em>acceleration</em> quantities:</p>
<ul>
<li><p><code class="sourceCode default">acceleration1</code></p>
<pre class="text"><code>quantity&lt;reference&lt;derived_quantity_spec&lt;isq::speed, per&lt;isq::time&gt;&gt;,
                   derived_unit&lt;si::kilo_&lt;si::metre&gt;, per&lt;non_si::hour, si::second&gt;&gt;&gt;{},
         double&gt;</code></pre></li>
<li><p><code class="sourceCode default">acceleration2</code></p>
<pre class="text"><code>quantity&lt;reference&lt;isq::acceleration,
                   derived_unit&lt;si::metre, per&lt;power&lt;si::second, 2&gt;&gt;&gt;&gt;{},
         double&gt;&gt;</code></pre></li>
</ul>
<h2 data-number="16.6" id="physical-constants"><span class="header-section-number">16.6</span> Physical constants<a href="#physical-constants" class="self-link"></a></h2>
<p>In most libraries, physical constants are implemented as constant
(possibly <code class="sourceCode default">constexpr</code>) quantity
values. Such an approach has some disadvantages, often resulting in
longer compilation times and a loss of precision.</p>
<h3 data-number="16.6.1" id="simplifying-constants-in-an-equation"><span class="header-section-number">16.6.1</span> Simplifying constants in an
equation<a href="#simplifying-constants-in-an-equation" class="self-link"></a></h3>
<p>When dealing with equations involving physical constants, they often
occur more than once in an expression. Such a constant may appear both
in a numerator and denominator of a quantity equation. As we know from
fundamental physics, we can simplify such an expression by simply
striking a constant out of the equation. Supporting such behavior allows
a faster runtime performance and often a better precision of the
resulting value.</p>
<h3 data-number="16.6.2" id="physical-constants-as-units"><span class="header-section-number">16.6.2</span> Physical constants as
units<a href="#physical-constants-as-units" class="self-link"></a></h3>
<p>The library allows and encourages implementing physical constants as
regular units. With that, the constant’s value is handled at
compile-time, and under favorable circumstances, it can be simplified in
the same way as all other repeated units do. If it is not simplified,
the value is stored in a type, and the expensive multiplication or
division operations can be delayed in time until a user selects a
specific unit to represent/print the data.</p>
<p>Such a feature often also allows the use of simpler or faster
representation types in the equation. For example, instead of always
multiplying a small integral value with a big floating-point constant
number, we can just use the integral type all the way. Only in case a
constant will not simplify in the equation, and the user will require a
specific unit, such a multiplication will be lazily invoked, and the
representation type will need to be expanded to facilitate that. With
that, addition, subtractions, multiplications, and divisions will always
be the fastest - compiled away or done on the fast arithmetic types or
in out-of-order execution.</p>
<p>To benefit from all of the above, constants (defined by SI or
otherwise) are implemented as units in the following way:</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> si <span class="op">{</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> si2019 <span class="op">{</span></span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> speed_of_light_in_vacuum <span class="op">:</span></span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a>  named_unit<span class="op">&lt;</span><span class="st">&quot;c&quot;</span>, mag<span class="op">&lt;</span><span class="dv">299&#39;792&#39;458</span><span class="op">&gt;</span> <span class="op">*</span> metre <span class="op">/</span> second<span class="op">&gt;</span> <span class="op">{}</span> speed_of_light_in_vacuum;</span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>  <span class="co">// namespace si2019</span></span>
<span id="cb196-9"><a href="#cb196-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-10"><a href="#cb196-10" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> magnetic_constant <span class="op">:</span></span>
<span id="cb196-11"><a href="#cb196-11" aria-hidden="true" tabindex="-1"></a>  named_unit<span class="op">&lt;{</span><span class="st">u8&quot;μ₀&quot;</span>, <span class="st">&quot;u_0&quot;</span><span class="op">}</span>, mag<span class="op">&lt;</span><span class="dv">4</span><span class="op">&gt;</span> <span class="op">*</span> mag_pi <span class="op">*</span> mag_power<span class="op">&lt;</span><span class="dv">10</span>, <span class="op">-</span><span class="dv">7</span><span class="op">&gt;</span> <span class="op">*</span> henry <span class="op">/</span> metre<span class="op">&gt;</span> <span class="op">{}</span> magnetic_constant;</span>
<span id="cb196-12"><a href="#cb196-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-13"><a href="#cb196-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>  <span class="co">// namespace si</span></span></code></pre></div>
<h3 data-number="16.6.3" id="physical-constants-usage-examples"><span class="header-section-number">16.6.3</span> Physical constants usage
examples<a href="#physical-constants-usage-examples" class="self-link"></a></h3>
<p>With the above definitions, we can calculate vacuum permittivity
as:</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="kw">constexpr</span> <span class="kw">auto</span> permeability_of_vacuum <span class="op">=</span> <span class="fl">1.</span> <span class="op">*</span> si<span class="op">::</span>magnetic_constant;</span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a><span class="kw">constexpr</span> <span class="kw">auto</span> speed_of_light_in_vacuum <span class="op">=</span> <span class="dv">1</span> <span class="op">*</span> si<span class="op">::</span>si2019<span class="op">::</span>speed_of_light_in_vacuum;</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>permittivity_of_vacuum<span class="op">&gt;</span> <span class="kw">auto</span> q <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> <span class="op">(</span>permeability_of_vacuum <span class="op">*</span> pow<span class="op">&lt;</span><span class="dv">2</span><span class="op">&gt;(</span>speed_of_light_in_vacuum<span class="op">))</span>;</span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;permittivity of vacuum = &quot;</span> <span class="op">&lt;&lt;</span> q <span class="op">&lt;&lt;</span> <span class="st">&quot; = &quot;</span> <span class="op">&lt;&lt;</span> q<span class="op">.</span>in<span class="op">(</span>F <span class="op">/</span> m<span class="op">)</span> <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>;</span></code></pre></div>
<p>The above first prints the following:</p>
<pre class="text"><code>permittivity of vacuum = 1  μ₀⁻¹ c⁻² = 8.85419e-12 F/m</code></pre>
<p>As we can clearly see, all the calculations above were just about
multiplying and dividing the number
<code class="sourceCode default">1</code> with the rest of the
information provided as a compile-time type. Only when a user wants a
specific SI unit as a result, the unit ratios are lazily resolved.</p>
<p>Another similar example can be an equation for total energy:</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>mechanical_energy<span class="op">&gt;</span> <span class="kw">auto</span> total_energy<span class="op">(</span>QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>momentum<span class="op">&gt;</span> <span class="kw">auto</span> p,</span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>                                                     QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>mass<span class="op">&gt;</span> <span class="kw">auto</span> m,</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>                                                     QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>speed<span class="op">&gt;</span> <span class="kw">auto</span> c<span class="op">)</span></span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> isq<span class="op">::</span>mechanical_energy<span class="op">(</span>sqrt<span class="op">(</span>pow<span class="op">&lt;</span><span class="dv">2</span><span class="op">&gt;(</span>p <span class="op">*</span> c<span class="op">)</span> <span class="op">+</span> pow<span class="op">&lt;</span><span class="dv">2</span><span class="op">&gt;(</span>m <span class="op">*</span> pow<span class="op">&lt;</span><span class="dv">2</span><span class="op">&gt;(</span>c<span class="op">))))</span>;</span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<!-- TODO refactor to the vector representation type when the design is done -->
<div class="sourceCode" id="cb199"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="kw">constexpr</span> Unit <span class="kw">auto</span> GeV <span class="op">=</span> si<span class="op">::</span>giga<span class="op">&lt;</span>si<span class="op">::</span>electronvolt<span class="op">&gt;</span>;</span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="kw">constexpr</span> quantity c <span class="op">=</span> <span class="fl">1.</span> <span class="op">*</span> si<span class="op">::</span>si2019<span class="op">::</span>speed_of_light_in_vacuum;</span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a><span class="kw">constexpr</span> quantity c2 <span class="op">=</span> pow<span class="op">&lt;</span><span class="dv">2</span><span class="op">&gt;(</span>c<span class="op">)</span>;</span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> quantity p1 <span class="op">=</span> isq<span class="op">::</span>momentum<span class="op">(</span><span class="fl">4.</span> <span class="op">*</span> GeV <span class="op">/</span> c<span class="op">)</span>;</span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>mass<span class="op">&gt;</span> <span class="kw">auto</span> m1 <span class="op">=</span> <span class="fl">3.</span> <span class="op">*</span> GeV <span class="op">/</span> c2;</span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> quantity E <span class="op">=</span> total_energy<span class="op">(</span>p1, m1, c<span class="op">)</span>;</span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-9"><a href="#cb199-9" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;in `GeV` and `c`:</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb199-10"><a href="#cb199-10" aria-hidden="true" tabindex="-1"></a>          <span class="op">&lt;&lt;</span> <span class="st">&quot;p = &quot;</span> <span class="op">&lt;&lt;</span> p1 <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb199-11"><a href="#cb199-11" aria-hidden="true" tabindex="-1"></a>          <span class="op">&lt;&lt;</span> <span class="st">&quot;m = &quot;</span> <span class="op">&lt;&lt;</span> m1 <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb199-12"><a href="#cb199-12" aria-hidden="true" tabindex="-1"></a>          <span class="op">&lt;&lt;</span> <span class="st">&quot;E = &quot;</span> <span class="op">&lt;&lt;</span> E <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>;</span>
<span id="cb199-13"><a href="#cb199-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-14"><a href="#cb199-14" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> quantity p2 <span class="op">=</span> p1<span class="op">.</span>in<span class="op">(</span>GeV <span class="op">/</span> <span class="op">(</span>m <span class="op">/</span> s<span class="op">))</span>;</span>
<span id="cb199-15"><a href="#cb199-15" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> quantity m2 <span class="op">=</span> m1<span class="op">.</span>in<span class="op">(</span>GeV <span class="op">/</span> pow<span class="op">&lt;</span><span class="dv">2</span><span class="op">&gt;(</span>m <span class="op">/</span> s<span class="op">))</span>;</span>
<span id="cb199-16"><a href="#cb199-16" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> quantity E2 <span class="op">=</span> total_energy<span class="op">(</span>p2, m2, c<span class="op">).</span>in<span class="op">(</span>GeV<span class="op">)</span>;</span>
<span id="cb199-17"><a href="#cb199-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-18"><a href="#cb199-18" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">in `GeV`:</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb199-19"><a href="#cb199-19" aria-hidden="true" tabindex="-1"></a>          <span class="op">&lt;&lt;</span> <span class="st">&quot;p = &quot;</span> <span class="op">&lt;&lt;</span> p2 <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb199-20"><a href="#cb199-20" aria-hidden="true" tabindex="-1"></a>          <span class="op">&lt;&lt;</span> <span class="st">&quot;m = &quot;</span> <span class="op">&lt;&lt;</span> m2 <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb199-21"><a href="#cb199-21" aria-hidden="true" tabindex="-1"></a>          <span class="op">&lt;&lt;</span> <span class="st">&quot;E = &quot;</span> <span class="op">&lt;&lt;</span> E2 <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>;</span>
<span id="cb199-22"><a href="#cb199-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-23"><a href="#cb199-23" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> quantity p3 <span class="op">=</span> p1<span class="op">.</span>in<span class="op">(</span>kg <span class="op">*</span> m <span class="op">/</span> s<span class="op">)</span>;</span>
<span id="cb199-24"><a href="#cb199-24" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> quantity m3 <span class="op">=</span> m1<span class="op">.</span>in<span class="op">(</span>kg<span class="op">)</span>;</span>
<span id="cb199-25"><a href="#cb199-25" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> quantity E3 <span class="op">=</span> total_energy<span class="op">(</span>p3, m3, c<span class="op">).</span>in<span class="op">(</span>J<span class="op">)</span>;</span>
<span id="cb199-26"><a href="#cb199-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-27"><a href="#cb199-27" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">in SI base units:</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb199-28"><a href="#cb199-28" aria-hidden="true" tabindex="-1"></a>          <span class="op">&lt;&lt;</span> <span class="st">&quot;p = &quot;</span> <span class="op">&lt;&lt;</span> p3 <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb199-29"><a href="#cb199-29" aria-hidden="true" tabindex="-1"></a>          <span class="op">&lt;&lt;</span> <span class="st">&quot;m = &quot;</span> <span class="op">&lt;&lt;</span> m3 <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb199-30"><a href="#cb199-30" aria-hidden="true" tabindex="-1"></a>          <span class="op">&lt;&lt;</span> <span class="st">&quot;E = &quot;</span> <span class="op">&lt;&lt;</span> E3 <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>;</span></code></pre></div>
<p>The above prints the following:</p>
<pre class="text"><code>in `GeV` and `c`:
p = 4 GeV/c
m = 3 GeV/c²
E = 5 GeV

in `GeV`:
p = 1.33426e-08 GeV s/m
m = 3.33795e-17 GeV s²/m²
E = 5 GeV

in SI base units:
p = 2.13771e-18 kg m/s
m = 5.34799e-27 kg
E = 8.01088e-10 J</code></pre>
<h2 data-number="16.7" id="quantity-references"><span class="header-section-number">16.7</span> Quantity references<a href="#quantity-references" class="self-link"></a></h2>
<p><em>Note: We know that probably the term “reference” will not survive
too long in the Committee, but we couldn’t find a better name for it in
the <span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span> library
(<a href="https://github.com/mpusz/mp-units/issues/486" class="uri">https://github.com/mpusz/mp-units/issues/486</a>).</em></p>
<p><span class="citation" data-cites="ISO-GUIDE">[<a href="#ref-ISO-GUIDE" role="doc-biblioref">ISO/IEC Guide 99</a>]</span>
says:</p>
<blockquote>
<p><strong>quantity</strong> - property of a phenomenon, body, or
substance, where the property has a magnitude that can be expressed as a
number and a reference. … A reference can be a measurement unit, a
measurement procedure, a reference material, or a combination of
such.</p>
</blockquote>
<p>In the library a quantity reference represents all the
domain-specific meta-data about the quantity besides its representation
type and its value. A <a href="#Reference-concept"><code class="sourceCode default">Reference</code></a>
concept is satisfied by either of:</p>
<ul>
<li>an associated unit (e.g.,
<code class="sourceCode default">si::metre</code>),</li>
<li>an instantiation of the <code class="sourceCode default">reference&lt;QuantitySpec, Unit&gt;</code>
class template explicitly specifying the quantity type and its
unit.</li>
</ul>
<p>A reference type is implicitly created as a result of the following
expression:</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="kw">constexpr</span> Reference <span class="kw">auto</span> distance <span class="op">=</span> isq<span class="op">::</span>distance<span class="op">[</span>m<span class="op">]</span>;</span></code></pre></div>
<p>The above example defines a variable of type <code class="sourceCode default">reference&lt;isq::distance, si::metre&gt;</code>.</p>
<p>The <code class="sourceCode default">reference</code> class template
also exposes an arithmetic interface similar to the one that we have
already discussed in case of units and quantity types. It simply
forwards the operation to its quantity type and unit members.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="kw">constexpr</span> ReferenceOf<span class="op">&lt;</span>isq<span class="op">::</span>speed<span class="op">&gt;</span> <span class="kw">auto</span> speed <span class="op">=</span> distance <span class="op">/</span> si<span class="op">::</span>second;</span></code></pre></div>
<p>As a result we get a <code class="sourceCode default">reference&lt;derived_quantity_spec&lt;distance, per&lt;time&gt;&gt;, derived_unit&lt;metre, per&lt;second&gt;&gt;&gt;</code>
type.</p>
<p>Similarly to the <a href="#AssociatedUnit-concept"><code class="sourceCode default">AssociatedUnit</code></a>,
such a reference can be used to construct a quantity:</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>speed<span class="op">&gt;</span> <span class="kw">auto</span> s <span class="op">=</span> <span class="dv">60</span> <span class="op">*</span> speed;</span></code></pre></div>
<h2 data-number="16.8" id="quantities"><span class="header-section-number">16.8</span> Quantities<a href="#quantities" class="self-link"></a></h2>
<p>The <code class="sourceCode default">quantity</code> class template
is a workhorse of the library. It can be considered a generalization of
<code class="sourceCode default">std::chrono::duration</code>, but is
not directly compatible with it.</p>
<p>Based on the ISO definition provided in the <a href="#quantity-references">Quantity references</a> chapter, the
<code class="sourceCode default">quantity</code> class template has the
following signature:</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span>Reference <span class="kw">auto</span> R, RepresentationOf<span class="op">&lt;</span>get_quantity_spec<span class="op">(</span>R<span class="op">).</span>character<span class="op">&gt;</span> Rep <span class="op">=</span> <span class="dt">double</span><span class="op">&gt;</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> quantity;</span></code></pre></div>
<p>It stores only one data member of
<code class="sourceCode default">Rep</code> type. Unfortunately, this
data member has to be publicly exposed to satisfy the C++ language
requirements for <a href="https://eel.is/c++draft/temp.param#def:type,structural">structural
types</a>. Hopefully, the language rules for structural types will
improve with time before this library gets standardized.</p>
<h3 data-number="16.8.1" id="why-dont-we-use-udls-to-create-quantities"><span class="header-section-number">16.8.1</span> Why don’t we use UDLs to
create quantities?<a href="#why-dont-we-use-udls-to-create-quantities" class="self-link"></a></h3>
<p><a href="#constructing-a-quantity">Constructing a quantity</a>
chapter describes and explains why we introduced the multiply syntax as
a construction helper for quantities. Many people ask why we chose this
approach over battle-proven User Defined Literals (UDLs) that work well
for the <code class="sourceCode default">std::chrono</code> library.</p>
<p>It turns out that many reasons make UDLs a poor choice for a physical
units library:</p>
<ol type="1">
<li><p>UDLs work only with literals (compile-time known values). Our
observation is that besides the unit tests, only a few compile-time
known quantity values are used in the production code. Please note that
for <a href="#physical-constants">Physical constants</a>, we recommend
using units rather than compile-time constants.</p></li>
<li><p>Typical implementations of UDLs tend to always use the widest
representation type available. In the case of
<code class="sourceCode default">std::chrono::duration</code>, the
following is true:</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">::</span>chrono_literals;</span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> d1 <span class="op">=</span> <span class="dv">42</span><span class="bu">s</span>;</span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> d2 <span class="op">=</span> <span class="fl">42.</span><span class="bu">s</span>;</span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>std<span class="op">::</span>is_same_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>d1<span class="op">)::</span>rep, std<span class="op">::</span><span class="dt">int64_t</span><span class="op">&gt;)</span>;</span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>std<span class="op">::</span>is_same_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>d2<span class="op">)::</span>rep, <span class="dt">long</span> <span class="dt">double</span><span class="op">&gt;)</span>;</span></code></pre></div>
<p>When such UDL is intermixed in arithmetics with any quantity type of
a shorter representation type, it will always expand it to the longest
one. In other words, such long type spreads until all types use it
everywhere.</p></li>
<li><p>While increasing the coverage for the <span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span> library, we learned that many
unit symbols conflict with built-in types or numeric extensions. A few
of those are: <code class="sourceCode default">F</code> (farad),
<code class="sourceCode default">J</code> (joule),
<code class="sourceCode default">W</code> (watt),
<code class="sourceCode default">K</code> (kelvin),
<code class="sourceCode default">d</code> (day),
<code class="sourceCode default">l</code> or
<code class="sourceCode default">L</code> (litre),
<code class="sourceCode default">erg</code>,
<code class="sourceCode default">ergps</code>. Using the
<code class="sourceCode default">_</code> prefix would make it work for
<span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span>, but if the library is
standardized, those naming collisions would be a big issue. This is why
we came up with the <code class="sourceCode default">_q_</code> prefix
that would become <code class="sourceCode default">q_</code> after
standardization (e.g., <code class="sourceCode default">42q_s</code>),
which is not that nice anymore.</p></li>
<li><p>UDLs with the same identifiers defined in different namespace
can’t be disambiguated in the C++ language. If both SI and CGS systems
define <code class="sourceCode default">q_s</code> UDL for a second
unit, then it would not be possible to specify which one to use in case
both namespaces are “imported” with using directives.</p></li>
<li><p>Another bad property of UDLs is that they do not compose. A
coherent unit of angular momentum would have a UDL specified as
<code class="sourceCode default">q_kg_m2_per_s</code>. Now imagine that
we want to make every possible user happy. How many variations of that
unit would we predefine for differently scaled versions of all unit
ingredients?</p></li>
<li><p>UDLs are also really expensive to define and specify. Typically,
for each unit, we need two definitions. One for integral and another one
for floating-point representation. In version 0.8.0 of the <span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span> library, the coherent unit of
angular momentum was defined as:</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="kw">constexpr</span> <span class="kw">auto</span> <span class="kw">operator</span><span class="st">&quot;&quot;</span> _q_kg_m2_per_s<span class="op">(</span><span class="dt">unsigned</span> <span class="dt">long</span> <span class="dt">long</span> l<span class="op">)</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>  gsl_ExpectsAudit<span class="op">(</span>std<span class="op">::</span>in_range<span class="op">&lt;</span>std<span class="op">::</span><span class="dt">int64_t</span><span class="op">&gt;(</span>l<span class="op">))</span>;</span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> angular_momentum<span class="op">&lt;</span>kilogram_metre_sq_per_second, std<span class="op">::</span><span class="dt">int64_t</span><span class="op">&gt;(</span><span class="kw">static_cast</span><span class="op">&lt;</span>std<span class="op">::</span><span class="dt">int64_t</span><span class="op">&gt;(</span>l<span class="op">))</span>;</span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true" tabindex="-1"></a><span class="kw">constexpr</span> <span class="kw">auto</span> <span class="kw">operator</span><span class="st">&quot;&quot;</span> _q_kg_m2_per_s<span class="op">(</span><span class="dt">long</span> <span class="dt">double</span> l<span class="op">)</span></span>
<span id="cb205-8"><a href="#cb205-8" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb205-9"><a href="#cb205-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> angular_momentum<span class="op">&lt;</span>kilogram_metre_sq_per_second, <span class="dt">long</span> <span class="dt">double</span><span class="op">&gt;(</span>l<span class="op">)</span>;</span>
<span id="cb205-10"><a href="#cb205-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div></li>
</ol>
<p>The multiply syntax that we chose for this library does not have any
of those issues.</p>
<h3 data-number="16.8.2" id="quantity-arithmetics"><span class="header-section-number">16.8.2</span> Quantity arithmetics<a href="#quantity-arithmetics" class="self-link"></a></h3>
<h4 data-number="16.8.2.1" id="quantity-is-a-numeric-wrapper"><span class="header-section-number">16.8.2.1</span>
<code class="sourceCode default">quantity</code> is a numeric wrapper<a href="#quantity-is-a-numeric-wrapper" class="self-link"></a></h4>
<p>If we think about it, the
<code class="sourceCode default">quantity</code> class template is just
a “smart” numeric wrapper. It exposes properly constrained set of
arithmetic operations on one or two operands.</p>
<p>Every single arithmetic operator is exposed by the
<code class="sourceCode default">quantity</code> class template only if
the underlying representation type provides it as well and its
implementation has proper semantics (e.g., returns a reasonable
type).</p>
<p>For example, in the following code,
<code class="sourceCode default">-a</code> will compile only if
<code class="sourceCode default">MyInt</code> exposes such an operation
as well:</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>quantity a <span class="op">=</span> MyInt<span class="op">{</span><span class="dv">42</span><span class="op">}</span> <span class="op">*</span> m;</span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>quantity b <span class="op">=</span> <span class="op">-</span>a;</span></code></pre></div>
<p>Assuming that:</p>
<ul>
<li><code class="sourceCode default">q</code> is our quantity,</li>
<li><code class="sourceCode default">qq</code> is a quantity implicitly
convertible to <code class="sourceCode default">q</code>,</li>
<li><code class="sourceCode default">q2</code> is any other
quantity,</li>
<li><code class="sourceCode default">kind</code> is a quantity of the
same kind as <code class="sourceCode default">q</code>,</li>
<li><code class="sourceCode default">one</code> is a quantity of
<code class="sourceCode default">dimension_one</code> with the unit
<code class="sourceCode default">one</code>,</li>
<li><code class="sourceCode default">number</code> is a value of a type
“compatible” with <code class="sourceCode default">q</code>’s
representation type,</li>
</ul>
<p>here is the list of all the supported operators:</p>
<ul>
<li>unary:
<ul>
<li><code class="sourceCode default">+q</code></li>
<li><code class="sourceCode default">-q</code></li>
<li><code class="sourceCode default">++q</code></li>
<li><code class="sourceCode default">q++</code></li>
<li><code class="sourceCode default">--q</code></li>
<li><code class="sourceCode default">q--</code></li>
</ul></li>
<li>compound assignment:
<ul>
<li><code class="sourceCode default">q += qq</code></li>
<li><code class="sourceCode default">q -= qq</code></li>
<li><code class="sourceCode default">q %= qq</code></li>
<li><code class="sourceCode default">q *= number</code></li>
<li><code class="sourceCode default">q *= one</code></li>
<li><code class="sourceCode default">q /= number</code></li>
<li><code class="sourceCode default">q /= one</code></li>
</ul></li>
<li>binary:
<ul>
<li><code class="sourceCode default">q + kind</code></li>
<li><code class="sourceCode default">q - kind</code></li>
<li><code class="sourceCode default">q % kind</code></li>
<li><code class="sourceCode default">q * q2</code></li>
<li><code class="sourceCode default">q * number</code></li>
<li><code class="sourceCode default">number * q</code></li>
<li><code class="sourceCode default">q / q2</code></li>
<li><code class="sourceCode default">q / number</code></li>
<li><code class="sourceCode default">number / q</code></li>
</ul></li>
<li>ordering and comparison:
<ul>
<li><code class="sourceCode default">q == kind</code></li>
<li><code class="sourceCode default">q &lt;=&gt; kind</code></li>
</ul></li>
</ul>
<p>As we can see, there are plenty of operations one can do on a value
of a <code class="sourceCode default">quantity</code> type. As most of
them are obvious, in the following chapters, we will discuss only the
most important or non-trivial aspects of quantity arithmetics.</p>
<h4 data-number="16.8.2.2" id="addition-and-subtraction"><span class="header-section-number">16.8.2.2</span> Addition and subtraction<a href="#addition-and-subtraction" class="self-link"></a></h4>
<p>Quantities can easily be added or subtracted from each other:</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span><span class="dv">1</span> <span class="op">*</span> m <span class="op">+</span> <span class="dv">1</span> <span class="op">*</span> m <span class="op">==</span> <span class="dv">2</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span><span class="dv">2</span> <span class="op">*</span> m <span class="op">-</span> <span class="dv">1</span> <span class="op">*</span> m <span class="op">==</span> <span class="dv">1</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>isq<span class="op">::</span>height<span class="op">(</span><span class="dv">1</span> <span class="op">*</span> m<span class="op">)</span> <span class="op">+</span> isq<span class="op">::</span>height<span class="op">(</span><span class="dv">1</span> <span class="op">*</span> m<span class="op">)</span> <span class="op">==</span> isq<span class="op">::</span>height<span class="op">(</span><span class="dv">2</span> <span class="op">*</span> m<span class="op">))</span>;</span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>isq<span class="op">::</span>height<span class="op">(</span><span class="dv">2</span> <span class="op">*</span> m<span class="op">)</span> <span class="op">-</span> isq<span class="op">::</span>height<span class="op">(</span><span class="dv">1</span> <span class="op">*</span> m<span class="op">)</span> <span class="op">==</span> isq<span class="op">::</span>height<span class="op">(</span><span class="dv">1</span> <span class="op">*</span> m<span class="op">))</span>;</span></code></pre></div>
<p>The above uses the same types for LHS, RHS, and the result, but in
general, we can add, subtract, or compare the values of any quantity
type as long as both quantities are of the same kind. The result of
addition and subtraction will be the common type of the arguments:</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span><span class="dv">1</span> <span class="op">*</span> km <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> m <span class="op">==</span> <span class="fl">1001.5</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>isq<span class="op">::</span>height<span class="op">(</span><span class="dv">1</span> <span class="op">*</span> m<span class="op">)</span> <span class="op">+</span> isq<span class="op">::</span>width<span class="op">(</span><span class="dv">1</span> <span class="op">*</span> m<span class="op">)</span> <span class="op">==</span> isq<span class="op">::</span>length<span class="op">(</span><span class="dv">2</span> <span class="op">*</span> m<span class="op">))</span>;</span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>isq<span class="op">::</span>height<span class="op">(</span><span class="dv">2</span> <span class="op">*</span> m<span class="op">)</span> <span class="op">-</span> isq<span class="op">::</span>distance<span class="op">(</span><span class="fl">0.5</span> <span class="op">*</span> m<span class="op">)</span> <span class="op">==</span> <span class="fl">1.5</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>isq<span class="op">::</span>radius<span class="op">(</span><span class="dv">1</span> <span class="op">*</span> m<span class="op">)</span> <span class="op">-</span> <span class="fl">0.5</span> <span class="op">*</span> m <span class="op">==</span> isq<span class="op">::</span>radius<span class="op">(</span><span class="fl">0.5</span> <span class="op">*</span> m<span class="op">))</span>;</span></code></pre></div>
<p>Please note that for the compound assignment operators, both
arguments have to either be of the same type or the RHS has to be
implicitly convertible to the LHS, as the type of LHS is always the
result of such an operation:</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">((</span><span class="dv">1</span> <span class="op">*</span> m <span class="op">+=</span> <span class="dv">1</span> <span class="op">*</span> km<span class="op">)</span> <span class="op">==</span> <span class="dv">1001</span> <span class="op">*</span> m<span class="op">)</span>;</span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">((</span>isq<span class="op">::</span>height<span class="op">(</span><span class="fl">1.5</span> <span class="op">*</span> m<span class="op">)</span> <span class="op">-=</span> <span class="dv">1</span> <span class="op">*</span> m<span class="op">)</span> <span class="op">==</span> isq<span class="op">::</span>height<span class="op">(</span><span class="fl">0.5</span> <span class="op">*</span> m<span class="op">))</span>;</span></code></pre></div>
<p>If we break those rules, the code will not compile:</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">((</span><span class="dv">1</span> <span class="op">*</span> m <span class="op">-=</span> <span class="fl">0.5</span> <span class="op">*</span> m<span class="op">)</span> <span class="op">==</span> <span class="fl">0.5</span> <span class="op">*</span> m<span class="op">)</span>;                       <span class="co">// Compile-time error (1)</span></span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">((</span><span class="dv">1</span> <span class="op">*</span> km <span class="op">+=</span> <span class="dv">1</span> <span class="op">*</span> m<span class="op">)</span> <span class="op">==</span> <span class="dv">1001</span> <span class="op">*</span> m<span class="op">)</span>;                       <span class="co">// Compile-time error (2)</span></span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">((</span>isq<span class="op">::</span>height<span class="op">(</span><span class="dv">1</span> <span class="op">*</span> m<span class="op">)</span> <span class="op">+=</span> isq<span class="op">::</span>length<span class="op">(</span><span class="dv">1</span> <span class="op">*</span> m<span class="op">))</span> <span class="op">==</span> <span class="dv">2</span> <span class="op">*</span> m<span class="op">)</span>; <span class="co">// Compile-time error (3)</span></span></code></pre></div>
<p><code class="sourceCode default">(1)</code> Floating-point to
integral representation type is considered narrowing.</p>
<p><code class="sourceCode default">(2)</code> Conversion of quantity
with integral representation type from a unit of a higher resolution to
the one with a lower resolution is considered narrowing.</p>
<p><code class="sourceCode default">(3)</code> Conversion from a more
generic quantity type to a more specific one is considered unsafe.</p>
<h4 data-number="16.8.2.3" id="multiplication-and-division"><span class="header-section-number">16.8.2.3</span> Multiplication and
division<a href="#multiplication-and-division" class="self-link"></a></h4>
<p>Multiplying or dividing a quantity by a number does not change its
quantity type or unit. However, its representation type may change. For
example:</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>isq<span class="op">::</span>height<span class="op">(</span><span class="dv">3</span> <span class="op">*</span> m<span class="op">)</span> <span class="op">*</span> <span class="fl">0.5</span> <span class="op">==</span> isq<span class="op">::</span>height<span class="op">(</span><span class="fl">1.5</span> <span class="op">*</span> m<span class="op">))</span>;</span></code></pre></div>
<p>Unless we use a compound assignment operator, in which case
truncating operations are again not allowed:</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">((</span>isq<span class="op">::</span>height<span class="op">(</span><span class="dv">3</span> <span class="op">*</span> m<span class="op">)</span> <span class="op">*=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">==</span> isq<span class="op">::</span>height<span class="op">(</span><span class="fl">1.5</span> <span class="op">*</span> m<span class="op">))</span>; <span class="co">// Compile-time error (1)</span></span></code></pre></div>
<p><code class="sourceCode default">(1)</code> Floating-point to
integral representation type is considered narrowing.</p>
<p>However, suppose we multiply or divide quantities of the same or
different types, or we divide a raw number by a quantity. In that case,
we most probably will end up in a quantity of yet another type:</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span><span class="dv">120</span> <span class="op">*</span> km <span class="op">/</span> <span class="op">(</span><span class="dv">2</span> <span class="op">*</span> h<span class="op">)</span> <span class="op">==</span> <span class="dv">60</span> <span class="op">*</span> km <span class="op">/</span> h<span class="op">)</span>;</span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>isq<span class="op">::</span>width<span class="op">(</span><span class="dv">2</span> <span class="op">*</span> m<span class="op">)</span> <span class="op">*</span> isq<span class="op">::</span>length<span class="op">(</span><span class="dv">2</span> <span class="op">*</span> m<span class="op">)</span> <span class="op">==</span> isq<span class="op">::</span>area<span class="op">(</span><span class="dv">4</span> <span class="op">*</span> m2<span class="op">))</span>;</span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span><span class="dv">50</span> <span class="op">/</span> isq<span class="op">::</span>time<span class="op">(</span><span class="dv">1</span> <span class="op">*</span> s<span class="op">)</span> <span class="op">==</span> isq<span class="op">::</span>frequency<span class="op">(</span><span class="dv">50</span> <span class="op">*</span> Hz<span class="op">))</span>;</span></code></pre></div>
<p>An exception from the above rule happens when one of the arguments is
a dimensionless quantity. If we multiply or divide by such a quantity,
the quantity type will not change. If such a quantity has a unit
<code class="sourceCode default">one</code>, also the unit of a quantity
will not change:</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span><span class="dv">120</span> <span class="op">*</span> m <span class="op">/</span> <span class="op">(</span><span class="dv">2</span> <span class="op">*</span> one<span class="op">)</span> <span class="op">==</span> <span class="dv">60</span> <span class="op">*</span> m<span class="op">)</span>;</span></code></pre></div>
<p>An interesting special case happens when we divide the same quantity
kinds or multiply a quantity by its inverted type. In such a case, we
end up with a dimensionless quantity.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>isq<span class="op">::</span>height<span class="op">(</span><span class="dv">4</span> <span class="op">*</span> m<span class="op">)</span> <span class="op">/</span> isq<span class="op">::</span>width<span class="op">(</span><span class="dv">2</span> <span class="op">*</span> m<span class="op">)</span> <span class="op">==</span> <span class="dv">2</span> <span class="op">*</span> one<span class="op">)</span>; <span class="co">// (1)</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span><span class="dv">5</span> <span class="op">*</span> h <span class="op">/</span> <span class="op">(</span><span class="dv">120</span> <span class="op">*</span> min<span class="op">)</span> <span class="op">==</span> <span class="dv">0</span> <span class="op">*</span> one<span class="op">)</span>;                    <span class="co">// (2)</span></span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span><span class="fl">5.</span> <span class="op">*</span> h <span class="op">/</span> <span class="op">(</span><span class="dv">120</span> <span class="op">*</span> min<span class="op">)</span> <span class="op">==</span> <span class="fl">2.5</span> <span class="op">*</span> one<span class="op">)</span>;</span></code></pre></div>
<p><code class="sourceCode default">(1)</code> The resulting quantity
type of the LHS is
<code class="sourceCode default">isq::height / isq::width</code>, which
is a quantity of the dimensionless kind.</p>
<p><code class="sourceCode default">(2)</code> The resulting quantity of
the LHS is
<code class="sourceCode default">0 * dimensionless[h / min]</code>. To
be consistent with the division of different quantity types, we do not
convert quantity values to a common unit before the division.</p>
<h5 data-number="16.8.2.3.1" id="beware-of-integral-division"><span class="header-section-number">16.8.2.3.1</span> Beware of integral
division<a href="#beware-of-integral-division" class="self-link"></a></h5>
<p>The physical units library can’t do any runtime branching logic for
the division operator. All logic has to be done at compile-time when the
actual values are not known, and the quantity types can’t change at
runtime.</p>
<p>If we expect
<code class="sourceCode default">120 * km / (2 * h)</code> to return
<code class="sourceCode default">60 km/h</code>, we have to agree with
the fact that <code class="sourceCode default">5 * km / (24 * h)</code>
returns <code class="sourceCode default">0 km/h</code>. We can’t do a
range check at runtime to dynamically adjust scales and types based on
the values of provided function arguments.</p>
<p>This is why we often prefer floating-point representation types when
dealing with units. Some popular physical units libraries even <a href="https://aurora-opensource.github.io/au/main/troubleshooting/#integer-division-forbidden">forbid
integer division at all</a>.</p>
<h4 data-number="16.8.2.4" id="modulo"><span class="header-section-number">16.8.2.4</span> Modulo<a href="#modulo" class="self-link"></a></h4>
<p>Now that we know how addition, subtraction, multiplication, and
division work, it is time to talk about modulo. What would we expect to
be returned from the following quantity equation?</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> q <span class="op">=</span> <span class="dv">5</span> <span class="op">*</span> h <span class="op">%</span> <span class="op">(</span><span class="dv">120</span> <span class="op">*</span> min<span class="op">)</span>;</span></code></pre></div>
<p>Most of us would probably expect to see
<code class="sourceCode default">1 h</code> or
<code class="sourceCode default">60 min</code> as a result. And this is
where the problems start.</p>
<p>The C++ language defines its
<code class="sourceCode default">/</code> and
<code class="sourceCode default">%</code> operators with the <a href="https://eel.is/c++draft/expr.mul#4">quotient-remainder
theorem</a>:</p>
<pre class="text"><code>q = a / b;
r = a % b;
q * b + r == a;</code></pre>
<p>The important property of the modulo operator is that it only works
for integral representation types (it is undefined what modulo for
floating-point types means). However, as we saw in the previous chapter,
integral types are tricky because they often truncate the value.</p>
<p>From the quotient-remainder theorem, the result of modulo operation
is <code class="sourceCode default">r = a - q * b</code>. Let’s see what
we get from such a quantity equation on integral representation
types:</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>quantity a <span class="op">=</span> <span class="dv">5</span> <span class="op">*</span> h;</span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>quantity b <span class="op">=</span> <span class="dv">120</span> <span class="op">*</span> min;</span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a>quantity q <span class="op">=</span> a <span class="op">/</span> b;</span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a>quantity r <span class="op">=</span> a <span class="op">-</span> q <span class="op">*</span> b;</span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-6"><a href="#cb217-6" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;reminder: &quot;</span> <span class="op">&lt;&lt;</span> r <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>;</span></code></pre></div>
<p>The above code outputs:</p>
<pre class="text"><code>reminder: 5 h</code></pre>
<p>And now, a tough question needs an answer. Do we really want modulo
operator on physical units to be consistent with the quotient-remainder
theorem and return <code class="sourceCode default">5 h</code> for
<code class="sourceCode default">5 * h % (120 * min)</code>?</p>
<p>This is exactly why we decided not to follow this hugely surprising
path in this library. The selected approach was also consistent with the
feedback from C++ experts. For example, this is what Richard Smith said
about this issue:</p>
<blockquote>
<p>I think the quotient-remainder property is a less important
motivation here than other factors – the constraints on
<code class="sourceCode default">%</code> and
<code class="sourceCode default">/</code> are quite different, so they
lack the inherent connection they have for integers. In particular, I
would expect that <code class="sourceCode default">A / B</code> works
for all quantities <code class="sourceCode default">A</code> and
<code class="sourceCode default">B</code>, whereas
<code class="sourceCode default">A % B</code> is only meaningful when
<code class="sourceCode default">A</code> and
<code class="sourceCode default">B</code> have the same dimension. It
seems like a nice-to-have for the property to apply in the case where
both <code class="sourceCode default">/</code> and
<code class="sourceCode default">%</code> are defined, but internal
consistency of <code class="sourceCode default">/</code> across all
cases seems much more important to me.</p>
<p>I would expect <code class="sourceCode default">61 min % 1 h</code>
to be <code class="sourceCode default">1 min</code>, and
<code class="sourceCode default">1 h % 59 min</code> to also be
<code class="sourceCode default">1 min</code>, so my intuition tells me
that the result type of <code class="sourceCode default">A % B</code>,
where <code class="sourceCode default">A</code> and
<code class="sourceCode default">B</code> have the same dimension,
should have the smaller unit of
<code class="sourceCode default">A</code> and
<code class="sourceCode default">B</code> (and if the smaller one
doesn’t divide the larger one, we should either use the
<code class="sourceCode default">gcd / std::common_type</code> of the
units of <code class="sourceCode default">A</code> and
<code class="sourceCode default">B</code> or perhaps just produce an
error). I think any other behavior for
<code class="sourceCode default">%</code> is hard to defend.</p>
<p>On the other hand, for division it seems to me that the choice of
unit should probably not affect the result, and so if we want that
<code class="sourceCode default">5 mm / 120 min = 0 mm/min</code>, then
<code class="sourceCode default">5 h / 120 min == 0 hc</code> (where
<code class="sourceCode default">hc</code> is a dimensionless
“hexaconta”, or <code class="sourceCode default">60x</code>, unit). I
don’t like the idea of taking SI base units into account; that seems
arbitrary and like it would do the wrong thing as often as it does the
right thing, especially when the units have a multiplier that is very
large or small. We could special-case the situation of a dimensionless
quantity, but that could lead to problematic overflow pretty easily: a
calculation such as
<code class="sourceCode default">10 s * 5 GHz * 2 uW</code> would
overflow an <code class="sourceCode default">int</code> if it produces a
dimensionless quantity for
<code class="sourceCode default">10 s * 5 GHz</code>, but it could
equally produce
<code class="sourceCode default">50 G * 2 uW = 100 kW</code> without any
overflow, and presumably would if the terms were merely reordered.</p>
<p>If people want to use integer-valued quantities, I think it’s
fundamental that you need to know what the units of the result of an
operation will be, and take that into account in how you express
computations; the simplest rule for heterogeneous operators like
<code class="sourceCode default">*</code> or
<code class="sourceCode default">/</code> seems to be that the units of
the result are determined by applying the operator to the units of the
operands – and for homogeneous operators like
<code class="sourceCode default">+</code> or
<code class="sourceCode default">%</code>, it seems like the only
reasonable option is that you get the
<code class="sourceCode default">std::common_type</code> of the units of
the operands.</p>
</blockquote>
<p>To summarize, the modulo operator on physical units has more in
common with addition and division operators than with the
quotient-remainder theorem. To avoid surprising results, the operation
uses a common unit to do the calculation and provide its result:</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span><span class="dv">5</span> <span class="op">*</span> h <span class="op">/</span> <span class="op">(</span><span class="dv">120</span> <span class="op">*</span> min<span class="op">)</span> <span class="op">==</span> <span class="dv">0</span> <span class="op">*</span> one<span class="op">)</span>;</span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span><span class="dv">5</span> <span class="op">*</span> h <span class="op">%</span> <span class="op">(</span><span class="dv">120</span> <span class="op">*</span> min<span class="op">)</span> <span class="op">==</span> <span class="dv">60</span> <span class="op">*</span> min<span class="op">)</span>;</span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span><span class="dv">61</span> <span class="op">*</span> min <span class="op">%</span> <span class="op">(</span><span class="dv">1</span> <span class="op">*</span> h<span class="op">)</span> <span class="op">==</span> <span class="dv">1</span> <span class="op">*</span> min<span class="op">)</span>;</span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span><span class="dv">1</span> <span class="op">*</span> h <span class="op">%</span> <span class="op">(</span><span class="dv">59</span> <span class="op">*</span> min<span class="op">)</span> <span class="op">==</span> <span class="dv">1</span> <span class="op">*</span> min<span class="op">)</span>;</span></code></pre></div>
<h4 data-number="16.8.2.5" id="comparison-against-zero"><span class="header-section-number">16.8.2.5</span> Comparison against zero<a href="#comparison-against-zero" class="self-link"></a></h4>
<p>Zero is special. It is the only number that unambiguously defines the
value of any kind of quantity, regardless of its units: zero inches and
zero meters and zero miles are all identical. For this reason, it’s very
common to compare the value of a quantity against zero. For example,
when checking the sign of a quantity, or when making sure that it’s
nonzero.</p>
<p>We could implement such checks in the following way:</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span><span class="op">(</span>q1 <span class="op">/</span> q2 <span class="op">!=</span> <span class="dv">0</span> <span class="op">*</span> m <span class="op">/</span> s<span class="op">)</span></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ...</span></span></code></pre></div>
<p>The above would work (assuming we are dealing with the quantity of
<em>speed</em>), but it’s not ideal. If the result of
<code class="sourceCode default">q1 / q2</code> is not expressed in
<code class="sourceCode default">m / s</code>, we’ll incur an extra unit
conversion. Even if it is in
<code class="sourceCode default">m / s</code>, it’s cumbersome to repeat
the unit in a context where it makes no difference.</p>
<p>We could avoid repeating the unit, and guarantee there won’t be an
extra conversion, by writing:</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span><span class="op">(</span><span class="kw">auto</span> q <span class="op">=</span> q1 <span class="op">/</span> q2; q <span class="op">!=</span> q<span class="op">.</span>zero<span class="op">())</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ...</span></span></code></pre></div>
<p>But that is a bit inconvenient, and inexperienced users could be
unaware of this technique and its rationale.</p>
<h5 data-number="16.8.2.5.1" id="named-comparison-functions"><span class="header-section-number">16.8.2.5.1</span> Named comparison
functions<a href="#named-comparison-functions" class="self-link"></a></h5>
<p>For the above reasons, the <span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span> library provides dedicated
interfaces to compare against zero that follow the naming convention of
<a href="https://en.cppreference.com/w/cpp/utility/compare/named_comparison_functions">named
comparison functions</a> in the C++ Standard Library:</p>
<ul>
<li><code class="sourceCode default">is_eq_zero</code></li>
<li><code class="sourceCode default">is_neq_zero</code></li>
<li><code class="sourceCode default">is_lt_zero</code></li>
<li><code class="sourceCode default">is_gt_zero</code></li>
<li><code class="sourceCode default">is_lteq_zero</code></li>
<li><code class="sourceCode default">is_gteq_zero</code></li>
</ul>
<p>Thanks to them, to save typing and not pay for unneeded conversions,
our check could be implemented as follows:</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span>is_neq_zero<span class="op">(</span>q1 <span class="op">/</span> q2<span class="op">))</span></span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ...</span></span></code></pre></div>
<p>Those functions will work with any type
<code class="sourceCode default">T</code> that exposes a
<code class="sourceCode default">zero()</code> member function returning
something comparable to <code class="sourceCode default">T</code>.
Thanks to that, we can use them not only with quantities but also with
<code class="sourceCode default">std::chrono::duration</code> or any
other type that exposes such an interface.</p>
<p>This approach has a downside, though: it produces a set of new APIs
which users must learn. Nor are these six the only such functions that
will need to exist: for example,
<code class="sourceCode default">max</code> and
<code class="sourceCode default">min</code> are perfectly reasonable to
use with <code class="sourceCode default">0</code> regardless of the
units, but supporting them under this strategy would require adding a
new utility function for each — and coming up with a name for those
functions.</p>
<p>It also introduces small opportunities for error and diffs that are
harder to review, because we’re replacing a pattern that uses an
operator (say, <code class="sourceCode default">a &gt; 0</code>) with a
named function call (say,
<code class="sourceCode default">is_gt_zero(a)</code>).</p>
<p>These pitfalls motivate us to consider other approaches as well.</p>
<h5 data-number="16.8.2.5.2" id="zero-type"><span class="header-section-number">16.8.2.5.2</span>
<code class="sourceCode default">Zero</code> type<a href="#zero-type" class="self-link"></a></h5>
<p>The <span class="citation" data-cites="AU">[<a href="#ref-AU" role="doc-biblioref">Au</a>]</span> library takes a different approach
to this problem. It provides an empty type,
<code class="sourceCode default">Zero</code>, which represents a value
of exactly <code class="sourceCode default">0</code> (in any units). It
also provides an instance <code class="sourceCode default">ZERO</code>
of this type. Every quantity is implicitly constructible from
<code class="sourceCode default">Zero</code>.</p>
<p>Consider this example legacy (i.e., pre-units-library) code:</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span>speed_squared_m2ps2 <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> <span class="co">/* ... */</span> <span class="op">}</span></span></code></pre></div>
<p>When users upgrade to a units library, they will replace the raw
number <code class="sourceCode default">speed_squared_m2ps2</code> with
a strongly typed quantity
<code class="sourceCode default">speed_squared</code>. Unfortunately,
this replacement won’t compile, because quantities can’t be constructed
from raw numeric values such as
<code class="sourceCode default">0</code>. They can fix this problem by
using the instance, <code class="sourceCode default">ZERO</code>, which
encodes its value in the type:</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span>speed_squared <span class="op">&gt;</span> ZERO<span class="op">)</span> <span class="op">{</span> <span class="co">/* ... */</span> <span class="op">}</span></span></code></pre></div>
<p>This has significant advantages. It preserves the form of the code,
making the transition less error prone than replacement with a function
such as <code class="sourceCode default">is_gt_zero</code>. It also
reduces the number of new comparison APIs a user must learn:
<code class="sourceCode default">Zero</code> handles them all.</p>
<p><code class="sourceCode default">Zero</code> has one downside: it
will not work when passed across generic quantity interfaces.
<code class="sourceCode default">Zero</code>’s value comes in situations
where the surrounding context makes it unambiguous which quantity type
it should construct. While it converts to any specific quantity type, it
is not itself a quantity. This could confuse users.</p>
<p>This downside manifests in several different ways. Here are some
examples:</p>
<ol type="1">
<li><p>While refactoring the <span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span> code to try out this approach,
we found out a perfectly reasonable place where we could not replace the
numerical value <code class="sourceCode default">0</code> with
<code class="sourceCode default">ZERO</code>:</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>msl_altitude alt <span class="op">=</span> mean_sea_level <span class="op">+</span> <span class="dv">0</span> <span class="op">*</span> si<span class="op">::</span>metre;  <span class="co">// OK</span></span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>msl_altitude alt <span class="op">=</span> mean_sea_level <span class="op">+</span> ZERO;           <span class="co">// Compile-time error</span></span></code></pre></div>
<p>This would not work because the
<code class="sourceCode default">mean_sea_level</code> is an absolute
point origin that stores the information about the quantity type but not
its value or unit, which
<code class="sourceCode default">msl_altitude</code> needs, but none of
which <code class="sourceCode default">ZERO</code> has.</p></li>
<li><p>Callsites passing <code class="sourceCode default">ZERO</code>
can add friction when refactoring a concrete interface to be more
generic.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> v1 <span class="op">{</span> <span class="dt">void</span> foo<span class="op">(</span>quantity<span class="op">&lt;</span>si<span class="op">::</span>metre<span class="op">&gt;</span> q<span class="op">)</span>; <span class="op">}</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> v2 <span class="op">{</span> <span class="dt">void</span> foo<span class="op">(</span>QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>length<span class="op">&gt;</span> <span class="kw">auto</span> q<span class="op">)</span>; <span class="op">}</span></span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a>v1<span class="op">::</span>foo<span class="op">(</span>ZERO<span class="op">)</span>;   <span class="co">// OK</span></span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a>v2<span class="op">::</span>foo<span class="op">(</span>ZERO<span class="op">)</span>;   <span class="co">// Compile-time error</span></span></code></pre></div>
<p>In practice, this issue will be discovered at the point of
refactoring, so it mainly affects library authors, not their clients.
They can handle this by adding an overload for
<code class="sourceCode default">Zero</code>, if appropriate. However,
this wouldn’t scale well for APIs with multiple parameters where users
would want to pass
<code class="sourceCode default">Zero</code>.</p></li>
<li><p>For completeness, we mention that
<code class="sourceCode default">Zero</code> works for addition but not
multiplication. When multiplying, we do not know what units (or even
what dimension!) is desired for the result. However, this is not a
problem in practice because users would not be motivated to write this
in the first place, as simple multiplication with
<code class="sourceCode default">0</code> (including any necessary
units, if the result has a different dimension) would work.</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>quantity q1 <span class="op">=</span> <span class="dv">1</span> <span class="op">*</span> m <span class="op">/</span> s;</span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>quantity q2 <span class="op">=</span> q1 <span class="op">+</span> <span class="dv">0</span> <span class="op">*</span> m <span class="op">/</span> s;   <span class="co">// OK</span></span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a>quantity q3 <span class="op">=</span> q1 <span class="op">*</span> <span class="op">(</span><span class="dv">0</span> <span class="op">*</span> s<span class="op">)</span>;     <span class="co">// OK</span></span></code></pre></div>
<div class="sourceCode" id="cb227"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a>quantity q1 <span class="op">=</span> <span class="dv">1</span> <span class="op">*</span> m <span class="op">/</span> s;</span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a>quantity q2 <span class="op">=</span> q1 <span class="op">+</span> ZERO;        <span class="co">// OK</span></span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a>quantity q3 <span class="op">=</span> q1 <span class="op">*</span> ZERO;        <span class="co">// Compile-time error</span></span></code></pre></div></li>
</ol>
<p>The main concern with the
<code class="sourceCode default">Zero</code> feature is that novices
might be tempted to replace every numeric value
<code class="sourceCode default">0</code> with the instance
<code class="sourceCode default">ZERO</code>, becoming confused when it
doesn’t work. We could address this with easy-to-read documentation that
clarifies its use cases and mental models.</p>
<h5 data-number="16.8.2.5.3" id="summary-comparison-against-zero"><span class="header-section-number">16.8.2.5.3</span> Summary (comparison
against zero)<a href="#summary-comparison-against-zero" class="self-link"></a></h5>
<p>Overall, these two approaches — special functions, and a
<code class="sourceCode default">Zero</code> type — represent two local
optima in design space. Each has its strengths and weaknesses; each
makes different tradeoffs. It’s currently an open question as to which
approach would be best suited for a quantity type in the standard
library.</p>
<h4 data-number="16.8.2.6" id="other-maths"><span class="header-section-number">16.8.2.6</span> Other maths<a href="#other-maths" class="self-link"></a></h4>
<p>This chapter scoped only on the
<code class="sourceCode default">quantity</code> type’s operators.
However, there are many named math functions provided in the <span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span> library. Among others, we can
find there the following:</p>
<ul>
<li><code class="sourceCode default">pow()</code>,
<code class="sourceCode default">sqrt()</code>, and
<code class="sourceCode default">cbrt()</code>,</li>
<li><code class="sourceCode default">exp()</code>,</li>
<li><code class="sourceCode default">abs()</code>,</li>
<li><code class="sourceCode default">epsilon()</code>,</li>
<li><code class="sourceCode default">fma()</code>,
<code class="sourceCode default">fmod()</code>,</li>
<li><code class="sourceCode default">floor()</code>,
<code class="sourceCode default">ceil()</code>,
<code class="sourceCode default">round()</code>,</li>
<li><code class="sourceCode default">inverse()</code>,</li>
<li><code class="sourceCode default">hypot()</code>,</li>
<li><code class="sourceCode default">sin()</code>,
<code class="sourceCode default">cos()</code>,
<code class="sourceCode default">tan()</code>,</li>
<li><code class="sourceCode default">asin()</code>,
<code class="sourceCode default">acos()</code>,
<code class="sourceCode default">atan()</code>,
<code class="sourceCode default">atan2()</code>.</li>
</ul>
<p>In the library, we can also find the
<code class="sourceCode default">&lt;mp-units/random.h&gt;</code> header
file with all the pseudo-random number generators.</p>
<p>We plan to provide a separate paper on those in the future.</p>
<h3 data-number="16.8.3" id="dimensionless-quantities"><span class="header-section-number">16.8.3</span> Dimensionless quantities<a href="#dimensionless-quantities" class="self-link"></a></h3>
<p>The quantities we discussed so far always had some specific type and
physical dimension. However, this is not always the case. While
performing various computations, we sometimes end up with so-called
“dimensionless” quantities, which <span class="citation" data-cites="ISO-GUIDE">[<a href="#ref-ISO-GUIDE" role="doc-biblioref">ISO/IEC Guide 99</a>]</span> correctly defines as
quantities of dimension one:</p>
<blockquote>
<ul>
<li>Quantity for which all the exponents of the factors corresponding to
the base quantities in its quantity dimension are zero.</li>
<li>The measurement units and values of quantities of dimension one are
numbers, but such quantities convey more information than a number.</li>
<li>Some quantities of dimension one are defined as the ratios of two
quantities of the same kind.</li>
<li>Numbers of entities are quantities of dimension one.</li>
</ul>
</blockquote>
<h4 data-number="16.8.3.1" id="dividing-two-quantities-of-the-same-kind"><span class="header-section-number">16.8.3.1</span> Dividing two quantities of
the same kind<a href="#dividing-two-quantities-of-the-same-kind" class="self-link"></a></h4>
<p>Dividing two quantities of the same kind always results in a quantity
of dimension one. However, depending on what type of quantities we
divide or what their units are, we may end up with slightly different
types.</p>
<p>Dividing two quantities of the same dimension always results in a
quantity with the dimension being
<code class="sourceCode default">dimension_one</code>. This is often
different for other physical units libraries, which may return a raw
representation type for such cases. A raw value is also always returned
from the division of two
<code class="sourceCode default">std::chrono::duration</code>
values.</p>
<p>In the initial design of the <span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span> library, the resulting type of
division of two quantities was their common representation type (just
like <code class="sourceCode default">std::chrono::duration</code>):</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>std<span class="op">::</span>is_same_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span><span class="dv">10</span> <span class="op">*</span> km <span class="op">/</span> <span class="op">(</span><span class="dv">5</span> <span class="op">*</span> km<span class="op">))</span>, <span class="dt">int</span><span class="op">&gt;)</span>;</span></code></pre></div>
<p>The reasoning behind it was not providing a false impression of a
strong <code class="sourceCode default">quantity</code> type for
something that looks and feels like a regular number. Also, all of the
mathematic and trigonometric functions were working fine out of the box
with such representation types, so we did not have to rewrite
<code class="sourceCode default">sin()</code>,
<code class="sourceCode default">cos()</code>,
<code class="sourceCode default">exp()</code>, and others.</p>
<p>However, the feedback we got from the production usage was that such
an approach is really bad for generic programming. It is hard to handle
the result of the two quantities’ division (or multiplication) as it
might be either a quantity or a fundamental type. If we want to raise
such a result to some power, we must use
<code class="sourceCode default">units::pow</code> or
<code class="sourceCode default">std::pow</code> depending on the
resulting type (<code class="sourceCode default">units::pow</code> takes
the power as template arguments). Those are only a few issues related to
such an approach.</p>
<p>Moreover, suppose we divide quantities of the same dimension, but
with units of significantly different magnitudes. In such case, we may
end up with a really small or a huge floating-point value, which may
result in losing lots of precision. Returning a dimensionless quantity
from such cases allows us to benefit from all the properties of scaled
units and is consistent with the rest of the library.</p>
<h5 data-number="16.8.3.1.1" id="dividing-quantities-of-the-same-type"><span class="header-section-number">16.8.3.1.1</span> Dividing quantities of
the same type<a href="#dividing-quantities-of-the-same-type" class="self-link"></a></h5>
<p>First, let’s analyze what happens if we divide two quantities of the
same type:</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="kw">constexpr</span> QuantityOf<span class="op">&lt;</span>dimensionless<span class="op">&gt;</span> <span class="kw">auto</span> q <span class="op">=</span> isq<span class="op">::</span>height<span class="op">(</span><span class="dv">200</span> <span class="op">*</span> m<span class="op">)</span> <span class="op">/</span> isq<span class="op">::</span>height<span class="op">(</span><span class="dv">50</span> <span class="op">*</span> m<span class="op">)</span>;</span></code></pre></div>
<p>In such a case, we end up with a dimensionless quantity that has the
following properties:</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>q<span class="op">.</span>quantity_spec <span class="op">==</span> dimensionless<span class="op">)</span>;</span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>q<span class="op">.</span>dimension <span class="op">==</span> dimension_one<span class="op">)</span>;</span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>q<span class="op">.</span>unit <span class="op">==</span> one<span class="op">)</span>;</span></code></pre></div>
<p>In case we would like to print its value, we would see a raw value of
<code class="sourceCode default">4</code> in the output with no unit
being printed.</p>
<h5 data-number="16.8.3.1.2" id="dividing-quantities-of-different-types"><span class="header-section-number">16.8.3.1.2</span> Dividing quantities of
different types<a href="#dividing-quantities-of-different-types" class="self-link"></a></h5>
<p>We can divide quantities of the same dimension and unit but of
different quantity types:</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="kw">constexpr</span> QuantityOf<span class="op">&lt;</span>dimensionless<span class="op">&gt;</span> <span class="kw">auto</span> q <span class="op">=</span> isq<span class="op">::</span>work<span class="op">(</span><span class="dv">200</span> <span class="op">*</span> J<span class="op">)</span> <span class="op">/</span> isq<span class="op">::</span>heat<span class="op">(</span><span class="dv">50</span> <span class="op">*</span> J<span class="op">)</span>;</span></code></pre></div>
<p>Again we end up with
<code class="sourceCode default">dimension_one</code> and
<code class="sourceCode default">one</code>, but this time:</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>q<span class="op">.</span>quantity_spec <span class="op">==</span> isq<span class="op">::</span>work <span class="op">/</span> isq<span class="op">::</span>heat<span class="op">)</span>;</span></code></pre></div>
<p>As shown above, the result is not of a
<code class="sourceCode default">dimensionless</code> type anymore.
Instead, we get a quantity type derived from the performed quantity
equation. According to the <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span>, <em>work</em> divided by
<em>heat</em> is the recipe for the <em>thermodynamic efficiency</em>
quantity, thus:</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>implicitly_convertible<span class="op">(</span>q<span class="op">.</span>quantity_spec, isq<span class="op">::</span>efficiency_thermodynamics<span class="op">))</span>;</span></code></pre></div>
<p>Please note that the quantity of
<code class="sourceCode default">isq::efficiency_thermodynamics</code>
is of a kind <code class="sourceCode default">dimensionless</code>, so
it is implicitly convertible to
<code class="sourceCode default">dimensionless</code> and satisfies the
<a href="#QuantityOf-concept"><code class="sourceCode default">QuantityOf&lt;dimensionless&gt;</code></a>
concept.</p>
<h5 data-number="16.8.3.1.3" id="dividing-quantities-of-different-units"><span class="header-section-number">16.8.3.1.3</span> Dividing quantities of
different units<a href="#dividing-quantities-of-different-units" class="self-link"></a></h5>
<p>Now, let’s see what happens when we divide two quantities of the same
type but different units:</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="kw">constexpr</span> QuantityOf<span class="op">&lt;</span>dimensionless<span class="op">&gt;</span> <span class="kw">auto</span> q <span class="op">=</span> isq<span class="op">::</span>height<span class="op">(</span><span class="dv">4</span> <span class="op">*</span> km<span class="op">)</span> <span class="op">/</span> isq<span class="op">::</span>height<span class="op">(</span><span class="dv">2</span> <span class="op">*</span> m<span class="op">)</span>;</span></code></pre></div>
<p>This time we get a quantity of
<code class="sourceCode default">dimensionless</code> type with a
<code class="sourceCode default">dimension_one</code> as its dimension.
However, the resulting unit is not
<code class="sourceCode default">one</code> anymore:</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>q<span class="op">.</span>unit <span class="op">==</span> mag_power<span class="op">&lt;</span><span class="dv">10</span>, <span class="dv">3</span><span class="op">&gt;</span> <span class="op">*</span> one<span class="op">)</span>;</span></code></pre></div>
<p>In case we would print the text output of this quantity, we would not
see a raw value of <code class="sourceCode default">2000</code>, but
<code class="sourceCode default">2 km/m</code>.</p>
<p>First, it may look surprising, but this is actually consistent with
the division of quantities of different dimensions. For example, if we
divide <code class="sourceCode default">4 * km / (2 * s)</code>, we do
not expect <code class="sourceCode default">km</code> to be “expanded”
to <code class="sourceCode default">m</code> before the division, right?
We would expect the result of
<code class="sourceCode default">2 * (km / s)</code>, which is exactly
what we get when we divide quantities of the same kind.</p>
<p>This is a compelling feature that allows us to express huge or tiny
ratios without the need for big and expensive representation types. With
this, we can easily define things like a <a href="https://en.wikipedia.org/wiki/Hubble%27s_law#Dimensionless_Hubble_constant">Hubble’s
constant</a> that uses a unit that is proportional to the ratio of
kilometers per megaparsecs, which are both units of length:</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> hubble_constant <span class="op">:</span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>    named_unit<span class="op">&lt;{</span><span class="st">u8&quot;H₀&quot;</span>, <span class="st">&quot;H_0&quot;</span><span class="op">}</span>, mag<span class="op">&lt;</span>ratio<span class="op">{</span><span class="dv">701</span>, <span class="dv">10</span><span class="op">}&gt;</span> <span class="op">*</span> si<span class="op">::</span>kilo<span class="op">&lt;</span>si<span class="op">::</span>metre<span class="op">&gt;</span> <span class="op">/</span> si<span class="op">::</span>second <span class="op">/</span> si<span class="op">::</span>mega<span class="op">&lt;</span>parsec<span class="op">&gt;&gt;</span> <span class="op">{</span></span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> hubble_constant;</span></code></pre></div>
<h4 data-number="16.8.3.2" id="counts-of-things"><span class="header-section-number">16.8.3.2</span> Counts of things<a href="#counts-of-things" class="self-link"></a></h4>
<p>Another important use case for dimensionless quantities is to provide
strong types for counts of things. For example:</p>
<ul>
<li><span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span>
(part 3) provides a <em>rotation</em> quantity defined as the number of
revolutions,</li>
<li><span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span>
(part 6) provides a <em>number of turns in a winding</em> quantity,</li>
<li><span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span>
(part 13) provides a <em>Hamming distance</em> quantity defined as the
number of digit positions in which the corresponding digits of two words
of the same length are different.</li>
</ul>
<p>Thanks to assigning strong names to such quantities, they can be used
in the quantity equation of other quantities. For example,
<em>rotational frequency</em> is defined by
<code class="sourceCode default">rotation / duration</code>.</p>
<h4 data-number="16.8.3.3" id="lack-of-convertibility-from-fundamental-types"><span class="header-section-number">16.8.3.3</span> Lack of convertibility
from fundamental types<a href="#lack-of-convertibility-from-fundamental-types" class="self-link"></a></h4>
<p>As stated before, the division of two quantities of the same kind
results in a quantity of dimension one. Even though it does not have a
specific physical dimension it still uses units with various ratios such
as <code class="sourceCode default">one</code>,
<code class="sourceCode default">percent</code>,
<code class="sourceCode default">radian</code>,
<code class="sourceCode default">degree</code>, etc. It is essential to
be explicit about which unit we want to use for such a quantity.</p>
<p>However, in some cases, this might look like an overkill. In the <a href="#basic-quantity-equations">Basic quantity equations</a> chapter
one of the lines looks as follows:</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span><span class="dv">10</span> <span class="op">*</span> km <span class="op">/</span> <span class="op">(</span><span class="dv">5</span> <span class="op">*</span> km<span class="op">)</span> <span class="op">==</span> <span class="dv">2</span> <span class="op">*</span> one<span class="op">)</span>;</span></code></pre></div>
<p>Another example could be subtracting a value
<code class="sourceCode default">1</code> from the dimensionless
quantity that we can find in <a href="#storage-tank">Storage tank</a>
example:</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>time<span class="op">&gt;</span> <span class="kw">auto</span> fill_time_left <span class="op">=</span> <span class="op">(</span>height <span class="op">/</span> fill_level <span class="op">-</span> <span class="dv">1</span> <span class="op">*</span> one<span class="op">)</span> <span class="op">*</span> fill_time;</span></code></pre></div>
<p>Some physical quantities and units libraries (e.g. <span class="citation" data-cites="BOOST-UNITS">[<a href="#ref-BOOST-UNITS" role="doc-biblioref">Boost.Units</a>]</span>) provide <a href="https://www.boost.org/doc/libs/1_83_0/doc/html/boost_units/Quantities.html#boost_units.Quantities.Quantity_Construction_and_Conversion">implicit
conversions from the values of representation types to such
quantities</a>.</p>
<p>With such support, the above examples would look in the following
way:</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span><span class="dv">10</span> <span class="op">*</span> km <span class="op">/</span> <span class="op">(</span><span class="dv">5</span> <span class="op">*</span> km<span class="op">)</span> <span class="op">==</span> <span class="dv">2</span><span class="op">)</span>;</span></code></pre></div>
<div class="sourceCode" id="cb240"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> QuantityOf<span class="op">&lt;</span>isq<span class="op">::</span>time<span class="op">&gt;</span> <span class="kw">auto</span> fill_time_left <span class="op">=</span> <span class="op">(</span>height <span class="op">/</span> fill_level <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">*</span> fill_time;</span></code></pre></div>
<p>Such simplification might look tempting, and the <span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span> initially provided a special
support that allowed the above to compile. However, in the V2 version of
the library, it was removed. There are a few reasons for that:</p>
<ul>
<li><p>Such support has sense only for quantities of dimension one with
a unit <code class="sourceCode default">one</code>. In the case of all
the other units, the specific unit should still be provided.</p></li>
<li><p>If we provide implicit conversions from the representation type
to a quantity of dimension one with a unit
<code class="sourceCode default">one</code> and we start depending on
such a feature, we might end up with compile-time errors after
refactoring the unit in a type of such a quantity. For example:</p></li>
</ul>
<table>
<thead>
<tr class="header">
<th><div style="text-align:center">
<strong>Before</strong>
</div></th>
<th><div style="text-align:center">
<strong>After</strong>
</div></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><div>

<div class="sourceCode" id="cb241"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> my_data <span class="op">{</span></span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a>  quantity<span class="op">&lt;</span>dimensionless<span class="op">[</span>one<span class="op">]&gt;</span> value;</span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>;</span>
<span id="cb241-4"><a href="#cb241-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-5"><a href="#cb241-5" aria-hidden="true" tabindex="-1"></a>my_data data1<span class="op">{.</span>value <span class="op">=</span> <span class="dv">42</span><span class="op">}</span>;</span>
<span id="cb241-6"><a href="#cb241-6" aria-hidden="true" tabindex="-1"></a>my_data data2<span class="op">{.</span>value <span class="op">=</span> <span class="dv">42</span> <span class="op">*</span> one<span class="op">}</span>;</span></code></pre></div>

</div></td>
<td><div>

<div class="sourceCode" id="cb242"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> my_data <span class="op">{</span></span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a>  quantity<span class="op">&lt;</span>dimensionless<span class="op">[</span>percent<span class="op">]&gt;</span> value;</span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>;</span>
<span id="cb242-4"><a href="#cb242-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-5"><a href="#cb242-5" aria-hidden="true" tabindex="-1"></a>my_data data1<span class="op">{.</span>value <span class="op">=</span> <span class="dv">42</span><span class="op">}</span>;        <span class="co">// Compile-time error</span></span>
<span id="cb242-6"><a href="#cb242-6" aria-hidden="true" tabindex="-1"></a>my_data data2<span class="op">{.</span>value <span class="op">=</span> <span class="dv">42</span> <span class="op">*</span> one<span class="op">}</span>;  <span class="co">// OK</span></span></code></pre></div>

</div></td>
</tr>
</tbody>
</table>
<ul>
<li>Such support is purely additive (it can be added later) and requires
a bunch of additional overloads not only for a constructor but for
arithmetic operators and comparisons as well.</li>
</ul>
<p>Please also note that we will still need to use explicit units to
create a quantity for some cases. For example, in the following code,
<code class="sourceCode default">asin(-1)</code> would use the overload
from the <code class="sourceCode default">&lt;math&gt;</code> header of
the C++ standard library rather than the one for quantities provided in
<code class="sourceCode default">&lt;mp-units/math.h&gt;</code> header
file:</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a>REQUIRE_THAT<span class="op">(</span>asin<span class="op">(-</span><span class="dv">1</span> <span class="op">*</span> one<span class="op">)</span>, AlmostEquals<span class="op">(-</span><span class="fl">90.</span> <span class="op">*</span> deg<span class="op">))</span>;</span></code></pre></div>
<p>The authors of this paper are not opposed to providing support for
conversions from the raw value to the dimensionless quantity of a unit
<code class="sourceCode default">one</code>. If WG21 groups decide that
is a good direction, we will provide additional interfaces to the
library to support such a scenario. If we choose to go this path, two
questions should be answered first:</p>
<ol type="1">
<li><p>Should such a conversion be explicit or implicit?</p>
<p>We may be tempted to stay on the safe side and choose explicit
conversions here. However, this would make the following expression
illegal or at least awkward:</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span><span class="dv">10</span> <span class="op">*</span> km <span class="op">/</span> <span class="op">(</span><span class="dv">5</span> <span class="op">*</span> km<span class="op">)</span> <span class="op">+</span> <span class="dv">1</span> <span class="op">==</span> <span class="dv">3</span><span class="op">)</span>;</span></code></pre></div>
<p>It would be strange to support arithmetics against the raw value if
the quantity type can’t be implicitly constructed from it.</p></li>
<li><p>Should we support converting from the dimensionless quantity with
unit <code class="sourceCode default">one</code> to the raw value? And
if yes, should it be implicit or explicit?</p>
<p>It could probably be better to allow implicit conversions to work
with legacy interfaces or to benefit from regular math-related functions
that work on fundamental types. Otherwise, we will need to type
something like this in our code:</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> res <span class="op">=</span> sin<span class="op">(</span><span class="kw">static_cast</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span>q<span class="op">))</span>;</span></code></pre></div>
<p>which really is not a great improvement over:</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> res <span class="op">=</span> sin<span class="op">(</span>q<span class="op">.</span>numerical_value_in<span class="op">(</span>one<span class="op">))</span>;</span></code></pre></div></li>
</ol>
<h4 data-number="16.8.3.4" id="predefined-units-of-the-dimensionless-quantity"><span class="header-section-number">16.8.3.4</span> Predefined units of the
dimensionless quantity<a href="#predefined-units-of-the-dimensionless-quantity" class="self-link"></a></h4>
<p>As we observed above, the most common unit for dimensionless
quantities is <code class="sourceCode default">one</code>. It has the
ratio of <code class="sourceCode default">1</code> and does not output
any textual symbol.</p>
<p>A unit <code class="sourceCode default">one</code> is special in the
entire type system of units as it is considered to be an identity
operand in the unit expression templates. This means that, for
example:</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>one <span class="op">*</span> one <span class="op">==</span> one<span class="op">)</span>;</span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>one <span class="op">*</span> si<span class="op">::</span>metre <span class="op">==</span> si<span class="op">::</span>metre<span class="op">)</span>;</span>
<span id="cb247-3"><a href="#cb247-3" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>si<span class="op">::</span>metre <span class="op">/</span> si<span class="op">::</span>metre <span class="op">==</span> one<span class="op">)</span>;</span></code></pre></div>
<p>The same is also true for
<code class="sourceCode default">dimension_one</code> and
<code class="sourceCode default">dimensionless</code> in the domains of
dimensions and quantity specifications, respectively.</p>
<p>Besides the unit <code class="sourceCode default">one</code>, there
are a few other scaled units predefined in the library for usage with
dimensionless quantities:</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> percent <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;%&quot;</span>, mag<span class="op">&lt;</span>ratio<span class="op">{</span><span class="dv">1</span>, <span class="dv">100</span><span class="op">}&gt;</span> <span class="op">*</span> one<span class="op">&gt;</span> <span class="op">{}</span> percent;</span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> per_mille <span class="op">:</span> named_unit<span class="op">&lt;{</span><span class="st">u8&quot;‰&quot;</span>, <span class="st">&quot;</span><span class="sc">%o</span><span class="st">&quot;</span><span class="op">}</span>, mag<span class="op">&lt;</span>ratio<span class="op">(</span><span class="dv">1</span>, <span class="dv">1000</span><span class="op">)&gt;</span> <span class="op">*</span> one<span class="op">&gt;</span> <span class="op">{}</span> per_mille;</span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> parts_per_million <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;ppm&quot;</span>, mag<span class="op">&lt;</span>ratio<span class="op">(</span><span class="dv">1</span>, <span class="dv">1&#39;000&#39;000</span><span class="op">)&gt;</span> <span class="op">*</span> one<span class="op">&gt;</span> <span class="op">{}</span> parts_per_million;</span>
<span id="cb248-4"><a href="#cb248-4" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">auto</span> ppm <span class="op">=</span> parts_per_million;</span></code></pre></div>
<h4 data-number="16.8.3.5" id="angular-quantities"><span class="header-section-number">16.8.3.5</span> Angular quantities<a href="#angular-quantities" class="self-link"></a></h4>
<p>Special, often controversial, examples of dimensionless quantities
are the <em>angular measure</em> and <em>solid angular measure</em>
quantities that are defined in <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span> (part 3) to be the result
of a division of
<code class="sourceCode default">arc_length / radius</code> and
<code class="sourceCode default">area / pow&lt;2&gt;(radius)</code>
respectively. Moreover, <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span> also
explicitly states that both can be expressed in the unit
<code class="sourceCode default">one</code>. This means that both
<code class="sourceCode default">isq::angular_measure</code> and
<code class="sourceCode default">isq::solid_angular_measure</code>
should be of a kind of
<code class="sourceCode default">dimensionless</code>.</p>
<p>On the other hand, <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span> also
specifies that the unit <code class="sourceCode default">radian</code>
can be used for <em>angular measure</em>, and the unit
<code class="sourceCode default">steradian</code> can be used for
<em>solid angular measure</em>. Those should not be mixed or used to
express other types of dimensionless quantities. We should not be able
to measure:</p>
<ul>
<li>basic dimensionless quantity in radians or steradians,</li>
<li><em>angular measure</em> in steradians,</li>
<li><em>solid angular measure</em> in radians.</li>
</ul>
<p>This means that both
<code class="sourceCode default">isq::angular_measure</code> and
<code class="sourceCode default">isq::solid_angular_measure</code>
should also be quantity kinds by themselves.</p>
<p><em>Note: Many people claim that angle being a dimensionless quantity
is a bad idea. There are proposals submitted to make an angle a base
quantity and <code class="sourceCode default">rad</code> to become a
base unit in both <span class="citation" data-cites="SI">[<a href="#ref-SI" role="doc-biblioref">SI</a>]</span> and <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span>.</em></p>
<h4 data-number="16.8.3.6" id="nested-quantity-kinds"><span class="header-section-number">16.8.3.6</span> Nested quantity kinds<a href="#nested-quantity-kinds" class="self-link"></a></h4>
<p>Angular quantities are not the only ones with such a “strange”
behavior. A similar case is the <em>storage capacity</em> quantity
specified in <span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span>
(part 13) that again allows expressing it in both
<code class="sourceCode default">one</code> and
<code class="sourceCode default">bit</code> units.</p>
<p>Those cases make dimensionless quantities an exceptional tree in the
library. This is the only quantity hierarchy that contains more than one
quantity kind in its tree:</p>
<p><img src="data:image/svg+xml;base64,PHN2ZyBhcmlhLXJvbGVkZXNjcmlwdGlvbj0iZmxvd2NoYXJ0LXYyIiByb2xlPSJncmFwaGljcy1kb2N1bWVudCBkb2N1bWVudCIgdmlld0JveD0iLTggLTggMTA1OC4zNDM3NSAyODEiIHN0eWxlPSJtYXgtd2lkdGg6IDEwMCU7IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBpZD0iZ3JhcGgtZGl2IiBoZWlnaHQ9IjEwMCUiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj48c3R5bGU+QGltcG9ydCB1cmwoImh0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL2ZvbnQtYXdlc29tZS82LjQuMi9jc3MvYWxsLm1pbi5jc3MiKTsnPC9zdHlsZT48c3R5bGU+I2dyYXBoLWRpdntmb250LWZhbWlseToidHJlYnVjaGV0IG1zIix2ZXJkYW5hLGFyaWFsLHNhbnMtc2VyaWY7Zm9udC1zaXplOjE2cHg7ZmlsbDojMzMzO30jZ3JhcGgtZGl2IC5lcnJvci1pY29ue2ZpbGw6IzU1MjIyMjt9I2dyYXBoLWRpdiAuZXJyb3ItdGV4dHtmaWxsOiM1NTIyMjI7c3Ryb2tlOiM1NTIyMjI7fSNncmFwaC1kaXYgLmVkZ2UtdGhpY2tuZXNzLW5vcm1hbHtzdHJva2Utd2lkdGg6MnB4O30jZ3JhcGgtZGl2IC5lZGdlLXRoaWNrbmVzcy10aGlja3tzdHJva2Utd2lkdGg6My41cHg7fSNncmFwaC1kaXYgLmVkZ2UtcGF0dGVybi1zb2xpZHtzdHJva2UtZGFzaGFycmF5OjA7fSNncmFwaC1kaXYgLmVkZ2UtcGF0dGVybi1kYXNoZWR7c3Ryb2tlLWRhc2hhcnJheTozO30jZ3JhcGgtZGl2IC5lZGdlLXBhdHRlcm4tZG90dGVke3N0cm9rZS1kYXNoYXJyYXk6Mjt9I2dyYXBoLWRpdiAubWFya2Vye2ZpbGw6IzMzMzMzMztzdHJva2U6IzMzMzMzMzt9I2dyYXBoLWRpdiAubWFya2VyLmNyb3Nze3N0cm9rZTojMzMzMzMzO30jZ3JhcGgtZGl2IHN2Z3tmb250LWZhbWlseToidHJlYnVjaGV0IG1zIix2ZXJkYW5hLGFyaWFsLHNhbnMtc2VyaWY7Zm9udC1zaXplOjE2cHg7fSNncmFwaC1kaXYgLmxhYmVse2ZvbnQtZmFtaWx5OiJ0cmVidWNoZXQgbXMiLHZlcmRhbmEsYXJpYWwsc2Fucy1zZXJpZjtjb2xvcjojMzMzO30jZ3JhcGgtZGl2IC5jbHVzdGVyLWxhYmVsIHRleHR7ZmlsbDojMzMzO30jZ3JhcGgtZGl2IC5jbHVzdGVyLWxhYmVsIHNwYW4sI2dyYXBoLWRpdiBwe2NvbG9yOiMzMzM7fSNncmFwaC1kaXYgLmxhYmVsIHRleHQsI2dyYXBoLWRpdiBzcGFuLCNncmFwaC1kaXYgcHtmaWxsOiMzMzM7Y29sb3I6IzMzMzt9I2dyYXBoLWRpdiAubm9kZSByZWN0LCNncmFwaC1kaXYgLm5vZGUgY2lyY2xlLCNncmFwaC1kaXYgLm5vZGUgZWxsaXBzZSwjZ3JhcGgtZGl2IC5ub2RlIHBvbHlnb24sI2dyYXBoLWRpdiAubm9kZSBwYXRoe2ZpbGw6I0VDRUNGRjtzdHJva2U6IzkzNzBEQjtzdHJva2Utd2lkdGg6MXB4O30jZ3JhcGgtZGl2IC5mbG93Y2hhcnQtbGFiZWwgdGV4dHt0ZXh0LWFuY2hvcjptaWRkbGU7fSNncmFwaC1kaXYgLm5vZGUgLmxhYmVse3RleHQtYWxpZ246Y2VudGVyO30jZ3JhcGgtZGl2IC5ub2RlLmNsaWNrYWJsZXtjdXJzb3I6cG9pbnRlcjt9I2dyYXBoLWRpdiAuYXJyb3doZWFkUGF0aHtmaWxsOiMzMzMzMzM7fSNncmFwaC1kaXYgLmVkZ2VQYXRoIC5wYXRoe3N0cm9rZTojMzMzMzMzO3N0cm9rZS13aWR0aDoyLjBweDt9I2dyYXBoLWRpdiAuZmxvd2NoYXJ0LWxpbmt7c3Ryb2tlOiMzMzMzMzM7ZmlsbDpub25lO30jZ3JhcGgtZGl2IC5lZGdlTGFiZWx7YmFja2dyb3VuZC1jb2xvcjojZThlOGU4O3RleHQtYWxpZ246Y2VudGVyO30jZ3JhcGgtZGl2IC5lZGdlTGFiZWwgcmVjdHtvcGFjaXR5OjAuNTtiYWNrZ3JvdW5kLWNvbG9yOiNlOGU4ZTg7ZmlsbDojZThlOGU4O30jZ3JhcGgtZGl2IC5sYWJlbEJrZ3tiYWNrZ3JvdW5kLWNvbG9yOnJnYmEoMjMyLCAyMzIsIDIzMiwgMC41KTt9I2dyYXBoLWRpdiAuY2x1c3RlciByZWN0e2ZpbGw6I2ZmZmZkZTtzdHJva2U6I2FhYWEzMztzdHJva2Utd2lkdGg6MXB4O30jZ3JhcGgtZGl2IC5jbHVzdGVyIHRleHR7ZmlsbDojMzMzO30jZ3JhcGgtZGl2IC5jbHVzdGVyIHNwYW4sI2dyYXBoLWRpdiBwe2NvbG9yOiMzMzM7fSNncmFwaC1kaXYgZGl2Lm1lcm1haWRUb29sdGlwe3Bvc2l0aW9uOmFic29sdXRlO3RleHQtYWxpZ246Y2VudGVyO21heC13aWR0aDoyMDBweDtwYWRkaW5nOjJweDtmb250LWZhbWlseToidHJlYnVjaGV0IG1zIix2ZXJkYW5hLGFyaWFsLHNhbnMtc2VyaWY7Zm9udC1zaXplOjEycHg7YmFja2dyb3VuZDpoc2woODAsIDEwMCUsIDk2LjI3NDUwOTgwMzklKTtib3JkZXI6MXB4IHNvbGlkICNhYWFhMzM7Ym9yZGVyLXJhZGl1czoycHg7cG9pbnRlci1ldmVudHM6bm9uZTt6LWluZGV4OjEwMDt9I2dyYXBoLWRpdiAuZmxvd2NoYXJ0VGl0bGVUZXh0e3RleHQtYW5jaG9yOm1pZGRsZTtmb250LXNpemU6MThweDtmaWxsOiMzMzM7fSNncmFwaC1kaXYgOnJvb3R7LS1tZXJtYWlkLWZvbnQtZmFtaWx5OiJ0cmVidWNoZXQgbXMiLHZlcmRhbmEsYXJpYWwsc2Fucy1zZXJpZjt9PC9zdHlsZT48Zz48bWFya2VyIG9yaWVudD0iYXV0byIgbWFya2VySGVpZ2h0PSIxMiIgbWFya2VyV2lkdGg9IjEyIiBtYXJrZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIHJlZlk9IjUiIHJlZlg9IjYiIHZpZXdCb3g9IjAgMCAxMCAxMCIgY2xhc3M9Im1hcmtlciBmbG93Y2hhcnQiIGlkPSJncmFwaC1kaXZfZmxvd2NoYXJ0LXBvaW50RW5kIj48cGF0aCBzdHlsZT0ic3Ryb2tlLXdpZHRoOiAxOyBzdHJva2UtZGFzaGFycmF5OiAxLCAwOyIgY2xhc3M9ImFycm93TWFya2VyUGF0aCIgZD0iTSAwIDAgTCAxMCA1IEwgMCAxMCB6Ij48L3BhdGg+PC9tYXJrZXI+PG1hcmtlciBvcmllbnQ9ImF1dG8iIG1hcmtlckhlaWdodD0iMTIiIG1hcmtlcldpZHRoPSIxMiIgbWFya2VyVW5pdHM9InVzZXJTcGFjZU9uVXNlIiByZWZZPSI1IiByZWZYPSI0LjUiIHZpZXdCb3g9IjAgMCAxMCAxMCIgY2xhc3M9Im1hcmtlciBmbG93Y2hhcnQiIGlkPSJncmFwaC1kaXZfZmxvd2NoYXJ0LXBvaW50U3RhcnQiPjxwYXRoIHN0eWxlPSJzdHJva2Utd2lkdGg6IDE7IHN0cm9rZS1kYXNoYXJyYXk6IDEsIDA7IiBjbGFzcz0iYXJyb3dNYXJrZXJQYXRoIiBkPSJNIDAgNSBMIDEwIDEwIEwgMTAgMCB6Ij48L3BhdGg+PC9tYXJrZXI+PG1hcmtlciBvcmllbnQ9ImF1dG8iIG1hcmtlckhlaWdodD0iMTEiIG1hcmtlcldpZHRoPSIxMSIgbWFya2VyVW5pdHM9InVzZXJTcGFjZU9uVXNlIiByZWZZPSI1IiByZWZYPSIxMSIgdmlld0JveD0iMCAwIDEwIDEwIiBjbGFzcz0ibWFya2VyIGZsb3djaGFydCIgaWQ9ImdyYXBoLWRpdl9mbG93Y2hhcnQtY2lyY2xlRW5kIj48Y2lyY2xlIHN0eWxlPSJzdHJva2Utd2lkdGg6IDE7IHN0cm9rZS1kYXNoYXJyYXk6IDEsIDA7IiBjbGFzcz0iYXJyb3dNYXJrZXJQYXRoIiByPSI1IiBjeT0iNSIgY3g9IjUiPjwvY2lyY2xlPjwvbWFya2VyPjxtYXJrZXIgb3JpZW50PSJhdXRvIiBtYXJrZXJIZWlnaHQ9IjExIiBtYXJrZXJXaWR0aD0iMTEiIG1hcmtlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgcmVmWT0iNSIgcmVmWD0iLTEiIHZpZXdCb3g9IjAgMCAxMCAxMCIgY2xhc3M9Im1hcmtlciBmbG93Y2hhcnQiIGlkPSJncmFwaC1kaXZfZmxvd2NoYXJ0LWNpcmNsZVN0YXJ0Ij48Y2lyY2xlIHN0eWxlPSJzdHJva2Utd2lkdGg6IDE7IHN0cm9rZS1kYXNoYXJyYXk6IDEsIDA7IiBjbGFzcz0iYXJyb3dNYXJrZXJQYXRoIiByPSI1IiBjeT0iNSIgY3g9IjUiPjwvY2lyY2xlPjwvbWFya2VyPjxtYXJrZXIgb3JpZW50PSJhdXRvIiBtYXJrZXJIZWlnaHQ9IjExIiBtYXJrZXJXaWR0aD0iMTEiIG1hcmtlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgcmVmWT0iNS4yIiByZWZYPSIxMiIgdmlld0JveD0iMCAwIDExIDExIiBjbGFzcz0ibWFya2VyIGNyb3NzIGZsb3djaGFydCIgaWQ9ImdyYXBoLWRpdl9mbG93Y2hhcnQtY3Jvc3NFbmQiPjxwYXRoIHN0eWxlPSJzdHJva2Utd2lkdGg6IDI7IHN0cm9rZS1kYXNoYXJyYXk6IDEsIDA7IiBjbGFzcz0iYXJyb3dNYXJrZXJQYXRoIiBkPSJNIDEsMSBsIDksOSBNIDEwLDEgbCAtOSw5Ij48L3BhdGg+PC9tYXJrZXI+PG1hcmtlciBvcmllbnQ9ImF1dG8iIG1hcmtlckhlaWdodD0iMTEiIG1hcmtlcldpZHRoPSIxMSIgbWFya2VyVW5pdHM9InVzZXJTcGFjZU9uVXNlIiByZWZZPSI1LjIiIHJlZlg9Ii0xIiB2aWV3Qm94PSIwIDAgMTEgMTEiIGNsYXNzPSJtYXJrZXIgY3Jvc3MgZmxvd2NoYXJ0IiBpZD0iZ3JhcGgtZGl2X2Zsb3djaGFydC1jcm9zc1N0YXJ0Ij48cGF0aCBzdHlsZT0ic3Ryb2tlLXdpZHRoOiAyOyBzdHJva2UtZGFzaGFycmF5OiAxLCAwOyIgY2xhc3M9ImFycm93TWFya2VyUGF0aCIgZD0iTSAxLDEgbCA5LDkgTSAxMCwxIGwgLTksOSI+PC9wYXRoPjwvbWFya2VyPjxnIGNsYXNzPSJyb290Ij48ZyBjbGFzcz0iY2x1c3RlcnMiPjwvZz48ZyBjbGFzcz0iZWRnZVBhdGhzIj48cGF0aCBzdHlsZT0iZmlsbDpub25lOyIgY2xhc3M9ImVkZ2UtdGhpY2tuZXNzLW5vcm1hbCBlZGdlLXBhdHRlcm4tc29saWQgZmxvd2NoYXJ0LWxpbmsgTFMtZGltZW5zaW9ubGVzcyBMRS1yb3RhdGlvbiIgaWQ9IkwtZGltZW5zaW9ubGVzcy1yb3RhdGlvbi0wIiBkPSJNNDc4LjM2NywzNy45NTRMNDA0LjcwNiw0Ni4yOTVDMzMxLjA0NCw1NC42MzYsMTgzLjcyMSw3MS4zMTgsMTEwLjA2LDg1LjgyNkMzNi4zOTgsMTAwLjMzMywzNi4zOTgsMTEyLjY2NywzNi4zOTgsMTE4LjgzM0wzNi4zOTgsMTI1Ij48L3BhdGg+PHBhdGggc3R5bGU9ImZpbGw6bm9uZTsiIGNsYXNzPSJlZGdlLXRoaWNrbmVzcy1ub3JtYWwgZWRnZS1wYXR0ZXJuLXNvbGlkIGZsb3djaGFydC1saW5rIExTLWRpbWVuc2lvbmxlc3MgTEUtZWZmaWNpZW5jeSIgaWQ9IkwtZGltZW5zaW9ubGVzcy1lZmZpY2llbmN5LTAiIGQ9Ik00NzguMzY3LDQwLjIxM0w0MjYuMjYzLDQ4LjE3N0MzNzQuMTU5LDU2LjE0MiwyNjkuOTUxLDcyLjA3MSwyMTcuODQ2LDg2LjIwMkMxNjUuNzQyLDEwMC4zMzMsMTY1Ljc0MiwxMTIuNjY3LDE2NS43NDIsMTE4LjgzM0wxNjUuNzQyLDEyNSI+PC9wYXRoPjxwYXRoIHN0eWxlPSJmaWxsOm5vbmU7IiBjbGFzcz0iZWRnZS10aGlja25lc3Mtbm9ybWFsIGVkZ2UtcGF0dGVybi1zb2xpZCBmbG93Y2hhcnQtbGluayBMUy1kaW1lbnNpb25sZXNzIExFLWFuZ3VsYXJfbWVhc3VyZSIgaWQ9IkwtZGltZW5zaW9ubGVzcy1hbmd1bGFyX21lYXN1cmUtMCIgZD0iTTQ3OC4zNjcsNDYuOTc5TDQ1My4xOSw1My44MTVDNDI4LjAxMyw2MC42NTIsMzc3LjY1OSw3NC4zMjYsMzUyLjQ4Miw4NS4zM0MzMjcuMzA1LDk2LjMzMywzMjcuMzA1LDEwNC42NjcsMzI3LjMwNSwxMDguODMzTDMyNy4zMDUsMTEzIj48L3BhdGg+PHBhdGggc3R5bGU9ImZpbGw6bm9uZTsiIGNsYXNzPSJlZGdlLXRoaWNrbmVzcy1ub3JtYWwgZWRnZS1wYXR0ZXJuLXNvbGlkIGZsb3djaGFydC1saW5rIExTLWFuZ3VsYXJfbWVhc3VyZSBMRS1yb3RhdGlvbmFsX2Rpc3BsYWNlbWVudCIgaWQ9IkwtYW5ndWxhcl9tZWFzdXJlLXJvdGF0aW9uYWxfZGlzcGxhY2VtZW50LTAiIGQ9Ik0yNzIuNDgyLDE3NkwyNjUuMjMxLDE4MC4xNjdDMjU3Ljk3OSwxODQuMzMzLDI0My40NzYsMTkyLjY2NywyMzYuMjI0LDIwMUMyMjguOTczLDIwOS4zMzMsMjI4Ljk3MywyMTcuNjY3LDIyOC45NzMsMjIxLjgzM0wyMjguOTczLDIyNiI+PC9wYXRoPjxwYXRoIHN0eWxlPSJmaWxsOm5vbmU7IiBjbGFzcz0iZWRnZS10aGlja25lc3Mtbm9ybWFsIGVkZ2UtcGF0dGVybi1zb2xpZCBmbG93Y2hhcnQtbGluayBMUy1hbmd1bGFyX21lYXN1cmUgTEUtcGhhc2VfYW5nbGUiIGlkPSJMLWFuZ3VsYXJfbWVhc3VyZS1waGFzZV9hbmdsZS0wIiBkPSJNMzk1LjkyMiwxNjguMzEzTDQxMS42MiwxNzMuNzYxQzQyNy4zMTgsMTc5LjIwOSw0NTguNzE0LDE5MC4xMDQsNDc0LjQxMSwxOTkuNzE5QzQ5MC4xMDksMjA5LjMzMyw0OTAuMTA5LDIxNy42NjcsNDkwLjEwOSwyMjEuODMzTDQ5MC4xMDksMjI2Ij48L3BhdGg+PHBhdGggc3R5bGU9ImZpbGw6bm9uZTsiIGNsYXNzPSJlZGdlLXRoaWNrbmVzcy1ub3JtYWwgZWRnZS1wYXR0ZXJuLXNvbGlkIGZsb3djaGFydC1saW5rIExTLWRpbWVuc2lvbmxlc3MgTEUtc29saWRfYW5ndWxhcl9tZWFzdXJlIiBpZD0iTC1kaW1lbnNpb25sZXNzLXNvbGlkX2FuZ3VsYXJfbWVhc3VyZS0wIiBkPSJNNTM1LjM2Nyw2M0w1MzUuMzY3LDY3LjE2N0M1MzUuMzY3LDcxLjMzMyw1MzUuMzY3LDc5LjY2Nyw1MzUuMzY3LDg4QzUzNS4zNjcsOTYuMzMzLDUzNS4zNjcsMTA0LjY2Nyw1MzUuMzY3LDEwOC44MzNMNTM1LjM2NywxMTMiPjwvcGF0aD48cGF0aCBzdHlsZT0iZmlsbDpub25lOyIgY2xhc3M9ImVkZ2UtdGhpY2tuZXNzLW5vcm1hbCBlZGdlLXBhdHRlcm4tc29saWQgZmxvd2NoYXJ0LWxpbmsgTFMtZGltZW5zaW9ubGVzcyBMRS1kcmFnX2ZhY3RvciIgaWQ9IkwtZGltZW5zaW9ubGVzcy1kcmFnX2ZhY3Rvci0wIiBkPSJNNTkyLjM2Nyw0OC41NzRMNjE0LjMwNSw1NS4xNDVDNjM2LjI0Miw2MS43MTYsNjgwLjExNyw3NC44NTgsNzAyLjA1NSw4Ny41OTZDNzIzLjk5MiwxMDAuMzMzLDcyMy45OTIsMTEyLjY2Nyw3MjMuOTkyLDExOC44MzNMNzIzLjk5MiwxMjUiPjwvcGF0aD48cGF0aCBzdHlsZT0iZmlsbDpub25lOyIgY2xhc3M9ImVkZ2UtdGhpY2tuZXNzLW5vcm1hbCBlZGdlLXBhdHRlcm4tc29saWQgZmxvd2NoYXJ0LWxpbmsgTFMtZGltZW5zaW9ubGVzcyBMRS1zdG9yYWdlX2NhcGFjaXR5IiBpZD0iTC1kaW1lbnNpb25sZXNzLXN0b3JhZ2VfY2FwYWNpdHktMCIgZD0iTTU5Mi4zNjcsNDAuNTQ0TDY0Mi4yMTQsNDguNDU0QzY5Mi4wNiw1Ni4zNjMsNzkxLjc1Myw3Mi4xODEsODQxLjU5OSw4NC4yNTdDODkxLjQ0NSw5Ni4zMzMsODkxLjQ0NSwxMDQuNjY3LDg5MS40NDUsMTA4LjgzM0w4OTEuNDQ1LDExMyI+PC9wYXRoPjxwYXRoIHN0eWxlPSJmaWxsOm5vbmU7IiBjbGFzcz0iZWRnZS10aGlja25lc3Mtbm9ybWFsIGVkZ2UtcGF0dGVybi1zb2xpZCBmbG93Y2hhcnQtbGluayBMUy1zdG9yYWdlX2NhcGFjaXR5IExFLWVxdWl2YWxlbnRfYmluYXJ5X3N0b3JhZ2VfY2FwYWNpdHkiIGlkPSJMLXN0b3JhZ2VfY2FwYWNpdHktZXF1aXZhbGVudF9iaW5hcnlfc3RvcmFnZV9jYXBhY2l0eS0wIiBkPSJNODkxLjQ0NSwxNzZMODkxLjQ0NSwxODAuMTY3Qzg5MS40NDUsMTg0LjMzMyw4OTEuNDQ1LDE5Mi42NjcsODkxLjQ0NSwyMDFDODkxLjQ0NSwyMDkuMzMzLDg5MS40NDUsMjE3LjY2Nyw4OTEuNDQ1LDIyMS44MzNMODkxLjQ0NSwyMjYiPjwvcGF0aD48cGF0aCBzdHlsZT0iZmlsbDpub25lOyIgY2xhc3M9ImVkZ2UtdGhpY2tuZXNzLW5vcm1hbCBlZGdlLXBhdHRlcm4tc29saWQgZmxvd2NoYXJ0LWxpbmsgTFMtZGltZW5zaW9ubGVzcyBMRS0uLi4iIGlkPSJMLWRpbWVuc2lvbmxlc3MtLi4uLTAiIGQ9Ik01OTIuMzY3LDM4LjA2NEw2NjQuNjQ1LDQ2LjM4NkM3MzYuOTIyLDU0LjcwOSw4ODEuNDc3LDcxLjM1NSw5NTMuNzU0LDg1Ljg0NEMxMDI2LjAzMSwxMDAuMzMzLDEwMjYuMDMxLDExMi42NjcsMTAyNi4wMzEsMTE4LjgzM0wxMDI2LjAzMSwxMjUiPjwvcGF0aD48L2c+PGcgY2xhc3M9ImVkZ2VMYWJlbHMiPjxnIGNsYXNzPSJlZGdlTGFiZWwiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAsIDApIiBjbGFzcz0ibGFiZWwiPjxmb3JlaWduT2JqZWN0IGhlaWdodD0iMCIgd2lkdGg9IjAiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0iZWRnZUxhYmVsIj48L3NwYW4+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+PGcgY2xhc3M9ImVkZ2VMYWJlbCI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCwgMCkiIGNsYXNzPSJsYWJlbCI+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSIwIiB3aWR0aD0iMCI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPjxzcGFuIGNsYXNzPSJlZGdlTGFiZWwiPjwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48ZyBjbGFzcz0iZWRnZUxhYmVsIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLCAwKSIgY2xhc3M9ImxhYmVsIj48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjAiIHdpZHRoPSIwIj48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+PHNwYW4gY2xhc3M9ImVkZ2VMYWJlbCI+PC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIGNsYXNzPSJlZGdlTGFiZWwiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAsIDApIiBjbGFzcz0ibGFiZWwiPjxmb3JlaWduT2JqZWN0IGhlaWdodD0iMCIgd2lkdGg9IjAiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0iZWRnZUxhYmVsIj48L3NwYW4+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+PGcgY2xhc3M9ImVkZ2VMYWJlbCI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCwgMCkiIGNsYXNzPSJsYWJlbCI+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSIwIiB3aWR0aD0iMCI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPjxzcGFuIGNsYXNzPSJlZGdlTGFiZWwiPjwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48ZyBjbGFzcz0iZWRnZUxhYmVsIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLCAwKSIgY2xhc3M9ImxhYmVsIj48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjAiIHdpZHRoPSIwIj48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+PHNwYW4gY2xhc3M9ImVkZ2VMYWJlbCI+PC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIGNsYXNzPSJlZGdlTGFiZWwiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAsIDApIiBjbGFzcz0ibGFiZWwiPjxmb3JlaWduT2JqZWN0IGhlaWdodD0iMCIgd2lkdGg9IjAiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0iZWRnZUxhYmVsIj48L3NwYW4+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+PGcgY2xhc3M9ImVkZ2VMYWJlbCI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCwgMCkiIGNsYXNzPSJsYWJlbCI+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSIwIiB3aWR0aD0iMCI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPjxzcGFuIGNsYXNzPSJlZGdlTGFiZWwiPjwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48ZyBjbGFzcz0iZWRnZUxhYmVsIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLCAwKSIgY2xhc3M9ImxhYmVsIj48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjAiIHdpZHRoPSIwIj48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+PHNwYW4gY2xhc3M9ImVkZ2VMYWJlbCI+PC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIGNsYXNzPSJlZGdlTGFiZWwiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAsIDApIiBjbGFzcz0ibGFiZWwiPjxmb3JlaWduT2JqZWN0IGhlaWdodD0iMCIgd2lkdGg9IjAiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0iZWRnZUxhYmVsIj48L3NwYW4+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+PC9nPjxnIGNsYXNzPSJub2RlcyI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNTM1LjM2NzE4NzUsIDMxLjUpIiBpZD0iZmxvd2NoYXJ0LWRpbWVuc2lvbmxlc3MtMzU4IiBjbGFzcz0ibm9kZSBkZWZhdWx0IGRlZmF1bHQgZmxvd2NoYXJ0LWxhYmVsIj48cmVjdCBoZWlnaHQ9IjYzIiB3aWR0aD0iMTE0IiB5PSItMzEuNSIgeD0iLTU3IiByeT0iMCIgcng9IjAiIHN0eWxlPSIiIGNsYXNzPSJiYXNpYyBsYWJlbC1jb250YWluZXIiPjwvcmVjdD48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNDkuNSwgLTI0KSIgc3R5bGU9IiIgY2xhc3M9ImxhYmVsIj48cmVjdD48L3JlY3Q+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSI0OCIgd2lkdGg9Ijk5Ij48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+PHNwYW4gY2xhc3M9Im5vZGVMYWJlbCI+ZGltZW5zaW9ubGVzczxici8+W29uZV08L3NwYW4+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzYuMzk4NDM3NSwgMTQ0LjUpIiBpZD0iZmxvd2NoYXJ0LXJvdGF0aW9uLTM2MCIgY2xhc3M9Im5vZGUgZGVmYXVsdCBkZWZhdWx0IGZsb3djaGFydC1sYWJlbCI+PHJlY3QgaGVpZ2h0PSIzOSIgd2lkdGg9IjcyLjc5Njg3NSIgeT0iLTE5LjUiIHg9Ii0zNi4zOTg0Mzc1IiByeT0iMCIgcng9IjAiIHN0eWxlPSIiIGNsYXNzPSJiYXNpYyBsYWJlbC1jb250YWluZXIiPjwvcmVjdD48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMjguODk4NDM3NSwgLTEyKSIgc3R5bGU9IiIgY2xhc3M9ImxhYmVsIj48cmVjdD48L3JlY3Q+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSIyNCIgd2lkdGg9IjU3Ljc5Njg3NSI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPjxzcGFuIGNsYXNzPSJub2RlTGFiZWwiPnJvdGF0aW9uPC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE2NS43NDIxODc1LCAxNDQuNSkiIGlkPSJmbG93Y2hhcnQtZWZmaWNpZW5jeS0zNjIiIGNsYXNzPSJub2RlIGRlZmF1bHQgZGVmYXVsdCBmbG93Y2hhcnQtbGFiZWwiPjxyZWN0IGhlaWdodD0iMzkiIHdpZHRoPSI4NS44OTA2MjUiIHk9Ii0xOS41IiB4PSItNDIuOTQ1MzEyNSIgcnk9IjAiIHJ4PSIwIiBzdHlsZT0iIiBjbGFzcz0iYmFzaWMgbGFiZWwtY29udGFpbmVyIj48L3JlY3Q+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTM1LjQ0NTMxMjUsIC0xMikiIHN0eWxlPSIiIGNsYXNzPSJsYWJlbCI+PHJlY3Q+PC9yZWN0Pjxmb3JlaWduT2JqZWN0IGhlaWdodD0iMjQiIHdpZHRoPSI3MC44OTA2MjUiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0ibm9kZUxhYmVsIj5lZmZpY2llbmN5PC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDMyNy4zMDQ2ODc1LCAxNDQuNSkiIGlkPSJmbG93Y2hhcnQtYW5ndWxhcl9tZWFzdXJlLTM2NCIgY2xhc3M9Im5vZGUgZGVmYXVsdCBkZWZhdWx0IGZsb3djaGFydC1sYWJlbCI+PHJlY3QgaGVpZ2h0PSI2MyIgd2lkdGg9IjEzNy4yMzQzNzUiIHk9Ii0zMS41IiB4PSItNjguNjE3MTg3NSIgcnk9IjAiIHJ4PSIwIiBzdHlsZT0iIiBjbGFzcz0iYmFzaWMgbGFiZWwtY29udGFpbmVyIj48L3JlY3Q+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTYxLjExNzE4NzUsIC0yNCkiIHN0eWxlPSIiIGNsYXNzPSJsYWJlbCI+PHJlY3Q+PC9yZWN0Pjxmb3JlaWduT2JqZWN0IGhlaWdodD0iNDgiIHdpZHRoPSIxMjIuMjM0Mzc1Ij48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+PHNwYW4gY2xhc3M9Im5vZGVMYWJlbCI+YW5ndWxhcl9tZWFzdXJlPGJyLz5bcmFkXTwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMjguOTcyNjU2MjUsIDI0NS41KSIgaWQ9ImZsb3djaGFydC1yb3RhdGlvbmFsX2Rpc3BsYWNlbWVudC0zNjYiIGNsYXNzPSJub2RlIGRlZmF1bHQgZGVmYXVsdCBmbG93Y2hhcnQtbGFiZWwiPjxyZWN0IGhlaWdodD0iMzkiIHdpZHRoPSIxOTAuMDQ2ODc1IiB5PSItMTkuNSIgeD0iLTk1LjAyMzQzNzUiIHJ5PSIwIiByeD0iMCIgc3R5bGU9IiIgY2xhc3M9ImJhc2ljIGxhYmVsLWNvbnRhaW5lciI+PC9yZWN0PjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC04Ny41MjM0Mzc1LCAtMTIpIiBzdHlsZT0iIiBjbGFzcz0ibGFiZWwiPjxyZWN0PjwvcmVjdD48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjI0IiB3aWR0aD0iMTc1LjA0Njg3NSI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPjxzcGFuIGNsYXNzPSJub2RlTGFiZWwiPnJvdGF0aW9uYWxfZGlzcGxhY2VtZW50PC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQ5MC4xMDkzNzUsIDI0NS41KSIgaWQ9ImZsb3djaGFydC1waGFzZV9hbmdsZS0zNjgiIGNsYXNzPSJub2RlIGRlZmF1bHQgZGVmYXVsdCBmbG93Y2hhcnQtbGFiZWwiPjxyZWN0IGhlaWdodD0iMzkiIHdpZHRoPSIxMDMuMjgxMjUiIHk9Ii0xOS41IiB4PSItNTEuNjQwNjI1IiByeT0iMCIgcng9IjAiIHN0eWxlPSIiIGNsYXNzPSJiYXNpYyBsYWJlbC1jb250YWluZXIiPjwvcmVjdD48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNDQuMTQwNjI1LCAtMTIpIiBzdHlsZT0iIiBjbGFzcz0ibGFiZWwiPjxyZWN0PjwvcmVjdD48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjI0IiB3aWR0aD0iODguMjgxMjUiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0ibm9kZUxhYmVsIj5waGFzZV9hbmdsZTwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1MzUuMzY3MTg3NSwgMTQ0LjUpIiBpZD0iZmxvd2NoYXJ0LXNvbGlkX2FuZ3VsYXJfbWVhc3VyZS0zNzAiIGNsYXNzPSJub2RlIGRlZmF1bHQgZGVmYXVsdCBmbG93Y2hhcnQtbGFiZWwiPjxyZWN0IGhlaWdodD0iNjMiIHdpZHRoPSIxNzguODkwNjI1IiB5PSItMzEuNSIgeD0iLTg5LjQ0NTMxMjUiIHJ5PSIwIiByeD0iMCIgc3R5bGU9IiIgY2xhc3M9ImJhc2ljIGxhYmVsLWNvbnRhaW5lciI+PC9yZWN0PjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC04MS45NDUzMTI1LCAtMjQpIiBzdHlsZT0iIiBjbGFzcz0ibGFiZWwiPjxyZWN0PjwvcmVjdD48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjQ4IiB3aWR0aD0iMTYzLjg5MDYyNSI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPjxzcGFuIGNsYXNzPSJub2RlTGFiZWwiPnNvbGlkX2FuZ3VsYXJfbWVhc3VyZTxici8+W3NyXTwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSg3MjMuOTkyMTg3NSwgMTQ0LjUpIiBpZD0iZmxvd2NoYXJ0LWRyYWdfZmFjdG9yLTM3MiIgY2xhc3M9Im5vZGUgZGVmYXVsdCBkZWZhdWx0IGZsb3djaGFydC1sYWJlbCI+PHJlY3QgaGVpZ2h0PSIzOSIgd2lkdGg9Ijk4LjM1OTM3NSIgeT0iLTE5LjUiIHg9Ii00OS4xNzk2ODc1IiByeT0iMCIgcng9IjAiIHN0eWxlPSIiIGNsYXNzPSJiYXNpYyBsYWJlbC1jb250YWluZXIiPjwvcmVjdD48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNDEuNjc5Njg3NSwgLTEyKSIgc3R5bGU9IiIgY2xhc3M9ImxhYmVsIj48cmVjdD48L3JlY3Q+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSIyNCIgd2lkdGg9IjgzLjM1OTM3NSI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPjxzcGFuIGNsYXNzPSJub2RlTGFiZWwiPmRyYWdfZmFjdG9yPC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDg5MS40NDUzMTI1LCAxNDQuNSkiIGlkPSJmbG93Y2hhcnQtc3RvcmFnZV9jYXBhY2l0eS0zNzQiIGNsYXNzPSJub2RlIGRlZmF1bHQgZGVmYXVsdCBmbG93Y2hhcnQtbGFiZWwiPjxyZWN0IGhlaWdodD0iNjMiIHdpZHRoPSIxMzYuNTQ2ODc1IiB5PSItMzEuNSIgeD0iLTY4LjI3MzQzNzUiIHJ5PSIwIiByeD0iMCIgc3R5bGU9IiIgY2xhc3M9ImJhc2ljIGxhYmVsLWNvbnRhaW5lciI+PC9yZWN0PjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC02MC43NzM0Mzc1LCAtMjQpIiBzdHlsZT0iIiBjbGFzcz0ibGFiZWwiPjxyZWN0PjwvcmVjdD48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjQ4IiB3aWR0aD0iMTIxLjU0Njg3NSI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPjxzcGFuIGNsYXNzPSJub2RlTGFiZWwiPnN0b3JhZ2VfY2FwYWNpdHk8YnIvPltiaXRdPC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDg5MS40NDUzMTI1LCAyNDUuNSkiIGlkPSJmbG93Y2hhcnQtZXF1aXZhbGVudF9iaW5hcnlfc3RvcmFnZV9jYXBhY2l0eS0zNzUiIGNsYXNzPSJub2RlIGRlZmF1bHQgZGVmYXVsdCBmbG93Y2hhcnQtbGFiZWwiPjxyZWN0IGhlaWdodD0iMzkiIHdpZHRoPSIyNzMuNzgxMjUiIHk9Ii0xOS41IiB4PSItMTM2Ljg5MDYyNSIgcnk9IjAiIHJ4PSIwIiBzdHlsZT0iIiBjbGFzcz0iYmFzaWMgbGFiZWwtY29udGFpbmVyIj48L3JlY3Q+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEyOS4zOTA2MjUsIC0xMikiIHN0eWxlPSIiIGNsYXNzPSJsYWJlbCI+PHJlY3Q+PC9yZWN0Pjxmb3JlaWduT2JqZWN0IGhlaWdodD0iMjQiIHdpZHRoPSIyNTguNzgxMjUiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0ibm9kZUxhYmVsIj5lcXVpdmFsZW50X2JpbmFyeV9zdG9yYWdlX2NhcGFjaXR5PC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEwMjYuMDMxMjUsIDE0NC41KSIgaWQ9ImZsb3djaGFydC0uLi4tMzc3IiBjbGFzcz0ibm9kZSBkZWZhdWx0IGRlZmF1bHQgZmxvd2NoYXJ0LWxhYmVsIj48cmVjdCBoZWlnaHQ9IjM5IiB3aWR0aD0iMzIuNjI1IiB5PSItMTkuNSIgeD0iLTE2LjMxMjUiIHJ5PSIwIiByeD0iMCIgc3R5bGU9IiIgY2xhc3M9ImJhc2ljIGxhYmVsLWNvbnRhaW5lciI+PC9yZWN0PjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC04LjgxMjUsIC0xMikiIHN0eWxlPSIiIGNsYXNzPSJsYWJlbCI+PHJlY3Q+PC9yZWN0Pjxmb3JlaWduT2JqZWN0IGhlaWdodD0iMjQiIHdpZHRoPSIxNy42MjUiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj48c3BhbiBjbGFzcz0ibm9kZUxhYmVsIj4uLi48L3NwYW4+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+PC9nPjwvZz48L2c+PC9zdmc+" /></p>
<p>To provide such support in the library, we provided an
<code class="sourceCode default">is_kind</code> specifier that can be
appended to the quantity specification:</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> angular_measure <span class="op">:</span> quantity_spec<span class="op">&lt;</span>dimensionless, arc_length <span class="op">/</span> radius, is_kind<span class="op">&gt;</span> <span class="op">{}</span> angular_measure;</span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> solid_angular_measure <span class="op">:</span> quantity_spec<span class="op">&lt;</span>dimensionless, area <span class="op">/</span> pow<span class="op">&lt;</span><span class="dv">2</span><span class="op">&gt;(</span>radius<span class="op">)</span>, is_kind<span class="op">&gt;</span> <span class="op">{}</span> solid_angular_measure;</span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> storage_capacity <span class="op">:</span> quantity_spec<span class="op">&lt;</span>dimensionless, is_kind<span class="op">&gt;</span> <span class="op">{}</span> storage_capacity;</span></code></pre></div>
<p>With the above, we can constrain
<code class="sourceCode default">radian</code>,
<code class="sourceCode default">steradian</code>, and
<code class="sourceCode default">bit</code> to be allowed for usage with
specific quantity kinds only:</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> radian <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;rad&quot;</span>, metre <span class="op">/</span> metre, kind_of<span class="op">&lt;</span>isq<span class="op">::</span>angular_measure<span class="op">&gt;&gt;</span> <span class="op">{}</span> radian;</span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> steradian <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;sr&quot;</span>, square<span class="op">(</span>metre<span class="op">)</span> <span class="op">/</span> square<span class="op">(</span>metre<span class="op">)</span>, kind_of<span class="op">&lt;</span>isq<span class="op">::</span>solid_angular_measure<span class="op">&gt;&gt;</span> <span class="op">{}</span> steradian;</span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> bit <span class="op">:</span> named_unit<span class="op">&lt;</span><span class="st">&quot;bit&quot;</span>, one, kind_of<span class="op">&lt;</span>storage_capacity<span class="op">&gt;&gt;</span> <span class="op">{}</span> bit;</span></code></pre></div>
<p>This still allows the usage of
<code class="sourceCode default">one</code> (possibly scaled) for such
quantities which is exactly what we wanted to achieve.</p>
<h2 data-number="16.9" id="interoperability-with-other-libraries"><span class="header-section-number">16.9</span> Interoperability with other
libraries<a href="#interoperability-with-other-libraries" class="self-link"></a></h2>
<p>It is easy to cooperate with similar entities of other libraries. No
matter if we want to provide interoperability with a simple home-grown
strongly typed wrapper type (e.g.,
<code class="sourceCode default">Meter</code>,
<code class="sourceCode default">Timestamp</code>, …) or with a
feature-rich quantities and units library, we have to provide
specializations of:</p>
<ul>
<li>a <code class="sourceCode default">quantity_like_traits</code> for
external <code class="sourceCode default">quantity</code>-like
type,</li>
<li>a <code class="sourceCode default">quantity_point_like_traits</code>
for external <code class="sourceCode default">quantity_point</code>-like
type.</li>
</ul>
<h3 data-number="16.9.1" id="specifying-a-conversion-kind"><span class="header-section-number">16.9.1</span> Specifying a conversion
kind<a href="#specifying-a-conversion-kind" class="self-link"></a></h3>
<p>Before we delve into the template specialization details, let’s first
decide if we want the conversions to happen implicitly or if explicit
ones would be a better choice. Or maybe the conversion should be
implicit in one direction only (e.g., into abstractions in this library)
while the explicit conversions in the other direction should be
preferred?</p>
<p>There is no one unified answer to the above questions. Everything
depends on the use case.</p>
<p>Typically, in the C++ language, the implicit conversions are allowed
in cases where:</p>
<ul>
<li>both abstractions mean exactly the same, and interchanging them in
the code should not change its logic,</li>
<li>there is no significant runtime overhead introduced by such a
conversion (e.g., no need for dynamic allocation or copying of huge
internal buffers),</li>
<li>the target type of the conversion provides the same or better safety
to the users,</li>
<li>we prefer the simplicity of implicit conversions over safety during
the (hopefully short) transition period of refactoring our code base
from the usage of one library to the other.</li>
</ul>
<p>In all other scenarios, we should probably enforce explicit
conversions.</p>
<p>The kinds of inter-library conversions can be easily configured in
partial specializations of conversion traits. To require an explicit
conversion, the return type of the conversion function should be wrapped
in <code class="sourceCode default">convert_explicitly&lt;T&gt;</code>.
Otherwise,
<code class="sourceCode default">convert_implicitly&lt;T&gt;</code>
should be used.</p>
<h3 data-number="16.9.2" id="quantities-conversions"><span class="header-section-number">16.9.2</span> Quantities conversions<a href="#quantities-conversions" class="self-link"></a></h3>
<p>For example, let’s assume that some company has its own
<code class="sourceCode default">Meter</code> strong-type wrapper:</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Meter <span class="op">{</span></span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> value;</span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>;</span></code></pre></div>
<p>As every usage of <code class="sourceCode default">Meter</code> is at
least as good and safe as the usage of
<code class="sourceCode default">quantity&lt;si::metre, int&gt;</code>,
and as there is no significant runtime performance penalty, we would
like to allow the conversion to
<code class="sourceCode default">mp_units::quantity</code> to happen
implicitly.</p>
<p>On the other hand, the
<code class="sourceCode default">quantity</code> type is much safer than
the <code class="sourceCode default">Meter</code>, and that is why we
would prefer to see the opposite conversions stated explicitly in our
code.</p>
<p>To enable such interoperability, we must define a partial
specialization of the
<code class="sourceCode default">quantity_like_traits&lt;T&gt;</code>
type trait. Such specialization should provide:</p>
<ul>
<li>static data member <code class="sourceCode default">reference</code>
that provides the quantity reference (e.g., unit),</li>
<li><code class="sourceCode default">rep</code> type that specifies the
underlying storage type,</li>
<li><code class="sourceCode default">to_numerical_value(T)</code> static
member function returning a quantity’s raw value of
<code class="sourceCode default">rep</code> type packed in either
<code class="sourceCode default">convert_explicitly</code> or
<code class="sourceCode default">convert_implicitly</code> wrapper.</li>
<li><code class="sourceCode default">from_numerical_value(rep)</code>
static member function returning
<code class="sourceCode default">T</code> packed in either
<code class="sourceCode default">convert_explicitly</code> or
<code class="sourceCode default">convert_implicitly</code> wrapper.</li>
</ul>
<p>For example, for our <code class="sourceCode default">Meter</code>
type, we could provide the following:</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;&gt;</span></span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> std<span class="op">::</span>quantity_like_traits<span class="op">&lt;</span>Meter<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">static</span> <span class="kw">constexpr</span> <span class="kw">auto</span> reference <span class="op">=</span> si<span class="op">::</span>metre;</span>
<span id="cb252-4"><a href="#cb252-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">using</span> rep <span class="op">=</span> <span class="kw">decltype</span><span class="op">(</span>Meter<span class="op">::</span>value<span class="op">)</span>;</span>
<span id="cb252-5"><a href="#cb252-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">static</span> <span class="kw">constexpr</span> convert_implicitly<span class="op">&lt;</span>rep<span class="op">&gt;</span> to_numerical_value<span class="op">(</span>Meter m<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> m<span class="op">.</span>value; <span class="op">}</span></span>
<span id="cb252-6"><a href="#cb252-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">static</span> <span class="kw">constexpr</span> convert_explicitly<span class="op">&lt;</span>Meter<span class="op">&gt;</span> from_numerical_value<span class="op">(</span>rep v<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> Meter<span class="op">{</span>v<span class="op">}</span>; <span class="op">}</span></span>
<span id="cb252-7"><a href="#cb252-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>;</span></code></pre></div>
<p>After that, we can check that the <a href="#QuantityLike-concept"><code class="sourceCode default">QuantityLike</code></a>
concept is satisfied:</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>QuantityLike<span class="op">&lt;</span>Meter<span class="op">&gt;)</span>;</span></code></pre></div>
<p>and we can write the following:</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> print<span class="op">(</span>Meter m<span class="op">)</span> <span class="op">{</span> std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> m<span class="op">.</span>value <span class="op">&lt;&lt;</span> <span class="st">&quot; m</span><span class="sc">\n</span><span class="st">&quot;</span>; <span class="op">}</span></span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span></span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">::</span>si<span class="op">::</span>unit_symbols;</span>
<span id="cb254-6"><a href="#cb254-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-7"><a href="#cb254-7" aria-hidden="true" tabindex="-1"></a>  Meter height<span class="op">{</span><span class="dv">42</span><span class="op">}</span>;</span>
<span id="cb254-8"><a href="#cb254-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-9"><a href="#cb254-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">// implicit conversions</span></span>
<span id="cb254-10"><a href="#cb254-10" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>quantity h1 <span class="op">=</span> height;</span>
<span id="cb254-11"><a href="#cb254-11" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>quantity<span class="op">&lt;</span>isq<span class="op">::</span>height<span class="op">[</span>m<span class="op">]</span>, <span class="dt">int</span><span class="op">&gt;</span> h2 <span class="op">=</span> height;</span>
<span id="cb254-12"><a href="#cb254-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-13"><a href="#cb254-13" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> h1 <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>;</span>
<span id="cb254-14"><a href="#cb254-14" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> h2 <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>;</span>
<span id="cb254-15"><a href="#cb254-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-16"><a href="#cb254-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">// explicit conversions</span></span>
<span id="cb254-17"><a href="#cb254-17" aria-hidden="true" tabindex="-1"></a>  print<span class="op">(</span>Meter<span class="op">(</span>h1<span class="op">))</span>;</span>
<span id="cb254-18"><a href="#cb254-18" aria-hidden="true" tabindex="-1"></a>  print<span class="op">(</span>Meter<span class="op">(</span>h2<span class="op">))</span>;</span>
<span id="cb254-19"><a href="#cb254-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>No matter if we decide to use implicit or explicit conversions, the
library’s framework will not allow unsafe operations to happen.</p>
<p>If we extend the above example with unsafe conversions, the code will
not compile, and we will have to fix the issues first before the
conversion may be performed:</p>
<table>
<thead>
<tr class="header">
<th><div style="text-align:center">
<strong>Unsafe</strong>
</div></th>
<th><div style="text-align:center">
<strong>Fixed</strong>
</div></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><div>

<div class="sourceCode" id="cb255"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>isq<span class="op">::</span>height<span class="op">[</span>m<span class="op">]&gt;</span> h3 <span class="op">=</span> height;</span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>isq<span class="op">::</span>height<span class="op">[</span>mm<span class="op">]</span>, <span class="dt">int</span><span class="op">&gt;</span> h4 <span class="op">=</span> height;</span>
<span id="cb255-3"><a href="#cb255-3" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>isq<span class="op">::</span>height<span class="op">[</span>km<span class="op">]</span>, <span class="dt">int</span><span class="op">&gt;</span> h5 <span class="op">=</span> height;  <span class="co">// Error (1)</span></span>
<span id="cb255-4"><a href="#cb255-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-5"><a href="#cb255-5" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> h3 <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>;</span>
<span id="cb255-6"><a href="#cb255-6" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> h4 <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>;</span>
<span id="cb255-7"><a href="#cb255-7" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> h5 <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>;</span>
<span id="cb255-8"><a href="#cb255-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-9"><a href="#cb255-9" aria-hidden="true" tabindex="-1"></a>print<span class="op">(</span>Meter<span class="op">(</span>h3<span class="op">))</span>;                            <span class="co">// Error (2)</span></span>
<span id="cb255-10"><a href="#cb255-10" aria-hidden="true" tabindex="-1"></a>print<span class="op">(</span>Meter<span class="op">(</span>h4<span class="op">))</span>;                            <span class="co">// Error (3)</span></span>
<span id="cb255-11"><a href="#cb255-11" aria-hidden="true" tabindex="-1"></a>print<span class="op">(</span>Meter<span class="op">(</span>h5<span class="op">))</span>;</span></code></pre></div>

</div></td>
<td><div>

<div class="sourceCode" id="cb256"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>isq<span class="op">::</span>height<span class="op">[</span>m<span class="op">]&gt;</span> h3 <span class="op">=</span> height;</span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>isq<span class="op">::</span>height<span class="op">[</span>mm<span class="op">]</span>, <span class="dt">int</span><span class="op">&gt;</span> h4 <span class="op">=</span> height;</span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a>quantity<span class="op">&lt;</span>isq<span class="op">::</span>height<span class="op">[</span>km<span class="op">]</span>, <span class="dt">int</span><span class="op">&gt;</span> h5 <span class="op">=</span> quantity<span class="op">{</span>height<span class="op">}.</span>force_in<span class="op">(</span>km<span class="op">)</span>;</span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-5"><a href="#cb256-5" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> h3 <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>;</span>
<span id="cb256-6"><a href="#cb256-6" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> h4 <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>;</span>
<span id="cb256-7"><a href="#cb256-7" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> h5 <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>;</span>
<span id="cb256-8"><a href="#cb256-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-9"><a href="#cb256-9" aria-hidden="true" tabindex="-1"></a>print<span class="op">(</span>Meter<span class="op">(</span>value_cast<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span>h3<span class="op">)))</span>;</span>
<span id="cb256-10"><a href="#cb256-10" aria-hidden="true" tabindex="-1"></a>print<span class="op">(</span>Meter<span class="op">(</span>h4<span class="op">.</span>force_in<span class="op">(</span>m<span class="op">)))</span>;</span>
<span id="cb256-11"><a href="#cb256-11" aria-hidden="true" tabindex="-1"></a>print<span class="op">(</span>Meter<span class="op">(</span>h5<span class="op">))</span>;</span></code></pre></div>

</div></td>
</tr>
</tbody>
</table>
<p><code class="sourceCode default">(1)</code> Truncation of value while
converting from meters to kilometers.</p>
<p><code class="sourceCode default">(2)</code> Conversion of
<code class="sourceCode default">double</code> to
<code class="sourceCode default">int</code> is not value-preserving.</p>
<p><code class="sourceCode default">(3)</code> Truncation of value while
converting from millimeters to meters.</p>
<h3 data-number="16.9.3" id="quantity-points-conversions"><span class="header-section-number">16.9.3</span> Quantity points
conversions<a href="#quantity-points-conversions" class="self-link"></a></h3>
<p>To play with quantity point conversions, let’s assume that we have a
<code class="sourceCode default">Timestamp</code> strong type in our
codebase, and we would like to start using this library to work with
this abstraction.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Timestamp <span class="op">{</span></span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> seconds;</span>
<span id="cb257-3"><a href="#cb257-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>;</span></code></pre></div>
<p>As we described in <a href="#the-affine-space">The Affine Space</a>
chapter, timestamps should be modeled as quantity points rather than
regular quantities.</p>
<p>To allow the conversion between our custom
<code class="sourceCode default">Timestamp</code> type and the
<code class="sourceCode default">quantity_point</code> class template we
need to provide the following in the partial specialization of the <code class="sourceCode default">quantity_point_like_traits&lt;T&gt;</code>
type trait:</p>
<ul>
<li>static data member <code class="sourceCode default">reference</code>
that provides the quantity point reference (e.g., unit),</li>
<li>static data member
<code class="sourceCode default">point_origin</code> that specifies the
absolute point, which is the beginning of our measurement scale for our
points,</li>
<li><code class="sourceCode default">rep</code> type that specifies the
underlying storage type,</li>
<li><code class="sourceCode default">to_quantity(T)</code> static member
function returning the <code class="sourceCode default">quantity</code>
being the offset of the point from the origin packed in either
<code class="sourceCode default">convert_explicitly</code> or
<code class="sourceCode default">convert_implicitly</code> wrapper,</li>
<li><code class="sourceCode default">from_quantity(quantity&lt;reference, rep&gt;)</code>
static member function returning
<code class="sourceCode default">T</code> packed in either
<code class="sourceCode default">convert_explicitly</code> or
<code class="sourceCode default">convert_implicitly</code> wrapper.</li>
</ul>
<p>For example, for our
<code class="sourceCode default">Timestamp</code> type, we could provide
the following:</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;&gt;</span></span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> std<span class="op">::</span>quantity_point_like_traits<span class="op">&lt;</span>Timestamp<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb258-3"><a href="#cb258-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">static</span> <span class="kw">constexpr</span> <span class="kw">auto</span> reference <span class="op">=</span> si<span class="op">::</span>second;</span>
<span id="cb258-4"><a href="#cb258-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">static</span> <span class="kw">constexpr</span> <span class="kw">auto</span> point_origin <span class="op">=</span> default_point_origin<span class="op">(</span>reference<span class="op">)</span>;</span>
<span id="cb258-5"><a href="#cb258-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">using</span> rep <span class="op">=</span> <span class="kw">decltype</span><span class="op">(</span>Timestamp<span class="op">::</span>seconds<span class="op">)</span>;</span>
<span id="cb258-6"><a href="#cb258-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-7"><a href="#cb258-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">static</span> <span class="kw">constexpr</span> convert_implicitly<span class="op">&lt;</span>quantity<span class="op">&lt;</span>reference, rep<span class="op">&gt;&gt;</span> to_quantity<span class="op">(</span>Timestamp ts<span class="op">)</span></span>
<span id="cb258-8"><a href="#cb258-8" aria-hidden="true" tabindex="-1"></a>  <span class="op">{</span></span>
<span id="cb258-9"><a href="#cb258-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ts<span class="op">.</span>seconds <span class="op">*</span> si<span class="op">::</span>second;</span>
<span id="cb258-10"><a href="#cb258-10" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb258-11"><a href="#cb258-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-12"><a href="#cb258-12" aria-hidden="true" tabindex="-1"></a>  <span class="kw">static</span> <span class="kw">constexpr</span> convert_explicitly<span class="op">&lt;</span>Timestamp<span class="op">&gt;</span> from_quantity<span class="op">(</span>quantity<span class="op">&lt;</span>reference, rep<span class="op">&gt;</span> q<span class="op">)</span></span>
<span id="cb258-13"><a href="#cb258-13" aria-hidden="true" tabindex="-1"></a>  <span class="op">{</span></span>
<span id="cb258-14"><a href="#cb258-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Timestamp<span class="op">(</span>q<span class="op">.</span>numerical_value_ref_in<span class="op">(</span>si<span class="op">::</span>second<span class="op">))</span>;</span>
<span id="cb258-15"><a href="#cb258-15" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb258-16"><a href="#cb258-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>;</span></code></pre></div>
<p>After that, we can check that the <a href="#QuantityPointLike-concept"><code class="sourceCode default">QuantityPointLike</code></a>
concept is satisfied:</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="kw">static_assert</span><span class="op">(</span>mp_units<span class="op">::</span>QuantityPointLike<span class="op">&lt;</span>Timestamp<span class="op">&gt;)</span>;</span></code></pre></div>
<p>and we can write the following:</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> print<span class="op">(</span>Timestamp ts<span class="op">)</span> <span class="op">{</span> std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> ts<span class="op">.</span>seconds <span class="op">&lt;&lt;</span> <span class="st">&quot; s</span><span class="sc">\n</span><span class="st">&quot;</span>; <span class="op">}</span></span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span></span>
<span id="cb260-4"><a href="#cb260-4" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb260-5"><a href="#cb260-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">using</span> <span class="kw">namespace</span> mp_units;</span>
<span id="cb260-6"><a href="#cb260-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">using</span> <span class="kw">namespace</span> mp_units<span class="op">::</span>si<span class="op">::</span>unit_symbols;</span>
<span id="cb260-7"><a href="#cb260-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-8"><a href="#cb260-8" aria-hidden="true" tabindex="-1"></a>  Timestamp ts<span class="op">{</span><span class="dv">42</span><span class="op">}</span>;</span>
<span id="cb260-9"><a href="#cb260-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-10"><a href="#cb260-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">// implicit conversion</span></span>
<span id="cb260-11"><a href="#cb260-11" aria-hidden="true" tabindex="-1"></a>  quantity_point qp <span class="op">=</span> ts;</span>
<span id="cb260-12"><a href="#cb260-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-13"><a href="#cb260-13" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> qp<span class="op">.</span>quantity_from_zero<span class="op">()</span> <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>;</span>
<span id="cb260-14"><a href="#cb260-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-15"><a href="#cb260-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">// explicit conversion</span></span>
<span id="cb260-16"><a href="#cb260-16" aria-hidden="true" tabindex="-1"></a>  print<span class="op">(</span>Timestamp<span class="op">(</span>qp<span class="op">))</span>;</span>
<span id="cb260-17"><a href="#cb260-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 data-number="16.9.4" id="interoperability-with-the-stdchrono-abstractions"><span class="header-section-number">16.9.4</span> Interoperability with the
<code class="sourceCode default">std::chrono</code> abstractions<a href="#interoperability-with-the-stdchrono-abstractions" class="self-link"></a></h3>
<p>In the C++ standard library, we have two types that handle quantities
and model the affine space. Those are:</p>
<ul>
<li><a href="https://en.cppreference.com/w/cpp/chrono/duration"><code class="sourceCode default">std::chrono::duration</code></a>
- specifies quantities of time,</li>
<li><a href="https://en.cppreference.com/w/cpp/chrono/time_point"><code class="sourceCode default">std::chrono::time_point</code></a>
- specifies quantity points of time.</li>
</ul>
<p>This library comes with built-in interoperability with those types
thanks to:</p>
<ul>
<li>partial specializations of
<code class="sourceCode default">quantity_like_traits</code> and
<code class="sourceCode default">quantity_point_like_traits</code> that
provide support for implicit conversions between types in both
directions,</li>
<li><code class="sourceCode default">chrono_point_origin&lt;Clock&gt;</code>
point origin for <code class="sourceCode default">std</code>
clocks,</li>
<li><code class="sourceCode default">to_chrono_duration</code> and
<code class="sourceCode default">to_chrono_time_point</code> dedicated
conversion functions that result in types exactly representing this
library’s abstractions.</li>
</ul>
<p>It is important to note here that only a
<code class="sourceCode default">quantity_point</code> that uses
<code class="sourceCode default">chrono_point_origin&lt;Clock&gt;</code>
as its origin can be converted to the
<code class="sourceCode default">std::chrono</code> abstractions:</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> ts_origin <span class="op">:</span> relative_point_origin<span class="op">&lt;</span>chrono_point_origin<span class="op">&lt;</span>system_clock<span class="op">&gt;</span> <span class="op">+</span> <span class="dv">1</span> <span class="op">*</span> h<span class="op">&gt;</span> <span class="op">{}</span> ts_origin;</span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> my_origin <span class="op">:</span> absolute_point_origin<span class="op">&lt;</span>my_origin, isq<span class="op">::</span>time<span class="op">&gt;</span> <span class="op">{}</span> my_origin;</span>
<span id="cb261-3"><a href="#cb261-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-4"><a href="#cb261-4" aria-hidden="true" tabindex="-1"></a>quantity_point qp1 <span class="op">=</span> sys_seconds<span class="op">{</span><span class="dv">1</span><span class="bu">s</span><span class="op">}</span>;</span>
<span id="cb261-5"><a href="#cb261-5" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> tp1 <span class="op">=</span> to_chrono_time_point<span class="op">(</span>qp1<span class="op">)</span>;  <span class="co">// OK</span></span>
<span id="cb261-6"><a href="#cb261-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-7"><a href="#cb261-7" aria-hidden="true" tabindex="-1"></a>quantity_point qp2 <span class="op">=</span> chrono_point_origin<span class="op">&lt;</span>system_clock<span class="op">&gt;</span> <span class="op">+</span> <span class="dv">1</span> <span class="op">*</span> s;</span>
<span id="cb261-8"><a href="#cb261-8" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> tp2 <span class="op">=</span> to_chrono_time_point<span class="op">(</span>qp2<span class="op">)</span>;  <span class="co">// OK</span></span>
<span id="cb261-9"><a href="#cb261-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-10"><a href="#cb261-10" aria-hidden="true" tabindex="-1"></a>quantity_point qp3 <span class="op">=</span> ts_origin <span class="op">+</span> <span class="dv">1</span> <span class="op">*</span> s;</span>
<span id="cb261-11"><a href="#cb261-11" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> tp3 <span class="op">=</span> to_chrono_time_point<span class="op">(</span>qp3<span class="op">)</span>;  <span class="co">// OK</span></span>
<span id="cb261-12"><a href="#cb261-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-13"><a href="#cb261-13" aria-hidden="true" tabindex="-1"></a>quantity_point qp4 <span class="op">=</span> my_origin <span class="op">+</span> <span class="dv">1</span> <span class="op">*</span> s;</span>
<span id="cb261-14"><a href="#cb261-14" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> tp4 <span class="op">=</span> to_chrono_time_point<span class="op">(</span>qp4<span class="op">)</span>;  <span class="co">// Compile-time Error (1)</span></span>
<span id="cb261-15"><a href="#cb261-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-16"><a href="#cb261-16" aria-hidden="true" tabindex="-1"></a>quantity_point qp5<span class="op">{</span><span class="dv">1</span> <span class="op">*</span> s<span class="op">}</span>;</span>
<span id="cb261-17"><a href="#cb261-17" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> tp5 <span class="op">=</span> to_chrono_time_point<span class="op">(</span>qp5<span class="op">)</span>;  <span class="co">// Compile-time Error (2)</span></span></code></pre></div>
<p><code class="sourceCode default">(1)</code>
<code class="sourceCode default">my_origin</code> is not defined in
terms of
<code class="sourceCode default">chrono_point_origin&lt;Clock&gt;</code>.</p>
<p><code class="sourceCode default">(2)</code>
<code class="sourceCode default">zeroth_point_origin</code> is not
defined in terms of
<code class="sourceCode default">chrono_point_origin&lt;Clock&gt;</code>.</p>
<p>Here is an example of how interoperability described in this chapter
can be used in practice:</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">::</span>chrono;</span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-3"><a href="#cb262-3" aria-hidden="true" tabindex="-1"></a>sys_seconds ts_now <span class="op">=</span> floor<span class="op">&lt;</span>seconds<span class="op">&gt;(</span>system_clock<span class="op">::</span>now<span class="op">())</span>;</span>
<span id="cb262-4"><a href="#cb262-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-5"><a href="#cb262-5" aria-hidden="true" tabindex="-1"></a>quantity_point start_time <span class="op">=</span> ts_now;</span>
<span id="cb262-6"><a href="#cb262-6" aria-hidden="true" tabindex="-1"></a>quantity speed <span class="op">=</span> <span class="fl">925.</span> <span class="op">*</span> km <span class="op">/</span> h;</span>
<span id="cb262-7"><a href="#cb262-7" aria-hidden="true" tabindex="-1"></a>quantity distance <span class="op">=</span> <span class="fl">8111.</span> <span class="op">*</span> km;</span>
<span id="cb262-8"><a href="#cb262-8" aria-hidden="true" tabindex="-1"></a>quantity flight_time <span class="op">=</span> distance <span class="op">/</span> speed;</span>
<span id="cb262-9"><a href="#cb262-9" aria-hidden="true" tabindex="-1"></a>quantity_point exp_end_time <span class="op">=</span> start_time <span class="op">+</span> flight_time;</span>
<span id="cb262-10"><a href="#cb262-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-11"><a href="#cb262-11" aria-hidden="true" tabindex="-1"></a>sys_seconds ts_end <span class="op">=</span> value_cast<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span>exp_end_time<span class="op">.</span>in<span class="op">(</span>s<span class="op">))</span>;</span>
<span id="cb262-12"><a href="#cb262-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-13"><a href="#cb262-13" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> curr_time <span class="op">=</span> zoned_time<span class="op">(</span>current_zone<span class="op">()</span>, ts_now<span class="op">)</span>;</span>
<span id="cb262-14"><a href="#cb262-14" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> mst_time <span class="op">=</span> zoned_time<span class="op">(</span><span class="st">&quot;America/Denver&quot;</span>, ts_end<span class="op">)</span>;</span>
<span id="cb262-15"><a href="#cb262-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-16"><a href="#cb262-16" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;Takeoff: &quot;</span> <span class="op">&lt;&lt;</span> curr_time <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>;</span>
<span id="cb262-17"><a href="#cb262-17" aria-hidden="true" tabindex="-1"></a>std<span class="op">::</span>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;Landing: &quot;</span> <span class="op">&lt;&lt;</span> mst_time <span class="op">&lt;&lt;</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>;</span></code></pre></div>
<p>The above may print the following output:</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a>Takeoff<span class="op">:</span> <span class="dv">2023</span><span class="op">-</span><span class="dv">11</span><span class="op">-</span><span class="dv">18</span> <span class="dv">13</span><span class="op">:</span><span class="dv">20</span><span class="op">:</span><span class="dv">54</span> UTC</span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a>Landing<span class="op">:</span> <span class="dv">2023</span><span class="op">-</span><span class="dv">11</span><span class="op">-</span><span class="dv">18</span> <span class="dv">15</span><span class="op">:</span><span class="bn">07</span><span class="op">:</span><span class="bn">01</span> MST</span></code></pre></div>
<h1 data-number="17" id="teachability"><span class="header-section-number">17</span> Teachability<a href="#teachability" class="self-link"></a></h1>
<p>Through the last years <span class="citation" data-cites="MP-UNITS">[<a href="#ref-MP-UNITS" role="doc-biblioref">mp-units</a>]</span> library proved to be very
intuitive to both novices in the domain and non-C++ experts. Thanks to
the user-friendly multiply syntax, support for CTAD, excellent
readability of generated types in compiler error messages, and
simplicity of systems definitions, this library makes it easy to do the
first steps in the dimensional analysis domain.</p>
<p>If someone is new to the domain, a concise introduction of <a href="#systems-of-units">Systems of units</a>, the <span class="citation" data-cites="SI">[<a href="#ref-SI" role="doc-biblioref">SI</a>]</span>, and the US Customary System (and
how it relates to SI) might be needed.</p>
<p>After that, every new user, even a C++ newbie, should have no
problems with understanding the topics of the <a href="#unit-based-quantities-simple-mode">Unit-based quantities (simple
mode)</a> chapter and should be able to start using the library
successfully. At least as long as they keep operating in the safety zone
using floating-point representation types.</p>
<p>Eventually, the library will stand in the way, disallowing “unsafe”
conversions. This would be a perfect place to mention the importance of
providing safe interfaces at compile-time and describe why narrowing
conversions are unwelcome and what the side effects of those might be.
After that, forced conversions in the library should be presented.</p>
<p>In case a target audience needs to interact with legacy interfaces
that take raw numeric values, <a href="#obtaining-a-numerical-value-of-a-quantity">Obtaining a numerical
value of a quantity</a> chapter should be introduced. In such a case, it
is important to warn students of why this operation is unsafe and what
are the potential maintainability issues.</p>
<p>Next, we could show how easy extending the library with custom units
is. A simple and funny example like the below could be a great exercise
here:</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> mp_units;</span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> std;</span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-4"><a href="#cb264-4" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="kw">constexpr</span> <span class="kw">struct</span> smoot <span class="op">:</span> std<span class="op">::</span>named_unit<span class="op">&lt;</span><span class="st">&quot;smoot&quot;</span>, std<span class="op">::</span>mag<span class="op">&lt;</span><span class="dv">67</span><span class="op">&gt;</span> <span class="op">*</span> std<span class="op">::</span>usc<span class="op">::</span>inch<span class="op">&gt;</span> <span class="op">{}</span> smoot;</span>
<span id="cb264-5"><a href="#cb264-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-6"><a href="#cb264-6" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span></span>
<span id="cb264-7"><a href="#cb264-7" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb264-8"><a href="#cb264-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">constexpr</span> std<span class="op">::</span>quantity dist <span class="op">=</span> <span class="fl">364.4</span> <span class="op">*</span> smoot;</span>
<span id="cb264-9"><a href="#cb264-9" aria-hidden="true" tabindex="-1"></a>  std<span class="op">::</span>println<span class="op">(</span><span class="st">&quot;Harvard Bridge length = {:{%N:.5} %U} ({:{%N:.5} %U}, {:{%N:.5} %U}) ± 1 εar&quot;</span>,</span>
<span id="cb264-10"><a href="#cb264-10" aria-hidden="true" tabindex="-1"></a>               dist, dist<span class="op">.</span>in<span class="op">(</span>usc<span class="op">::</span>foot<span class="op">)</span>, dist<span class="op">.</span>in<span class="op">(</span>si<span class="op">::</span>metre<span class="op">))</span>;</span>
<span id="cb264-11"><a href="#cb264-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>After a while, we can also introduce students to <a href="#the-affine-space">The affine space</a> abstractions and discuss
the <a href="#temperature-support">Temperature support</a>.</p>
<p>With the above, we have learned enough for most users’ needs and do
not need to delve into more details. The library is intuitive and will
prevent all errors at compile time.</p>
<p>For more advanced classes, groups, or use cases, we can introduce <a href="#generic-interfaces">Generic Interfaces</a> and <a href="#systems-of-quantities">Systems of quantities</a> but we don’t
have to describe every detail and corner cases of quantity types design
and their convertibility. It is good to start here with <a href="#why-do-we-need-typed-quantities">Why do we need typed
quantities?</a>, followed by <a href="#quantities-of-the-same-kind">Quantities of the same kind</a> and
<a href="#system-of-quantities-is-not-only-about-kinds">System of
quantities is not only about kinds</a>.</p>
<p>According to our experience, the most common pitfall in using
quantity types might be related to the names chosen for them by the
<span class="citation" data-cites="ISO80000">[<a href="#ref-ISO80000" role="doc-biblioref">ISO/IEC 80000</a>]</span> (e.g., <em>length</em>).
It might be good to describe what <em>length</em> means when we say
“every <em>height</em> is a <em>length</em>” and what it means when we
describe a box of <em>length</em>, <em>width</em>, and <em>height</em>
dimensions. In the latter case, <em>length</em> will not restrict us to
the horizontal dimension only. This is how the ISQ is defined, and we
should accept this. However, we should present a way to define
<em>horizontal length</em> as presented in the <a href="#comparing-adding-and-subtracting-quantities-of-the-same-kind">Comparing,
adding, and subtracting quantities of the same kind</a> and describe its
rationale.</p>
<h1 data-number="18" id="acknowledgements"><span class="header-section-number">18</span> Acknowledgements<a href="#acknowledgements" class="self-link"></a></h1>
<p>Special thanks and recognition goes to <a href="http://www.epam.com">Epam Systems</a> for supporting Mateusz’s
membership in the ISO C++ Committee and the production of this
proposal.</p>
<p>We would also like to thank Peter Sommerlad for providing valuable
feedback that helped us shape the final version of this document.</p>
<!-- markdownlint-disable -->
<h1 data-number="19" id="bibliography"><span class="header-section-number">19</span> References<a href="#bibliography" class="self-link"></a></h1>
<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-ARIANE" class="csl-entry" role="doc-biblioentry">
[Ariane flight V88] Ariane flight V88. <a href="https://en.wikipedia.org/wiki/Ariane_flight_V88"><div class="csl-block">https://en.wikipedia.org/wiki/Ariane_flight_V88</div></a>
</div>
<div id="ref-AU" class="csl-entry" role="doc-biblioentry">
[Au] The Au Units library. <a href="https://aurora-opensource.github.io/au"><div class="csl-block">https://aurora-opensource.github.io/au</div></a>
</div>
<div id="ref-BOOST-UNITS" class="csl-entry" role="doc-biblioentry">
[Boost.Units] Matthias C. Schabel and Steven Watanabe. Boost.Units. <a href="https://www.boost.org/doc/libs/1_83_0/doc/html/boost_units.html"><div class="csl-block">https://www.boost.org/doc/libs/1_83_0/doc/html/boost_units.html</div></a>
</div>
<div id="ref-CHEP98" class="csl-entry" role="doc-biblioentry">
[CHEP’98] Walter E. Brown. Introduction to the SI Library of Unit-Based
Computation. <a href="https://digital.library.unt.edu/ark:/67531/metadc668099"><div class="csl-block">https://digital.library.unt.edu/ark:/67531/metadc668099</div></a>
</div>
<div id="ref-CLARENCE" class="csl-entry" role="doc-biblioentry">
[Clarence] Steve Chawkins. Mismeasure for Measure. <a href="https://www.latimes.com/archives/la-xpm-2001-feb-09-me-23253-story.html"><div class="csl-block">https://www.latimes.com/archives/la-xpm-2001-feb-09-me-23253-story.html</div></a>
</div>
<div id="ref-COLUMBUS" class="csl-entry" role="doc-biblioentry">
[Columbus] Christopher Columbus. <a href="https://en.wikipedia.org/wiki/Christopher_Columbus"><div class="csl-block">https://en.wikipedia.org/wiki/Christopher_Columbus</div></a>
</div>
<div id="ref-DISNEY" class="csl-entry" role="doc-biblioentry">
[Disney] Cause of the Space Mountain Incident Determined at Tokyo
Disneyland Park. <a href="https://web.archive.org/web/20040209033827/http://www.olc.co.jp/news/20040121_01en.html"><div class="csl-block">https://web.archive.org/web/20040209033827/http://www.olc.co.jp/news/20040121_01en.html</div></a>
</div>
<div id="ref-FLIGHT_6316" class="csl-entry" role="doc-biblioentry">
[Flight 6316] Korean Air Flight 6316 MD-11, Shanghai, China - April 15,
1999. <a href="https://web.archive.org/web/20210917190721/https://www.ntsb.gov/news/press-releases/Pages/Korean_Air_Flight_6316_MD-11_Shanghai_China_-_April_15_1999.aspx"><div class="csl-block">https://web.archive.org/web/20210917190721/https://www.ntsb.gov/news/press-releases/Pages/Korean_Air_Flight_6316_MD-11_Shanghai_China_-_April_15_1999.aspx</div></a>
</div>
<div id="ref-GIMLI_GLIDER" class="csl-entry" role="doc-biblioentry">
[Gimli Glider] Gimli Glider. <a href="https://en.wikipedia.org/wiki/Gimli_Glider"><div class="csl-block">https://en.wikipedia.org/wiki/Gimli_Glider</div></a>
</div>
<div id="ref-HOCHRHEINBRÜCKE" class="csl-entry" role="doc-biblioentry">
[Hochrheinbrücke] An embarrassing discovery during the construction of a
bridge. <a href="https://www.normaalamsterdamspeil.nl/wp-content/uploads/2015/03/website_bridge.pdf"><div class="csl-block">https://www.normaalamsterdamspeil.nl/wp-content/uploads/2015/03/website_bridge.pdf</div></a>
</div>
<div id="ref-ISO80000" class="csl-entry" role="doc-biblioentry">
[ISO/IEC 80000] ISO/IEC 80000: Quantities and units. <a href="https://www.iso.org/standard/76921.html"><div class="csl-block">https://www.iso.org/standard/76921.html</div></a>
</div>
<div id="ref-ISO-GUIDE" class="csl-entry" role="doc-biblioentry">
[ISO/IEC Guide 99] ISO/IEC Guide 99: International vocabulary of
metrology — Basic and general concepts and associated terms (VIM). <a href="https://www.iso.org/obp/ui#iso:std:iso-iec:guide:99"><div class="csl-block">https://www.iso.org/obp/ui#iso:std:iso-iec:guide:99</div></a>
</div>
<div id="ref-BIPM-VIM" class="csl-entry" role="doc-biblioentry">
[JCGM 200:2012] International vocabulary of metrology - Basic and
general concepts and associated terms (VIM) (JCGM 200:2012, 3rd
edition). <a href="https://jcgm.bipm.org/vim/en"><div class="csl-block">https://jcgm.bipm.org/vim/en</div></a>
</div>
<div id="ref-JSR-385" class="csl-entry" role="doc-biblioentry">
[JSR 385] Units of Measurement. <a href="https://unitsofmeasurement.github.io/indriya"><div class="csl-block">https://unitsofmeasurement.github.io/indriya</div></a>
</div>
<div id="ref-LK8000" class="csl-entry" role="doc-biblioentry">
[LK8000] LK8000 - Tactical Flight Computer. <a href="http://lk8000.it"><div class="csl-block">http://lk8000.it</div></a>
</div>
<div id="ref-MARS_ORBITER" class="csl-entry" role="doc-biblioentry">
[Mars Orbiter] Mars Climate Orbiter. <a href="https://en.wikipedia.org/wiki/Mars_Climate_Orbiter"><div class="csl-block">https://en.wikipedia.org/wiki/Mars_Climate_Orbiter</div></a>
</div>
<div id="ref-MSRMT_DATA" class="csl-entry" role="doc-biblioentry">
[Measurement Data] William Kent, Stephanie Leichner Janowski, Bruce
Hamilton, and Dan Hepner. Measurement Data (Archive Report). <a href="https://www.bkent.net/Doc/mdarchiv.pdf"><div class="csl-block">https://www.bkent.net/Doc/mdarchiv.pdf</div></a>
</div>
<div id="ref-MEDICATION_DOSE_ERRORS" class="csl-entry" role="doc-biblioentry">
[Medication dose errors] Alma Mulac, Ellen Hagesaether, and Anne Gerd
Granas. Medication dose calculation errors and other numeracy mishaps in
hospitals: Analysis of the nature and enablers of incident reports. <a href="https://onlinelibrary.wiley.com/doi/10.1111/jan.15072"><div class="csl-block">https://onlinelibrary.wiley.com/doi/10.1111/jan.15072</div></a>
</div>
<div id="ref-MISRA_CPP" class="csl-entry" role="doc-biblioentry">
[MISRA C++] MISRA C++:2008 Guidelines for the use of the C++ language in
critical systems. <a href="https://misra.org.uk/misra-c-plus-plus/"><div class="csl-block">https://misra.org.uk/misra-c-plus-plus/</div></a>
</div>
<div id="ref-MP-UNITS" class="csl-entry" role="doc-biblioentry">
[mp-units] mp-units - A Physical Quantities and Units library for C++.
<a href="https://mpusz.github.io/mp-units"><div class="csl-block">https://mpusz.github.io/mp-units</div></a>
</div>
<div id="ref-NHOLTHAUS-UNITS" class="csl-entry" role="doc-biblioentry">
[nholthaus/units] UNITS - A compile-time, header-only, dimensional
analysis and unit conversion library built on c++14 with no
dependencies. <a href="https://github.com/nholthaus/units"><div class="csl-block">https://github.com/nholthaus/units</div></a>
</div>
<div id="ref-P0870R5" class="csl-entry" role="doc-biblioentry">
[P0870R5] Giuseppe D’Angelo. 2023-02-15. A proposal for a type trait to
detect narrowing conversions. <a href="https://wg21.link/p0870r5"><div class="csl-block">https://wg21.link/p0870r5</div></a>
</div>
<div id="ref-P1045R1" class="csl-entry" role="doc-biblioentry">
[P1045R1] David Stone. 2019-09-27. constexpr Function Parameters. <a href="https://wg21.link/p1045r1"><div class="csl-block">https://wg21.link/p1045r1</div></a>
</div>
<div id="ref-P1729R3" class="csl-entry" role="doc-biblioentry">
[P1729R3] Elias Kosunen, Victor Zverovich. 2023-10-12. Text Parsing. <a href="https://wg21.link/p1729r3"><div class="csl-block">https://wg21.link/p1729r3</div></a>
</div>
<div id="ref-P1930R0" class="csl-entry" role="doc-biblioentry">
[P1930R0] Vincent Reverdy. 2019-10-07. Towards a standard unit systems
library. <a href="https://wg21.link/p1930r0"><div class="csl-block">https://wg21.link/p1930r0</div></a>
</div>
<div id="ref-P1935R2" class="csl-entry" role="doc-biblioentry">
[P1935R2] Mateusz Pusz. 2020-01-13. A C++ Approach to Physical Units. <a href="https://wg21.link/p1935r2"><div class="csl-block">https://wg21.link/p1935r2</div></a>
</div>
<div id="ref-P2509R0" class="csl-entry" role="doc-biblioentry">
[P2509R0] Giuseppe D’Angelo. 2021-12-17. A proposal for a type trait to
detect value-preserving conversions. <a href="https://wg21.link/p2509r0"><div class="csl-block">https://wg21.link/p2509r0</div></a>
</div>
<div id="ref-P2980R1" class="csl-entry" role="doc-biblioentry">
[P2980R1] Mateusz Pusz, Dominik Berner, Johel Ernesto Guerrero Peña,
Charles Hogg, Nicolas Holthaus, Roth Michaels, Vincent Reverdy.
2023-11-28. A motivation, scope, and plan for a quantities and units
library. <a href="https://wg21.link/p2980r1"><div class="csl-block">https://wg21.link/p2980r1</div></a>
</div>
<div id="ref-P2981R1" class="csl-entry" role="doc-biblioentry">
[P2981R1] Mateusz Pusz, Dominik Berner, Johel Ernesto Guerrero Peña.
2023-11-09. Improving our safety with a physical quantities and units
library. <a href="https://wg21.link/p2981r1"><div class="csl-block">https://wg21.link/p2981r1</div></a>
</div>
<div id="ref-P2982R1" class="csl-entry" role="doc-biblioentry">
[P2982R1] Mateusz Pusz, Chip Hogg. 2023-11-09. `std::quantity` as a
numeric type. <a href="https://wg21.link/p2982r1"><div class="csl-block">https://wg21.link/p2982r1</div></a>
</div>
<div id="ref-P2993_PRE" class="csl-entry" role="doc-biblioentry">
[P2993] Luke Valenty. Constrained Numbers. <a href="https://wg21.link/p2993"><div class="csl-block">https://wg21.link/p2993</div></a>
</div>
<div id="ref-P3003R0" class="csl-entry" role="doc-biblioentry">
[P3003R0] Johel Ernesto Guerrero Peña. 2023-10-14. The design of a
library of number concepts. <a href="https://wg21.link/p3003r0"><div class="csl-block">https://wg21.link/p3003r0</div></a>
</div>
<div id="ref-P3045R0" class="csl-entry" role="doc-biblioentry">
[P3045R0] Mateusz Pusz, Dominik Berner, Johel Ernesto Guerrero Peña,
Charles Hogg, Nicolas Holthaus, Roth Michaels, Vincent Reverdy.
2024-02-15. Quantities and units library. <a href="https://wg21.link/p3045r0"><div class="csl-block">https://wg21.link/p3045r0</div></a>
</div>
<div id="ref-P3094R0" class="csl-entry" role="doc-biblioentry">
[P3094R0] Mateusz Pusz. 2024-02-05. std::basic_fixed_string. <a href="https://wg21.link/p3094r0"><div class="csl-block">https://wg21.link/p3094r0</div></a>
</div>
<div id="ref-P3133R0" class="csl-entry" role="doc-biblioentry">
[P3133R0] Chip Hogg. 2024-02-14. Fast first-factor finding function. <a href="https://wg21.link/p3133r0"><div class="csl-block">https://wg21.link/p3133r0</div></a>
</div>
<div id="ref-PINT" class="csl-entry" role="doc-biblioentry">
[Pint] Pint: makes units easy. <a href="https://pint.readthedocs.io/en/stable/index.html"><div class="csl-block">https://pint.readthedocs.io/en/stable/index.html</div></a>
</div>
<div id="ref-SI" class="csl-entry" role="doc-biblioentry">
[SI] SI Brochure: The International System of Units (SI). <a href="https://www.bipm.org/en/publications/si-brochure"><div class="csl-block">https://www.bipm.org/en/publications/si-brochure</div></a>
</div>
<div id="ref-SI_LIB" class="csl-entry" role="doc-biblioentry">
[SI library] SI - Type safety for physical units”. <a href="https://si.dominikberner.ch/doc"><div class="csl-block">https://si.dominikberner.ch/doc</div></a>
</div>
<div id="ref-STONEHENGE" class="csl-entry" role="doc-biblioentry">
[Stonehenge] Tim Robey. Tiny stones, giant laughs: the story behind
Spinal Tap’s Stonehenge. <a href="https://www.telegraph.co.uk/films/2020/05/01/tiny-stones-giant-laughs-story-behind-spinal-taps-stonehenge"><div class="csl-block">https://www.telegraph.co.uk/films/2020/05/01/tiny-stones-giant-laughs-story-behind-spinal-taps-stonehenge</div></a>
</div>
<div id="ref-THE_GUARDIAN" class="csl-entry" role="doc-biblioentry">
[The Guardian] Charles Pensulo. Record Heat: Malawi swelters with
temperatures nearly 68F above average. <a href="https://randomascii.wordpress.com/2023/10/17/localization-failure-temperature-is-hard"><div class="csl-block">https://randomascii.wordpress.com/2023/10/17/localization-failure-temperature-is-hard</div></a>
</div>
<div id="ref-VCINL" class="csl-entry" role="doc-biblioentry">
[Value Category Is Not Lifetime] Arthur O’Dwyer. Value Category Is Not
Lifetime. <a href="https://quuxplusone.github.io/blog/2019/03/11/value-category-is-not-lifetime/"><div class="csl-block">https://quuxplusone.github.io/blog/2019/03/11/value-category-is-not-lifetime/</div></a>
</div>
<div id="ref-VASA" class="csl-entry" role="doc-biblioentry">
[Vasa] Rhitu Chatterjee and Lisa Mullins. New Clues Emerge in
Centuries-Old Swedish Shipwreck. <a href="https://theworld.org/stories/2012-02-23/new-clues-emerge-centuries-old-swedish-shipwreck"><div class="csl-block">https://theworld.org/stories/2012-02-23/new-clues-emerge-centuries-old-swedish-shipwreck</div></a>
</div>
<div id="ref-WILD_RICE" class="csl-entry" role="doc-biblioentry">
[Wild Rice] Manufacturers, exporters think metric. <a href="https://www.bizjournals.com/eastbay/stories/2001/07/09/focus3.html"><div class="csl-block">https://www.bizjournals.com/eastbay/stories/2001/07/09/focus3.html</div></a>
</div>
</div>
</div>
</div>
</body>
</html>
